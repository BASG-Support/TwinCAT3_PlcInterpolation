var TcHmi;!function(t){let e;!function(e){let n;!function(e){class n extends t.Controls.System.TcHmiControl{constructor(element,e,n){super(element,e,n),this.__targetMarkup=null,this.__currentContent=null,this.__onResizedEventDestroyEvent=null,this.__onContentChangedEventDestroyEvent=null,this.__onContentCreatedEventDestroyEvent=null,this.__onContentRemovedEventDestroyEvent=null,this.__processTargetMarkupTimeout1=0,this.__processTargetMarkupTimeout2=0,this.__processTargetMarkupOldContent=null,this.__processTargetMarkupOldContentOldOpacity="",!0===TCHMI_ENGINEERING&&(this.__onContentChangedEventDestroyEvent=t.EventProvider.register("System.onContentChanged",this.__onContentChanged()),this.__onContentCreatedEventDestroyEvent=t.EventProvider.register("System.onContentCreated",this.__onContentCreated()),this.__onContentRemovedEventDestroyEvent=t.EventProvider.register("System.onContentRemoved",this.__onContentRemoved())),this.__onResizedEventDestroyEvent=t.EventProvider.register(this.getId()+".onResized",this.__onResized());let r=this.__element[0].querySelector(".TcHmi_System_Controls_TcHmiRegion-loading-spinner-container");if(r)r.remove(),this.__processTargetMarkupLoadingSpinnerDiv=r;else{let t=document.createElement("div");t.innerHTML='<div class="TcHmi_System_Controls_TcHmiRegion-loading-spinner-container"><div class="TcHmi_System_Controls_TcHmiRegion-loading-spinner"><div></div><div></div><div></div><div></div></div></div>',this.__processTargetMarkupLoadingSpinnerDiv=t.firstElementChild}}__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_System_TcHmiRegion-template"),0===this.__elementTemplateRoot.length&&(this.__elementTemplateRoot=this.__element.find(".tchmi-region-template")),0===this.__elementTemplateRoot.length)throw new Error("Invalid Template.html");super.__previnit()}__init(){super.__init(),this.__processScrolling(),this.__processScaleMode()}__attach(){super.__attach()}__detach(){super.__detach()}destroy(){var e;this.__keepAlive||(t.Engineering.ErrorPane.remove("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED"),this.__xhr&&(this.__xhr.abort(),this.__xhr=void 0),this.__processTargetMarkupTimeout1&&(clearTimeout(this.__processTargetMarkupTimeout1),this.__processTargetMarkupTimeout1=0),this.__processTargetMarkupTimeout2&&(clearTimeout(this.__processTargetMarkupTimeout2),this.__processTargetMarkupTimeout2=0),!0===TCHMI_ENGINEERING&&(null!==this.__onContentChangedEventDestroyEvent&&(this.__onContentChangedEventDestroyEvent(),this.__onContentChangedEventDestroyEvent=null),null!==this.__onContentCreatedEventDestroyEvent&&(this.__onContentCreatedEventDestroyEvent(),this.__onContentCreatedEventDestroyEvent=null),null!==this.__onContentRemovedEventDestroyEvent&&(this.__onContentRemovedEventDestroyEvent(),this.__onContentRemovedEventDestroyEvent=null)),this.__onResizedEventDestroyEvent&&(this.__onResizedEventDestroyEvent(),this.__onResizedEventDestroyEvent=null),(null===(e=this.__currentContent)||void 0===e?void 0:e.getKeepAlive())&&this.__removeChild(this.__currentContent),super.destroy())}__setKeepAlive(value){if(super.__setKeepAlive(value),this.__currentContent){let e=tchmi_path(this.__targetContent),n=!1;if(e&&!0===t.System.Data.isKeepAlivePartial.get(e)&&(n=!0),e&&this.__targetContentMarkup&&(n||this.__keepAlive)&&!t.System.Data.Caches.partialMarkupCache.has(this.__targetContentMarkup)){let n=document.createElement("div");n.innerHTML=this.__targetContentMarkup,n.firstElementChild&&t.System.Data.Caches.partialMarkupCache.set(e,{markup:this.__targetContentMarkup,partialId:n.firstElementChild.id})}!0!==value&&!1!==n||this.__currentContent.__setKeepAlive(value)}}__tryContentRefresh(url,content){null===this.__targetContent||tchmi_path(url)!==tchmi_path(this.__targetContent)||null!=content&&this.__targetMarkup===content||(null!=content?this.__processTargetContent(content):this.__processTargetContent())}__onContentChanged(){return(t,data)=>{this.__tryContentRefresh(data.url,data.content)}}__onContentCreated(){return(t,data)=>{this.__tryContentRefresh(data.url,null)}}__onContentRemoved(){return(t,data)=>{this.__tryContentRefresh(data.url,null)}}__onResized(){return(t,data)=>{this.__processScrolling(),this.__processScaleMode()}}__isRecursionSave(path){let t=this.__parent;for(;null!==t;){if("TcHmi.Controls.System.TcHmiRegion"===t.getType()&&void 0!==t.getTargetContent&&tchmi_path(t.getTargetContent())===path)return t=null,!1;t=t.getParent()}return!0}setWidthMode(valueNew){let e=t.ValueConverter.toSizeModeWithContent(valueNew);null===e&&(e=this.getAttributeDefaultValueInternal("WidthMode")),e!==this.__widthMode&&(this.__widthMode=e,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"WidthMode"}),this.__processWidthMode())}__processWidth(callerControl){if("Content"===this.getWidthMode()){let e="";if(null!==this.__currentContent){const t=this.__currentContent.__getContentWidth();null!==t&&(e=t+"px"),callerControl&&this.__currentContent===callerControl||"Content"!==this.__currentContent.getWidthMode()||this.__currentContent.__processWidth(this)}t.StyleProvider.setSimpleElementStyle(this.__element,"width",e)}super.__processWidth(callerControl)}setHeightMode(valueNew){let e=t.ValueConverter.toSizeModeWithContent(valueNew);null===e&&(e=this.getAttributeDefaultValueInternal("HeightMode")),e!==this.__heightMode&&(this.__heightMode=e,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeightMode"}),this.__processHeightMode())}__processHeight(callerControl){if("Content"===this.__heightMode&&(this.__intHeight=null,null!==this.__currentContent)){const t=this.__currentContent.__getContentHeight();null!==t&&(this.__intHeight=t+"px"),callerControl&&this.__currentContent===callerControl||"Content"!==this.__currentContent.getHeightMode()||this.__currentContent.__processHeight(this)}super.__processHeight(callerControl)}__getContentWidth(){return"Collapsed"===this.__visibility?null:"Content"!==this.getWidthMode()?super.__getContentWidth():null!==this.__currentContent?this.__currentContent.__getContentWidth():null}__getContentHeight(){return"Collapsed"===this.__visibility?null:"Content"!==this.getHeightMode()?super.__getContentHeight():null!==this.__currentContent?this.__currentContent.__getContentHeight():null}setTargetContent(valueNew){let e=t.ValueConverter.toString(valueNew);null===e&&(e=this.getAttributeDefaultValueInternal("TargetContent")),e=""===e?null:tchmi_path(e),e!==this.__targetContent&&(this.__targetContent=e,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TargetContent"}),this.__processTargetContent())}getTargetContent(){return this.__targetContent}__destroyTargetobjObject(t){null!==t&&!1===t.getIsDestroyed()&&t.destroy()}__processTargetContent(e=null){if(t.Engineering.ErrorPane.remove("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED"),TCHMI_BENCHMARK_MODE&&t.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoad",{targetContent:this.__targetContent}),this.__targetMarkup=null,void 0!==this.__targetContent&&null!==this.__targetContent||(this.__destroyTargetobjObject(this.__currentContent),this.__currentContent&&this.__removeChild(this.__currentContent),this.__currentContent=null),!this.__targetContent)return void(TCHMI_BENCHMARK_MODE&&t.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoaded",{targetContent:this.__targetContent}));const n=tchmi_path(this.__targetContent);!1===this.__isRecursionSave(n)&&TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked to avoid recursion!");const r=this;let i;if(i=e?{markup:e}:t.System.Data.Caches.partialMarkupCache.get(n),i)this.__xhr&&this.__xhr.abort(),this.__targetContentMarkup=i.markup,this.__processTargetMarkup(i.partialId),i=void 0;else if(TCHMI_ENGINEERING)this.__destroyRequestCurrentPartialContent&&(this.__destroyRequestCurrentPartialContent(),this.__destroyRequestCurrentPartialContent=void 0),this.__destroyRequestCurrentPartialContent=t.System.Services.Engineering.designerModeManager.partialContentManager.requestCurrentPartialContent(n,data=>{data.error===t.Errors.NONE?(r.__targetContentMarkup=data.content,r.__processTargetMarkup()):(TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+r.getId()+", Attribut=TargetContent] Loading "+n+" failed with error: "+t.Log.buildMessage(data.details)),this.__destroyRequestCurrentPartialContent=void 0)});else{this.__xhr&&this.__xhr.abort();let e=new XMLHttpRequest;this.__xhr=e,e.open("GET",n+(TCHMI_ENGINEERING?"?preventcache="+Math.random():"")),e.addEventListener("load",i=>{200===e.status?(r.__targetContentMarkup=e.responseText,r.__processTargetMarkup()):TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+r.getId()+", Attribut=TargetContent] Loading "+n+" failed with error: "+e.statusText+"."),this.__xhr=void 0}),e.addEventListener("error",i=>{TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+r.getId()+", Attribut=TargetContent] Loading "+n+" failed with error: "+e.statusText+"."),this.__xhr=void 0}),e.send()}}__processTargetMarkup(n){if(!this.__targetContent)return;let r=this.__targetContentMarkup;if(!r)return;let i=tchmi_path(this.__targetContent),s=null;if(this.__currentContent){let element=this.__currentContent.getElement();element&&element.length>0&&(s=element[0].getAttribute("data-tchmi-partial-url"))}let o=!1;i&&!0===t.System.Data.isKeepAlivePartial.get(i)&&(o=!0);let _=!1;if(s&&!0===t.System.Data.isKeepAlivePartial.get(s)&&(_=!0),i&&(o||this.__keepAlive)&&!t.System.Data.Caches.partialMarkupCache.has(i)){let e=document.createElement("div");e.innerHTML=r,e.firstElementChild&&t.System.Data.Caches.partialMarkupCache.set(i,{markup:r,partialId:e.firstElementChild.id})}s&&!_&&i!==s&&t.System.Data.Caches.partialMarkupCache.delete(s),this.__processTargetMarkupTimeout1?(clearTimeout(this.__processTargetMarkupTimeout1),this.__processTargetMarkupTimeout1=0,this.__processTargetMarkupLoadingSpinnerDiv.remove(),this.__currentContent&&(this.__currentContent.getElement()[0].style.opacity=this.__processTargetMarkupOldContentOldOpacity,this.__processTargetMarkupOldContentOldOpacity="")):this.__processTargetMarkupTimeout2&&(clearTimeout(this.__processTargetMarkupTimeout2),this.__processTargetMarkupTimeout2=0,this.__processTargetMarkupOldContent&&(this.__processTargetMarkupOldContent.getElement()[0].style.opacity=this.__processTargetMarkupOldContentOldOpacity,this.__processTargetMarkupOldContentOldOpacity="",this.__destroyTargetobjObject(this.__processTargetMarkupOldContent),this.__removeChild(this.__processTargetMarkupOldContent),this.__processTargetMarkupOldContent=null)),this.__processTargetMarkupOldContent=this.__currentContent,this.__processTargetMarkupOldContent&&(this.__processTargetMarkupOldContentOldOpacity=this.__processTargetMarkupOldContent.getElement()[0].style.opacity,this.__processTargetMarkupOldContent.getElement()[0].style.opacity="0"),!1===TCHMI_DESIGNER&&this.__elementTemplateRoot[0].appendChild(this.__processTargetMarkupLoadingSpinnerDiv),this.__processTargetMarkupTimeout1=setTimeout(()=>{let i,s;this.__processTargetMarkupTimeout1=0;let l=null;if(n)s=n;else if(r){let t=document.createElement("div");t.innerHTML=r,l=t.firstElementChild,l&&(s=l.id)}if(i=t.Controls.get(s),i){let e=i.getParent();if(e){if(e===this&&TCHMI_ENGINEERING)return this.__processTargetMarkupLoadingSpinnerDiv.remove(),i.getElement()[0].style.opacity=this.__processTargetMarkupOldContentOldOpacity,void(this.__processTargetMarkupOldContentOldOpacity="");if(e!==this)return this.__processTargetMarkupLoadingSpinnerDiv.remove(),t.Engineering.ErrorPane.add("E_REGION["+this.getId()+"]_CONTENT_ALREADY_USED","[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked because it is already used in region with id="+e.getId()+".",t.Engineering.ErrorPane.MessageType.Error),void(TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Loading content="+this.__targetContent+" was blocked because it is already used in region with id="+e.getId()+"."))}}else if(!l&&r){let t=document.createElement("div");t.innerHTML=r,l=t.firstElementChild}if(r&&(this.__targetMarkup=r),!i&&l&&(this.__targetContent&&l.setAttribute("data-tchmi-partial-url",tchmi_path(this.__targetContent)),i=t.System.Services.controlManager.compile(l,this),i&&(o||this.__keepAlive)&&i.__setKeepAlive(!0)),i&&i.getType()!==e.TcHmiContent.__type)return this.__destroyTargetobjObject(this.__currentContent),this.__currentContent&&this.__removeChild(this.__currentContent),this.__currentContent=null,TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiRegion, Id="+this.getId()+", Attribut=TargetContent] Wrong content type (not TcHmi.Controls.System.TcHmiContent)."),void(TCHMI_BENCHMARK_MODE&&t.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoaded",{targetContent:this.__targetContent}));this.__currentContent=i||null,null!==this.__currentContent?("Yes"!==this.__scrolling&&"Auto"!==this.__scrolling||(this.__element[0].scrollTop=0,this.__element[0].scrollLeft=0),this.__elementTemplateRoot[0].appendChild(this.__currentContent.getElement()[0]),this.__addChild(this.__currentContent),this.__processTargetMarkupLoadingSpinnerDiv.remove(),!_&&(this.__processTargetMarkupOldContent&&!this.__currentContent||this.__processTargetMarkupOldContent&&this.__currentContent&&this.__processTargetMarkupOldContent.getId()!==this.__currentContent.getId())&&this.__processTargetMarkupOldContent.__setKeepAlive(!1),this.__processTargetMarkupOldContent&&t.System.Services.controlManager.forceDetach(this.__processTargetMarkupOldContent),this.__processTargetMarkupTimeout2=setTimeout(()=>{this.__processTargetMarkupTimeout2=0,this.__processTargetMarkupOldContent&&!this.__currentContent||this.__processTargetMarkupOldContent&&this.__currentContent&&this.__processTargetMarkupOldContent.getId()!==this.__currentContent.getId()?(this.__processTargetMarkupOldContent.getElement()[0].style.opacity=this.__processTargetMarkupOldContentOldOpacity,this.__destroyTargetobjObject(this.__processTargetMarkupOldContent),this.__removeChild(this.__processTargetMarkupOldContent),this.__processTargetMarkupOldContent=null,this.__processTargetMarkupOldContentOldOpacity=""):this.__processTargetMarkupOldContent&&(this.__processTargetMarkupOldContent.getElement()[0].style.opacity=this.__processTargetMarkupOldContentOldOpacity,this.__processTargetMarkupOldContent=null,this.__processTargetMarkupOldContentOldOpacity="")}),t.EventProvider.register(this.__currentContent.getId()+".onAttached",(e,n)=>{e.destroy(),null!==this.__currentContent&&("Content"===this.getWidthMode()&&this.__processWidth(),"Content"===this.getHeightMode()&&this.__processHeight()),TCHMI_BENCHMARK_MODE&&t.EventProvider.raise("Benchmark.TcHmiRegion<"+this.__id+">.onTargetContentLoaded",{targetContent:this.__targetContent})})):(this.__processTargetMarkupLoadingSpinnerDiv.remove(),this.__destroyTargetobjObject(this.__processTargetMarkupOldContent),this.__processTargetMarkupOldContent&&this.__removeChild(this.__processTargetMarkupOldContent),this.__processTargetMarkupOldContent=null),t.EventProvider.raise(this.__id+".onTargetContentReplaced",this.__currentContent),this.__processScrolling(),this.__processScaleMode()})}__processIsEnabled(){super.__processIsEnabled(),this.__currentContent&&this.__currentContent.__processIsEnabled()}__processAccessConfig(){super.__processAccessConfig(),this.__currentContent&&this.__currentContent.__processAccessConfig()}setScaleMode(valueNew){let e=t.ValueConverter.toScaleModeString(valueNew);null===e&&(e=this.getAttributeDefaultValueInternal("ScaleMode")),e!==this.__scaleMode&&(this.__scaleMode=e,t.EventProvider.raise(this.__id+".onFunctionResultChanged",["getScaleMode"]),this.__attributesInitialized&&(this.__processScrolling(),this.__processScaleMode()))}getScaleMode(){return this.__scaleMode}__processScaleMode(){if(null===this.__currentContent)return;const t=this.__currentContent.getElement();switch(this.__scaleMode){case"ScaleToFit":{let e=1*this.__element.width()/(1*t.width()),n=1*this.__element.height()/(1*t.height()),r=e>n?n:e;t.css({"-webkit-transform":"scale("+r+")",transform:"scale("+r+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"})}break;case"ScaleToFitWidth":{let e=this.__elementTemplateRoot[0].offsetWidth-this.__elementTemplateRoot[0].clientWidth,n=1*this.__element.width()/(1*(t.width()+e));t.css({"-webkit-transform":"scale("+n+")",transform:"scale("+n+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"})}break;case"ScaleToFitHeight":{let e=this.__elementTemplateRoot[0].offsetHeight-this.__elementTemplateRoot[0].clientHeight,n=1*this.__element.height()/(1*(t.height()+e));t.css({"-webkit-transform":"scale("+n+")",transform:"scale("+n+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"})}break;case"ScaleToFill":{let e=this.__element.width()/t.width()*1,n=this.__element.height()/t.height()*1;t.css({"-webkit-transform":"scale("+e+","+n+")",transform:"scale("+e+","+n+")","-webkit-transform-origin":"0 0","transform-origin":"0 0"})}break;case"None":default:t.css({"-webkit-transform":"",transform:"","-webkit-transform-origin":"","transform-origin":""})}}setScrolling(valueNew){let e=t.ValueConverter.toString(valueNew);if(null===e&&(e=this.getAttributeDefaultValueInternal("Scrolling")),e!==this.__scrolling){switch(e){case"Yes":case"Auto":this.__scrolling=e;break;default:this.__scrolling="No"}t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Scrolling"}),this.__attributesInitialized&&(this.__processScrolling(),this.__processScaleMode())}}getScrolling(){return this.__scrolling}__processScrolling(){let e={};switch(this.__scrolling){case"Yes":case"Auto":this.__scaleMode&&"None"!==this.__scaleMode&&"ScaleToFitHeight"!==this.__scaleMode?e["overflow-x"]="hidden":e["overflow-x"]="",this.__scaleMode&&"None"!==this.__scaleMode&&"ScaleToFitWidth"!==this.__scaleMode?e["overflow-y"]="hidden":e["overflow-y"]="";break;case"No":default:e["overflow-x"]="hidden",e["overflow-y"]="hidden"}t.StyleProvider.setSimpleElementStyle(this.__elementTemplateRoot,e),this.__processWidth(),this.__processHeight()}getCurrentContent(){return this.__currentContent}}e.TcHmiRegion=n}(n=e.System||(e.System={})),e.registerEx("TcHmiRegion","TcHmi.Controls.System",t.Controls.System.TcHmiRegion)}(e=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));