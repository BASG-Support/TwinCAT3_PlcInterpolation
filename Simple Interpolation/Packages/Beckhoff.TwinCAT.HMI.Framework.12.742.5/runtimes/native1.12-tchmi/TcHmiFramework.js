var TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi,TcHmi;
/**
* Converts string "\n" (symbol world) to newline (HTML world).
* This supports escaping with "\\n"
* @param {string} text The text to escape
* @return {string} The encoded representation of parameter text.
* @preserve (Part of the public API)
*/
function tchmi_decode_control_characters(text){if(!text)return"";return"string"!=typeof text&&"function"==typeof text.toString&&(text=text.toString()),text.replace(/^\\n|([^\\])\\n/gm,"$1\n").replace(/\\\\n/gm,"\\n").replace(/^\\r|([^\\])\\r/gm,"$1\r").replace(/\\\\r/gm,"\\r").replace(/^\\t|([^\\])\\t/gm,"$1\t").replace(/\\\\t/gm,"\\t")}
/**
* Encodes HTML
* @param {string} html The html to encode
* @return {string} The encoded representation of parameter html.
* @preserve (Part of the public API)
*/function tchmi_encode_html(html){return"string"!=typeof html&&"function"==typeof html.toString&&(html=html.toString()),String(html).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}
/**
* Decodes HTML
* @param {string} text The text to decode
* @return {string} The decoded representation of parameter text.
"&#176;!\"&#167;$%&/()=?~#|&#233;&#232;€…™&#174;&#169;"
"°     !\"§     $%&/()=?~#|é     è     €…™®     ©"
 @preserve (Part of the public API)
*/function tchmi_decode_html(text){return"string"!=typeof text&&"function"==typeof text.toString&&(text=text.toString()),String(text).replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&quot;/g,'"').replace(/\&#39;/g,"'").replace(/\&#228;/g,"ä").replace(/\&#196;/g,"Ä").replace(/\&#246;/g,"ö").replace(/\&#214;/g,"Ö").replace(/\&#252;/g,"ü").replace(/\&#220;/g,"Ü").replace(/\&#223;/g,"ß").replace(/\&#233;/g,"é").replace(/\&#232;/g,"è").replace(/\&#176;/g,"°").replace(/\&#167;/g,"§").replace(/\&#174;/g,"®").replace(/\&#169;/g,"©").replace(/\&#181;/g,"µ")}
/**
* Converts formatted text to formatted html.
* @param {string} text The text which contains the formatting placeholders which shall be encoded.
* @return {string} The encoded representation of parameter text.
* @preserve (Part of the public API)
*/function tchmi_text_to_html(text){"string"!=typeof text&&"function"==typeof text.toString&&(text=text.toString());var e=text;let t=0;for(let r=e.length-1,o=0;r>=o;r--){if(" "!==e[r])break;t++}e=(e=(e=(e=e.substr(0,e.length-t)).replace(/\\s\\s/g," &nbsp;")).replace(/  /g," &nbsp;")).replace(/\\t/g,"&nbsp;&nbsp;&nbsp;");let r=[];for(let e=0,o=t;e<o;e++)e%2==0?r.push("&nbsp;"):r.push(" ");for(let t=r.length-1,o=0;t>=o;t--)e+=r[t];return e=(e=e.replace(/\\r\\n/g,"<br/>")).replace(/\\n/g,"<br/>")}
/**
* Decode base64 strings
* Attention: JS strings are UTF16!
* @param input
* @return {string} returns the String or null
* @preserve (Part of the public API)
*/function tchmi_base64decode(input){return"string"!=typeof input&&"function"==typeof input.toString&&(input=input.toString()),window.atob(input)}
/**
* Encode base64 strings
* Attention: JS strings are UTF16!
* @param {string} input String to encode
* @return {string} returns the String or null
* @preserve (Part of the public API)
*/function tchmi_base64encode(input){return"string"!=typeof input&&"function"==typeof input.toString&&(input=input.toString()),window.btoa(input)}
/**
* Creates a Guid string.
* @return {string} Guid
* @preserve (Part of the public API)
*/function tchmi_create_guid(){var e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:7&r|8).toString(16)}))}
/**
 * Compares 2 values for equality.
 * @param a Value 1
 * @param b Value 2
 * @param {boolean} typeSafe If set to "true" the comparison will return "false" if a {string} "1" is compared with {number} 1. If it is set to "false" the same comparison will return "true" because the value is rough equal.
 * @returns {boolean}
 * @preserve (Part of the public API)
 */function tchmi_equal(a,b,typeSafe=!0){if(a===b)return!0;if(null===a||null===b)return!1;let e=typeof a,t=typeof b;if(e!==t){if(!typeSafe)switch(e){case"boolean":switch(t){case"number":return a==b;case"string":return a.toString()===b.toLowerCase()}break;case"number":switch(t){case"boolean":return a==b;case"string":return""!==b&&a==b}break;case"string":switch(t){case"boolean":return a.toLowerCase()===b.toString();case"number":return""!==a&&a==b}}return!1}if("number"===e&&isNaN(a)&&isNaN(b))return!0;if("object"!==e||__tchmi_is_instanced_object(a)||__tchmi_is_instanced_object(b))return!1;let r=Array.isArray(a);if(r!==Array.isArray(b))return!1;if(r){let length=a.length;if(length!==b.length)return!1;for(let e=0;e<length;e++)if(!tchmi_equal(a[e],b[e]))return!1;return!0}if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let e in a){if(!b.hasOwnProperty(e))return!1;if(!tchmi_equal(a[e],b[e]))return!1}return!0}function __tchmi_is_instanced_object(obj){if(null===obj||"object"!=typeof obj)return!1;void 0===__tchmi_is_instanced_object.__objectPrototype&&(__tchmi_is_instanced_object.__objectPrototype=Object.getPrototypeOf({})),void 0===__tchmi_is_instanced_object.__arrayPrototype&&(__tchmi_is_instanced_object.__arrayPrototype=Object.getPrototypeOf([]));let e=Object.getPrototypeOf(obj);return null!==e&&e!==__tchmi_is_instanced_object.__objectPrototype&&e!==__tchmi_is_instanced_object.__arrayPrototype}
/**
 * Clones the data {Object} in param obj and returns a clone of it.
 * Do not use this function to create clones of objects which contain functions or are based on a prototype definition!
 * String, null, undefined are returned directly as they are immutable / handled by value.
 * @function
 * @param {Object} obj The {Object} to clone.
 * @returns {Object} Clone of param obj.
 * @template T defines the type of the target object
 * @preserve (Part of the public API)
 */function tchmi_clone_object(obj){let e=!1,t=function(value){var r,o=typeof value;if("function"===o)return e=!0,null;if(null===value||"object"!==o||__tchmi_is_instanced_object(value))return value;if(Array.isArray(value)){r=[];for(var i=0,n=value.length;i<n;i++)if(r[i]=t(value[i]),e)return null}else for(var s in r={},value)if(r[s]=t(value[s]),e)return null;return r},r=t(obj);return e?obj:r}
/*
 * Unify a path {string}.
 * Replace all backslashes with slashes, replace multiple slashes with single slashes except ://, remove leading slash.
 * @function
 * @param {string} path The path {string}
 * @return {string} Unified path {string}.
 * @preserve (Part of the public API)
 */function tchmi_path(path){if("string"==typeof path){let e=path.replace(/\\+/g,"/").split("/");for(let t=0,r=e.length;t<r;t++){let r=e[t];if(""===r)e.splice(t,1),t--;else if("."===r)e.splice(t,1),t--;else if(".."===r){let r=e[t-1];r&&".."!==r&&(e.splice(t,1),e.splice(t-1,1),t-=2)}}return e.join("/")}return path}
/**
* Converts a String to a valid CSS id pattern by escaping all reserved characters.
* @param {string} id The target id.
* @returns {string} Converted id.
* @preserve (Part of the public API)
*/function tchmi_css_escape_selector(id){if("string"!=typeof id)return id;if(CSS&&CSS.escape)return CSS.escape(id);for(var e,length=id.length,t=-1,r="",o=id.charCodeAt(0);++t<length;)0!==(e=id.charCodeAt(t))?r+=e>=1&&e<=31||127===e||0===t&&e>=48&&e<=57||1===t&&e>=48&&e<=57&&45===o?"\\"+e.toString(16)+" ":(0!==t||1!==length||45!==e)&&(e>=128||45===e||95===e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?id.charAt(t):"\\"+id.charAt(t):r+="�";return r}
/**
 * tchmi_escape_regex
 * @param {string} text
 * @returns {string}
 * @preserve (Part of the public API)
 */function tchmi_escape_regex(text){return"string"!=typeof text&&"function"==typeof text.toString&&(text=text.toString()),text.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}
/**
 * @preserve (Part of the public API)
 */function gIsolatedEval_TcHmi_System_FunctionExpression_Results(s,resSE,resFCE){return eval(s)}function gIsolatedEval_TcHmi_System_FunctionExpression(s){return eval(s)}function gIsolatedEval_TcHmi_System_TriggerManager_JavaScriptAction(ctx,s){return eval(s)}function gIsolatedEval_TcHmi_System_TriggerManager_ConditionExpressionsResult(s,results){return eval(s)}!function(e){if(!window.hasOwnProperty("jQuery")||null===jQuery)throw new ReferenceError('Object "jQuery" is missing!');if(!window.hasOwnProperty("$")||null===$)throw new ReferenceError('Object "$" is missing!');if(!window.hasOwnProperty("acorn")||null===acorn)throw new ReferenceError('Object "acorn" is missing!');let t=window.localStorage.getItem("TCHMI_FLAG_OVERRIDES"),r=null;if(t)try{r=JSON.parse(t)}catch(e){}TCHMI_DEBUG_TIME_LOAD_LIBRARY=Date.now(),TCHMI_DYNAMIC_INSTANCE_ID="unset",window.hasOwnProperty("TCHMI_ENGINEERING")||(window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE")?TCHMI_ENGINEERING=TCHMI_ENABLE_DESIGNER_MODE:TCHMI_ENGINEERING=!1),TCHMI_ENABLE_DESIGNER_MODE=TCHMI_ENGINEERING,window.hasOwnProperty("TCHMI_DESIGNER")||(window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE_MASTER")?TCHMI_DESIGNER=TCHMI_ENABLE_DESIGNER_MODE_MASTER:TCHMI_DESIGNER=!1),TCHMI_ENABLE_DESIGNER_MODE_MASTER=TCHMI_DESIGNER,window.hasOwnProperty("TCHMI_LIVEVIEW")||(window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE_SLAVE")?TCHMI_LIVEVIEW=TCHMI_ENABLE_DESIGNER_MODE_SLAVE:TCHMI_LIVEVIEW=!1),TCHMI_ENABLE_DESIGNER_MODE_SLAVE=TCHMI_LIVEVIEW,window.hasOwnProperty("TCHMI_RUNTIME")||(TCHMI_ENGINEERING?TCHMI_RUNTIME=!1:TCHMI_RUNTIME=!0),window.hasOwnProperty("TCHMI_TARGET_PARTIAL")?TCHMI_TARGET_PARTIAL=tchmi_path(TCHMI_TARGET_PARTIAL):window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE_TARGET_PARTIAL")?TCHMI_TARGET_PARTIAL=tchmi_path(TCHMI_ENABLE_DESIGNER_MODE_TARGET_PARTIAL):TCHMI_TARGET_PARTIAL="",TCHMI_ENABLE_DESIGNER_MODE_TARGET_PARTIAL=TCHMI_TARGET_PARTIAL,window.hasOwnProperty("TCHMI_CONFIG_OVERRIDE")||(window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE_FALLBACK_CONFIG_JSON")?TCHMI_CONFIG_OVERRIDE=TCHMI_ENABLE_DESIGNER_MODE_FALLBACK_CONFIG_JSON:TCHMI_CONFIG_OVERRIDE=null),TCHMI_ENABLE_DESIGNER_MODE_FALLBACK_CONFIG_JSON=TCHMI_CONFIG_OVERRIDE,window.hasOwnProperty("TCHMI_ENGINEERING_WEBSOCKET")||(window.hasOwnProperty("TCHMI_ENABLE_DESIGNER_MODE_WEBSOCKET_URL")?TCHMI_ENGINEERING_WEBSOCKET=TCHMI_ENABLE_DESIGNER_MODE_WEBSOCKET_URL:TCHMI_ENGINEERING_WEBSOCKET=""),TCHMI_ENABLE_DESIGNER_MODE_WEBSOCKET_URL=TCHMI_ENGINEERING_WEBSOCKET,window.hasOwnProperty("TCHMI_CONSOLE_LOG_LEVEL")||(TCHMI_CONSOLE_LOG_LEVEL=0),r&&void 0!==r.TCHMI_CONSOLE_LOG_LEVEL&&null!==r.TCHMI_CONSOLE_LOG_LEVEL&&(TCHMI_CONSOLE_LOG_LEVEL=r.TCHMI_CONSOLE_LOG_LEVEL),window.hasOwnProperty("TCHMI_CONSOLE_LOG_PERSISTENT")||(TCHMI_CONSOLE_LOG_PERSISTENT=!1),r&&void 0!==r.TCHMI_CONSOLE_LOG_PERSISTENT&&null!==r.TCHMI_CONSOLE_LOG_PERSISTENT&&(TCHMI_CONSOLE_LOG_PERSISTENT=r.TCHMI_CONSOLE_LOG_PERSISTENT),window.hasOwnProperty("TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES")||(TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES=2e4),r&&void 0!==r.TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES&&null!==r.TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES&&(TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES=r.TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES),window.hasOwnProperty("TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES")||(TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES=!1),r&&void 0!==r.TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES&&null!==r.TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES&&(TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES=r.TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES),window.hasOwnProperty("TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES")||(window.hasOwnProperty("TCHMI_CONSOLE_LOG_DESIGNER_MODE_COM_MESSAGES")?TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES=TCHMI_CONSOLE_LOG_DESIGNER_MODE_COM_MESSAGES:TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES=!1),TCHMI_CONSOLE_LOG_DESIGNER_MODE_COM_MESSAGES=TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES,window.hasOwnProperty("TCHMI_UNITTEST_MODE")||(TCHMI_UNITTEST_MODE=!1),window.hasOwnProperty("TCHMI_BENCHMARK_MODE")||(TCHMI_BENCHMARK_MODE=!1),window.hasOwnProperty("TCHMI_EVENT_OPTION_OBJECT_SUPPORTED")||(TCHMI_EVENT_OPTION_OBJECT_SUPPORTED=!1),window.hasOwnProperty("TCHMI_SERVER_STATE_WATCH_INTERVAL")&&"number"==typeof TCHMI_SERVER_STATE_WATCH_INTERVAL||(TCHMI_SERVER_STATE_WATCH_INTERVAL=1e3);try{window.addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){TCHMI_EVENT_OPTION_OBJECT_SUPPORTED=!0}}))}catch(e){}}(TcHmi||(TcHmi={})),function(e){e.Config=class{static get(){return tchmi_clone_object(e.System.config)}}}(TcHmi||(TcHmi={})),function(e){e.Access=
/**
    * Provides functions for checking rights
    * @class Access
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class{
/**
        * Checks if an right is allowed for the current user on this control or its parents
        * Rules for granting access:
        *      - Designer Mode Master => true
        *
        *      - Server Auth is not restricted (IsAuthRequired == false in Server) => TRUE
        *
        *      - Server Auth is not known right now => null
        *      - Server Auth loading error => false
        *
        *      - On this control: 1 Group  has  ALLOW => TRUE
        *      - On this control: 0 Groups have ALLOW, but 1 Group has DENY => FALSE
        *      - On this control: 0 Groups have ALLOW, 0 Groups have DENY => Ask Parent
        *
        *      - use control default of the bottom most control with this right. TcHmi.Controls.System.TcHmiView has operate/observe set to TRUE
        *      - control has no Parent (should not be possible) => FALSE
        *
        * @param {TcHmi.Controls.System.baseTcHmiControl} control Control to check
        * @param {string} accessright name of the access right
        * @returns true/false or null if the state is not known right now
        * @preserve (Part of the public API)
        */
static checkAccess(control,requestedAccessright){return control instanceof e.Controls.System.baseTcHmiControl!=!1&&("string"==typeof requestedAccessright&&e.System.Services.accessManager.checkAccess(control,requestedAccessright))}}}(TcHmi||(TcHmi={})),function(e){e.AnimationProvider=class{
/**
         * Deprecated. Please use new TcHmi.Animation()
         * Creates a new animation
         * @function
         * @param {string} controlName       The name of the control for which the animation is intendend.
         * @param {string} selector          A CSS selector to identify the element inside the control to animate.
         * @preserve (Part of the public API)
         * @deprecated Please use new TcHmi.Animation()
         */
static create(controlName,selector=""){return new t(controlName,selector)}};class t{
/**
         * Creates a new animation
         * @constructor
         * @param {string} controlName      The name of the control for which the animation is intendend.
         * @param {string} selector         A CSS selector to identify the element inside the control to animate.
         * @preserve (Part of the public API)
        */
constructor(controlName,selector=""){this.__keyframes=[],this.__duration=0,this.__delay=0,this.__iterationCount=1,this.__direction="normal",this.__timingFunction="ease",this.__fillMode="none",this.__cleanup=!1,this.__useCss=!0,this.__eventHandlers=[],this.__state=t.Status.CONFIGURE,this.__stateUpdater=e=>{this.__state=e},this.__animationController=null,this.__controlName=controlName,this.__selector=selector,this.__animationName="anim-"+tchmi_create_guid()}
/**
         * Returns the name of the control the animation is intended for.
         * @function
         * @returns {string} The name of the control.
         * @preserve (Part of the public API)
         */controlName(){return this.__controlName}
/**
         * Returns the selector of the element to animate.
         * @function
         * @returns {string} The selector.
         * @preserve (Part of the public API)
         */selector(){return this.__selector}
/**
         * Returns the name of the animation.
         * @function
         * @returns {string} The name of the animation.
         * @preserve (Part of the public API)
         */animationName(){return this.__animationName}
/**
         * Returns the state of the animation.
         * @function
         * @returns {Status} The state.
         * @preserve (Part of the public API)
         */state(){return this.__state}addKeyframe(e,t,r){if(!this.__configAllowed())return this;if(1===arguments.length){if(e.progressPoint<0||e.progressPoint>1)throw new Error("Argument out of range: progressPoint must be between 0 and 1 inclusive.");this.__keyframes.push(e)}else if(2===arguments.length&&"number"==typeof t){if(t<0||t>1)throw new Error("Argument out of range: progressPoint must be between 0 and 1 inclusive.");let r={styles:{},progressPoint:t};for(var o in e)e.hasOwnProperty(o)&&("string"==typeof e[o]?r.styles[o]=[e[o]]:r.styles[o]=e[o]);this.__keyframes.push(r)}else if("string"==typeof e&&("string"==typeof t||Array.isArray(t))){if(void 0===r||r<0||r>1)throw new Error("Argument out of range: progressPoint must be between 0 and 1 inclusive.");let o={styles:{},progressPoint:r};o.styles[e]="string"==typeof t?[t]:t,this.__keyframes.push(o)}return this}
/**
         * Removes all keyframes.
         * @function
         * @preserve (Part of the public API)
         */clearKeyframes(){return this.__configAllowed()?(this.__keyframes=[],this):this}
/**
         * Reverses the keyframes by subtracting the progressPoint from 1 and setting that as the new progressPoint.
         * @preserve (Part of the public API)
         */reverseKeyframes(){return this.__keyframes.forEach(e=>{e.progressPoint=1-e.progressPoint}),this}
/**
         * Gets the keyframes of this animation.
         * @function
         * @returns {Animation.Keyframe[]} The keyframes.
         * @preserve (Part of the public API)
         */keyframes(){return this.__keyframes}duration(valueNew){return void 0===valueNew?this.__duration:this.__configAllowed()?(this.__duration=null===valueNew?0:valueNew,this):this}delay(valueNew){return void 0===valueNew?this.__delay:this.__configAllowed()?(this.__delay=null===valueNew?0:valueNew,this):this}iterationCount(valueNew){return void 0===valueNew?this.__iterationCount:this.__configAllowed()?(this.__iterationCount=null===valueNew?1:valueNew,this):this}direction(valueNew){return void 0===valueNew?this.__direction:this.__configAllowed()?(this.__direction=null===valueNew?"normal":valueNew,this):this}timingFunction(valueNew){return void 0===valueNew?this.__timingFunction:this.__configAllowed()?(this.__timingFunction=null===valueNew?"ease":valueNew,this):this}fillMode(valueNew){return void 0===valueNew?this.__fillMode:this.__configAllowed()?(this.__fillMode=null===valueNew?"none":valueNew,this):this}cleanup(valueNew){return void 0===valueNew?this.__cleanup:(this.__cleanup=null!==valueNew&&valueNew,this.__state===t.Status.ENDED&&null!==this.__animationController&&this.__animationController.cleanup(),this)}useCss(valueNew){return void 0===valueNew?this.__canUseCss()&&this.__useCss:this.__configAllowed()?(this.__useCss=null===valueNew||valueNew,this):this}
/**
         * Registers an event handler for one of the events animationstart, animationend or animationiteration.
         * @function
         * @param {string} name     The name of the event.
         * @param callback          The callback function.
         * @preserve (Part of the public API)
         */registerEventHandler(name,callback){return this.__eventHandlers.push({name:name,callback:callback}),this}
/**
         * Unregisters a previously registered event handler.
         * @function
         * @param {string} name     The name of the event.
         * @param callback          The callback function to unregister.
         * @preserve (Part of the public API)
         */unregisterEventHandler(name,callback){return this.__eventHandlers=this.__eventHandlers.filter(e=>!(e.name===name&&(void 0===callback||e.callback===callback))),this}
/**
         * Gets all event handlers
         * @function
         * @returns The event handlers.
         * @preserve (Part of the public API)
         */eventHandlers(){return this.__eventHandlers}
/**
         * Run the animation.
         * @function
         * @preserve (Part of the public API)
         */run(){return 0===this.__keyframes.length?(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Animation] This animation has no keyframes defined."),this):0===this.__keyframes.filter(e=>0===e.progressPoint).length?(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Animation] This animation has no start keyframe with progressPoint 0 defined."),this):0===this.__keyframes.filter(e=>1===e.progressPoint).length?(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Animation] This animation has no end keyframe with progressPoint 1 defined."),this):(null!==this.__animationController&&this.__animationController.isValid()||(this.__animationController=e.System.Services.animationProvider.createAnimationController(this,this.__stateUpdater)),this.__animationController.run(),this)}
/**
         * Pause the animation.
         * @function
         * @preserve (Part of the public API)
         */pause(){return null!==this.__animationController&&this.__animationController.pause(),this}
/**
         * Cancels the animation and writes the last keyframe styles into the element CSS.
         * @function
         * @preserve (Part of the public API)
         */skip(){return null!==this.__animationController&&this.__animationController.skip(),this}
/**
         * Resets the animation. This is an asynchronous operation.
         * @function
         * @param callback The function to call when the animation has been reset.
         * @preserve (Part of the public API)
         */reset(callback){return null!==this.__animationController&&this.__animationController.reset(callback),this}__canUseCss(){return"string"==typeof this.__timingFunction}__configAllowed(){return this.__state===t.Status.CONFIGURE||this.__state===t.Status.ENDED||(TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Animation] Configuring an animation is only allowed when it has the state CONFIGURE or ENDED."),!1)}}e.Animation=t,function(e){let t;!function(e){e[e.CONFIGURE=0]="CONFIGURE",e[e.INITIALIZED=1]="INITIALIZED",e[e.RUNNING=2]="RUNNING",e[e.PAUSED=3]="PAUSED",e[e.ENDED=4]="ENDED"}(t=e.Status||(e.Status={}))}(t=e.Animation||(e.Animation={}))}(TcHmi||(TcHmi={})),function(e){e.Base64BinaryReader=
/**
     * Provides methods to read base64 encoded data.
     * @class Base64BinaryReader
     * @memberOf TcHmi
     * @preserve (Part of the public API)
     */
class{
/**
         * Creates a new Base64BinaryReader.
         * @constructor
         * @param {string} data          The base64 encoded string to read from.
         * @param endianness    Whether the encoded data uses little endian (default) or big endian to store numbers.
         * @preserve (Part of the public API)
         */
constructor(data,endianness=e.Endianness.LittleEndian){this.__offset=0,this.__stringEncodings={"UTF-8":{decode:(e,endianness)=>{let codePoints=[];for(let t=0,r=e.length;t<r;t++){let o=e[t];if(0===o)return{codePoints:codePoints,byteCount:t+1};if(o<=127)codePoints.push(o);else if(o>=194&&o<=244){let i=1,n=31,s=32;for(;s>0;)(o&s)>0?(i++,n>>>=1,s>>>=1):s=0;let l=o&n,c=t+i;if(c>=r)l=65533;else for(;t<c;){t++;let r=e[t];if(r<128||r>191){l=65533,t--;break}l=l<=67108863?(l<<6|63&r)>>>0:l*Math.pow(2,6)+(63&r)}codePoints.push(l)}else codePoints.push(65533)}return{codePoints:codePoints,byteCount:e.length}}}};let t=tchmi_base64decode(data);if(null===t)throw new Error(`Could not decode string "${data}" as base64.`);this.__data=[];for(let e=0,r=t.length;e<r;e++)this.__data.push(t.charCodeAt(e));this.__endianness=endianness}__getChunk(length){if(this.__offset+length>this.__data.length)throw new RangeError(`Trying to read ${length} bytes from offset ${this.__offset} exceeds the length of the data.`);let t=this.__data.slice(this.__offset,this.__offset+length);return this.__offset+=length,this.__endianness===e.Endianness.BigEndian&&(t=t.reverse()),t}__readInteger(lengthInBytes,signed){let e=this.__getChunk(lengthInBytes),t=0;for(let r=0,o=e.length;r<o;r++){let o=255&e[r];r<4?t=(t|o<<8*r)>>>0:t+=o*Math.pow(256,r)}if(signed){let r=Math.pow(2,8*lengthInBytes-1);lengthInBytes<=4?t=(t&~r)-((t&r)>>>0):128==(128&e[e.length-1])&&(t-=2*r)}return t}__readFloatingPointNumber(lengthInBytes){let e=this.__getChunk(lengthInBytes),t=8,r=23;switch(lengthInBytes){case 4:t=8,r=23;break;case 8:t=11,r=52}let o=Math.pow(2,t-1)-1,i=[{value:0,bitsToRead:r},{value:0,bitsToRead:t},{value:0,bitsToRead:1}],n=0,s=0;for(let t=0;t<lengthInBytes||i[n].bitsToRead<0;t++){let r=0;i[n].bitsToRead<0?(r=8+i[n].bitsToRead,t--,n++,s=0):0===i[n].bitsToRead&&(n++,s=0);let o=(255&e[t])>>>r;i[n].bitsToRead<8&&(o&=Math.pow(2,i[n].bitsToRead)-1),s<=24?i[n].value=(i[n].value|o<<s)>>>0:i[n].value+=o*Math.pow(2,s),s+=8-r,i[n].bitsToRead-=8-r}let l=i[0].value,c=i[1].value,d=i[2].value;return c===Math.pow(2,t)-1?l>0?NaN:1/0*(1===d?-1:1):0===c&&0===l?0*(1===d?-1:1):0===c?(1===d?-1:1)*l*Math.pow(2,1-o-r):(1===d?-1:1)*(1+l/Math.pow(2,r))*Math.pow(2,c-o)}
/**
         * Reads a boolean value.
         * @preserve (Part of the public API)
         */readBoolean(){return 0!==this.__readInteger(1,!1)}
/**
         * Reads a single byte of data.
         * @preserve (Part of the public API)
         */readByte(){return this.__readInteger(1,!1)}
/**
         * Reads a signed byte.
         * @preserve (Part of the public API)
         */readSByte(){return this.__readInteger(1,!0)}
/**
         * Reads a signed 16-bit integer.
         * @preserve (Part of the public API)
         */readInt16(){return this.__readInteger(2,!0)}
/**
         * Reads an unsigned 16-bit integer.
         * @preserve (Part of the public API)
         */readUInt16(){return this.__readInteger(2,!1)}
/**
         * Reads a signed 32-bit integer.
         * @preserve (Part of the public API)
         */readInt32(){return this.__readInteger(4,!0)}
/**
         * Reads an unsigned 32-bit integer.
         * @preserve (Part of the public API)
         */readUInt32(){return this.__readInteger(4,!1)}
/**
         * Reads a single precision floating point number.
         * @preserve (Part of the public API)
         */readFloat(){return this.__readFloatingPointNumber(4)}
/**
         * Reads a double precision floating point number.
         * @preserve (Part of the public API)
         */readDouble(){return this.__readFloatingPointNumber(8)}
/**
         * Reads a string. Will read until a zero byte is encountered, or until the specified length has been reached, or, if no length has been specified, until the end of the data.
         * @param {number} length The length of the string to read in bytes.
         * @preserve (Part of the public API)
         */readString(length){let e;if(void 0!==length){if(length<0)throw new RangeError("Length of the string to read must be positive.");if(this.__offset+length>this.__data.length)throw new RangeError(`Trying to read ${length} bytes from offset ${this.__offset} exceeds the length of the data.`);e=this.__data.slice(this.__offset,this.__offset+length)}else e=this.__data.slice(this.__offset);let t=this.__stringEncodings["UTF-8"].decode(e,this.__endianness);return this.__offset+=void 0!==length?length:t.byteCount,this.__getStringFromCodePoints(t.codePoints)}__getStringFromCodePoints(codePoints){let e=[];for(let t=0,r=codePoints.length;t<r;t++){let r=codePoints[t];if(r<=65535)e.push(r);else{r-=65536;let t=55296+(r>>10),o=r%1024+56320;e.push(t,o)}}return String.fromCharCode(...e)}
/**
         *
         * @preserve (Part of the public API)
         */getLength(){return this.__data.length}
/**
         *
         * @preserve (Part of the public API)
         */getOffset(){return this.__offset}
/**
         *
         * @preserve (Part of the public API)
         */setOffset(offset){let t=Math.floor(e.ValueConverter.toNumber(offset,0));this.__offset=t}}}(TcHmi||(TcHmi={})),function(e){e.Base64BinaryWriter=
/**
     * Provides methods to write base64 encoded data.
     * @class Base64BinaryWriter
     * @memberOf TcHmi
     * @preserve (Part of the public API)
     */
class{
/**
         * Creates a new Base64BinaryWriter.
         * @param endianness    Whether to use little endian (default) or big endian when encoding numbers.
         * @param {number} length        The desired length of the data. If this parameter is omitted the data will be expanded dynamically.
         * @preserve (Part of the public API)
         */
constructor(endianness=e.Endianness.LittleEndian,length){this.__data=[],this.__stringEncodings={"UTF-8":{encode:(codePoints,endianness)=>{let e=[];for(let t=0,r=codePoints.length;t<r;t++){let r=codePoints[t];if(r<=127)e.push(r);else{let t=[],o=192,i=31,n=128,s=63;for(;r>0&&t.length<=6;)t.push(n|r&s),r<=4294967295?r>>>=6:r=Math.floor(r/Math.pow(2,6)),r<=i?(t.push(o|r&i),r=0):(o=n|o>>>1,i>>>=1);e=e.concat(t.reverse())}}return e}}},this.__endianness=endianness,this.__length=void 0!==length?length:1/0}__addChunk(t){if(this.__data.length+t.length>this.__length)throw new RangeError(`Trying to write ${t.length} bytes exceeds the length of the data.`);this.__endianness===e.Endianness.BigEndian&&(t=t.reverse()),this.__data=this.__data.concat(t)}__checkIntegerBounds(value,lengthInBytes,signed){if(value%1!=0)return!1;let e=Math.pow(2,8*lengthInBytes)-1,t=signed?-Math.ceil(e/2):0;return value>=t&&value<=e+t}__writeInteger(value,lengthInBytes){let e=[];for(let t=0;t<lengthInBytes;t++)e.push(255&value),lengthInBytes-t<=4?value>>>=8:value=Math.floor(value/256);this.__addChunk(e)}__writeFloatingPointNumber(value,lengthInBytes){let e=8,t=23;switch(lengthInBytes){case 4:e=8,t=23;break;case 8:e=11,t=52}let r,o,i=Math.pow(2,e-1)-1,n=value<0?1:0;if(isFinite(value))if(0===value)n=1/value==-1/0?1:0,r=0,o=0;else{value=Math.abs(value);let n=Math.floor(value),s=value-n,l=0,c=n;for(;c>0;)l++,c<=4294967295?c>>>=1:c=Math.floor(c/2);o=n>0?n-Math.pow(2,l-1):0;let d=l>0?l-1:0;d>t&&(o<=4294967295?o>>>=d-t:o=Math.floor(o/Math.pow(2,d-t)),d=t);let _=-1;c=s;let m=0;for(;d<t;){c*=2;let e=c>=1?1:0;m>=i-1&&-1===_&&(_=m),e&&(c--,-1===_&&(_=m,0===l&&(e=0))),o=d<32?(o<<1|e)>>>0:2*o+e,(l>0||_>-1||0===s)&&d++,m++}r=l>0?l-1:-_-1,r+=i;let u=Math.pow(2,e)-1;r<1?r=0:r>u-1&&(r=u,o=0)}else{r=0;for(let t=0;t<e;t++)r=r<<1|1;o=isNaN(value)?1:0}let s=[{value:o,length:t},{value:r,length:e},{value:n,length:1}],l=[],c=0;for(let e=0;e<lengthInBytes||s[c].length<0;e++){let t=0;s[c].length<0?(t=8+s[c].length,e--,c++):0===s[c].length&&c++,void 0===l[e]&&(l[e]=0),l[e]|=s[c].value<<t&255,s[c].length<=32?s[c].value=s[c].value>>>8-t:s[c].value=Math.floor(s[c].value/Math.pow(2,8-t)),s[c].length-=8-t}this.__addChunk(l)}
/**
         * Writes a boolean value.
         * @param {boolean} value The boolean value to write.
         * @preserve (Part of the public API)
         */writeBoolean(value){return this.writeByte(value?1:0),this}
/**
         * Writes a single byte of data.
         * @param {number} value The byte to write.
         * @preserve (Part of the public API)
         */writeByte(value){if(!this.__checkIntegerBounds(value,1,!1))throw new RangeError(`The value ${value} does not fit into a byte.`);return this.__writeInteger(value,1),this}
/**
         * Writes a signed byte.
         * @param {number} value The byte to write.
         * @preserve (Part of the public API)
         */writeSByte(value){if(!this.__checkIntegerBounds(value,1,!0))throw new RangeError(`The value ${value} does not fit into a signed byte.`);return this.__writeInteger(value,1),this}
/**
         * Writes a signed 16-bit integer.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeInt16(value){if(!this.__checkIntegerBounds(value,2,!0))throw new RangeError(`The value ${value} does not fit into an int16.`);return this.__writeInteger(value,2),this}
/**
         * Writes an unsigned 16-bit integer.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeUInt16(value){if(!this.__checkIntegerBounds(value,2,!1))throw new RangeError(`The value ${value} does not fit into an uint16.`);return this.__writeInteger(value,2),this}
/**
         * Writes a signed 32-bit integer.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeInt32(value){if(!this.__checkIntegerBounds(value,4,!0))throw new RangeError(`The value ${value} does not fit into a int32.`);return this.__writeInteger(value,4),this}
/**
         * Writes an unsigned 32-bit integer.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeUInt32(value){if(!this.__checkIntegerBounds(value,4,!1))throw new RangeError(`The value ${value} does not fit into an uint32.`);return this.__writeInteger(value,4),this}
/**
         * Writes a single precision floating point number.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeFloat(value){return this.__writeFloatingPointNumber(value,4),this}
/**
         * Writes a double precision floating point number.
         * @param {number} value The number to write.
         * @preserve (Part of the public API)
         */writeDouble(value){return this.__writeFloatingPointNumber(value,8),this}
/**
         * Writes a string.
         * @param {string} value The string to write.
         * @param {number} length (Optional) The length of the string to write. If the string is shorter, the remaining space is filled with 0.
         * @preserve (Part of the public API)
         */writeString(value,length){let e=this.__stringEncodings["UTF-8"].encode(this.__getCodePointsFromString(value),this.__endianness);if(void 0!==length){for(;e.length<length;)e.push(0);if(e.length>length)throw new RangeError("The specified string does not fit into the specified length.")}if(this.__data.length+e.length>this.__length)throw new RangeError(`Trying to write ${e.length} bytes exceeds the length of the data.`);return this.__data=this.__data.concat(e),this}__getCodePointsFromString(value){let codePoints=[];for(let e=0,t=value.length;e<t;e++){let r=value.charCodeAt(e);if(r>=55296&&r<=56319&&e<t-1){let t=value.charCodeAt(e+1);t>=56320&&t<=57343?(codePoints.push(1024*(r-55296)+t-56320+65536),e++):codePoints.push(r)}else codePoints.push(r)}return codePoints}
/**
         * Returns the base64 encoded string. If not enough data was written to fill the length the data should have, the rest is filled up with zeros.
         * @preserve (Part of the public API)
         */getEncodedString(){let length=this.__data.length;for(;isFinite(this.__length)&&this.__data.length<this.__length;)this.__data.push(0);let e=String.fromCharCode(...this.__data);return this.__data.length=length,tchmi_base64encode(e)}
/**
         * Returns the length of the data that has been written.
         * @preserve (Part of the public API)
         */getLength(){return this.__data.length}}}(TcHmi||(TcHmi={})),function(e){
/**
    * Reserved
    * @class Binding
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{static __getFuncName(fn,control){let e=null;for(let t in control)if(control[t]===fn){e=t;break}return e}
/**
         * Creates a binding between a symbol and a control attribute setter function.
         * @function createEx
         * @param {string} expression The target symbol expression.
         * @param {(value: any) => void} fn The target function as prototype reference.
         * @param {fnThis: TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @preserve (Part of the public API)
         */static create(expression,fn,control){let e=t.__getFuncName(fn,control);null!==e&&t.createEx(expression,e,control)}
/**
         * Creates a binding between a symbol and a control attribute setter function by name.
         * @function create
         * @param {string} expression The target symbol expression.
         * @param {string} fn The name of the control setter function.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @preserve (Part of the public API)
         */static createEx(expression,fn,control){let t=e.System.Services.controlManager.getAttributeByPropertySetterName(control,fn);t?e.System.Services.bindingManager.createBinding(expression,t.propertyName,control):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Binding] The attribute with the setter "+fn+" is not included in the description.json of "+control.getType()+". Creating a binding with this attribute failed.")}
/**
        * Creates a binding between a symbol and a control attribute setter function by name of property.
        * @function createEx2
        * @param {string} expression The target symbol expression.
        * @param {string} propertyName The name of the control property.
        * @param {TcHmi.Controls.System.baseTcHmiControl} control
        * @preserve (Part of the public API)
        */static createEx2(expression,propertyName,control){e.System.Services.bindingManager.createBinding(expression,propertyName,control)}
/**
         * Removes a binding between a symbol and a control attribute setter function.
         * @function remove
         * @param {string} expression [OBSOLETE] The target symbol expression.
         * @param {(value: any) => void} fn
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @param {boolean} bReset [Optional] If set to false the setter will not resetted with null.
         * @preserve (Part of the public API)
         */static remove(expression,fn,control,bReset=!0){let e=t.__getFuncName(fn,control);null!==e&&t.removeEx(expression,e,control,bReset)}
/**
         * Removes a binding between a symbol and a control attribute setter function.
         * @function remove
         * @param {string} expression [OBSOLETE] The target symbol expression.
         * @param {string} fn The name of the control setter function.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @param {boolean} bReset [Optional] If set to false the setter will not resetted with null.
         * @preserve (Part of the public API)
         */static removeEx(expression,fn,control,bReset=!0){let r=e.System.Services.controlManager.getAttributeByPropertySetterName(control,fn);r?t.removeEx2(expression,r.propertyName,control,bReset):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Binding] The attribute with the setter "+fn+" is not included in the description.json of "+control.getType()+". Removing a binding with this attribute failed.")}
/**
        * Removes a binding between a symbol and a control attribute setter function by name of property.
        * @function remove
        * @param {string} unused [OBSOLETE] The target symbol expression.
        * @param {string} propertyName The name of the control attribute property.
        * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
        * @param {boolean} bReset [Optional] If set to false the setter will not resetted with null.
        * @preserve (Part of the public API)
        */static removeEx2(unused,propertyName,control,bReset=!0){e.System.Services.bindingManager.removeBinding(propertyName,control,bReset)}
/**
         * Returns true if a symbol is bound to the target control property.
         * @param {string} propertyName The name of the control attribute property.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @preserve (Part of the public API)
         */static exists(propertyName,control){return!!t.resolve(propertyName,control)}
/**
         * Returns the symbol expression of a binding as string or null if no symbol is bound to the target control property.
         * @param {string} propertyName The name of the control attribute property.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @preserve (Part of the public API)
         */static resolve(propertyName,control){let t=e.System.Services.bindingManager.getBinding(propertyName,control);if(t){let e=t.getSymbol();if(e)return e.getExpression().toString()}return null}
/**
         * Returns the symbol expression of a binding as SymbolExpression object or null if no symbol is bound to the target control property.
         * @param {string} propertyName The name of the control attribute property.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control The target control instance.
         * @preserve (Part of the public API)
         */static resolveEx(propertyName,control){let t=e.System.Services.bindingManager.getBinding(propertyName,control);if(t){let r=t.getSymbol();if(r)return new e.SymbolExpression(r.getExpression().toString())}return null}}e.Binding=t}(TcHmi||(TcHmi={})),function(e){e.Callback=class{
/**
         * Calls a callback and catches exceptions to return them as value of type {Error} for further processing.
         * @param {function} callback function to call
         * @param {object|null} thisArg the this pointer in the function call
         * @param args parameters for the function call
         * @returns undefined or the Error in case of an exception
         * @template T this for the call
         * @template A Array of types for all parameter for the function
         * @preserve (Part of the public API)
         */
static callSafe(callback,thisArg,...e){let t;if(callback&&"function"==typeof callback)try{callback.call(thisArg,...e)}catch(e){t=e}return t}}}(TcHmi||(TcHmi={})),function(e){e.control={};e.Control=class{}}(TcHmi||(TcHmi={})),function(e){e.ControlFactory=class{
/**
        * Creates a new control.
        * @function
        * @param {string} type The type of the control.
        * @param {string} name The name of the control.
        * @param {Dictionary<{}>}
        * @param {TcHmi.Controls.System.baseTcHmiControl} parent Optional. The logical parent control.
        * @template C defines the type for the new control
        * @preserve (Part of the public API)
         */
static createEx(type,name,attributes,parent){if("string"!=typeof type||""===type)throw new TypeError("[[Source=Framework, Module=TcHmi.ControlFactory.createEx] Invalid value: '"+type+"' for parameter: 'type'.");if("string"!=typeof name||""===name)throw new TypeError("[[Source=Framework, Module=TcHmi.ControlFactory.createEx] Invalid value: '"+name+"' for parameter: 'name'.");if(void 0===attributes||null!==attributes&&"object"!=typeof attributes||__tchmi_is_instanced_object(attributes))throw new TypeError("[[Source=Framework, Module=TcHmi.ControlFactory.createEx] Invalid value: '"+attributes+"' for parameter: 'attributes'.");if(parent&&!(parent instanceof e.Controls.System.baseTcHmiControl))throw new TypeError("[[Source=Framework, Module=TcHmi.ControlFactory.createEx] Invalid value: '"+parent+"' for parameter: 'parent'.");let t=document.createElement("div");t.id=name,t.setAttribute("data-tchmi-type",type);for(let e in attributes){let value=attributes[e];if(null!=value)if("object"!=typeof value)t.setAttribute(e,value);else{let r=document.createElement("script");r.setAttribute("data-tchmi-target-attribute",e),r.setAttribute("type","application/json"),r.textContent=JSON.stringify(value),t.appendChild(r)}}return e.System.Services.controlManager.compile(t,parent,{designerIgnore:!0})}
/**
        * DEPRECATED
        * Creates a new control.
        * @function
        * @param {string|jQuery} htmlOrElementOrType The HTML, jQuery element or type of the control.
        * @param {string} [name] Optional the name of the control.
        * @param {TcHmi.Controls.System.baseTcHmiControl} [parent] Optional. The logical parent control.
        * @deprecated Please use createEx()
        * @template C defines the type for the new control
        * @preserve (Part of the public API)
        */static create(htmlOrElementOrType,name,parent){let t;if(null==name)t="string"==typeof htmlOrElementOrType?$(htmlOrElementOrType):htmlOrElementOrType;else{if("string"!=typeof htmlOrElementOrType)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.ControlFactory] Error compiling control. Wrong input parameter given."));t=$('<div id="'+name+'" data-tchmi-type="'+htmlOrElementOrType+'"></div>')}if(0===t.length)return;if(void 0!==e.Controls.get(t[0].id))return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.ControlFactory] Error compiling control. A control with the name "+t[0].id+" already exists."));return e.System.Services.controlManager.compile(t[0],parent,{designerIgnore:!0})}}}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.register=
/**
         * DEPRECATED
         * Register a control.
         * The Framework will fetch and interprete the Description.json in the Control Directory and optionally load a HTML Template file
         * @param {string} name Name of the Control.
         * @param {TcHmi.Controls.baseTcHmiControlConstructor} constructor Constructor which generates the TcHmi Control.
         * @param {string} directory Directory of the Control (base path is the Controls directory).
         * @param {string} template Template file of the Control (base path is the Controls directory).
         * @template C defines the type for the control to register
         * @preserve (Part of the public API)
         * @deprecated Please use registerEx()
         */
function(name,constructor,t,r){let o={error:e.Errors.NONE,apiVersion:0,name:name,ctrlConstructor:constructor,directory:t,template:r};if(constructor.toString().startsWith("class"))o.nativeEs6Control=!0;else{o.nativeEs6Control=!1;let e=constructor;do{e=Object.getPrototypeOf(e)}while(e&&!e.toString().startsWith("class"));e&&(o.nearestEs6Constructor=e)}e.System.Data.Registrations.controls.map.has(name)?e.System.Data.Registrations.controls.map.set(name,{apiVersion:1,error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Controls.register",reason:'Ambiguous registration for the name: "'+name+'". Control will not be addressable by this name. Please try fully qualified name to access control.'}}):e.System.Data.Registrations.controls.map.set(name,o),e.System.Data.Registrations.controls.array.push(o),e.EventProvider.raise("System.onControlRegistered",o)},t.registerEx=
/**
         * Register a control.
         * The Framework will fetch and interprete the Description.json in the Control Directory and optionally load a HTML Template file
         * @param {string} name Name of the Control.
         * @param {TcHmi.Controls.baseTcHmiControlConstructor} constructor Constructor which generates the TcHmi Control.
         * @template C defines the type for the control to register
         * @preserve (Part of the public API)
         */
function(name,namespace,constructor){let t={error:e.Errors.NONE,apiVersion:1,name:name,namespace:namespace,ctrlConstructor:constructor};if(constructor.toString().startsWith("class"))t.nativeEs6Control=!0;else{t.nativeEs6Control=!1;let e=constructor;do{e=Object.getPrototypeOf(e)}while(e&&!e.toString().startsWith("class"));e&&(t.nearestEs6Constructor=e)}let r=e.System.resolveQualifiedName(name,namespace);if(e.System.Data.Registrations.controls.map.has(name)?e.System.Data.Registrations.controls.map.set(name,{apiVersion:1,error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Controls.registerEx",reason:'Ambiguous registration for the name: "'+name+'". Control will not be addressable by this name. Please try fully qualified name to access control.'}}):e.System.Data.Registrations.controls.map.set(name,t),e.System.Data.Registrations.controls.map.has(r)?e.System.Data.Registrations.controls.map.set(r,{apiVersion:1,error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Controls.registerEx",reason:'Ambiguous registration for the name: " '+r+'". Control will not be addressable by this name.'}}):e.System.Data.Registrations.controls.map.set(r,t),e.System.mapControlNamesFromPackageManifestApi1ToApi0.has(r)){let o=e.System.mapControlNamesFromPackageManifestApi1ToApi0.get(r);e.System.Data.Registrations.controls.map.has(o)?e.System.Data.Registrations.controls.map.set(o,{apiVersion:1,error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Controls.registerEx",reason:'Ambiguous registration for the name: " '+r+'". Control will not be addressable by this name.'}}):e.System.Data.Registrations.controls.map.set(o,t)}e.System.Data.Registrations.controls.array.push(t),e.EventProvider.raise("System.onControlRegistered",t)},t.get=
/**
         * Get control by name. Returns the Control or undefined
         * @param {string} name Name of the Control.
         * @template T Type of the Control
         * @preserve (Part of the public API)
         */
function(name){if(!name)return;return e.System.Services.controlManager.getControlsCache().get(name)},t.getVersion=
/**
         * Gets version information of control by type.
         * @param {string} type Type of the Control.
         * @preserve (Part of the public API)
         */
function(type){let t=e.System.Services.controlManager.getDescription(type);return t&&t.version&&"object"==typeof t.version?t.version:null},t.getBasePath=
/**
        * Returns the dynamic base path of a control.
        * @preserve (Part of the public API)
        * @param type Control type name
        * @returns {string}
        */
function(type){return e.Environment.getControlBasePath(type)},t.getBasePathEx=
/**
        * Returns the dynamic base path of a control.
        * @preserve (Part of the public API)
        * @param TcHmi Control reference
        * @returns {string}
        */
function(control){return e.Environment.getControlBasePathEx(control)},t.getMap=
/**
         * Get an ES5 Map of all controls. Key of the map is the control identifier
         * @preserve (Part of the public API)
         */
function(){return e.System.Services.controlManager.getControlsCache()},t.tachControls=
/**
         * DEPRECATED
         * Does no longer do anything
         * @deprecated  Does no longer do anything
         * @function tachControls
         * @memberOf TcHmi.Controls
         * @param {((this: void, data: TcHmi.IResultObject) => void} callback
         * @preserve (Part of the public API)
         */
function(callback=null){TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Controls] The function 'TcHmi.Controls.tachControls(callback: null | ((this: void) => void) = null)' has been marked as deprecated and should no longer be used because it does no longer do anything."),"function"==typeof callback&&callback.apply(null)},t.tachControlsAsync=function(callback=null){TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Controls] The function 'TcHmi.Controls.tachControlsAsync(callback: null | ((this: void) => void) = null)' has been marked as deprecated and should no longer be used because it does no longer do anything."),"function"==typeof callback&&callback.apply(null)}}(t=e.Controls||(e.Controls={}))}(TcHmi||(TcHmi={})),function(e){
/**
    * Provides multiple types of dialogs to the user.
    *
    * @class DialogManager
    * @preserve (Part of the public API)
    */
class t{
/**
        * Change visibility of dialog and set its DialogType when showing.
        *
        * @param {string} dialogOwner Caller Id to prevent overwriting forreign dialogs
        * @param {boolean} bVisibility Toggling visiblity of Dialog
        * @param {TcHmi.DialogManager.DialogType} dialogType?
        * @param {object} options?
        * @param {string} options.cancelable The dialog should have an button to close the dialog
        * @preserve (Part of the public API)
        */
static showDialog(dialogOwner,bVisibility,dialogType,options){return e.System.Services.dialogManager.showDialog(dialogOwner,bVisibility,dialogType,options)}
/**
         * Changes the output content of the Dialog to a new value.
         * The default Severity is Info.
         *
         * @param {string} dialogOwner Caller Id to prevent overwriting forreign dialogs
         * @param {string} html
         * @param [severity = DialogManager.DialogSeverity.Info]
         * @returns {boolean} Success of the text update
         * @preserve (Part of the public API)
         */static updateText(dialogOwner,html,severity=t.DialogSeverity.Info){return e.System.Services.dialogManager.updateText(dialogOwner,html,severity)}
/**
        * Returns the current dialog owner or null.
        * @returns {string, null}
        * @preserve (Part of the public API)
        */static getDialogOwner(){return e.System.Services.dialogManager.getDialogOwner()}static __buildFirstDeepestErrorMessage(error){let t=function(error){if(void 0!==error.errors&&error.errors.length)for(let r=0;r<error.errors.length;r++){if(error.errors[r].code!==e.Errors.NONE)return t(error.errors[r]);error.errors.splice(r,1),r--}return error};if(!error)return"";let r=tchmi_clone_object(error),o=t(r);return e.DialogManager.buildMessage(o)}
/**
         * Builds a formatted message of hierarchical error objects for use in dialog.
         * @param {TcHmi.IErrorDetails} error
         * @preserve (Part of the public API)
         */static buildMessage(error){let e=function(error,t){if(!error)return"";let r="",o="&nbsp;&nbsp;";for(let e=0,r=t;e<r;e++)o+="&nbsp;&nbsp;";if(error.code&&(r+="Code: "+error.code+"/0x"+error.code.toString(16)),error.message&&(r+=", Message: "+error.message),error.reason&&(r+="<br />"+o+"Reason: "+error.reason),error.domain&&(r+="<br />"+o+"Domain: "+error.domain),void 0!==error.errors&&error.errors.length){r+="<br />"+o+"as result of: ";for(let o=0,i=error.errors.length;o<i;o++)r+=e(error.errors[o],t+1)}return r};return e(error,0)}}e.DialogManager=t,function(e){let t,r;!function(e){e[e.Info=0]="Info",e[e.Error=1]="Error"}(t=e.DialogSeverity||(e.DialogSeverity={})),function(e){e[e.Overlay=1]="Overlay"}(r=e.DialogType||(e.DialogType={}))}(t=e.DialogManager||(e.DialogManager={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){class r{static add(name,content,type){e.System.Services.Engineering.errorPane&&e.System.Services.Engineering.errorPane.add(name,content,type)}static remove(name){e.System.Services.Engineering.errorPane&&e.System.Services.Engineering.errorPane.remove(name)}}t.ErrorPane=r,function(e){let t;!function(e){e[e.Message=0]="Message",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information"}(t=e.MessageType||(e.MessageType={}))}(r=t.ErrorPane||(t.ErrorPane={}))}(t=e.Engineering||(e.Engineering={}))}(TcHmi||(TcHmi={})),function(e){
/**
    * Reserved
    * @class Environment
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{
/**
         * Returns the dynamic framework base path.
         * @preserve (Part of the public API)
         * @returns {string}
         */
static getBasePath(){return e.System.config.basePath}
/**
         * Returns the dynamic base path of a control.
         * @preserve (Part of the public API)
         * @param type Control type name
         * @returns {string}
         */static getControlBasePath(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE&&t.package&&void 0!==t.package.basePath&&null!==t.package.basePath&&t.manifestData&&void 0!==t.manifestData.basePath&&null!==t.manifestData.basePath?tchmi_path(t.package.basePath+"/"+t.manifestData.basePath):null}
/**
        * Returns the dynamic base path of a control.
        * @preserve (Part of the public API)
        * @param TcHmi Control reference
        * @returns {string}
        */static getControlBasePathEx(control){return control?t.getControlBasePath(control.getType()):null}}e.Environment=t}(TcHmi||(TcHmi={})),function(e){let t;!function(e){e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.E_PARAMETER_INVALID=2]="E_PARAMETER_INVALID",e[e.E_TIMEOUT=3]="E_TIMEOUT",e[e.E_EXCEPTION=4]="E_EXCEPTION",e[e.E_INVALID=5]="E_INVALID",e[e.E_NOT_UNIQUE=6]="E_NOT_UNIQUE",e[e.E_NOT_SUPPORTED=100]="E_NOT_SUPPORTED",e[e.E_NOT_ALLOWED=110]="E_NOT_ALLOWED",e[e.E_UNKNOWN=115]="E_UNKNOWN",e[e.E_UNKNOWN_TYPE=120]="E_UNKNOWN_TYPE",e[e.E_KEY_NOT_FOUND=130]="E_KEY_NOT_FOUND",e[e.E_TYPE_INVALID=150]="E_TYPE_INVALID",e[e.E_VALUE_INVALID=160]="E_VALUE_INVALID",e[e.E_REGISTRATION_MISSING=180]="E_REGISTRATION_MISSING",e[e.E_REGISTRATION_ERROR=190]="E_REGISTRATION_ERROR",e[e.E_MODULE_MISSING=200]="E_MODULE_MISSING",e[e.E_MODULE_ERROR=210]="E_MODULE_ERROR",e[e.E_WEBSOCKET_NOT_READY=1e3]="E_WEBSOCKET_NOT_READY",e[e.E_WEBSOCKET_CLOSED=1001]="E_WEBSOCKET_CLOSED",e[e.E_WEBSOCKET_NOT_SUPPORTED=1404]="E_WEBSOCKET_NOT_SUPPORTED",e[e.E_WEBSOCKET_OPEN_SERVER_LICENSE_CHECK_FAILED=1500]="E_WEBSOCKET_OPEN_SERVER_LICENSE_CHECK_FAILED",e[e.E_WEBSOCKET_OPEN_SERVER_LICENSE_MISSING=1501]="E_WEBSOCKET_OPEN_SERVER_LICENSE_MISSING",e[e.E_WEBSOCKET_OPEN_SERVER_NO_ACCESS=1502]="E_WEBSOCKET_OPEN_SERVER_NO_ACCESS",e[e.E_SYMBOL_STATE_INVALID=2e3]="E_SYMBOL_STATE_INVALID",e[e.E_SYMBOL_VALUE_INVALID=2001]="E_SYMBOL_VALUE_INVALID",e[e.E_SYMBOL_RESOLVE_SCHEMA=2002]="E_SYMBOL_RESOLVE_SCHEMA",e[e.E_SYMBOL_READONLY=2003]="E_SYMBOL_READONLY",e[e.E_SYMBOL_UNKNOWN=2010]="E_SYMBOL_UNKNOWN",e[e.E_SYMBOL_INVALID_DATA_PROVIDER_ENTRY=2020]="E_SYMBOL_INVALID_DATA_PROVIDER_ENTRY",e[e.E_SYMBOL_INVALID_PATH=2030]="E_SYMBOL_INVALID_PATH",e[e.E_SYMBOL_SUBSYMBOL_ERROR=2040]="E_SYMBOL_SUBSYMBOL_ERROR",e[e.E_SYMBOL_OBJECT_RESOLVE=2050]="E_SYMBOL_OBJECT_RESOLVE",e[e.E_SYMBOL_UNKNOWN_ATTRIBUTE=2100]="E_SYMBOL_UNKNOWN_ATTRIBUTE",e[e.E_SERVER_RESPONSE_ERROR=3e3]="E_SERVER_RESPONSE_ERROR",e[e.E_SERVER_COMMAND_ERROR=3005]="E_SERVER_COMMAND_ERROR",e[e.E_SERVER_INVALID_RESPONSE=3010]="E_SERVER_INVALID_RESPONSE",e[e.E_SERVER_COMMANDS_MISSING=3015]="E_SERVER_COMMANDS_MISSING",e[e.E_SERVER_COMMAND_MISSING=3016]="E_SERVER_COMMAND_MISSING",e[e.E_SERVER_READVALUE_MISSING=3020]="E_SERVER_READVALUE_MISSING",e[e.E_SERVER_WRITEVALUE_MISSING=3025]="E_SERVER_WRITEVALUE_MISSING",e[e.E_SERVER_RESPONSE_MISSING=3030]="E_SERVER_RESPONSE_MISSING",e[e.E_SERVER_DOMAIN_UNKNOWN=3100]="E_SERVER_DOMAIN_UNKNOWN",e[e.E_FUNCTION_MISSING_FUNCTION_REFERENCE=4e3]="E_FUNCTION_MISSING_FUNCTION_REFERENCE",e[e.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION=4005]="E_FUNCTION_MISSING_FUNCTION_DESCRIPTION",e[e.E_FUNCTION_INVALID_CONFIGURATION=4010]="E_FUNCTION_INVALID_CONFIGURATION",e[e.E_FUNCTION_EXCEPTION=4020]="E_FUNCTION_EXCEPTION",e[e.E_FUNCTION_UNKNOWN=4030]="E_FUNCTION_UNKNOWN",e[e.E_FUNCTION_RESTPARAMETER_DEFINITION_MISSING=4040]="E_FUNCTION_RESTPARAMETER_DEFINITION_MISSING",e[e.E_FUNCTION_RESOLVING_PARAMETER_FAILED=4050]="E_FUNCTION_RESOLVING_PARAMETER_FAILED",e[e.E_FUNCTION_EXPRESSION_PARSER_ERROR=4100]="E_FUNCTION_EXPRESSION_PARSER_ERROR",e[e.E_FUNCTION_EXPRESSION_EXCEPTION=4120]="E_FUNCTION_EXPRESSION_EXCEPTION",e[e.E_TRIGGER_ACTION_EXCEPTION=5050]="E_TRIGGER_ACTION_EXCEPTION",e[e.E_TRIGGER_JAVASCRIPT_EVAL_EXCEPTION=5055]="E_TRIGGER_JAVASCRIPT_EVAL_EXCEPTION",e[e.E_TRIGGER_FUNCTION_EXPRESSION_EXCEPTION=5060]="E_TRIGGER_FUNCTION_EXPRESSION_EXCEPTION",e[e.E_TRIGGER_RESOLVE_CONDITION_EXPRESSION_EXCEPTION=5065]="E_TRIGGER_RESOLVE_CONDITION_EXPRESSION_EXCEPTION",e[e.E_TRIGGER_CONDITION_INVALID=5200]="E_TRIGGER_CONDITION_INVALID",e[e.E_CONTROL_INSTANCE_NOT_FOUND=6e3]="E_CONTROL_INSTANCE_NOT_FOUND",e[e.E_CONTROL_INVALID_CONFIGURATION=6001]="E_CONTROL_INVALID_CONFIGURATION",e[e.E_CONTROL_ATTRIBUTE_NOT_FOUND=6005]="E_CONTROL_ATTRIBUTE_NOT_FOUND",e[e.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION=6010]="E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION",e[e.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE=6020]="E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE",e[e.E_SCHEMA_INVALID=7e3]="E_SCHEMA_INVALID",e[e.E_SCHEMA_INVALID_PATH=7010]="E_SCHEMA_INVALID_PATH",e[e.E_SCHEMA_INVALID_REF_ID=7020]="E_SCHEMA_INVALID_REF_ID",e[e.E_SCHEMA_UNKNOWN_FILE=7030]="E_SCHEMA_UNKNOWN_FILE",e[e.E_SCHEMA_UNKNOWN_DEFINITION=7040]="E_SCHEMA_UNKNOWN_DEFINITION",e[e.E_SCHEMA_NOT_RESOLVED=7050]="E_SCHEMA_NOT_RESOLVED",e[e.E_PACKAGE=8e3]="E_PACKAGE"}(t=e.Errors||(e.Errors={}))}(TcHmi||(TcHmi={})),function(e){
/**
    *
    * @class EventProvider
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{
/**
         * Register a callback to an event name.
         * If the name is a binding expression the callback will be initially called if there is a binding with this name
         * @function
         * @param {string} name Name of the event.
         * @param {function} callback Callback which will be called
         * @returns {function} Destroy function which cleans up/unregisters
         * @preserve (Part of the public API)
         */
static register(name,callback,options){const r=this.__internalEventId++;let o,i=null,n=()=>{i||(e.EventProvider.raise("System.EventProvider.onDestroyCallback<"+name+">",s),e.EventProvider.raise("System.EventProvider.onDestroyCallback",s)),o&&(o(),o=void 0),i&&(i.destroy(),i=null);const event=t.__events.get(name);event&&(event.delete(r),0===event.size&&t.__events.delete(name))},event=t.__events.get(name);void 0===event&&(event=new Map,t.__events.set(name,event));const s={id:r,name:name,callback:callback,options:options,destroy:n};return event.set(r,s),!0===e.Symbol.isSymbolExpression(name)?(i=new e.System.Symbol(name),o=i.watch((function(data){if(o||(o=data.destroy),data.error===e.Errors.NONE){let t=e.Callback.callSafe(callback,null,{name:name,destroy:n},data.value);t&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t)}}))):(e.EventProvider.raise("System.EventProvider.onRegisterCallback<"+name+">",s),e.EventProvider.raise("System.EventProvider.onRegisterCallback",s)),n}
/**
         * Calls all registered callbacks related to an event name.
         * @function
         * @param {string} name Name of the event.
         * @param {any} ...args optional parameter(s) which will be transfered to the callbacks
         * @preserve (Part of the public API)
         */static raise(name,...e){const event=t.__events.get(name);event&&event.forEach((r,o)=>{t.raiseEx(r,...e)})}
/**
         * Calls the callback of an specific event registration.
         * @function
         * @param {EventProvider.IEventEntry} event
         * @param args optional parameter(s) which will be transfered to the callbacks
         * @preserve (Part of the public API)
         */static raiseEx(event,...t){let r=e.Callback.callSafe(event.callback,null,{name:event.name,destroy:event.destroy},...t);r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r)}static watchEventRegistration(name,callback){let r=null,o=function(event){r=e.EventProvider.register("System.EventProvider.onDestroyCallback<"+name+">",(function(o,event){e.Callback.callSafe(callback,t,{error:e.Errors.NONE,type:t.EventRegWatchType.DESTROY,event:event}),r?(r(),r=null):o.destroy()})),e.Callback.callSafe(callback,t,{error:e.Errors.NONE,type:t.EventRegWatchType.REGISTER,event:event})},event=t.__events.get(name);event&&event.forEach((e,t)=>{o(e)});let i=e.EventProvider.register("System.EventProvider.onRegisterCallback<"+name+">",(function(e,event){o(event)}));return function(){i&&(i(),i=null),r&&(r(),r=null)}}static has(name){return e.EventProvider.__events.has(name)}static count(name){let t=e.EventProvider.__events.get(name);return t?t.size:0}}t.__events=new Map,t.__internalEventId=0,e.EventProvider=t,function(e){let t;!function(e){e[e.REGISTER=100]="REGISTER",e[e.DESTROY=200]="DESTROY"}(t=e.EventRegWatchType||(e.EventRegWatchType={}))}(t=e.EventProvider||(e.EventProvider={}))}(TcHmi||(TcHmi={})),function(e){e.Function=class{constructor(t){var r;this.__f=t;let o=e.System.Data.Modules.functions.map.get(t.fn);o&&o.error===e.Errors.NONE&&(this.__module=o,this.__fn=null===(r=this.__module.reg)||void 0===r?void 0:r.func,this.__fnDescr=this.__module.description)}__execute(t,r){if(!this.__f)return void t.error(e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,{code:e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,message:e.Errors[e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE],reason:"Function was destroyed already",domain:"TcHmi.Function"});if(!this.__module)return void t.error(e.Errors.E_MODULE_MISSING,{code:e.Errors.E_MODULE_MISSING,message:e.Errors[e.Errors.E_MODULE_MISSING],reason:this.__f.fn,domain:"TcHmi.Function"});if(this.__module.error!==e.Errors.NONE)return void t.error(e.Errors.E_MODULE_ERROR,{code:e.Errors.E_MODULE_ERROR,message:e.Errors[e.Errors.E_MODULE_ERROR],reason:this.__f.fn,domain:"TcHmi.Function",errors:this.__module.errorDetails?[this.__module.errorDetails]:void 0});if(!this.__fn)return void t.error(e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,{code:e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,message:e.Errors[e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE],reason:this.__f.fn,domain:"TcHmi.Function",errors:this.__module.errorDetails?[this.__module.errorDetails]:void 0});if(!this.__fnDescr)return void t.error(e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION,{code:e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION,message:e.Errors[e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION],reason:this.__f.fn,domain:"TcHmi.Function",errors:this.__module.errorDetails?[this.__module.errorDetails]:void 0});let o=[],i=this.__f.fnParams;Array.isArray(i)||(i=[]);let n=this.__fnDescr,s=n.function.arguments,l=!1,c=0,d=this;!0===n.function.injectContextObject&&c++;let _=function(error,r){if(!l)if(l=!0,error===e.Errors.NONE){let r;!0===n.function.injectContextObject&&(n.function&&n.function.waitMode&&"Asynchronous"===n.function.waitMode?o.unshift(t):o.unshift({}));try{r=d.__fn.call(d,...o)}catch(r){return void t.error(e.Errors.E_FUNCTION_EXCEPTION,{code:e.Errors.E_FUNCTION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXCEPTION],reason:n.function.name+', Exception: "'+r+'"',domain:"TcHmi.Function"})}if(n.function&&(!n.function.waitMode||n.function.waitMode&&"Synchronous"===n.function.waitMode))return void t.success(r)}else t.error(error,r)};if(n.function&&n.function.waitMode&&"Asynchronous"===n.function.waitMode&&!1===n.function.injectContextObject)return void _(e.Errors.E_FUNCTION_INVALID_CONFIGURATION,{code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],reason:n.function.name+", Setting waitMode=Asynchronous and injectContextObject="+n.function.injectContextObject+" is an invalid function configuration. Please define a context object if you want to use waitMode=Asynchronous.",domain:"TcHmi.Function"});let m=r.length+i.length,u=function(t,r,value){if(r){let i=e.System.Services.typeManager.getSchema(r.type);i&&"TcHmi.Symbol"===i.frameworkInstanceOf?value instanceof e.Symbol?o[t]=value:o[t]=null:o[t]=e.ValueConverter.toSchemaType(value,i)}else o[t]=value;m--,0===m&&_(e.Errors.NONE)},g=function(t,r,o){o.readEx((function(data){data.error===e.Errors.NONE?u(t,r,data.value):_(e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,{code:e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,message:e.Errors[e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED],reason:n.function.name+", Resolving symbol: '"+o.getExpression()+"' for parameter: "+t+" failed.",domain:"TcHmi.Function",errors:data.details?[data.details]:void 0})}))},E=function(t,r,o){try{new e.System.FunctionExpression(o).execute({success:function(e){u(t,r,e)},error:function(error,r){_(e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,{code:e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,message:e.Errors[e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED],reason:n.function.name+", Resolving function expression: '"+o+"' for parameter: "+t+" failed.",domain:"TcHmi.Function",errors:[r]})}})}catch(r){_(e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,{code:e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED,message:e.Errors[e.Errors.E_FUNCTION_RESOLVING_PARAMETER_FAILED],reason:n.function.name+", Resolving function expression: '"+o+"' for parameter: "+t+"  failed with exception.",domain:"TcHmi.Function",errors:[{code:e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION],reason:r,domain:"TcHmi.System.FunctionExpression"}]})}};if(!l)if(0===m)_(e.Errors.NONE);else{for(let e=0,t=r.length;e<t;e++){let t,o=r[e];e<s.length?t=s[e+c]:(t=s[s.length-1+c],t.restParameter||(t=null)),u(e,t,o)}for(let t=0,o=i.length;t<o;t++){if(l)return;let o,d=i[t];if(t<s.length-r.length?o=s[t+r.length+c]:(o=s[s.length-1+c],o.restParameter||(o=null)),!o)return void _(e.Errors.E_FUNCTION_INVALID_CONFIGURATION,{code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],reason:n.function.name,domain:"TcHmi.Function"});if(e.IFunction.isStaticValue(d))u(t+r.length,o,d.value);else if(e.IFunction.isSymbol(d)){let i=new e.Symbol(d.symbolExpression),n=e.System.Services.typeManager.getSchema(o.type);n&&"TcHmi.Symbol"===n.frameworkInstanceOf?u(t+r.length,o,i):g(t+r.length,o,i)}else e.IFunction.isFunctionExpression(d)?E(t+r.length,o,d.functionExpression):_(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:n.function.name,domain:"TcHmi.Function"})}}}
/**
         * Will raise the function defined in constructor argument f: IFunction.
         * @param requiredArgs Optional required arguments. Will be injected before arguments defined in IFunction and after context object dummy if context object is required.
         * @preserve (Part of the public API)
         */execute(e=[]){let t=null,r=!1;return this.__execute({success:function(e){r||(r=!0,t=e)},error:function(error){r||(r=!0,t=null)}},e),t}
/**
         * Will raise the function defined in constructor argument f: IFunction and raises a callback afterwards.
         * @param requiredArgs Optional required arguments. Will be injected before arguments defined in IFunction and after context object dummy if context object is required.
         * @param callback
         * @preserve (Part of the public API)
         */executeEx(t=[],callback){let r=this;t||(t=[]);let o=!1;this.__execute({success:function(t){o||(o=!0,e.Callback.callSafe(callback,r,{error:e.Errors.NONE,result:t}))},error:function(error,t){o||(o=!0,e.Callback.callSafe(callback,r,{error:error,details:t}))}},t)}
/**
         * Releases all resources of the function
         * @preserve (Part of the public API)
         */destroy(){this.__module=void 0,this.__f=void 0,this.__fn=void 0,this.__fnDescr=void 0}}}(TcHmi||(TcHmi={})),function(e){
/**
     * @preserve (Part of the public API)
     */
let t;!function(t){t.registerFrameworkFunction=
/**
         * Deprecated! Please use registerFunctionEx.
         * @deprecated Please use registerFunctionEx.
         * @function registerFrameworkFunction
         * @memberOf TcHmi.Functions
         * @param {string} name
         * @param {function} func
         * @param {string} descriptionUrl
         * @preserve (Part of the public API)
         */
function(name,t,r){e.Functions.registerFunction(name,t)},t.registerFunction=
/**
         * @function registerFunction
         * @memberOf TcHmi.Functions
         * @param {string} name
         * @param {(...args)} func
         * @preserve (Part of the public API)
         */
function(name,t){let r={error:e.Errors.NONE,name:name,func:t};e.System.Data.Registrations.functions.map.has(name)?e.System.Data.Registrations.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Functions.registerFunction",reason:'Ambiguous registration for the name: "'+name+'". Function will not be addressable by this name. Please try fully qualified name to access function.'}}):e.System.Data.Registrations.functions.map.set(name,r),e.EventProvider.raise("System.onFunctionRegistered",r)},t.registerFunctionEx=
/**
         * @function registerFunctionEx
         * @memberOf TcHmi.Functions
         * @param {string} name
         * @param {string} namespace
         * @param {(...args)} func
         * @preserve (Part of the public API)
         */
function(name,namespace,t){let r=e.System.resolveQualifiedName(name,namespace),o={error:e.Errors.NONE,name:name,namespace:name,func:t};e.System.Data.Registrations.functions.map.has(name)?e.System.Data.Registrations.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Functions.registerFunctionEx",reason:'Ambiguous registration for the name: "'+name+'". Function will not be addressable by this name. Please try fully qualified name to access function.'}}):e.System.Data.Registrations.functions.map.set(name,o),e.System.Data.Registrations.functions.map.has(r)?e.System.Data.Registrations.functions.map.set(r,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi.Functions.registerFunctionEx",reason:'Ambiguous registration for the name: " '+r+'". Function will not be addressable by this name.'}}):e.System.Data.Registrations.functions.map.set(r,o),e.EventProvider.raise("System.onFunctionRegistered",o)},t.getFunction=
/**
         * Returns a registered HMI function
         * @function getFunction
         * @memberOf TcHmi.Functions
         * @param {string} name
         * @returns {function}
         * @preserve (Part of the public API)
         */
function(name){let t=e.System.Data.Modules.functions.map.get(name);if(t&&t.error===e.Errors.NONE)return t.reg.func},t.getFunctionVersion=
/**
         * Gets version information of function by name.
         * @param {string} name
         * @returns {Version|null}
         * @preserve (Part of the public API)
         */
function(name){let t=e.System.Data.Modules.functions.map.get(name);return t&&t.error===e.Errors.NONE&&t.description&&t.description.version&&"object"==typeof t.description.version?t.description.version:null}}(t=e.Functions||(e.Functions={}))}(TcHmi||(TcHmi={})),function(e){class t extends Array{constructor(){super(),this.__proto__!==e.List.prototype&&(Object.setPrototypeOf?Object.setPrototypeOf(this,t.prototype):this.__proto__=t.prototype)}first(e){for(let t=0,r=this.length;t<r;t++)if(e(this[t]))return this[t];throw new Error("Array does not contain elements")}firstOrDefault(e,defaultValue=null){for(var t=0,r=this.length;t<r;t++)if(e(this[t]))return this[t];return null}remove(e){for(var t=0,r=this.length;t<r;t++)if(this[t]===e)return this.splice(t,1),!0;return!1}addRange(e){for(var t=0,r=e.length;t<r;t++)this.push(e[t])}clearAll(){for(;this.length>0;)this.pop()}findIndex(e){for(let t=0,r=this.length;t<r;t++)if(e(this[t],t,this))return t;return-1}}e.List=t}(TcHmi||(TcHmi={})),function(e){e.Locale=class{constructor(){}
/**
         * Loads a language file and refreshes localization symbols.
         * @param {string | null} locale
         * @param {null | function} callback
         * @preserve (Part of the public API)
         */static load(locale,callback=null){e.System.Services.localizationManager.loadLocale(locale,callback)}
/**
         * Returns the current locale string for texts or undefined if no localized Symbol is available.
         * @returns   {string}    The current locale identifier.
         * @preserve (Part of the public API)
         */static get(){return e.System.Services.localizationManager.getLocale()}
/**
         * Returns the list of locales for localizedSymbols.
         * @returns {string[]}
         * @preserve (Part of the public API)
         */static getRegisteredLocales(){let t=[];for(let r in e.System.config.languages)t.push(r);return t}}}(TcHmi||(TcHmi={})),function(e){
/**
    * Allows handling date and time formatting
    * @class Localization
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{constructor(){}static __rebuildLocalizationCache(){this.__numberFormatMilliSecondsCache.clear(),this.__dateFormatCache.clear()}static __getMillisecondsFormatter(t){let r=this.__numberFormatMilliSecondsCache.get(t);if(r)return r;let o=t;if(!o){o=e.System.Services.accessManager.getCurrentUserConfig().timeFormatLocale}try{r=new Intl.NumberFormat(o,{style:"decimal",minimumIntegerDigits:2,minimumFractionDigits:3})}catch(e){e instanceof RangeError&&(o=void 0,r=new Intl.NumberFormat(o,{style:"decimal",minimumIntegerDigits:2,minimumFractionDigits:3}))}return this.__numberFormatMilliSecondsCache.set(t,r),r}static getDateTimeFormatter(locale,timeZone,hour12,type="full"){let t=this.__dateFormatCache.get(locale);t||(t=new Map,this.__dateFormatCache.set(locale,t));let r=t.get(timeZone);r||(r=new Map,t.set(timeZone,r));let o=r.get(hour12);o||(o=new Map,r.set(hour12,o));let i=o.get(type);if(i)return i;const n=e.System.Services.accessManager.getCurrentUserConfig();let s=locale;s||(s=n.timeFormatLocale);let l=timeZone;l||(l=n.timeZone);try{new Intl.DateTimeFormat(s)}catch(e){s=void 0}try{new Intl.DateTimeFormat(s,{timeZone:l})}catch(e){e instanceof RangeError&&(l=void 0)}let c={timeZone:l,hour12:hour12};switch(type){case"date":c.year="numeric",c.month="numeric",c.day="numeric";break;case"time":case"time-no-millisec":c.hour="numeric",c.minute="numeric",c.second="numeric";break;case"full":case"full-no-millisec":c.year="numeric",c.month="numeric",c.day="numeric",c.hour="numeric",c.minute="numeric",c.second="numeric"}return c.hour&&"function"!=typeof Intl.DateTimeFormat.prototype.formatToParts&&(c.hour12=!1),i=new Intl.DateTimeFormat(s,c),o.set(type,i),i}
/**
         *  Skip non numberic chars and parseInt the rest.
         *  MS Browsers add Left-To-Right-Mark to output
         *  https://github.com/tc39/ecma402/issues/28
         * @param {string} input
         * @preserve (Part of the public API)
         */static parseInt(input){let value="";for(let e=0;e<input.length;e++)input.charCodeAt(e)>=32&&input.charCodeAt(e)<=126&&(value+=input[e]);return parseInt(value,10)}
/**
         * Parses a Date object
         * formats it to a time zone and split its components into an object
         * On error all entries will be NaN
         * @param date
         * @preserve (Part of the public API)
         */static parseDate(date,options){const t={year:NaN,month:NaN,day:NaN,hour:NaN,minute:NaN,second:NaN,millisecond:NaN};if(isNaN(date.getTime()))return t;let timeZone;if(options&&"string"==typeof options.timeZone&&(timeZone=options.timeZone),"function"==typeof Intl.DateTimeFormat.prototype.formatToParts){let r=this.getDateTimeFormatter("de-DE",timeZone,!1,"full").formatToParts(date);t.year=e.Localization.parseInt(r.find(value=>"year"===value.type).value),t.month=e.Localization.parseInt(r.find(value=>"month"===value.type).value),t.day=e.Localization.parseInt(r.find(value=>"day"===value.type).value),t.hour=e.Localization.parseInt(r.find(value=>"hour"===value.type).value),t.minute=e.Localization.parseInt(r.find(value=>"minute"===value.type).value),t.second=e.Localization.parseInt(r.find(value=>"second"===value.type).value),t.millisecond=date.getUTCMilliseconds()}else{let r=this.getDateTimeFormatter("de-DE",timeZone,!1,"date"),o=r.format(date).split(".");t.year=e.Localization.parseInt(o[2]),t.month=e.Localization.parseInt(o[1]),t.day=e.Localization.parseInt(o[0]),r=this.getDateTimeFormatter("de-DE",timeZone,!1,"time");let i=r.format(date).split(":");t.hour=e.Localization.parseInt(i[0]),t.minute=e.Localization.parseInt(i[1]),t.second=e.Localization.parseInt(i[2]),t.millisecond=date.getUTCMilliseconds()}return t}
/**
         * Formats a Date object down to milliseconds in the correct locale and time zone (config from server user or browser default)
         * On error this will be null
         * @param date
         * @preserve (Part of the public API)
         */static formatDate(date,options){if(isNaN(date.getTime()))return null;let locale=void 0;options&&"string"==typeof options.locale&&(locale=options.locale);let timeZone=void 0;options&&"string"==typeof options.timeZone&&(timeZone=options.timeZone);let e=void 0;options&&"string"==typeof options.type&&(e=options.type);let r="";if("function"==typeof Intl.DateTimeFormat.prototype.formatToParts){this.getDateTimeFormatter(locale,timeZone,void 0,e).formatToParts(date).forEach(o=>{if("second"===o.type&&"time-no-millisec"!==e&&"full-no-millisec"!==e){let e=t.parseInt(o.value);e%1==0&&(e+=date.getMilliseconds()/1e3);let i=this.__getMillisecondsFormatter(locale);r+=i.format(e)}else r+=o.value})}else{let t=this.getDateTimeFormatter(locale,timeZone,!1,e);if(r=t.format(date),!options||"date"!==options.type&&"time-no-millisec"!==e&&"full-no-millisec"!==e){let e=this.__getMillisecondsFormatter(locale).format(date.getMilliseconds()/1e3);r+=e.slice(2)}}return r}}t.__numberFormatMilliSecondsCache=new Map,t.__dateFormatCache=new Map,e.Localization=t}(TcHmi||(TcHmi={})),function(e){class t{}t.Prefix=!0,e.Log=t,
/**
     *
     * @preserve (Part of the public API)
     */
function(t){let r=new class{constructor(){if(this.__db=null,this.__cache=[],this.__ready=!1,this.__error=!1,TCHMI_CONSOLE_LOG_PERSISTENT)if(window.indexedDB){let request=null;try{request=window.indexedDB.open("TcHmi.Log")}catch(t){this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception while opening database: "+t)}null!==request&&(request.onerror=t=>{this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of request.onerror: "+t)},request.onsuccess=e=>{this.__db=request.result,this.__ready=!0},request.onupgradeneeded=t=>{this.__db=t.target.result;try{this.__db.createObjectStore("data",{keyPath:"id",autoIncrement:!0}),this.__ready=!0}catch(t){this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception in request.onupgradeneeded event handler: "+t)}})}else this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because IndexedDB API is missing in your browser.")}add(t,type,message,...r){if(!TCHMI_CONSOLE_LOG_PERSISTENT)return;if(!window.indexedDB)return;let o=[];for(let e=0,t=r.length;e<t;e++){let t=r[e];try{if(null!==t&&"object"==typeof t){t=__tchmi_is_instanced_object(t)?t.constructor&&t.constructor.name?"[IndexedDBLog: Serializing data not possible for type: 'object' with constructor: '"+t.constructor.name+"']":"[IndexedDBLog: Serializing data not possible for type: 'object']":JSON.parse(JSON.stringify(t,(e,value)=>{if("function"==typeof value)return"[IndexedDBLog: Serializing data not possible for type: 'function']";if("object"==typeof value){return __tchmi_is_instanced_object(value)?value.constructor&&value.constructor.name?"[IndexedDBLog: Serializing data not possible for type: 'object' with constructor: '"+value.constructor.name+"']":"[IndexedDBLog: Serializing data not possible for type: 'object']":value}return value}))}else null!==t&&"function"==typeof t&&(t="[IndexedDBLog: Serializing data not possible for type: 'function']")}catch(e){t="[IndexedDBLog: Serializing data failed with exception: '"+e+"']"}o.push(t)}if(!this.__ready)return void(this.__error||this.__cache.push({timespan:t,type:type,message:message,optionalParameters:o}));if(this.__cache&&this.__cache.length>0){let e=this.__cache;for(this.__cache=[];e.length>0;){let t=e.shift();this.add(t.timespan,t.type,t.message,...t.optionalParameters)}}if(!this.__db)return;let i=null;try{i=this.__db.transaction(["data"],"readwrite")}catch(t){this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception: "+t)}if(!i)return;let n=null;try{n=i.objectStore("data")}catch(t){this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception: "+t)}if(!n)return;let s=null;try{s=n.count()}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception: "+t),this.__ready=!1,this.__error=!0}s&&(s.onsuccess=r=>{let i=r.target.result;if(i+1>TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES){let s=i+1-TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES,l=0,c=null;try{c=n.openCursor()}catch(r){this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of unexpected exception while opening cursor: "+r)}if(!c)return;c.onerror=t=>{this.__ready=!1,this.__error=!0,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.Log] Persistent logging failed because of cursor.onerror: "+t)},c.onsuccess=e=>{let r=e.target.result;if(r)return l<s?(l++,r.delete(),void r.continue()):void n.add({timespan:t,type:type,message:message,optionalParameters:o})}}else n.add({timespan:t,type:type,message:message,optionalParameters:o})})}},o=null,i=new Map;window.addEventListener("error",e=>{TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&r.add((new Date).getTime(),"Error",e.error.stack)}),t.error=
/**
        * Prints out an error message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 1 or higher.
        * If the message is an object it will be inspectable in most debug tools
        * @function
        * @param {string | object} message The text which will be printed out in the browsers console.
        * @preserve (Part of the public API)
        */
function(message,forceNoPrefix=!1){TCHMI_CONSOLE_LOG_LEVEL<1||(console&&console.error&&!e.System.isUnloaded&&(!0===e.Log.Prefix&&!1===forceNoPrefix&&"object"!=typeof message?console.error("["+(new Date).toISOString()+"][Error] "+message):console.error(message)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&("string"==typeof message?r.add((new Date).getTime(),"Warning",message):r.add((new Date).getTime(),"Warning","",message)))},t.errorEx=
/**
        * Prints out an error message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 1 or higher.
        * @function
        * @param {string} message The text which will be printed out in the browsers console.
        * @param {...any[]} optionalParameters Optional parameters
        * @preserve (Part of the public API)
        */
function(message,...t){TCHMI_CONSOLE_LOG_LEVEL<1||(console&&console.error&&!e.System.isUnloaded&&(e.Log.Prefix&&(message="["+(new Date).toISOString()+"][Error] "+message),console.error(message,...t)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&r.add((new Date).getTime(),"Error",message,...t))},t.warn=
/**
        * Prints out a warning message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 2 or higher.
        * If the message is an object it will be inspectable in most debug tools
        * @function
        * @param {string | object} message The text which will be printed out in the browsers console
        * @preserve (Part of the public API)
        */
function(message,forceNoPrefix=!1){TCHMI_CONSOLE_LOG_LEVEL<2||(console&&console.warn&&!e.System.isUnloaded&&(!0===e.Log.Prefix&&!1===forceNoPrefix&&"object"!=typeof message?console.warn("["+(new Date).toISOString()+"][Warning] "+message):console.warn(message)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&("string"==typeof message?r.add((new Date).getTime(),"Warning",message):r.add((new Date).getTime(),"Warning","",message)))},t.warnEx=
/**
        * Prints out a warning message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 2 or higher.
        * @function
        * @param {string} message The text which will be printed out in the browsers console.
        * @param {...any[]} optionalParameters Optional parameters
        * @preserve (Part of the public API)
        */
function(message,...t){TCHMI_CONSOLE_LOG_LEVEL<2||(console&&console.warn&&!e.System.isUnloaded&&(e.Log.Prefix&&(message="["+(new Date).toISOString()+"][Warning] "+message),console.warn(message,...t)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&r.add((new Date).getTime(),"Warning",message,...t))},t.info=
/**
        * Prints out an info message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 3 or higher.
        * If the message is an object it will be inspectable in most debug tools
        * @function
        * @param {string | object} message The text which will be printed out in the browsers console
        * @preserve (Part of the public API)
        */
function(message,forceNoPrefix=!1){TCHMI_CONSOLE_LOG_LEVEL<3||(console&&console.info&&!e.System.isUnloaded&&(!0===e.Log.Prefix&&!1===forceNoPrefix&&"object"!=typeof message?console.info("["+(new Date).toISOString()+"][Info] "+message):console.info(message)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&("string"==typeof message?r.add((new Date).getTime(),"Info",message):r.add((new Date).getTime(),"Info","",message)))},t.infoEx=
/**
        * Prints out an info message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 3 or higher.
        * @function
        * @param {string} message The text which will be printed out in the browsers console.
        * @param {...any[]} optionalParameters Optional parameters
        * @preserve (Part of the public API)
        */
function(message,...t){TCHMI_CONSOLE_LOG_LEVEL<3||(console&&console.info&&!e.System.isUnloaded&&(e.Log.Prefix&&(message="["+(new Date).toISOString()+"][Info] "+message),console.info(message,...t)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&r.add((new Date).getTime(),"Info",message,...t))},t.debug=
/**
        * Prints out a debug message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 4 or higher.
        * If the message is an object it will be inspectable in most debug tools
        * @function
        * @param {string | object} message The text which will be printed out in the browsers console.
        * @preserve (Part of the public API)
        */
function(message,forceNoPrefix=!1){TCHMI_CONSOLE_LOG_LEVEL<4||(console&&console.log&&!e.System.isUnloaded&&(!0===e.Log.Prefix&&!1===forceNoPrefix&&"object"!=typeof message?console.log("["+(new Date).toISOString()+"][Debug] "+message):console.log(message)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&("string"==typeof message?r.add((new Date).getTime(),"Debug",message):r.add((new Date).getTime(),"Debug","",message)))},t.debugEx=
/**
        * Prints out a debug message in the browsers console if TCHMI_CONSOLE_LOG_LEVEL is set to 4 or higher.
        * @function
        * @param {string} message The text which will be printed out in the browsers console.
        * @param {...any[]} optionalParameters Optional parameters
        * @preserve (Part of the public API)
        */
function(message,...t){TCHMI_CONSOLE_LOG_LEVEL<4||(console&&console.log&&!e.System.isUnloaded&&(e.Log.Prefix&&(message="["+(new Date).toISOString()+"][Debug] "+message),console.log(message,...t)),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&r.add((new Date).getTime(),"Debug",message,...t))},t.performanceLog=function(e){if(!(TCHMI_CONSOLE_LOG_LEVEL<4)&&window.console&&window.console.time&&window.console.timeEnd){let t="["+(new Date).toISOString()+"][Performance] "+e;null!==o&&window.console.timeEnd(o),"[Source=Framework, Module=TcHmi] End"!==e?(window.console.time(t),o=t):o=null}},t.performanceLogStart=function(e){TCHMI_CONSOLE_LOG_LEVEL<4||(window.console&&window.console.time&&window.console.timeEnd&&window.console.time(e),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&window.performance&&window.performance.now&&(i.set(e,performance.now()),r.add((new Date).getTime(),"Debug","Timer: '"+e+"' started.")))},t.performanceLogEnd=function(e){if(!(TCHMI_CONSOLE_LOG_LEVEL<4)&&(window.console&&window.console.time&&window.console.timeEnd&&window.console.timeEnd(e),TCHMI_CONSOLE_LOG_PERSISTENT&&window.indexedDB&&window.performance&&window.performance.now)){let t=i.get(e);if(i.delete(e),void 0!==t){let o=performance.now();r.add((new Date).getTime(),"Debug","Timer: '"+e+"' finished after "+(o-t)+"ms.")}}},t.__buildFirstDeepestErrorMessage=function(error){let t=function(error){if(void 0!==error.errors&&error.errors.length)for(let r=0;r<error.errors.length;r++){if(error.errors[r].code!==e.Errors.NONE)return t(error.errors[r]);error.errors.splice(r,1),r--}return error};if(!error)return"";let r=tchmi_clone_object(error),o=t(r);return e.Log.buildMessage(o)},t.buildMessage=
/**
         * Builds a formatted message of hierarchical error objects
         * @param {TcHmi.IErrorDetails} error
         * @preserve (Part of the public API)
         */
function(error){let e=function(error,t){if(!error)return"";let r="",o="  ";for(let e=0,r=t;e<r;e++)o+="  ";if(error.code&&(r+="Code: "+error.code+"/0x"+error.code.toString(16)),error.message&&(r+=", Message: "+error.message),error.reason&&(r+="\n"+o+"Reason: "+error.reason),error.domain&&(r+="\n"+o+"Domain: "+error.domain),void 0!==error.errors&&error.errors.length){r+="\n"+o+"as result of: ";for(let o=0,i=error.errors.length;o<i;o++)r+=e(error.errors[o],t+1)}return r};return e(error,0)}}(t=e.Log||(e.Log={}))}(TcHmi||(TcHmi={})),function(e){
/**
    * Provides functions for interaction with the TwinCAT HMI Server.
    * @class Server
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{
/**
         * Returns the current readyState value of the underlying websocket which is connected to the TwinCAT HMI Server.
         * Use constants like WebSocket.CLOSED or WebSocket.OPEN for comparison.
         * @returns {number | null} The current readyState value of the underlying websocket which is connected to the TwinCAT HMI Server or null.
         * @preserve (Part of the public API)
         */
static getWebsocketReadyState(){let t=e.System.Services.serverManager;return null==t?null:t.getWebsocketReadyState()}
/**
         * Returns true if the websocket is ready and false if its not.
         * @returns {boolean} If true the websocket is ready for connectivity.
         * @preserve (Part of the public API)
         */static isWebsocketReady(){let t=e.System.Services.serverManager;return null!=t&&t.getWebsocketReadyState()===WebSocket.OPEN}
/**
         * Write one or more values to a TwinCAT HMI Server symbol.
         * @function writeSymbol
         * @memberOf TcHmi.Server
         * @param {string|string[]} symbolName The target TwinCAT HMI Server symbolname.
         * @param {string|number|boolean|Object|Array} value The value which should be written to the target symbol.
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @template W Type of the write value. Use any (or omit) if this contains multiple different types.
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static writeSymbol(symbolName,value,callback){return t.writeSymbolEx(symbolName,value,null,callback)}
/**
         *
         * Write one or more values to a TwinCAT HMI Server symbol.
         * @function writeSymbol
         * @memberOf TcHmi.Server
         * @param {string|string[]} symbolName The target TwinCAT HMI Server symbolname.
         * @param {string|number|boolean|Object|Array} value The value which should be written to the target symbol.
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @template W Type of the write value. Use any (or omit) if this contains multiple different types.
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static writeSymbolEx(symbolName,value,requestOptions,callback){let r,o,i=e.System.Services.serverManager;if(null==i)return e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),null;if(Array.isArray(symbolName)){if(!Array.isArray(value)||symbolName.length!==value.length)return e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],domain:"TcHmi.Server"}}),null;r=symbolName,o=value}else r=[symbolName],o=[value];const request={requestType:"ReadWrite",commands:[]};for(let t=0;t<r.length;t++){let i=r[t],n=o[t];if("string"!=typeof i)return e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],domain:"TcHmi.Server"}}),null;request.commands.push({commandOptions:["SendErrorMessage","SendWriteValue"],symbol:i,writeValue:n})}return i.requestEx(request,requestOptions,t.__handleServerResponse({completed:data=>{let t=e.Callback.callSafe(callback,null,data);t&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t)}}))}
/**
         * Reads the value of a TwinCAT HMI Server symbol.
         * @function readSymbol
         * @memberOf TcHmi.Server
         * @param {string|string[]} symbolName The target TwinCAT HMI Server symbolname.
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished. The callback function gets 'error' (TcHmi.Errors.E_WEBSOCKET_NOT_READY or TcHmi.Errors.NONE) and the response
         * @returns {number} Request id
         * @template W Type of the write value.
         * @template R Type of the read value.
         * @preserve (Part of the public API)
         */static readSymbol(symbolName,callback){return t.readSymbolEx(symbolName,null,callback)}
/**
        * Reads the value of a TwinCAT HMI Server symbol.
        * @function readSymbol
        * @memberOf TcHmi.Server
        * @param {string|string[]} symbolName The target TwinCAT HMI Server symbolname.
        * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
        * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished. The callback function gets 'error' (TcHmi.Errors.E_WEBSOCKET_NOT_READY or TcHmi.Errors.NONE) and the response
        * @returns {number} Request id
        * @template W Type of the write value.
        * @template R Type of the read value.
        * @preserve (Part of the public API)
        */static readSymbolEx(symbolName,requestOptions,callback){let r,o=e.System.Services.serverManager;if(null==o)return e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),null;r=Array.isArray(symbolName)?symbolName:[symbolName];const request={requestType:"ReadWrite",commands:[]};for(let t=0;t<r.length;t++){let o=r[t];if("string"!=typeof o)return e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID]}}),null;request.commands.push({commandOptions:["SendErrorMessage","SendWriteValue"],symbol:o})}return o.requestEx(request,requestOptions,t.__handleServerResponse({completed:data=>{let t=e.Callback.callSafe(callback,null,data);t&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t)}}))}
/**
         * Requests a message to the hmi server with default connection parameter
         * @function request
         * @memberOf TcHmi.Server
         * @param {Object} request Request object
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished. The callback function gets 'error' (TcHmi.Errors.E_WEBSOCKET_NOT_READY or TcHmi.Errors.NONE) and the response
         * @returns {number} Request id
         * @template W Type of the write value. Use any (or omit) if this contains multiple different types.
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static request(request,callback){return t.requestEx(request,null,callback)}
/**
         * Requests a message to the hmi server with given connection parameter
         * @function requestEx
         * @memberOf TcHmi.Server
         * @param {Object} request Request object
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished. The callback function gets 'error' (TcHmi.Errors.E_WEBSOCKET_NOT_READY or TcHmi.Errors.NONE) and the response
         * @returns {number} Request id
         * @template W Type of the write value. Use any (or omit) if this contains multiple different types.
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static requestEx(request,requestOptions,callback){let r=e.System.Services.serverManager;return null==r?(e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),null):r.requestEx(request,requestOptions,t.__handleServerResponse({completed:data=>{let t=e.Callback.callSafe(callback,null,data);t&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t)}}))}
/**
         * Subscribe to a to a list of commands.
         * Subscription have to be unsubscribed by use of the TcHmi.Server.unsubscribe function.
         * @function subscribe
         * @memberOf TcHmi.Server
         * @param {Object[]} commands
         * @param {number} interval Subscription refresh interval.
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static subscribe(commands,interval,callback){return t.subscribeEx(commands,interval,null,callback)}
/**
         * Subscribe to a to a list of commands.
         * Subscription have to be unsubscribed by use of the TcHmi.Server.unsubscribe function.
         * @function subscribe
         * @memberOf TcHmi.Server
         * @param {Object[]} commands
         * @param {number} interval Subscription refresh interval.
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @template R Type of the read value. Use any (or omit) if this contains multiple different types.
         * @preserve (Part of the public API)
         */static subscribeEx(commands,interval,requestOptions,callback){let r=e.System.Services.serverManager;if(null==r)return e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),null;if(!Array.isArray(commands))return e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"commands parameter must be an array",domain:"TcHmi.Server"}}),null;let request={requestType:"Subscription",commands:commands};return null!=interval&&"number"==typeof interval&&(request.intervalTime=interval),r.requestEx(request,requestOptions,t.__handleServerResponse({completed:data=>{let t=e.Callback.callSafe(callback,null,data);t&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t)}}))}
/**
         * Unsubscribe a list of commands.
         * @function unsubscribe
         * @memberOf TcHmi.Server
         * @param {number} requestId The id of the subscription request which shall be unsubscribed.
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @preserve (Part of the public API)
         */static unsubscribe(requestId,callback){return t.unsubscribeEx(requestId,null,callback)}
/**
         * Unsubscribe a list of commands.
         * @function unsubscribe
         * @memberOf TcHmi.Server
         * @param {number} requestId The id of the subscription request which shall be unsubscribed.
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback Asynchronous response callback which will be raised if the operation has finished.
         * @returns {number} Request id
         * @preserve (Part of the public API)
         */static unsubscribeEx(requestId,requestOptions,callback){let r=null,o=e.System.Services.serverManager;if(null==o)return e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),null;const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Unsubscribe",writeValue:requestId}]};let i=o.getRequest(requestId);return i?(!i.pending&&i.queued?o.releaseRequest(requestId):(o.releaseRequest(requestId),r=o.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))),r):(e.Callback.callSafe(callback,null,{error:e.Errors.NONE}),null)}static releaseRequest(id){let t=e.System.Services.serverManager;null!=t&&t.releaseRequest(id)}
/**
         * Get current username as string or null.
         * @returns {string|null}
         * @preserve (Part of the public API)
         */
static getCurrentUser(){return e.System.Services.accessManager.getCurrentUserConfig().name}
/**
         * Get groups membership of current user as array (can be empty).
         * @returns {string[]}
         * @preserve (Part of the public API)
         */static getGroupsOfCurrentUser(){return e.System.Services.accessManager.getCurrentUserConfig().userIsInGroups}
/**
         * Get current user config.
         * @preserve (Part of the public API)
         */static getCurrentUserConfig(){return tchmi_clone_object(e.System.Services.accessManager.getCurrentUserConfig())}
/**
         * Login into a TcHmiServer, reloads the page on success, call of a callback on failure.
         * @param {string | null | undefined} userName String with the username
         * @param {string | null | undefined} password String with the password
         * @param {boolean} persistent Should the session be valid even after browser restart
         * @param {null | ((this: void, data: TcHmi.Server.IResultObject) => void)} callback? This callback is called if the login was not successful
         * @return {boolean} returns a boolean if the login was called
         * @preserve (Part of the public API)
         */static login(userName,password,persistent=!0,callback){return t.loginEx(userName,password,persistent,null,callback)}
/**
         * Login into a TcHmiServer, reloads the page on success, call of a callback on failure.
         * @param {string | null | undefined} userName String with the username
         * @param {string | null | undefined} password String with the password
         * @param {boolean} persistent Should the session be valid even after browser restart
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.ResultObject) => void)} callback? This callback is called if the login was not successful
         * @return {boolean} returns a boolean if the login was called
         * @preserve (Part of the public API)
         */static loginEx(userName,password,persistent=!0,requestOptions,callback){return t.loginEx2(userName,password,persistent,!0,requestOptions,callback)}
/**
         * Login into a TcHmiServer, reloads the page on success if not deactivated, call of a callback on failure.
         * @param {string | null | undefined} userName String with the username
         * @param {string | null | undefined} password String with the password
         * @param {boolean} persistent Should the session be valid even after browser restart
         * @param {boolean} reload Reload hmi after session login.
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.ResultObject) => void)} callback? This callback is called if the login was not successful
         * @return {boolean} returns a boolean if the login was called
         * @preserve (Part of the public API)
         */static loginEx2(userName,password,persistent=!0,reload=!1,requestOptions,callback){let t=!1;const r=e.System.Services.serverManager;return null==r?(e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),!1):null==userName||"string"!=typeof userName||0===userName.length||null==password||"string"!=typeof password?(e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],domain:"TcHmi.Server"}}),!1):(t=r.login(userName,password,persistent,reload,requestOptions,callback),t)}
/**
         * Logout from a TcHmiServer, reloads the page on success, call of a callback on failure
         * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback This callback is called if the logout was not successful
         * @return {boolean} returns a boolean if the logout was called
         * @preserve (Part of the public API)
         */static logout(callback){return t.logoutEx(null,callback)}
/**
         * Logout from a TcHmiServer, reloads the page on success, call of a callback on failure
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback This callback is called if the logout was not successful
         * @return {boolean} returns a boolean if the logout was called
         * @preserve (Part of the public API)
         */static logoutEx(requestOptions,callback){return e.Server.logoutEx2(!0,requestOptions,callback)}
/**
        * Logout from a TcHmiServer, reloads the page on success, call of a callback on failure
        * @param {boolean} reload Reload hmi after session logout
        * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
        * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback This callback is called if the logout was not successful
        * @return {boolean} returns a boolean if the logout was called
        * @preserve (Part of the public API)
        */static logoutEx2(reload=!0,requestOptions,callback){let t=!1;const r=e.System.Services.serverManager;return null==r?(e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),t):(t=r.logout(reload,requestOptions,callback),t)}
/**
         * Logout all users with a specific username or all users from a TcHmiServer
         * @param {string | Server.IForceLogoutTarget} username username to logout.
         * If empty string or null is provided, all users are logged out.
         * The authentification domain can be specified by using 'Domain::UserName'. If no domain is specified all users with the given name will be logged out.
         * 'Domain::' will logout every user from this domain
         * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback This callback is called if the logout was not successful
         * @return {boolean} returns a boolean if the logout was called
         * @preserve (Part of the public API)
         */static forceLogout(username,callback){return t.forceLogoutEx(username,null,callback)}
/**
         * Logout all users with a specific username or all users from a TcHmiServer
         * @param {string | Server.IForceLogoutTarget} userName username to logout.
         * If empty string or null is provided, all users are logged out.
         * The authentification domain can be specified by using 'Domain::UserName'. If no domain is specified all users with the given name will be logged out.
         * 'Domain::' will logout every user from this domain
         * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
         * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback This callback is called if the logout was not successful
         * @return {boolean} returns a boolean if the logout was called
         * @preserve (Part of the public API)
         */static forceLogoutEx(userName,requestOptions,callback){let t=!1;const r=e.System.Services.serverManager;return null==r?(e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.Server"}}),!1):(void 0!==userName&&""!==userName||(userName=null),t=r.forceLogout(userName,requestOptions,callback),t)}static __handleServerResponse(t){return function(data){let r;if(data.error!==e.Errors.NONE)return r=e.Callback.callSafe(t.error,null,data),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),r=e.Callback.callSafe(t.completed,null,data),void(r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r));let o=data.response;if(!o)return r=e.Callback.callSafe(t.error,null,{error:e.Errors.E_SERVER_RESPONSE_MISSING,details:{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Server"}}),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),r=e.Callback.callSafe(t.completed,null,{error:e.Errors.E_SERVER_RESPONSE_MISSING,details:{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Server"}}),void(r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r));if(o.error)return r=e.Callback.callSafe(t.error,null,{error:e.Errors.E_SERVER_RESPONSE_ERROR,details:{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server",errors:[o.error]},response:o}),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),r=e.Callback.callSafe(t.completed,null,{error:e.Errors.E_SERVER_RESPONSE_ERROR,details:{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server",errors:[o.error]},response:o}),void(r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r));let commands=o.commands;if(!commands||0===commands.length)return r=e.Callback.callSafe(t.error,null,{error:e.Errors.E_SERVER_COMMANDS_MISSING,details:{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server"},response:o}),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),r=e.Callback.callSafe(t.completed,null,{error:e.Errors.E_SERVER_COMMANDS_MISSING,details:{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server"},response:o}),void(r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r));let i=!1,n=[];data.results=[];for(let t of commands)t.error?(i=!0,n.push({code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: '"+t.symbol+"' in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server",errors:[t.error]}),data.results.push({error:e.Errors.E_SERVER_COMMAND_ERROR,details:{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: '"+t.symbol+"' in response from server with id: '"+o.id+"'.",domain:"TcHmi.Server",errors:[t.error]},symbol:t.symbol})):data.results.push({error:e.Errors.NONE,symbol:t.symbol,value:t.readValue});r=i?e.Callback.callSafe(t.error,null,data):e.Callback.callSafe(t.success,null,data),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),r=e.Callback.callSafe(t.completed,null,data),r&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r)}}}e.Server=t,function(t){let r,o;!function(e){e[e.HMI_SUCCESS=0]="HMI_SUCCESS",e[e.HMI_E_FAIL=257]="HMI_E_FAIL",e[e.HMI_E_SYMBOL_IN_USE=274]="HMI_E_SYMBOL_IN_USE",e[e.HMI_E_SYMBOL_NOT_MAPPED=513]="HMI_E_SYMBOL_NOT_MAPPED",e[e.HMI_E_LICENSE_TARGET=778]="HMI_E_LICENSE_TARGET",e[e.HMI_E_MISSING_LICENSE_HANDSHAKE=781]="HMI_E_MISSING_LICENSE_HANDSHAKE",e[e.HMI_E_LICENSE_VERIFY=782]="HMI_E_LICENSE_VERIFY",e[e.HMI_E_INSUFFICIENT_ACCESS=4101]="HMI_E_INSUFFICIENT_ACCESS"}(r=t.Error||(t.Error={})),function(e){e[e.NONE=0]="NONE",e[e.READ=1]="READ",e[e.WRITE=2]="WRITE",e[e.READWRITE=3]="READWRITE"}(o=t.ACCESS||(t.ACCESS={}));t.UserManagement=class{
/**
             * Add a new user with a given password
             * @param {string} username
             * @param {string} password could be null if the default extension does not support passwords
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */
static addUser(userName,password,callback=null){return this.addUserEx(userName,password,null,null,callback)}
/**
             * Add a new user with a given password
             * @param {string} userName
             * @param {string} password could be null if the extension does not support passwords
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {boolean} options.enabled a new user can be disabled
             * @param {string} options.autoLogout ISO8601 TimeSpan for logout after user interaction
             * @param {string} options.locale locale of this user
             * @param {string[]} options.groups list of groups the user will be part of
             * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static addUserEx(userName,password,options=null,requestOptions=null,callback=null){if(!userName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter userName given",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r={domain:e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension,userName:userName,parameters:{password:password||void 0},settings:{}};options&&("string"==typeof options.domain&&options.domain.length>0&&(r.domain=options.domain),"boolean"==typeof options.enabled&&(r.parameters.enabled=options.enabled),("string"==typeof options.locale&&options.locale.length>0||null===options.locale)&&(r.settings.locale=options.locale),("string"==typeof options.timeFormatLocale&&options.timeFormatLocale.length>0||null===options.timeFormatLocale)&&(r.settings.timeFormatLocale=options.timeFormatLocale),("string"==typeof options.timeZone&&options.timeZone.length>0||null===options.timeZone)&&(r.settings.timeZone=options.timeZone),"string"==typeof options.autoLogout&&options.autoLogout.length>0&&(r.settings.autoLogoff=options.autoLogout),Array.isArray(options.groups)&&(r.settings.groups=options.groups));const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"AddOrChangeUser",writeValue:r}]};if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all usernames as a string array
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUsernameListResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsernames(callback=null){return this.listUsernamesEx(null,null,callback)}
/**
             * Lists all usernames as a string array
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUsernameListResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsernamesEx(options,requestOptions=null,callback=null){let r=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".ListUsers"}]};if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,userList:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all username as a dictionary with all meta data
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUserResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsers(callback=null){return this.listUsersEx(null,null,callback)}
/**
             * Lists all username as a dictionary with all meta data
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUserResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsersEx(options,requestOptions=null,callback=null){let r=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::USERS"},{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"TcHmiSrv.Config::USERGROUPUSERS::"+r}]};if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{let t={},o=data.results[0].value,i=data.response.commands[1].readValue;for(let userName in o){if(!i[userName]){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Internal error. TcHmiSrv.Config::USERGROUPUSERS is not in sync with "+r+".Config::USERS with user "+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}t[userName]={domain:r,enabled:o[userName].ENABLED,autoLogout:i[userName].USERGROUPUSERS_AUTO_LOGOFF,locale:i[userName].USERGROUPUSERS_LOCALE,timeFormatLocale:i[userName].USERGROUPUSERS_TIMEFORMATLOCALE,timeZone:i[userName].USERGROUPUSERS_TIMEZONE,groups:i[userName].USERGROUPUSERS_GROUPS}}e.Callback.callSafe(callback,null,{error:e.Errors.NONE,userDetails:t})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all user groups as a dictionary with all meta data
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IGroupResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUserGroups(callback=null){return this.listUserGroupsEx(null,null,callback)}
/**
             * Lists all user groups as a dictionary with all meta data
             * @param {object} options  (not used till now)
             * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IGroupResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUserGroupsEx(options,requestOptions=null,callback=null){if(null===t.requestEx({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"TcHmiSrv.Config::USERGROUPS"}]},requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{let t={},r=data.results[0].value;for(let groupName in r)t[groupName]={enabled:r[groupName].ENABLED,fileAccess:r[groupName].FILEACCESS,files:r[groupName].FILES,symbolAccess:r[groupName].SYMBOLACCESS,symbols:r[groupName].SYMBOLS};e.Callback.callSafe(callback,null,{error:e.Errors.NONE,groupDetailsList:t})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all users of a group as a string array
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUsernameListResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsersInGroup(groupName,callback=null){return this.listUsersInGroupEx(groupName,null,null,callback)}
/**
             * Lists all users of a group as a string array
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IUsernameListResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listUsersInGroupEx(groupName,options,requestOptions=null,callback=null){let r=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"TcHmiSrv.Config::USERGROUPS"},{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"TcHmiSrv.Config::USERGROUPUSERS::"+r}]};if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{const t=data.results[0].value;if(groupName in t){let t=data.response.commands[1].readValue,r=[];for(let userName in t)t[userName].USERGROUPUSERS_GROUPS&&-1!==t[userName].USERGROUPUSERS_GROUPS.indexOf(groupName)&&r.push(userName);e.Callback.callSafe(callback,null,{error:e.Errors.NONE,userList:r})}else e.Callback.callSafe(callback,null,{error:e.Errors.E_KEY_NOT_FOUND,details:{code:e.Errors.E_KEY_NOT_FOUND,reason:"Requested user group not found",domain:"TcHmi.Server.UserManagement"}})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Removes a user
             * @param userName
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static removeUser(userName,callback=null){return this.removeUserEx(userName,null,null,callback)}
/**
              * Removes a user
              * @param {string} userName
              * @param {object} options
              * @param {string} options.domain defaults to TcHmiUserManagement
              * @param {TcHmi.Server.IRequestOptions|null} requestOptions Request options
              * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
              * @preserve (Part of the public API)
              */static removeUserEx(userName,options,requestOptions=null,callback=null){if(!userName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter userName given",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&!userName.includes("::")&&(r=options.domain);const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"RemoveUser",writeValue:{userName:userName,domain:r}}]};if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Update user config
             * @param userName
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {boolean} options.enabled a new user can be disabled
             * @param {string} options.autoLogout ISO8601 TimeSpan for logout after user interaction
             * @param {string} options.locale locale of this user
             * @param {string} options.newName new name for this user
             * @param {string} options.password new password for this user
             * @param {string[]} options.addGroups List of groups the user will be added
             * @param {string[]} options.removeGroups List of groups the user will be removed
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateUser(userName,options,callback=null){return this.updateUserEx(userName,options,null,callback)}
/**
             * Update user config
             * @param userName
             * @param {object} options
             * @param {string} options.domain domain of user management. defaults to TcHmiUserManagement
             * @param {boolean} options.enabled a new user can be disabled
             * @param {string} options.autoLogout ISO8601 TimeSpan for logout after user interaction
             * @param {string} options.locale locale of this user
             * @param {string[]} options.addGroups List of groups the user will be added
             * @param {string[]} options.removeGroups List of groups the user will be removed
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateUserEx(userName,options,requestOptions=null,callback=null){if(!userName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter userName given",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null===options||"object"!=typeof options){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter options given",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);if(null!==e.Server.requestEx({requestType:"ReadWrite",commands:[{commandOptions:["SendWriteValue"],symbol:"GetSymbolAccess",writeValue:"AddOrChangeUser"},{commandOptions:["SendWriteValue"],symbol:"GetSymbolAccess",writeValue:r+".EnableUser"},{commandOptions:["SendWriteValue"],symbol:"GetSymbolAccess",writeValue:r+".DisableUser"},{commandOptions:["SendWriteValue"],symbol:"GetSymbolAccess",writeValue:r+".RenameUser"}]},{},data=>{var o;if(data.error){const t={code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],domain:"TcHmi.Server.UserManagement",errors:data.details?[data.details]:void 0};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}let i=data.response.commands.find(value=>"AddOrChangeUser"===value.writeValue);if(i.readValue===e.Server.ACCESS.NONE||i.readValue===e.Server.ACCESS.READ){if(options){if(options.newName){const t={code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:"Missing access rights for renaming "+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}if(options.addGroups){const t={code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:"Missing access rights for adding groups of "+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}if(options.removeGroups){const t={code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:"Missing access rights for removing groups of "+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}if(void 0!==options.enabled){const t={code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:"Missing access rights to "+(options.enabled?"enable ":"disable ")+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}if(options.autoLogout){const t={code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:"Missing access rights for changing auto logout of "+userName,domain:"TcHmi.Server.UserManagement"};return void e.Callback.callSafe(callback,null,{error:t.code,details:t})}const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"ChangeUserSettings",writeValue:{}}]};if(("string"==typeof options.locale&&options.locale.length>0||null===options.locale)&&(request.commands[0].writeValue.locale=options.locale),("string"==typeof options.timeFormatLocale&&options.timeFormatLocale.length>0||null===options.timeFormatLocale)&&(request.commands[0].writeValue.timeFormatLocale=options.timeFormatLocale),("string"==typeof options.timeZone&&options.timeZone.length>0||null===options.timeZone)&&(request.commands[0].writeValue.timeZone=options.timeZone),"string"==typeof options.password&&options.password.length>0&&(request.commands[0].writeValue.changePassword={currentPassword:options.currentPassword,newPassword:options.password}),Object.keys(request.commands[0].writeValue).length){if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};e.Callback.callSafe(callback,null,{error:t.code,details:t})}}else e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}else{const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"AddOrChangeUser",writeValue:{domain:r,userName:userName,parameters:{},settings:{}}}]};if(options){if("string"==typeof options.password&&options.password.length>0)request.commands[0].writeValue.parameters.password=options.password,request.commands[0].writeValue.parameters.enabled=null!==(o=options.enabled)&&void 0!==o?o:void 0;else if("boolean"==typeof options.enabled){const t=options.enabled?"EnableUser":"DisableUser";let o=data.response.commands.find(value=>value.writeValue===r+"."+t);o.readValue!==e.Server.ACCESS.READWRITE&&o.readValue!==e.Server.ACCESS.WRITE||request.commands.push({commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+"."+t,writeValue:userName})}if("string"==typeof options.autoLogout&&(request.commands[0].writeValue.settings.autoLogoff=options.autoLogout),("string"==typeof options.locale&&options.locale.length>0||null===options.locale)&&(request.commands[0].writeValue.settings.locale=options.locale),("string"==typeof options.timeFormatLocale&&options.timeFormatLocale.length>0||null===options.timeFormatLocale)&&(request.commands[0].writeValue.settings.timeFormatLocale=options.timeFormatLocale),("string"==typeof options.timeZone&&options.timeZone.length>0||null===options.timeZone)&&(request.commands[0].writeValue.settings.timeZone=options.timeZone),"string"==typeof options.newName&&options.newName.length>0){let t=data.response.commands.find(value=>value.writeValue===r+".RenameUser");t.readValue!==e.Server.ACCESS.READWRITE&&t.readValue!==e.Server.ACCESS.WRITE||request.commands.push({commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".RenameUser",writeValue:{currentUserName:userName,newUserName:options.newName}})}0===Object.keys(request.commands[0].writeValue.parameters).length&&delete request.commands[0].writeValue.parameters,0===Object.keys(request.commands[0].writeValue.settings).length&&delete request.commands[0].writeValue.settings;if(null===t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{var o,i,n,s;let l=data.results.find(value=>"AddOrChangeUser"===value.symbol),c=null!==(i=tchmi_clone_object(null===(o=l.value.settings)||void 0===o?void 0:o.groups))&&void 0!==i?i:[];if(Array.isArray(options.addGroups)&&options.addGroups.forEach(e=>{c.includes(e)||c.push(e)}),Array.isArray(options.removeGroups)&&options.removeGroups.forEach(e=>{let t=c.indexOf(e);-1!==t&&c.splice(t,1)}),tchmi_equal(tchmi_clone_object(c).sort(),tchmi_clone_object(null!==(s=null===(n=l.value.settings)||void 0===n?void 0:n.groups)&&void 0!==s?s:[]).sort()))e.Callback.callSafe(callback,null,{error:e.Errors.NONE});else{const request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"AddOrChangeUser",writeValue:{domain:r,userName:userName,settings:{groups:c}}}]};"string"==typeof options.newName&&options.newName.length>0&&(request.commands[0].writeValue.userName=options.newName),t.requestEx(request,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))}}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};e.Callback.callSafe(callback,null,{error:t.code,details:t})}}}}))return{code:e.Errors.NONE};{const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}}
/**
             * Check access rights for usermanagement functions
             * @param {TcHmi.Server.UserManagement.IUserManagementOptions | null} options Option for setting usermanagement domain
             * @param {null | ((this: void, data: TcHmi.Server.UserManagement.IApiAccessResultObject) => void)} callback
             *
             * @preserve (Part of the public API)
             */static getApiAccess(options,callback=null){let t=e.System.Services.accessManager.getCurrentUserConfig().defaultAuthExtension;options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);const r={};r.AddOrChangeUser=e.Server.ACCESS.NONE,r[t+".ListUsers"]=e.Server.ACCESS.NONE,r[t+".Config"]=e.Server.ACCESS.NONE,r["TcHmiSrv.Config"]=e.Server.ACCESS.NONE,r.RemoveUser=e.Server.ACCESS.NONE,r.ChangeUserSettings=e.Server.ACCESS.NONE,r[t+".EnableUser"]=e.Server.ACCESS.NONE,r[t+".DisableUser"]=e.Server.ACCESS.NONE,r[t+".RenameUser"]=e.Server.ACCESS.NONE;let commands=[];for(let symbolName of Object.keys(r))commands.push({commandOptions:["SendWriteValue"],symbol:"GetSymbolAccess",writeValue:symbolName});if(null!==e.Server.requestEx({requestType:"ReadWrite",commands:commands},{},data=>{if(data.error){const t={code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],domain:"TcHmi.Server.UserManagement",errors:data.details?[data.details]:void 0};e.Callback.callSafe(callback,null,{error:t.code,details:t})}else{for(let symbolName of Object.keys(r))r[symbolName]=data.response.commands.find(value=>value.writeValue===symbolName).readValue;e.Callback.callSafe(callback,null,{error:e.Errors.NONE,result:{addUser:{general:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,enable:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,locale:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,timeFormatLocale:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,timeZone:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,autoLogoff:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,groups:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE},listUserNames:{general:r[t+".ListUsers"]===e.Server.ACCESS.READWRITE||r[t+".ListUsers"]===e.Server.ACCESS.READ},listUsers:{general:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),enabled:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),locale:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),timeFormatLocale:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),timeZone:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),autoLogoff:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ),groups:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ)},listUserGroups:{general:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ,enabled:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ,fileAccess:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ,files:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ,symbolAccess:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ,symbols:r["TcHmiSrv.Config"]===e.Server.ACCESS.READWRITE||r["TcHmiSrv.Config"]===e.Server.ACCESS.READ},listUsersInGroup:{general:!(r[t+".Config"]!==e.Server.ACCESS.READWRITE&&r[t+".Config"]!==e.Server.ACCESS.READ||r["TcHmiSrv.Config"]!==e.Server.ACCESS.READWRITE&&r["TcHmiSrv.Config"]!==e.Server.ACCESS.READ)},removeUser:{general:r.RemoveUser===e.Server.ACCESS.READWRITE||r.RemoveUser===e.Server.ACCESS.WRITE},updateUser:{general:r.ChangeUserSettings===e.Server.ACCESS.READWRITE||r.ChangeUserSettings===e.Server.ACCESS.WRITE||r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,newName:!(r.AddOrChangeUser!==e.Server.ACCESS.READWRITE&&r.AddOrChangeUser!==e.Server.ACCESS.WRITE||r[t+".RenameUser"]!==e.Server.ACCESS.READWRITE&&r[t+".RenameUser"]!==e.Server.ACCESS.WRITE),addGroups:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,removeGroups:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,enabled:!(r.AddOrChangeUser!==e.Server.ACCESS.READWRITE&&r.AddOrChangeUser!==e.Server.ACCESS.WRITE||r[t+".EnableUser"]!==e.Server.ACCESS.READWRITE&&r[t+".EnableUser"]!==e.Server.ACCESS.WRITE||r[t+".DisableUser"]!==e.Server.ACCESS.READWRITE&&r[t+".DisableUser"]!==e.Server.ACCESS.WRITE),autoLogout:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,locale:r.ChangeUserSettings===e.Server.ACCESS.READWRITE||r.ChangeUserSettings===e.Server.ACCESS.WRITE||r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,timeFormatLocale:r.ChangeUserSettings===e.Server.ACCESS.READWRITE||r.ChangeUserSettings===e.Server.ACCESS.WRITE||r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,timeZone:r.ChangeUserSettings===e.Server.ACCESS.READWRITE||r.ChangeUserSettings===e.Server.ACCESS.WRITE||r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,changeOwnPassword:r.ChangeUserSettings===e.Server.ACCESS.READWRITE||r.ChangeUserSettings===e.Server.ACCESS.WRITE||r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE,changePassword:r.AddOrChangeUser===e.Server.ACCESS.READWRITE||r.AddOrChangeUser===e.Server.ACCESS.WRITE}}})}}))return{code:e.Errors.NONE};{const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.UserManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}}};class i{
/**
             * Lists all available recipe types
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */
static listRecipeTypes(callback=null){return this.listRecipeTypesEx(null,null,callback)}
/**
             * Lists all available recipe types
             * This function provides more options to manipulate the request
             * @param {TcHmi.Server.RecipeManagement.IRecipeListOption} options
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listRecipeTypesEx(options,requestOptions=null,callback=null){let r="TcHmiRecipeManagement",path="";options&&("string"==typeof options.domain&&options.domain.length>0&&(r=options.domain),"string"==typeof options.path&&options.path.length>0&&(path="::"+options.path));const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeTypeList"+path}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
            * Watches a list of all available recipe types
            * @param options Options for the watch
            * @param callback Callback which is called once and on every change
            * @preserve (Part of the public API)
            */static watchRecipeTypesList(options,callback=null){let t="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);let r=new e.Symbol("%s%"+t+".Config::recipeTypeList%/s%"),o=r.watch((function(data){o||(o=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.value,destroy:o}):e.Callback.callSafe(callback,null,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.getExpression().toString(),domain:"TcHmi.Server.RecipeManagement",errors:data.details?[data.details]:void 0},destroy:o})}));return o}
/**
            * Returns a recipe types adressed by name and optional path
            * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
            * @preserve (Part of the public API)
            */static getRecipeType(recipeTypeName,path,callback=null){return this.getRecipeTypeEx(recipeTypeName,path,null,null,callback)}
/**
             * Returns a recipe types adressed by name and optional path
             * This function provides more options to manipulate the request
             * @param {TcHmi.Server.RecipeManagement.IRecipeListOption} options
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getRecipeTypeEx(recipeTypeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeTypeName||""===recipeTypeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeTypeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let t="TcHmiRecipeManagement";return options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain),this.listRecipeTypesEx({domain:t,path:(path?path+"::":"")+recipeTypeName},requestOptions,callback)}
/**
            * Watches a recipe type
            * @param options Options for the watch
            * @param callback Callback which is called once and on every change
            * @preserve (Part of the public API)
            */static watchRecipeType(recipeTypeName,path,options,callback=null){if("string"!=typeof recipeTypeName||""===recipeTypeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeTypeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),function(){}}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),function(){}}let t="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);let r=new e.Symbol("%s%"+t+".Config::recipeTypeList::"+(path?path+"::":"")+recipeTypeName+"%/s%"),o=r.watch((function(data){o||(o=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.value,destroy:o}):e.Callback.callSafe(callback,null,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.getExpression().toString(),domain:"TcHmi.Server.RecipeManagement",errors:data.details?[data.details]:void 0},destroy:o})}));return o}
/**
             * Creates a recipe type folder
             * @param {string} path name of the new folder
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeTypeFolder(path,callback=null){return this.createRecipeTypeFolderEx(path,null,null,callback)}
/**
             * Creates a recipe type folder
             * This function provides more options to manipulate the request
             * @param {string} path name of the new folder
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeTypeFolderEx(path,options,requestOptions=null,callback=null){if("string"!=typeof path||""===path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeTypeList::"+path,writeValue:{}}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Deletes a recipe type folder
             * @param {string} path name of the folder
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeTypeFolder(path,callback=null){return this.deleteRecipeTypeFolderEx(path,null,null,callback)}
/**
             * Deletes a recipe type folder
             * This function provides more options to manipulate the request
             * @param {string} path name of the folder
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeTypeFolderEx(path,options,requestOptions=null,callback=null){if("string"!=typeof path||""===path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue","Delete"],symbol:r+".Config::recipeTypeList::"+path}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Creates a new recipe type
             * @param {string} recipeTypeName name of the recipe type
             * @param {TcHmi.Server.RecipeManagement.RecipeType} recipeType recipe type definition
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeType(recipeTypeName,recipeType,path,callback=null){return this.createRecipeTypeEx(recipeTypeName,recipeType,path,null,null,callback)}
/**
             * Creates a new recipe type
             * This function provides more options to manipulate the request
             * @param {string} recipeTypeName name of the recipe type
             * @param {TcHmi.Server.RecipeManagement.RecipeType} recipeType recipe type definition
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeTypeEx(recipeTypeName,recipeType,path,options,requestOptions=null,callback=null){return this.__manipulateRecipeType(!1,recipeTypeName,recipeType,path,options,requestOptions,callback)}
/**
             * Updates a recipe type
             * @param {string} recipeTypeName name of the recipe type
             * @param {TcHmi.Server.RecipeManagement.RecipeType} recipeType recipe type definition
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateRecipeType(recipeTypeName,recipeType,path,callback=null){return this.updateRecipeTypeEx(recipeTypeName,recipeType,path,null,null,callback)}
/**
             * Updates a recipe type
             * This function provides more options to manipulate the request
             * @param {string} recipeTypeName name of the recipe type
             * @param {TcHmi.Server.RecipeManagement.RecipeType} recipeType recipe type definition
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateRecipeTypeEx(recipeTypeName,recipeType,path,options,requestOptions=null,callback=null){return this.__manipulateRecipeType(!0,recipeTypeName,recipeType,path,options,requestOptions,callback)}static __manipulateRecipeType(r,recipeTypeName,recipeType,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeTypeName||""===recipeTypeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeTypeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let o="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(o=options.domain);const i={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:o+".Config::recipeTypeList::"+(path?path+"::":"")+recipeTypeName,writeValue:recipeType}]};r&&i.commands[0].commandOptions.push("Replace");if(null===t.requestEx(i,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Renames or moves a recipe type
             * @param {string} recipeTypeName old name of the recipe type
             * @param {string | null} path old path of the recipe type (root folder if set to null)
             * @param {string} newName new name of the recipe type
             * @param {string | null} newPath new path of the recipe type (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeType(recipeTypeName,path,newName,newPath,callback=null){return this.renameRecipeTypeEx(recipeTypeName,path,newName,newPath,null,null,callback)}
/**
             * Renames or moves a recipe type
             * This function provides more options to manipulate the request
             * @param {string} recipeTypeName old name of the recipe type
             * @param {string | null} path old path of the recipe type (root folder if set to null)
             * @param {string} newName new name of the recipe type
             * @param {string | null} newPath new path of the recipe type (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeTypeEx(recipeTypeName,path,newName,newPath,options,requestOptions=null,callback=null){return this.__renameRecipeEntry("recipeTypeList",recipeTypeName,path,newName,newPath,options,requestOptions,callback)}
/**
             * Renames or moves a recipe type folder
             * @param {string} recipeTypeFolderName old name of the recipe type
             * @param {string | null} path old path of the recipe type (root folder if set to null)
             * @param {string} newName new name of the recipe type
             * @param {string | null} newPath new path of the recipe type (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeTypeFolder(recipeTypeFolderName,path,newName,newPath,callback=null){return this.renameRecipeTypeFolderEx(recipeTypeFolderName,path,newName,newPath,null,null,callback)}
/**
             * Renames or moves a recipe type folder
             * This function provides more options to manipulate the request
             * @param {string} recipeTypeFolderName old name of the recipe type
             * @param {string | null} path old path of the recipe type (root folder if set to null)
             * @param {string} newName new name of the recipe type
             * @param {string | null} newPath new path of the recipe type (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeTypeFolderEx(recipeTypeFolderName,path,newName,newPath,options,requestOptions=null,callback=null){return this.__renameRecipeEntry("recipeTypeList",recipeTypeFolderName,path,newName,newPath,options,requestOptions,callback)}static __renameRecipeEntry(r,o,path,newName,newPath,options,requestOptions=null,callback=null){if("string"!=typeof o||""===o||"string"!=typeof newName||""===newName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter oldName or newName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==newPath&&"string"!=typeof newPath){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter newPath given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let i="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(i=options.domain);const n={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Rename",writeValue:{domain:i,configuration:"default",old:r+"::"+(path?path+"::":"")+o,new:r+"::"+(newPath?newPath+"::":"")+newName}}]};if(null===t.requestEx(n,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Deletes a recipe type
             * @param {string} recipeTypeName name of the recipe type
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeType(recipeTypeName,path,callback=null){return this.deleteRecipeTypeEx(recipeTypeName,path,null,null,callback)}
/**
             * Deletes a recipe type
             * This function provides more options to manipulate the request
             * @param {string} recipeTypeName name of the recipe type
             * @param {string | null} path path of the recipe type (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeTypeEx(recipeTypeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeTypeName||""===recipeTypeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeTypeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue","Delete"],symbol:r+".Config::recipeTypeList::"+(path?path+"::":"")+recipeTypeName}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all available recipes
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listRecipes(callback=null){return this.listRecipesEx(null,null,callback)}
/**
             * Lists all available recipes
             * This function provides more options to manipulate the request
             * @param {TcHmi.Server.IRecipeListOptions} options
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static listRecipesEx(options,requestOptions=null,callback=null){let r="TcHmiRecipeManagement",path="";options&&("string"==typeof options.domain&&options.domain.length>0&&(r=options.domain),"string"==typeof options.path&&options.path.length>0&&(path="::"+options.path));const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeList"+path}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
            * Watches a list of all available recipes
            * @param options Options for the watch
            * @param callback Callback which is called once and on every change
            * @preserve (Part of the public API)
            */static watchRecipeList(options,callback=null){let t="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);let r=new e.Symbol("%s%"+t+".Config::recipeList%/s%"),o=r.watch((function(data){o||(o=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.value,destroy:o}):e.Callback.callSafe(callback,null,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.getExpression().toString(),domain:"TcHmi.Server.RecipeManagement",errors:data.details?[data.details]:void 0},destroy:o})}));return o}
/**
             * Creates a recipe folder
             * @param {string} path name of the new folder
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeFolder(path,callback=null){return this.createRecipeFolderEx(path,null,null,callback)}
/**
             * Creates a recipe folder
             * This function provides more options to manipulate the request
             * @param {string} path name of the new folder
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeFolderEx(path,options,requestOptions=null,callback=null){if("string"!=typeof path||""===path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeList::"+path,writeValue:{}}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Deletes a recipe folder
             * @param {string} path name of the folder
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeFolder(path,callback=null){return this.deleteRecipeFolderEx(path,null,null,callback)}
/**
             * Deletes a recipe folder
             * This function provides more options to manipulate the request
             * @param {string} path name of the folder
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeFolderEx(path,options,requestOptions=null,callback=null){if("string"!=typeof path||""===path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue","Delete"],symbol:r+".Config::recipeList::"+path}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Creates a new recipe
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {TcHmi.Server.RecipeManagement.Recipe} recipe recipe definition
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipe(recipeName,path,recipe,callback=null){return this.createRecipeEx(recipeName,path,recipe,null,null,callback)}
/**
             * Creates a new recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {TcHmi.Server.RecipeManagement.Recipe} recipe recipe definition
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static createRecipeEx(recipeName,path,recipe,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeList"+(path?"::"+path:"")+"::"+recipeName,writeValue:recipe}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({completed:data=>{if(data.error===e.Errors.NONE){const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:r+".UpdateRecipe",writeValue:{path:(path?path+"::":"")+recipeName}}]};t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))}else e.Callback.callSafe(callback,null,{error:data.error,details:data.details})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists one recipe
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getRecipe(recipeName,path,callback=null){return this.getRecipeEx(recipeName,path,null,null,callback)}
/**
             * Lists one recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getRecipeEx(recipeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::recipeList"+(path?"::"+path:"")+"::"+recipeName}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
            * Watches a recipe
            * @param options Options for the watch
            * @param callback Callback which is called once and on every change
            * @preserve (Part of the public API)
            */static watchRecipe(recipeName,path,options,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),function(){}}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),function(){}}let t="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);let r=new e.Symbol("%s%"+t+".Config::recipeList"+(path?"::"+path:"")+"::"+recipeName+"%/s%"),o=r.watch((function(data){o||(o=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.value,destroy:o}):e.Callback.callSafe(callback,null,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.getExpression().toString(),domain:"TcHmi.Server.RecipeManagement",errors:data.details?[data.details]:void 0},destroy:o})}));return o}
/**
             * Updates a recipe
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {Dictionary<any>} newValues dictionary of the new values
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateRecipe(recipeName,path,e,callback=null){return this.updateRecipeEx(recipeName,path,e,null,null,callback)}
/**
             * Updates a recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {Dictionary<any>} newValues dictionary of the new values
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateRecipeEx(recipeName,path,r,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let o="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(o=options.domain);const i={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:o+".Config::recipeList"+(path?"::"+path:"")+"::"+recipeName+"::values",writeValue:r}]};if(null===t.requestEx(i,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Reads all values which is referenced by a recipe
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static readFromTarget(recipeName,path,callback=null){return this.readFromTargetEx(recipeName,path,null,null,callback)}
/**
             * Reads all values which is referenced by a recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.Server.RecipeManagement.IReadFromTargetResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static readFromTargetEx(recipeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".ReadFromTarget",writeValue:{path:(path?path+"::":"")+recipeName}}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Reads the current values which are referenced from a base recipe and write it back
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static teach(recipeName,path,callback=null){return this.teachEx(recipeName,path,null,null,callback)}
/**
             * Reads the current values which are referenced from a base recipe and write it back
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static teachEx(recipeName,path,options,requestOptions=null,callback=null){return this.readFromTargetEx(recipeName,path,options,requestOptions,(function(data){data.error===e.Errors.NONE?i.createRecipeEx(recipeName,path,data.value[(path?path+"::":"")+recipeName],options,requestOptions,callback):e.Callback.callSafe(callback,null,data)}))}
/**
             * Reads the current values which are referenced from a base recipe and write it into a new recipe
             * @param {string} recipeName name of the base recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {string} newRecipeName name of the new recipe. (could be prefixed with a path if seperated with ::)
             * @param {string | null} newRecipePath path of the new recipe. (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static teachAsNewRecipe(recipeName,path,newRecipeName,newRecipePath,callback=null){return this.teachAsNewRecipeEx(recipeName,path,newRecipeName,newRecipePath,null,null,callback)}
/**
             * Reads the current values which are referenced from a base recipe and write it into a new recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the base recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {string} newRecipeName name of the new recipe. (could be prefixed with a path if seperated with ::)
             * @param {string | null} newRecipePath path of the new recipe. (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static teachAsNewRecipeEx(recipeName,path,newRecipeName,newRecipePath,options,requestOptions=null,callback=null){if("string"!=typeof newRecipeName||""===newRecipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter newRecipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==newRecipePath&&"string"!=typeof newRecipePath){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter newRecipePath given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return this.readFromTargetEx(recipeName,path,options,requestOptions,(function(data){data.error===e.Errors.NONE?i.createRecipeEx(newRecipeName,newRecipePath,data.value[(path?path+"::":"")+recipeName],options,requestOptions,callback):e.Callback.callSafe(callback,null,data)}))}
/**
             * Activates a recipe (writes all values)
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static activate(recipeName,path,callback=null){return this.activateEx(recipeName,path,null,null,callback)}
/**
             * Activates a recipe (writes all values)
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static activateEx(recipeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".ActivateRecipe",writeValue:{path:(path?path+"::":"")+recipeName}}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Lists all active recipes
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getActiveRecipes(callback=null){return this.getActiveRecipesEx(null,null,callback)}
/**
             * Lists all active recipes
             * This function provides more options to manipulate the request
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getActiveRecipesEx(options,requestOptions=null,callback=null){let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".GetActiveRecipes"}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,recipeList:data.results[0].value})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
            * Watches a list of all active recipes
            * @param options Options for the watch
            * @param callback Callback which is called once and on every change
            * @preserve (Part of the public API)
            */static watchActiveRecipes(options,callback=null){let t="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(t=options.domain);let r=new e.Symbol("%s%"+t+".GetActiveRecipes%/s%"),o=r.watch((function(data){o||(o=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:data.value,destroy:o}):e.Callback.callSafe(callback,null,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.getExpression().toString(),domain:"TcHmi.Server.RecipeManagement",errors:data.details?[data.details]:void 0},destroy:o})}));return o}
/**
             * Renames or moves a recipe
             * @param {string} recipeName old name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path old path of the recipe (root folder if set to null)
             * @param {string} newName new name of the recipe
             * @param {string | null} newPath new path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipe(recipeName,path,newName,newPath,callback=null){return this.renameRecipeEx(recipeName,path,newName,newPath,null,null,callback)}
/**
             * Renames or moves a recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName old name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path old path of the recipe (root folder if set to null)
             * @param {string} newName new name of the recipe
             * @param {string | null} newPath new path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeEx(recipeName,path,newName,newPath,options,requestOptions=null,callback=null){return this.__renameRecipeEntry("recipeList",recipeName,path,newName,newPath,options,requestOptions,callback)}
/**
             * Renames or moves a recipe folder
             * @param {string} recipeFolderName old name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path old path of the recipe (root folder if set to null)
             * @param {string} newName new name of the recipe
             * @param {string | null} newPath new path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeFolder(recipeFolderName,path,newName,newPath,callback=null){return this.renameRecipeFolderEx(recipeFolderName,path,newName,newPath,null,null,callback)}
/**
             * Renames or moves a recipe folder
             * This function provides more options to manipulate the request
             * @param {string} recipeFolderName old name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path old path of the recipe (root folder if set to null)
             * @param {string} newName new name of the recipe
             * @param {string | null} newPath new path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static renameRecipeFolderEx(recipeFolderName,path,newName,newPath,options,requestOptions=null,callback=null){return this.__renameRecipeEntry("recipeList",recipeFolderName,path,newName,newPath,options,requestOptions,callback)}
/**
             * Deletes a recipe
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipe(recipeName,path,callback=null){return this.deleteRecipeEx(recipeName,path,null,null,callback)}
/**
             * Deletes a recipe
             * This function provides more options to manipulate the request
             * @param {string} recipeName name of the recipe (could be prefixed with a path if seperated with ::)
             * @param {string | null} path path of the recipe (root folder if set to null)
             * @param {object} options
             * @param {string} options.domain domain of recipe management. defaults to recipeManagement
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static deleteRecipeEx(recipeName,path,options,requestOptions=null,callback=null){if("string"!=typeof recipeName||""===recipeName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter recipeName given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null!==path&&"string"!=typeof path){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter path given",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiRecipeManagement";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue","Delete"],symbol:r+".Config::recipeList::"+(path?path+"::":"")+recipeName}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.RecipeManagement"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}}t.RecipeManagement=i;t.Historize=class{
/**
             * Adding a Symbol to the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */
static add(symbolName,settings,callback=null){return this.addEx2(symbolName,settings,null,null,callback)}
/**
             * Adding a Symbol to the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static addEx(symbolName,settings,requestOptions,callback=null){return this.addEx2(symbolName,settings,null,requestOptions,callback)}
/**
             * Adding a Symbol to the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {TcHmi.Server.Historize.IOptions} options global settings
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static addEx2(symbolName,settings,options,requestOptions,callback=null){if(!symbolName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter symbolName given",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null==settings||"object"!=typeof settings){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter settings given",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiSqliteHistorize";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);let o={interval:"PT1S",maxEntries:1e4,rowLimit:1e4,recordingEnabled:!0};void 0!==settings.INTERVAL&&(o.interval=settings.INTERVAL),void 0!==settings.MAXENTRIES&&(o.maxEntries=settings.MAXENTRIES),void 0!==settings.ROWLIMIT&&(o.rowLimit=settings.ROWLIMIT),void 0!==settings.RECORDINGENABLED&&(o.recordingEnabled=settings.RECORDINGENABLED);const i={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::historizedSymbolList::"+symbolName,writeValue:o}]};if(null===t.requestEx(i,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Removing a Symbol from the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static remove(symbolName,callback=null){return this.removeEx2(symbolName,null,null,callback)}
/**
            * Removing a Symbol from the Historize Configuration of the server
            * @param {string} symbolName Name of the Symbol to manipulate
            * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
            * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
            * @preserve (Part of the public API)
            */static removeEx(symbolName,requestOptions,callback=null){return this.removeEx2(symbolName,null,requestOptions,callback)}
/**
             * Removing a Symbol from the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IOptions} options
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static removeEx2(symbolName,options,requestOptions,callback=null){if(!symbolName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter symbolName given",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiSqliteHistorize";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue","Delete"],symbol:r+".Config::historizedSymbolList::"+symbolName}]};if(null===t.requestEx(o,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Update a config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static update(symbolName,settings,callback=null){return this.updateEx2(symbolName,settings,null,null,callback)}
/**
             * Update a config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateEx(symbolName,settings,requestOptions,callback=null){return this.updateEx2(symbolName,settings,null,requestOptions,callback)}
/**
             * Update a config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IEntrySettings} settings
             * @param {TcHmi.Server.Historize.IOptions} options global settings
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static updateEx2(symbolName,settings,options,requestOptions,callback=null){if(!symbolName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter symbolName given",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}if(null==settings||"object"!=typeof settings){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter settings given",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiSqliteHistorize";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:r+".Config::historizedSymbolList::"+symbolName}]};if(null===t.requestEx(o,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{let o=data.results[0].value;if(!o)return void e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_READVALUE_MISSING});let i=tchmi_clone_object(o);void 0!==settings.INTERVAL&&(i.interval=settings.INTERVAL),void 0!==settings.MAXENTRIES&&(i.maxEntries=settings.MAXENTRIES),void 0!==settings.ROWLIMIT&&(i.rowLimit=settings.ROWLIMIT),void 0!==settings.RECORDINGENABLED&&(i.recordingEnabled=settings.RECORDINGENABLED);const n={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::historizedSymbolList::"+symbolName,writeValue:i}]};t.requestEx(n,requestOptions,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}
/**
             * Gets the current config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static get(symbolName,callback=null){return this.getEx2(symbolName,null,null,callback)}
/**
             * Gets the current config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.IRequestOptions} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getEx(symbolName,requestOptions,callback=null){return this.getEx2(symbolName,null,requestOptions,callback)}
/**
             * Gets the current config of a Symbol in the Historize Configuration of the server
             * @param {string} symbolName Name of the Symbol to manipulate
             * @param {TcHmi.Server.Historize.IOptions|null} options
             * @param {TcHmi.Server.IRequestOptions|null} requestOptions for the request itself
             * @param {null | ((this: void, data: TcHmi.IResultObject) => void)} callback
             * @preserve (Part of the public API)
             */static getEx2(symbolName,options,requestOptions,callback=null){if(!symbolName){const t={code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid parameter symbolName given.",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}let r="TcHmiSqliteHistorize";options&&"string"==typeof options.domain&&options.domain.length>0&&(r=options.domain);const o={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:r+".Config::historizedSymbolList::"+symbolName}]};if(null===t.requestEx(o,requestOptions,t.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{let t=data.results[0].value;if(!t)return void e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_READVALUE_MISSING});let settings={};void 0!==t.interval&&(settings.INTERVAL=t.interval),void 0!==t.maxEntries&&(settings.MAXENTRIES=t.maxEntries),void 0!==t.rowLimit&&(settings.ROWLIMIT=t.rowLimit),void 0!==t.recordingEnabled&&(settings.RECORDINGENABLED=t.recordingEnabled),e.Callback.callSafe(callback,null,{error:e.Errors.NONE,key:symbolName,settings:settings})}}))){const t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request could not be sent.",domain:"TcHmi.Server.Historize"};return e.Callback.callSafe(callback,null,{error:t.code,details:t}),t}return{code:e.Errors.NONE}}};class n{static confirmAlarm(alarm,callback){var t,r,o,i;let n={name:alarm.name,domain:alarm.sourceDomain,severity:alarm.severity,timeRaised:alarm.timeRaised.toISOString(),params:alarm.params,id:alarm.id,timeCleared:null!==(r=null===(t=alarm.timeCleared)||void 0===t?void 0:t.toISOString())&&void 0!==r?r:null,timeConfirmed:null!==(i=null===(o=alarm.timeConfirmed)||void 0===o?void 0:o.toISOString())&&void 0!==i?i:null,alarmState:alarm.alarmState,confirmationState:alarm.confirmationState};e.System.Services.serverEventManager.confirmAlarm(n,callback)}static registerConsumer(filter,t){let r;try{r=e.System.Filter.parse(filter,e.Type.getSchema("tchmi:server#/definitions/eventFilter"))}catch(r){return e.Callback.callSafe(t.list,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:r.message,domain:"TcHmi.Server.Events"}}),e.Callback.callSafe(t.subscription,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:r.message,domain:"TcHmi.Server.Events"}}),null}let o={filter:r,rawFilter:filter,activeAlarmIds:[],listCallback:t.list,subscriptionCallback:t.subscription};return this.__consumersToAdd.push(o),-1!==this.__registerTimeoutId&&window.clearTimeout(this.__registerTimeoutId),this.__registerTimeoutId=window.setTimeout(()=>{this.__registerTimeoutId=-1,this.__addConsumers()},200),()=>{const e=this.__consumersToAdd.indexOf(o),t=this.__consumers.indexOf(o);-1!==e&&this.__consumersToAdd.splice(e,1),-1!==t&&(this.__consumers.splice(t,1),o.subscriptionCallback&&(-1!==this.__unregisterTimeoutId&&window.clearTimeout(this.__unregisterTimeoutId),this.__unregisterTimeoutId=window.setTimeout(()=>{this.__unregisterTimeoutId=-1,this.__updateSubscription()},500)))}}static __addConsumers(){this.__listEvents(this.__consumersToAdd),this.__consumers.push(...this.__consumersToAdd),this.__consumersToAdd=[],this.__updateSubscription()}static __feedListConsumers(t,r){for(let o=0,i=t.length;o<i;o++){let i=t[o];if(!i.listCallback)continue;i.activeAlarmIds=[];let s=[];for(let e=0,t=r.length;e<t;e++){let t=this.parseServerEvent(r[e]);i.filter.test(t)&&(s.push(t),n.isAlarm(t)&&t.id>-1&&-1===i.activeAlarmIds.indexOf(t.id)&&i.activeAlarmIds.push(t.id))}e.Callback.callSafe(i.listCallback,null,{error:e.Errors.NONE,events:s})}}static __feedSubscriptionConsumers(event){for(let t=0,r=this.__consumers.length;t<r;t++){let r=this.__consumers[t];if(!r.subscriptionCallback)continue;let o=this.parseServerEvent(event);if(r.filter.test(o))n.isAlarm(o)&&o.id>-1&&-1===r.activeAlarmIds.indexOf(o.id)&&r.activeAlarmIds.push(o.id),r.subscriptionCallback({error:e.Errors.NONE,event:o,changeType:this.__toServerEventChangeType(event.changeType),removedByFilter:!1});else if(n.isAlarm(o)&&o.id>-1){let t=r.activeAlarmIds.indexOf(o.id);-1!==t&&(r.activeAlarmIds.splice(t,1),e.Callback.callSafe(r.subscriptionCallback,null,{error:e.Errors.NONE,event:o,changeType:this.__toServerEventChangeType(event.changeType),removedByFilter:!0}))}}}static __listEvents(t){const filter=this.__accumulateFilters(t,!1);void 0!==filter&&e.System.Services.serverEventManager.listEvents(filter,data=>{data.error===e.Errors.NONE?this.__feedListConsumers(t,data.events):t.forEach(t=>e.Callback.callSafe(t.listCallback,null,{error:data.error}))})}static __updateSubscription(){const filter=this.__accumulateFilters(this.__consumers,!0);void 0!==filter?-1===this.__subscriptionId?(this.__subscriptionId=e.System.Services.serverEventManager.subscribe(filter,this.__onEventReveived()),this.__onLocaleChangedDestroyer=e.EventProvider.register("onLocaleChanged",this.__onLocaleChanged())):e.System.Services.serverEventManager.updateSubscription(this.__subscriptionId,filter):-1!==this.__subscriptionId&&(e.System.Services.serverEventManager.unsubscribe(this.__subscriptionId),this.__subscriptionId=-1,this.__onLocaleChangedDestroyer&&(this.__onLocaleChangedDestroyer(),this.__onLocaleChangedDestroyer=null))}static __onEventReveived(){return data=>{data.error===e.Errors.NONE?this.__feedSubscriptionConsumers(data.event):this.__consumers.forEach(t=>e.Callback.callSafe(t.subscriptionCallback,null,{error:data.error}))}}static __onLocaleChanged(){return()=>{this.__listEvents(this.__consumers)}}static __accumulateFilters(e,t){let filter;if(1===e.length)filter=t&&e[0].subscriptionCallback||!t&&e[0].listCallback?e[0].rawFilter:void 0;else{filter=[];for(let r=0,o=e.length;r<o;r++)if((!t||e[r].subscriptionCallback)&&(t||e[r].listCallback)){if(null===e[r].rawFilter||0===e[r].rawFilter.length){filter=null;break}filter.push(1===e[r].rawFilter.length?e[r].rawFilter[0]:e[r].rawFilter),r+1!==o&&filter.push({logic:"OR"})}null!==filter&&0===filter.length&&(filter=void 0)}return filter}static parseServerEvent(e){var t;switch(null!==(t=e.payloadType)&&void 0!==t?t:n.Type.Payload){case n.Type.Message:let t=e.payload,message={type:n.Type.Message,domain:e.domain,sourceDomain:t.domain,name:t.name,severity:t.severity,text:e.localizedString,timeRaised:new Date(t.timeRaised),timeReceived:new Date(e.timeReceived),params:t.params};return void 0!==e.sessionId&&(message.sessionId=e.sessionId),message;case n.Type.Alarm:let r=e.payload,alarm={type:n.Type.Alarm,domain:e.domain,sourceDomain:r.domain,name:r.name,severity:r.severity,id:r.id,text:e.localizedString,timeRaised:new Date(r.timeRaised),timeCleared:r.timeCleared?new Date(r.timeCleared):null,timeConfirmed:r.timeConfirmed?new Date(r.timeConfirmed):null,timeReceived:new Date(e.timeReceived),alarmState:r.alarmState,confirmationState:r.confirmationState,params:r.params};return void 0!==e.sessionId&&(alarm.sessionId=e.sessionId),alarm;case n.Type.Payload:let o={type:n.Type.Payload,domain:e.domain,name:e.name,timeReceived:new Date(e.timeReceived)};return void 0!==e.payload&&(o.payload=e.payload),void 0!==e.sessionId&&(o.sessionId=e.sessionId),o}}static __toServerEventChangeType(t){if(void 0===t)return n.ChangeType.MessageSent;switch(t){case e.System.ServerEventManager.ServerAlarmChangeType.Raise:return n.ChangeType.AlarmRaised;case e.System.ServerEventManager.ServerAlarmChangeType.Change:return n.ChangeType.AlarmChanged;case e.System.ServerEventManager.ServerAlarmChangeType.Dispose:return n.ChangeType.AlarmDisposed}}}n.__consumers=[],n.__consumersToAdd=[],n.__registerTimeoutId=-1,n.__unregisterTimeoutId=-1,n.__subscriptionId=-1,n.__onLocaleChangedDestroyer=null,t.Events=n,function(e){let t,r,o,i,n;!function(e){e[e.Message=0]="Message",e[e.Alarm=1]="Alarm",e[e.Payload=2]="Payload"}(t=e.Type||(e.Type={})),function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}(r=e.Severity||(e.Severity={})),function(e){e[e.Raised=0]="Raised",e[e.Confirmed=1]="Confirmed",e[e.Cleared=2]="Cleared",e[e.ClearedAndConfirmed=3]="ClearedAndConfirmed",e[e.Invalid=4]="Invalid"}(o=e.AlarmState||(e.AlarmState={})),function(e){e[e.NotSupported=0]="NotSupported",e[e.NotRequired=1]="NotRequired",e[e.WaitForConfirmation=2]="WaitForConfirmation",e[e.Confirmed=3]="Confirmed",e[e.Reset=4]="Reset"}(i=e.ConfirmationState||(e.ConfirmationState={})),function(e){e[e.AlarmRaised=0]="AlarmRaised",e[e.AlarmChanged=1]="AlarmChanged",e[e.AlarmDisposed=2]="AlarmDisposed",e[e.MessageSent=3]="MessageSent"}(n=e.ChangeType||(e.ChangeType={})),e.isAlarm=function(value){return value.type===t.Alarm},e.isMessage=function(value){return value.type===t.Message},e.isPayload=function(value){return value.type===t.Payload}}(n=t.Events||(t.Events={}));t.ADS=class{static checkLicense(e,callback=null){return t.ADS.checkLicenseEx(e,null,callback)}static checkLicenseEx(t,requestOptions,callback=null){return t?(e.Server.requestEx({requestType:"ReadWrite",commands:[{symbol:"ADS.CheckLicense",writeValue:t,commandOptions:["SendWriteValue","SendErrorMessage"]}]},requestOptions,data=>{if(data.error===e.Errors.NONE){let t=data.response;if(!t)return e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_RESPONSE_MISSING,details:{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Server.ADS"}}),{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Server.ADS"};if(t.error)return e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_RESPONSE_ERROR,details:{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS",errors:[t.error]}}),{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS",errors:[t.error]};let commands=t.commands;if(!commands)return e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_COMMANDS_MISSING,details:{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"}}),{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"};let r=null;for(let o=0,i=commands.length;o<i;o++){if(r=commands[o],"ADS.CheckLicense"===r.symbol){if(r.error)return e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_COMMAND_ERROR,details:{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS",errors:[r.error]}}),{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS",errors:[r.error]};break}r=null}if(!r)return e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_COMMAND_MISSING,details:{code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"}}),{code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"};let o=r.readValue;return o?(e.Callback.callSafe(callback,null,{error:e.Errors.NONE,count:o.count,expireTimeUTC:o.expireTimeUTC,result:o.result}),{code:e.Errors.NONE,message:e.Errors[e.Errors.NONE]}):(e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_READVALUE_MISSING,details:{code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"Missing property: 'readValue' in command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"}}),{code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"Missing property: 'readValue' in command for symbol: 'ADS.CheckLicense' in response from server with id: '"+t.id+"'.",domain:"TcHmi.Server.ADS"})}return e.Callback.callSafe(callback,null,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request failed.",domain:"TcHmi.Server.ADS",errors:data.details?[data.details]:void 0}}),{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Request failed.",domain:"TcHmi.Server.ADS",errors:data.details?[data.details]:void 0}}),{code:e.Errors.NONE,message:e.Errors[e.Errors.NONE]}):(e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Parameter: 'licenseId' must not be empty or undefined or null.",domain:"TcHmi.Server.ADS"}}),{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Parameter: 'licenseId' must not be empty or undefined or null.",domain:"TcHmi.Server.ADS"})}};t.Domains=class{static watch(name,callback){let t=new e.Symbol("%s%ListDomains%/s%"),r=t.watch(data=>{data&&data.error===e.Errors.NONE?data.value&&data.value[name]?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:tchmi_clone_object(data.value[name])}):e.Callback.callSafe(callback,null,{error:e.Errors.E_SERVER_DOMAIN_UNKNOWN,details:{code:e.Errors.E_SERVER_DOMAIN_UNKNOWN,message:e.Errors[e.Errors.E_SERVER_DOMAIN_UNKNOWN],reason:"Domain is unknown!",domain:"TcHmi.Server.Domains",errors:data.details?[data.details]:void 0}}):e.Callback.callSafe(callback,null,{error:data.error,details:data.details})});return()=>{r&&(r(),r=null),t.destroy(),t=null}}}}(t=e.Server||(e.Server={}))}(TcHmi||(TcHmi={})),function(e){e.StyleProvider=
/**
    * Reserved
    * @class StyleProvider
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class{
/**
         * Returns the given computed CSS property on the first given element. Does return values set by CSS files, the other Style APIs and AnimationProvider
         * Unset or unknown CSS values will not be set in the result object.
         * @param {JQuery|HTMLElement|SVGElement} element The jQuery collection or single HTML/SVG element.
         * @param {string|string[]} propertyNames  The CSS property (string) or properties (string array) to get.
         * @preserve (Part of the public API)
         */
static getComputedElementStyle(element,propertyName){return e.System.Services.styleManager.__getElementStyle(element,propertyName,!0)}
/**
         * Returns the given CSS property on the first given element. Does not return values set by CSS files, the other Style APIs and AnimationProvider
         * @param {JQuery | undefined} element The jQuery element.
         * @param {string|string[]} propertyNames  The CSS property (string) or properties (string array) to get.
         * @returns {object}
         * @preserve (Part of the public API)
         */static getSimpleElementStyle(element,propertyName){return e.System.Services.styleManager.__getElementStyle(element,propertyName,!1)}
/**
         * Style setter for simple styles in a collection of JQuery elements or single HTML or SVG Elements.
         * @param {JQuery | undefined} element The jQuery element.
         * @param {string|object} propertyName      The CSS property to process or a dictionary of property value pairs.
         * @param {string} [value]         The value for the CSS property or an array of values. Only used if second parameter is no object.
         * @preserve (Part of the public API)
         */static setSimpleElementStyle(element,propertyName,value=null){return e.System.Services.styleManager.__setSimpleElementStyle(element,propertyName,value)}static processGenericStyle(controlName,selector,propertyName,value=null){return e.System.Services.styleManager.processGenericStyle(controlName,selector,propertyName,value)}
/**
         * Resolves a SolidColor object to a string representation for use as css color property.
         * Has to be called with a valid SolidColor. Use isSolidColor to check
         * @param colorObject The SolidColor to resolve.
         * @preserve (Part of the public API)
        */static resolveSolidColorAsCssValue(colorObject){return"none"===colorObject.color.toLowerCase()?"transparent":colorObject.color}
/**
        * Resolve a SolidColor object to a RGBAColor object.
        * Has to be called with a valid SolidColor. Use isSolidColor to check
        * @param colorObject The SolidColor to resolve.
        * @preserve (Part of the public API)
        */static resolveSolidColorAsRGBA(colorObject){let e=document.createElement("canvas");e.width=e.height=1;let t=e.getContext("2d");t.clearRect(0,0,1,1),t.fillStyle=colorObject.color,t.fillRect(0,0,1,1);let r=t.getImageData(0,0,1,1).data;return{r:r[0],g:r[1],b:r[2],a:r[3]}}
/**
         * Resolves a LinearGradientColor object to a string representation for use in css background-image property.
         * Has to be called with a valid LinearGradientColor. Use isLinearGradientColor to check
         * @param colorObject The LinearGradientColor to resolve.
         * @preserve (Part of the public API)
        */static resolveLinearGradientColorAsCssValue(colorObject){let e=colorObject.angle;null==e&&(e=0);let t="linear-gradient(";if(t+=e+"deg",colorObject.stopPoints)for(let e=0,r=colorObject.stopPoints.length;e<r;e++){let r=colorObject.stopPoints[e];void 0!==r.stop&&null!==r.stop?t+=","+r.color+" "+r.stop:t+=","+r.color}return t+=")",t}
/**
         * Style Processor for background.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew  The new value for the background.
         * @preserve (Part of the public API)
         */static processBackground(element,valueNew){return e.System.Services.styleManager.processBackground(element,valueNew)}
/**
         * Style Processor for background colors and gradients.
         * @param {JQuery} element   The jQuery element.
         * @param valueNew  The new value for the background.
         * @preserve (Part of the public API)
         */static processBackgroundColor(element,valueNew){return e.System.Services.styleManager.processBackground(element,{color:valueNew})}
/**
         * Style Processor for background images.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew  The URL of the image.
         * @preserve (Part of the public API)
         */static processBackgroundImage(element,valueNew){return e.System.Services.styleManager.processBackground(element,{image:valueNew})}
/**
         * Style processor for SVG fill color.
         * @param {JQuery | SVGElement | undefined} element The jQuery element.
         * @param valueNew The new fill color.
         * @preserve (Part of the public API)
         * HTMLElement allowed because default jQuery type is HTMLElement
         */static processFillColor(element,valueNew){return e.System.Services.styleManager.processFillColor(element,valueNew)}
/**
         * Style processor for SVG stroke color.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new stroke color.
         * @preserve (Part of the public API)
         * HTMLElement allowed because default jQuery type is HTMLElement
         */static processStrokeColor(element,valueNew){return e.System.Services.styleManager.processStrokeColor(element,valueNew)}
/**
         * Style processor for text color.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new text color.
         * @preserve (Part of the public API)
         */static processTextColor(element,valueNew){return e.System.Services.styleManager.processTextColor(element,valueNew)}
/**
         * Style processor for border color.
         * @param {JQuery | undefined} element The jQuery element.
         * @param {object} valueNew      The new border color.
         * @preserve (Part of the public API)
         */static processBorderColor(element,valueNew){return e.System.Services.styleManager.processBorderColor(element,valueNew)}
/**
         * Style processor for border width.
         * @param {JQuery | undefined} element The jQuery element.
         * @param {object} valueNew      The new border widths.
         * @preserve (Part of the public API)
         */static processBorderWidth(element,valueNew){return e.System.Services.styleManager.processBorderWidth(element,valueNew)}
/**
         * Style processor for border radius.
         * @param {JQuery | undefined} element The jQuery element.
         * @param {object} valueNew      The new border radii.
         * @preserve (Part of the public API)
         */static processBorderRadius(element,valueNew){return e.System.Services.styleManager.processBorderRadius(element,valueNew)}
/**
         * Style processor for border style.
         * @param {JQuery | undefined} element The jQuery element.
         * @param {object} valueNew      The new border styles.
         * @preserve (Part of the public API)
         */static processBorderStyle(element,valueNew){return e.System.Services.styleManager.processBorderStyle(element,valueNew)}
/**
         * Style processor for box shadow.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new border styles.
         * @preserve (Part of the public API)
         */static processBoxShadow(element,valueNew){return e.System.Services.styleManager.processBoxShadow(element,valueNew)}
/**
         * Style processor for font family.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new font family.
         * @preserve (Part of the public API)
         */static processFontFamily(element,valueNew){return e.System.Services.styleManager.processFontFamily(element,valueNew)}
/**
         * Style processor for font size.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new font size.
         * @param unitNew       The new font size unit. Defaults to "px".
         * @preserve (Part of the public API)
         */static processFontSize(element,valueNew,unitNew="px"){return e.System.Services.styleManager.processFontSize(element,valueNew,unitNew)}
/**
         * Style processor for font style.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new font style. Allowed values are "Normal", "Italic" and "Oblique".
         * @preserve (Part of the public API)
         */static processFontStyle(element,valueNew){return e.System.Services.styleManager.processFontStyle(element,valueNew)}
/**
         * Style processor for font weight.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new font weight. Allowed values are "Normal" and "Bold".
         * @preserve (Part of the public API)
         */static processFontWeight(element,valueNew){return e.System.Services.styleManager.processFontWeight(element,valueNew)}
/**
         * Style processor for visibility.
         * Visibility also effects pointer events, i.e. a hidden element will not receive mouse click events.
         * Hidden still uses space in fluid calculations, collapsed is ignored there.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new visibility. Allowed values are "Visible", "Collapsed" and "Hidden". Hidden still uses space in fluid calculations, collapsed is ignored there.
         * @preserve (Part of the public API)
         */static processVisibility(element,valueNew){return e.System.Services.styleManager.processVisibility(element,valueNew)}
/**
         * Style processor for horizontal alignment. This aligns the content of the target element, not the target element itself.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new horizontal alignment. Allowed values are "Left", "Center" and "Right".
         * @preserve (Part of the public API)
         */static processContentHorizontalAlignment(element,valueNew){return e.System.Services.styleManager.processContentHorizontalAlignment(element,valueNew)}
/**
         * Style processor for vertical alignment. This aligns the content of the target element, not the target element itself.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new vertical alignment. Allowed values are "Top", "Center" and "Bottom".
         * @preserve (Part of the public API)
         */static processContentVerticalAlignment(element,valueNew){return e.System.Services.styleManager.processContentVerticalAlignment(element,valueNew)}
/**
         * Style processor for content padding.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new content padding.
         * @preserve (Part of the public API)
         */static processContentPadding(element,valueNew){return e.System.Services.styleManager.processContentPadding(element,valueNew)}
/**
         * Theme processor for transforms.
         * @param {JQuery | undefined} element The jQuery element.
         * @param valueNew      The new transform value or an array of transform values.
         * @param order         If this parameter is passed, the transforms in valueNew will replace the transform at the specified place, instead of replacing all transforms.
         * @preserve (Part of the public API)
         */static processTransform(element,valueNew,order){return e.System.Services.styleManager.processTransform(element,valueNew,order)}}}(TcHmi||(TcHmi={})),function(e){
/**
     * Provides methods to read and write symbol values and schemas.
     * @template ST Type of the value in the symbol.
     * @preserve (Part of the public API)
     */
class t{constructor(expression){this.__symbol=null,this.__symbol=new e.System.Symbol(expression)}
/**
        * Reads the value of the current symbol.
        * return undefined if the symbol is not available
        * @returns A copy of the value
        * @template T Type of the read value. Falls back to type of the symbol.
        * @preserve (Part of the public API)
        */read(){let t=void 0;return this.__symbol.getExpression().getType()===r.Server?(TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Symbol] The non static function 'TcHmi.Symbol.read()' does no longer support synchronous access to symbols of type Server. Please use the non static function 'TcHmi.Symbol.readEx(callback ?: (this: TcHmi.Symbol, data: TcHmi.Symbol.IReadResultObject | TcHmi.Symbol.IServerReadResultObject) => void)' instead."),t):(this.__symbol.read((function(data){data.error===e.Errors.NONE&&(t=data.value)})),t)}
/**
        * Reads the value of the current symbol and raises a callback with a copy of the result.
        * @param {string} expression
        * @param callback with gets a copy of the value
        * @template T Type of the read value. Falls back to type of the symbol.
        * @preserve (Part of the public API)
        */readEx(callback){let r=this,o=this.__symbol.read((function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,r,{error:data.error,value:data.value,response:data.response,details:data.details}):e.Callback.callSafe(callback,r,{error:data.error,value:data.value,details:data.details})}));return()=>{o&&o()}}
/**
         * Writes the value of the current symbol.
         * @param value
         * @param callback
         * @template T Type of the write value. Falls back to type of the symbol.
         * @preserve (Part of the public API)
         */write(value,callback){let r=this,o=this.__symbol.write(value,(function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,r,{error:data.error,value:data.value,response:data.response,details:data.details}):e.Callback.callSafe(callback,r,{error:data.error,value:data.value,details:data.details})}));return()=>{o&&o()}}
/**
         * Watches for changes of the current symbol and raises the callback in case of a change.
         * @param callback
         * @template T Type of the value to watch. Falls back to type of the symbol.
         * @preserve (Part of the public API)
         */watch(callback){let r=this;return this.__symbol.watch((function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,r,{error:data.error,value:data.value,response:data.response,destroy:data.destroy,details:data.details}):e.Callback.callSafe(callback,r,{error:data.error,value:data.value,destroy:data.destroy,details:data.details})}))}
/**
         * Returns the underlying TcHmi.SymbolExpression object.
         * @preserve (Part of the public API)
         */getExpression(){return this.__symbol.getExpression()}
/**
         * Resolves the schema of the current symbol.
         * @param callback
         * @preserve (Part of the public API)
         */resolveSchema(callback){let t=this;this.__symbol.resolveSchema((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,t,{error:e.Errors.NONE,schema:data.schema}):e.Callback.callSafe(callback,t,{error:data.error,details:data.details})}))}
/**
        * Resolves a dictionary of attributes from the underlying schema.
        * @param callback
        * @preserve (Part of the public API)
        */resolveAttributes(callback){this.__symbol.resolveAttributes(data=>{e.Callback.callSafe(callback,this,data)})}
/**
         * Resolves an attribute by name from the underlying schema.
         * @param {string} name
         * @param callback
         * @preserve (Part of the public API)
         */resolveAttribute(name,callback){this.__symbol.resolveAttribute(name,data=>{e.Callback.callSafe(callback,this,data)})}
/**
         *
         * @param callback
         * @preserve (Part of the public API)
         */exists(callback){let t=this;this.__symbol.exists((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,t,{error:e.Errors.NONE,result:data.result}):e.Callback.callSafe(callback,t,{error:data.error,details:data.details})}))}
/**
         * Destroys the current symbol object.
         * @preserve (Part of the public API)
         */destroy(){null!==this.__symbol&&(this.__symbol.destroy(),this.__symbol=null)}
/**
         * Reads the value of a symbol by name and type.
         * @param {string} name
         * @param type
         * @throws Throws an exception if the symbol type is not supported
         * @returns
         * @template T Type of the read value.
         * @preserve (Part of the public API)
         */static read(name,type){let o;switch(type){case r.Internal:o="i";break;case r.LocalizedText:o="l";break;case r.PartialParam:o="pp";break;case r.Server:o="s";break;case r.TemplateParam:o="tp";break;case r.Control:o="ctrl";break;default:throw new TypeError("Unsupported SymbolType="+(e.SymbolType[type]?e.SymbolType[type]:type)+".")}let i=void 0;if(type===r.Server)return TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("The static function 'TcHmi.Symbol.read(name: string, type: TcHmi.SymbolType)' does no longer support synchronous access to symbols of type Server. Please use the non static function 'TcHmi.Symbol.readEx2(expression: string, callback?: (this: void, data: TcHmi.Symbol.IReadResultObject)' instead."),i;let n=new t("%"+o+"%"+name+"%/"+o+"%");return n.readEx((function(data){data.error===e.Errors.NONE&&(i=data.value),n.destroy(),n=null})),i}
/**
         * Reads the value of a symbol by expression.
         * @function readEx
         * @param {string} expression
         * @returns
         * @template T Type of the read value.
         * @preserve (Part of the public API)
         */static readEx(expression){let o=new t(expression);if(o.getExpression().getType()===r.Server)return TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Symbol] The static function 'TcHmi.Symbol.readEx(expression: string)' does no longer support synchronous access to symbols of type Server. Please use the non static function 'TcHmi.Symbol.readEx2(expression: string, callback?: (this: void, data: TcHmi.Symbol.IReadResultObject)' instead."),o.destroy(),void(o=null);let i=o.read();return o.destroy(),o=null,i}
/**
         * Reads the value of a symbol by expression and raises a callback with the result.
         * @param {string} expression
         * @param callback
         * @returns
         * @template T Type of the read value.
         * @preserve (Part of the public API)
         */static readEx2(expression,callback){let r=new t(expression),o=r.readEx((function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,null,{error:data.error,value:data.value,response:data.response,details:data.details}):e.Callback.callSafe(callback,null,{error:data.error,value:data.value,details:data.details}),r.destroy(),r=null}));return()=>{o&&o(),r.destroy(),r=null}}
/**
         * Writes the value of a symbol by name and type.
         * @param {string} name
         * @param type
         * @param value
         * @param callback
         * @throws Throws an exception if the symbol type is not supported
         * @template T Type of the write value.
         * @preserve (Part of the public API)
         */static write(name,type,value,callback){let o;switch(type){case r.Internal:o="i";break;case r.LocalizedText:o="l";break;case r.PartialParam:o="pp";break;case r.Server:o="s";break;case r.TemplateParam:o="tp";break;case r.Control:o="ctrl";break;default:throw new TypeError("Unsupported SymbolType="+(e.SymbolType[type]?e.SymbolType[type]:type)+".")}let i=new t("%"+o+"%"+name+"%/"+o+"%"),n=i.write(value,(function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,null,{error:data.error,value:data.value,response:data.response,details:data.details}):e.Callback.callSafe(callback,null,{error:data.error,value:data.value,details:data.details}),i.destroy(),i=null}));return()=>{n&&n(),i.destroy(),i=null}}
/**
         * Writes the value of a symbol by expression.
         * @function writeEx
         * @param {string} expression
         * @param value
         * @param callback
         * @template T Type of the write value.
         * @preserve (Part of the public API)
         */static writeEx(expression,value,callback){let r=new t(expression),o=r.write(value,(function(data){t.isIServerReadResultObject(data)?e.Callback.callSafe(callback,null,{error:data.error,value:data.value,response:data.response,details:data.details}):e.Callback.callSafe(callback,null,{error:data.error,value:data.value,details:data.details}),r.destroy(),r=null}));return()=>{o&&o(),r.destroy(),r=null}}
/**
         * Resolves the schema of the current symbol.
         * @param {string} expression
         * @param callback
         * @preserve (Part of the public API)
         */static resolveSchema(expression,callback){let r=new t(expression);r.resolveSchema((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,schema:data.schema}):e.Callback.callSafe(callback,null,{error:data.error,details:data.details}),r.destroy(),r=null}))}
/**
        * Resolves a dictionary of attributes from the underlying schema.
        * @param {string} expression
        * @param callback
        * @preserve (Part of the public API)
        */static resolveAttributes(expression,callback){let r=new t(expression);r.resolveAttributes(data=>{e.Callback.callSafe(callback,this,data),r.destroy(),r=null})}
/**
         * Resolves an attribute by name from the underlying schema.
         * @param {string} name
         * @param callback
         * @preserve (Part of the public API)
         */static resolveAttribute(expression,name,callback){let r=new t(expression);r.resolveAttribute(name,data=>{e.Callback.callSafe(callback,this,data),r.destroy(),r=null})}
/**
        *
        * @param callback
        * @preserve (Part of the public API)
        */static exists(expression,callback){let r=new t(expression);r.exists((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,null,{error:e.Errors.NONE,result:data.result}):e.Callback.callSafe(callback,null,{error:data.error,details:data.details}),r.destroy(),r=null}))}
/**
         * @function isSymbolExpression
         * @param {string} expression
         * @preserve (Part of the public API)
         */static isSymbolExpression(expression){if("string"!=typeof expression)return!1;const t=expression.match(e.SymbolExpression.RegExpExpression);return null!=t&&0===t.index}static isIServerReadResultObject(data){return void 0!==data.response}}let r;e.Symbol=t,function(t){t.ObjectResolver=
/**
        * @class ObjectResolver
        * @memberOf TcHmi.Symbol
        * @preserve (Part of the public API)
        */
class{constructor(obj){this.__obj=null,this.__obj=obj}__resolve(obj,callback){let t,r=tchmi_clone_object(obj),error=e.Errors.NONE,o=new Map,i=0,n=function(){if(!(i>0))if(error===e.Errors.NONE){let t=e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:tchmi_clone_object(r)});t&&e.Log.error(t)}else{let r=e.Callback.callSafe(callback,null,{error:error,details:t});r&&e.Log.error(r)}},s=function(r){void 0===r.value&&(i++,r.obj.readEx((function(data){if(data.error===e.Errors.NONE)r.value=data.value,r.refs.forEach((e,obj)=>{for(let t=0,o=e.length;t<o;t++){let o=e[t];null!=o&&(obj[o]=r.value,l(obj,o,obj[o]))}}),o.forEach((e,t)=>{s(e)}),i>0&&i--,n();else{if(error=e.Errors.ERROR,t||(t={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.Symbol.ObjectResolver"}),data.details){t.errors||(t.errors=[]);let e=!1;for(let r=0,o=t.errors.length;r<o;r++)if(tchmi_equal(t.errors[r],data.details)){e=!0;break}e||t.errors.push(data.details)}i>0&&i--,n()}})))},l=function(t,r,value){if(value)if("object"==typeof value)if(Array.isArray(value))for(let e=0,t=value.length;e<t;e++)l(value,e,value[e]);else for(let e in value)l(value,e,value[e]);else if("string"==typeof value){if(e.Symbol.isSymbolExpression(value)){let i=null,n=o.get(value);if(n){void 0!==n.value&&(t[r]=n.value);let e=n.refs.get(t);e?e.push(r):n.refs.set(t,[r])}else{let n=new e.Symbol(value),s=new Map;s.set(t,[r]),i={obj:n,refs:s},o.set(value,i)}}}};return l(null,null,r),o.size>0?o.forEach((e,t)=>{s(e)}):n(),function(){o.forEach((e,t)=>{e.obj.destroy()}),o.clear()}}
/**
            * Resolves all symbol expression refs in the current object.
            * @param callback
            * @preserve (Part of the public API)
            */resolve(callback){if("object"==typeof this.__obj&&null!==this.__obj)return this.__resolve(this.__obj,callback);{let t=e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:this.__obj});return t&&e.Log.error(t),function(){}}}__watch(obj,callback){let t,r=tchmi_clone_object(obj),o=new Map,i=new Map,n=new Map,s=0,l=function(){n.forEach((e,t)=>{e.unwatch&&(e.unwatch(),e.unwatch=null),e.obj&&(e.obj.destroy(),e.obj=null)}),n.clear(),i.clear()},c=function(){if(s>0)return;let error=e.Errors.NONE,i=null;if(o.forEach((t,r)=>{if(error=e.Errors.ERROR,i||(i={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.Symbol.ObjectResolver"}),t){i.errors||(i.errors=[]);let e=!1;for(let r=0,o=i.errors.length;r<o;r++)if(tchmi_equal(i.errors[r],t)){e=!0;break}e||i.errors.push(t)}}),error===e.Errors.NONE){if(tchmi_equal(t,r))return;t=tchmi_clone_object(r);let o=e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:tchmi_clone_object(r),destroy:l});o&&e.Log.error(o)}else{let t=e.Callback.callSafe(callback,null,{error:error,details:i,destroy:l});t&&e.Log.error(t)}},d=function(t){t.active||(t.active=!0,s++,t.unwatch=t.obj.watch((function(data){if(data.error===e.Errors.NONE){if(o.has(t.obj)&&o.delete(t.obj),t.refs){let e=null,r=[],o=[],l=[];if(t.value=data.value,t.refs.forEach((n,obj)=>{for(let s=0,c=n.length;s<c;s++){let c=n[s];if(null!=c){let n=obj[c];if(obj[c]=t.value,"object"==typeof n&&null!=n){let t=i.get(n);if(t){for(let i=0,s=t.length;i<s;i++){let s=t[i];if(s&&s.refs&&(s.refs.delete(n),0===s.refs.size)){r.push(s.obj.getExpression().toString()),o.push(n),e=s;break}}}}l.push({o:obj,k:c,ref:obj[c]})}}}),r){for(let e=0,t=r.length;e<t;e++){let t=r[e];t&&n.delete(t)}r=[]}if(o){for(let e=0,t=o.length;e<t;e++){let t=o[e];t&&i.delete(t)}o=[]}if(e&&(e.unwatch(),e.unwatch=null,e.obj.destroy(),e.obj.destroy=null),l){for(let e=0,t=l.length;e<t;e++){let t=l[e];t&&_(t.o,t.k,t.ref)}l=[]}n.forEach((e,t)=>{d(e)}),s>0&&!1===t.initialized&&s--,t.initialized=!0,c()}}else s>0&&!1===t.initialized&&s--,t.initialized=!0,o.set(t.obj,data.details),c()})))},_=function(t,r,value){if(value)if("object"==typeof value)if(Array.isArray(value))for(let e=0,t=value.length;e<t;e++)_(value,e,value[e]);else for(let e in value)_(value,e,value[e]);else if("string"==typeof value){if(e.Symbol.isSymbolExpression(value)){let o=null,s=n.get(value);if(s){void 0!==s.value&&(t[r]=s.value);let e=s.refs.get(t);e?e.push(r):s.refs.set(t,[r])}else{let i=new e.Symbol(value),s=new Map;s.set(t,[r]),o={obj:i,refs:s,active:!1,initialized:!1},n.set(value,o)}let l=i.get(t);l?l.push(o):o&&i.set(t,[o])}}};return _(null,null,r),n.size>0?n.forEach((e,t)=>{d(e)}):c(),l}
/**
             * Watches for changes of symbol expressions in the current object und returns the object with updated values.
             * @param callback
             * @preserve (Part of the public API)
             */watch(callback){if("object"==typeof this.__obj&&null!==this.__obj)return this.__watch(this.__obj,callback);{let t=e.Callback.callSafe(callback,null,{error:e.Errors.NONE,value:this.__obj});return t&&e.Log.error(t),function(){}}}
/**
             * Destroys the current object.
             * @preserve (Part of the public API)
             */destroy(){this.__obj=null}}}(t=e.Symbol||(e.Symbol={})),function(e){e[e.Invalid=0]="Invalid",e[e.Server=10]="Server",e[e.Internal=20]="Internal",e[e.LocalizedText=30]="LocalizedText",e[e.PartialParam=40]="PartialParam",e[e.TemplateParam=50]="TemplateParam",e[e.Function=60]="Function",e[e.Control=70]="Control"}(r=e.SymbolType||(e.SymbolType={}))}(TcHmi||(TcHmi={})),function(e){class t{constructor(expression){if(this.__path=null,this.__type=e.SymbolType.Invalid,this.__options={},!expression)return;this.__expression=expression;let r=expression.match(t.RegExpExpression);if(null!=r&&3===r.length){switch(this.__tag=r[1],this.__tag){case"s":this.__type=e.SymbolType.Server;break;case"i":this.__type=e.SymbolType.Internal;break;case"l":this.__type=e.SymbolType.LocalizedText;break;case"pp":this.__type=e.SymbolType.PartialParam;break;case"tp":this.__type=e.SymbolType.TemplateParam;break;case"f":this.__type=e.SymbolType.Function;break;case"ctrl":this.__type=e.SymbolType.Control;break;default:this.__type=e.SymbolType.Invalid}switch(this.__tag){case"s":case"i":case"l":case"f":this.__content=this.__expression.substr(3,this.__expression.length-7);break;case"pp":case"tp":this.__content=this.__expression.substr(4,this.__expression.length-9);break;case"ctrl":this.__content=this.__expression.substr(6,this.__expression.length-13)}let o=r[2].match(t.RegExpExpressionGroupByPipe);if(null!=o&&o.length>0){if(this.__type!==e.SymbolType.Server&&this.__type!==e.SymbolType.Function){let t=o[0].indexOf("["),r=o[0].indexOf("::"),i=-1;i=-1===t?r:-1===r||t<r?t:r,-1!==i?(this.__name=o[0].substring(0,i),this.__path=o[0].substring(i),this.__pathTokens=e.System.resolveSymbolPathToTokenArray(this.__path)):(this.__name=o[0],this.__path=null,this.__pathTokens=null)}else this.__name=o[0];if(this.__type!==e.SymbolType.Function)for(let t=1,r=o.length;t<r;t++){if(this.__type===e.SymbolType.Server){let e=/^(?:Interval\s*=)\s*(\d+)\s*$/i.exec(o[t]);null!==e&&0!==e.length&&(this.__options.Interval=parseInt(e[1],10));let r=/^(?:Timeout\s*=)\s*(\d+)\s*$/i.exec(o[t]);null!==r&&0!==r.length&&(this.__options.Timeout=parseInt(r[1],10));let i=/^(?:Parallel\s*=)\s*([a-zA-Z]+)\s*$/i.exec(o[t]);if(null!==i&&0!==i.length){let e=!1;switch(i[1].toLowerCase()){case"true":e=!0;break;case"false":e=!1}this.__options.Parallel=e}}let r=/^(?:BindingMode\s*=)\s*([a-zA-Z]+)\s*$/i.exec(o[t]);null!==r&&0!==r.length&&(this.__options.BindingMode=r[1]);let i=/^(?:BindingEvent\s*=)\s*([a-zA-Z]+)\s*$/i.exec(o[t]);null!==i&&0!==i.length&&(this.__options.BindingEvent||(this.__options.BindingEvent=i[1]),this.__options.BindingEvents||(this.__options.BindingEvents=[]),this.__options.BindingEvents.push(i[1]));let n=/^(?:SubscriptionMode\s*=)\s*([a-zA-Z]+)\s*$/i.exec(o[t]);null!==n&&0!==n.length&&(this.__options.SubscriptionMode=n[1])}}}}
/**
        * Returns the expression as string.
        * @member
        * @preserve (Part of the public API)
        */toString(){return this.__expression}
/**
         * @preserve (Part of the public API)
         */getContent(){return this.__content}
/**
         *
         * @preserve (Part of the public API)
         */getTag(){return this.__tag}getName(){return this.__name}
/**
         * @preserve (Part of the public API)
         */getPath(){return this.__path}
/**
         * @preserve (Part of the public API)
         */getPathTokens(){return this.__pathTokens}
/**
         * @preserve (Part of the public API)
         */getType(){return this.__type}
/**
         * @preserve (Part of the public API)
         */getOptions(){return this.__options}}t.RegExpExpressionGroupByPipe=/([^|()]+|[(](['][^']*[']|["][^"]*["]|[^)])*[)])+/g,t.RegExpExpression=new RegExp("^\\%(s|i|l|pp|tp|f|ctrl)\\%([^]*)\\%/\\1\\%$"),e.SymbolExpression=t}(TcHmi||(TcHmi={})),function(e){
/**
    * @class Theme
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{
/**
         * Returns the active theme.
         *
         * @preserve (Part of the public API)
         * @returns {string}
         */
static get(){return e.System.Services.themeManager.getTheme()}
/**
         * Sets the active theme.
         *
         * @preserve (Part of the public API)
         * @returns {TcHmi.Errors}
         */static set(valueNew){return e.System.Services.themeManager.setTheme(valueNew,!0)}
/**
         * Returns all registered themes of the project.
         *
         * @preserve (Part of the public API)
         * @returns {string[]}
         */static getRegisteredThemes(){return Object.keys(e.System.config.themes)}}e.Theme=t,function(t){t.Properties=
/**
         * Control property related API
         * @preserve (Part of the public API)
         */
class{
/**
            * Parses every source of implicit properties and returns this or null
            * Can have different value after the event onThemeDataChanged.
            * The order of resources are
            * 1) control class
            * 2) theme definition of the control type in project
            * 3) theme definition in control
            * 4) defaultValueInternal in Description.json of the control
            * @param {TcHmi.Controls.System.baseTcHmiControl} control Control which needs the resource
            * @param {string} propertyName name of the property
            * @template T Type of the default value
            * @preserve (Part of the public API)
            */
static getDefaultValue(control,propertyName){return control instanceof e.Controls.System.baseTcHmiControl==!1?{error:e.Errors.E_PARAMETER_INVALID,origin:"system",originThemeName:e.System.Services.themeManager.getTheme(),value:null}:propertyName?e.System.Services.themeManager.getDefaultPropertyValue(control,propertyName):{error:e.Errors.E_PARAMETER_INVALID,origin:"system",originThemeName:e.System.Services.themeManager.getTheme(),value:null}}
/**
             * Sets the default value of a property and change it (if needed) on theme change.
             *
             * @param {TcHmi.Controls.System.baseTcHmiControl}
             * @param {string} propertyName
             * @returns {TcHmi.Errors} returns an Error code
             * @preserve (Part of the public API)
             */static setThemeValue(control,propertyName){if(control instanceof e.Controls.System.baseTcHmiControl==!1)return e.Errors.E_PARAMETER_INVALID;if(!propertyName)return e.Errors.E_PARAMETER_INVALID;let error=e.System.Services.controlManager.setControlProperty(control,propertyName,null);return error?error.code:e.Errors.NONE}};t.Resources=
/**
         * Control resource related API
         * @preserve (Part of the public API)
         */
class{
/**
            * Gets a themed resource.
            * Parses every source of properties and returns this or null
            * Can have different value after the event onThemeDataChanged.
            * The order of resources are
            * 1) control class
            * 2) theme definition of the control type in project
            * 3) theme definition in control
        
            * @param {TcHmi.Controls.System.baseTcHmiControl} control Control which needs the resource
            * @param {string} resourceName name of the resource
            * @return {TcHmi.Theme.Resource<T> | null} returns the resource or null
            * @template T Type of the value
            * @preserve (Part of the public API)
            */
static get(control,resourceName){return control instanceof e.Controls.System.baseTcHmiControl==!1?{error:e.Errors.E_PARAMETER_INVALID,origin:"system",originThemeName:e.System.Services.themeManager.getTheme(),value:null}:resourceName?e.System.Services.themeManager.getThemeResource(control,resourceName):{error:e.Errors.E_PARAMETER_INVALID,origin:"system",originThemeName:e.System.Services.themeManager.getTheme(),value:null}}static resolveBasePath(control,resource){let url;if("control"===resource.origin){let t=e.System.Data.Modules.controls.map.get(control.getType());url=t&&t.error===e.Errors.NONE?t.package.basePath+"/"+t.manifestData.basePath+"/Themes/"+resource.originThemeName+"/":t&&t.error!==e.Errors.NONE?"ControlModuleHasError/":"controlNotFoundInSystemCache/"}else url="/Themes/"+resource.originThemeName+"/";return url}}}(t=e.Theme||(e.Theme={}))}(TcHmi||(TcHmi={})),function(e){e.TopMostLayer=
/**
    * Provides a layer to show elements above the normal visualization
    * @class TopMostLayer
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class{
/**
        * Appends the elements to the top layer above the normal visualization
        * A reference to the element should be kept to be able to call remove() function
        * The parent element will be a div with style="width:<browserwindowwidth>;height:<browserwindowheight>;"
        * Your element could have style="min-width:50%;min-height:50%;"
        *
        * @param {TcHmi.Controls.System.baseTcHmiControl} control control which requests this
        * @param {JQuery} element jQuery Collection with exactly one element which should be moved to TopMostLayer
        * @param {object} options optional options
        * @param options.resizeCb optional callback which will be called after resizing the element or parent. Will be called after add, too. ("this" will be the calling control in this function)
        * @param options.removeCb optional callback which will be called after removing the element ("this" will be the calling control in this function)
        * @param {boolean} options.centerHorizontal bool to center the given element
        * @param {boolean} options.centerVertical bool to center the given element
        * @param {boolean} options.dimBackground Should the overlay be darken over the background. Default is true
        * @returns {boolean} success of the add
        * @preserve (Part of the public API)
        */
static add(control,element,options){return!!control&&e.System.Services.topMostLayer.add(control,element,options)}
/**
         * Removes the element from the top layer and returns it for later use by the caller
         * If the element is not inside the TopMostLayer it will be returned without change.
         * @param {TcHmi.Controls.System.baseTcHmiControl} control control which requests this
         * @param {JQuery} element jQuery Collection with the element which should be removed from TopMostLayer
         * @returns {JQuery} jQuery Collection
         * @preserve (Part of the public API)
         */static remove(control,element){return control?e.System.Services.topMostLayer.remove(control,element,!1):element}
/**
        * Appends the elements to the top layer above the normal visualization (not control namespaced)
        * A reference to the element should be kept to be able to call remove() function
        * The parent element will be a div with style="width:<browserwindowwidth>;height:<browserwindowheight>;"
        * Your element could have style="min-width:50%;min-height:50%;"
        *
        * @param {JQuery} element jQuery Collection with exactly one element which should be moved to TopMostLayer
        * @param {object} options optional options
        * @param options.resizeCb optional callback which will be called after resizeing the element or parent ("this" will be the calling control in this function)
        * @param options.removeCb optional callback which will be called after removing the element ("this" will be the calling control in this function)
        * @param {boolean} options.centerHorizontal bool to center the given element
        * @param {boolean} options.centerVertical bool to center the given element
        * @returns {boolean} success of the add
        * @preserve (Part of the public API)
        */static addEx(element,options){return e.System.Services.topMostLayer.add(null,element,options)}
/**
         * Removes the element from the top layer and returns it for later use by the caller (not control namespaced)
         * If the element is not inside the TopMostLayer it will be returned without change.
         * @param {JQuery} element jQuery Collection with the element which should be removed from TopMostLayer
         * @returns {JQuery} jQuery Collection
         * @preserve (Part of the public API)
         */static removeEx(element){return e.System.Services.topMostLayer.remove(null,element,!1)}}}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;t.getSchema=function(typeName){return e.System.Services.typeManager.getSchema(typeName)},function(t){t.resolveDefault=function(schema){return e.System.Type.Schema.resolveDefault(schema)}}(r=t.Schema||(t.Schema={}))}(t=e.Type||(e.Type={}))}(TcHmi||(TcHmi={})),function(e){
/**
    * Allows converting of values from any type to any type if types are compatible.
    * @class ValueConverter
    * @memberOf TcHmi
    * @preserve (Part of the public API)
    */
class t{constructor(){}
/**
         * Converts a value to {Object/Array} and returns the {Object/Array} or null if the type of value is not compatible to {Object/Array}.
         * No content check will be done!
         * @function toObject
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string|number|boolean|Object|Array} defaultValue The fallback value (null if not given)
         * @returns {Object|Array|null}
         * @template T Type of the resulting object.
         * @preserve (Part of the public API)
         */static toObject(value,defaultValue=null){var e=defaultValue;if("string"==typeof value&&""!==value)try{e=JSON.parse(value)}catch(e){}else"object"==typeof value&&null!==value&&(e=value);return e}
/**
         * Converts a value to {string} and returns the {string} or null if the type of value is not compatible to {string}.
         * @function toString
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible to string (null if not given)
         * @returns {string} returns the {string} or defaultValue if the type of value is not compatible to {string}.
         * @preserve (Part of the public API)
         */static toString(value,defaultValue=null){let t=defaultValue;switch(typeof value){case"boolean":case"number":t=value.toString();break;case"object":null!==value&&value instanceof e.Controls.System.baseTcHmiControl!=!0&&value instanceof Element!=!0&&(t=JSON.stringify(value));break;case"string":t=value}return t}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toDimensionUnit(value,defaultValue){return t.toEnum(value,t.DimensionUnitList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toAngleUnit(value,defaultValue){return t.toEnum(value,t.AngleUnitList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toBorderStyleValue(value,defaultValue){return t.toEnum(value,t.BorderStyleValueList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toFontStyle(value,defaultValue){return t.toEnum(value,t.FontStyleList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toFontSizeUnit(value,defaultValue){return t.toEnum(value,t.FontSizeUnitList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toFontWeight(value,defaultValue){return t.toEnum(value,t.FontWeightList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toHorizontalAlignment(value,defaultValue){return t.toEnum(value,t.HorizontalAlignmentList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toScaleModeString(value,defaultValue){return t.toEnum(value,t.ScaleModeStringList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toSizeMode(value,defaultValue){return t.toEnum(value,t.SizeModeList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toSizeModeWithContent(value,defaultValue){return t.toEnum(value,t.SizeModeWithContentList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toVerticalAlignment(value,defaultValue){return t.toEnum(value,t.VerticalAlignmentList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toVisibility(value,defaultValue){return t.toEnum(value,t.VisibilityList,defaultValue)}
/**
         * Converts a value to enum value and returns the string or null if the type of value is not compatible to the enum.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to the enum.
         * @preserve (Part of the public API)
         */static toToggleState(value,defaultValue){return t.toEnum(value,t.ToggleStateList,defaultValue)}
/**
         * Converts a value to fontFamily value and returns the string or null if the type of value is not compatible to {string}.
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns {string} returns the {string} or null if the type of value is not compatible to string.
         * @preserve (Part of the public API)
         */static toFontFamily(value,defaultValue){return t.toString(value,defaultValue)}static __parseFloatStrict(value){return/^(\-|\+)?([0-9]+(\.[0-9]+)?|Infinity)$/.test(value)?parseFloat(value):NaN}
/**
         * Converts a value to {number}
         * @function toNumber
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible to number (null if not given)
         * @returns {number} returns the {number} or the defaultValue if the type of value is not compatible to {number}.
         * @preserve (Part of the public API)
         */static toNumber(value,defaultValue=null){var e=defaultValue;switch(typeof value){case"string":e=t.__parseFloatStrict(value),isNaN(e)&&"NaN"!==value&&(e=defaultValue);break;case"boolean":switch(value){case!0:e=1;break;case!1:e=0}break;case"number":e=value}return e}
/**
         * Converts a value to {boolean} and returns the {boolean} or null if the type of value is not compatible to {boolean}.
         * @function toBoolean
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value The value to convert.
         * @param {string} defaultValue Value which should be returned if value is not compatible to boolean (null if not given)
         * @returns {boolean}
         * @preserve (Part of the public API)
         */static toBoolean(value,defaultValue=null){var e=defaultValue;switch(typeof value){case"string":switch(value.toLowerCase()){case"true":e=!0;break;case"false":e=!1}break;case"number":switch(value){case 1:e=!0;break;case 0:e=!1}break;case"boolean":e=value}return e}
/**
         * Converts a value to enum {number} and returns the enum {number} or null if the type of value is not compatible to enum {Object}.
         * @function toEnum
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value  The value to convert.
         * @param {Object} enumType The enum {Object}.
         * @param {number} defaultValue Value which should be returned if value is not compatible with the enum (null if not given)
         * @returns number
         * @preserve (Part of the public API)
         */static toEnum(value,enumType,defaultValue=null){var e=defaultValue;switch(typeof value){case"string":if(""===value)break;var t=parseInt(value,10);isNaN(t)?(void 0===(e=enumType[value])&&(e=enumType[value.toLowerCase()]),void 0===e&&(e=enumType[value.toUpperCase()]),void 0===e&&(e=defaultValue)):e=this.toEnum(t,enumType,defaultValue);break;case"number":void 0!==enumType[value]&&(e=value);break;case"boolean":e=this.toEnum(this.toNumber(value),enumType,defaultValue)}return e}
/**
         * Converts a value to the best effort value related to schema adressed by its by name or null if no schema related type is matching or schema is unknown.
         * @function toType
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value
         * @param {string} typeName
         * @returns {string|number|boolean|Object|Array}
         * @preserve (Part of the public API)
         */static toType(value,typeName,options){const schema=e.System.Services.typeManager.getSchema(typeName);return null===schema?null:t.toSchemaType(value,schema,options)}
/**
         * Converts a value to the best effort value related to schema adressed by its by name or null if no schema related type is matching or schema is unknown. Returns an result object for error detection.
         * @function toType
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value
         * @param {string} typeName
         * @returns {ValueConverter.IResultObject }
         * @preserve (Part of the public API)
         */static toTypeEx(value,typeName,options){const r=e.System.Services.typeManager.getSchemaEx(typeName);if(r.error!==e.Errors.NONE)return{error:r.error,value:null,details:{code:r.error,message:e.Errors[r.error],domain:"TcHmi.ValueConverter",reason:"Schema resolving failed.",errors:[r.details]}};const o=t.toSchemaType(value,r.schema,options);return{error:e.Errors.NONE,value:o}}
/**
         * Converts a value to the best effort value related to schema or null if no schema related type is matching.
         * @function toSchemaType
         * @memberOf TcHmi.ValueConverter
         * @param {string|number|boolean|Object|Array} value
         * @param {Object} schema
         * @returns {string|number|boolean|Object|Array}
         * @preserve (Part of the public API)
         */static toSchemaType(value,schema,options){if(null==value)return null;if(null==schema)return null;if(options&&options.resolveFunctionWriteValue&&schema.writeValue)return this.toSchemaType(value,schema.writeValue,options.convertDirection?{convertDirection:options.convertDirection}:void 0);let r=typeof value;if(options&&options.convertDirection===t.ConvertDirection.Backward){let r=e.System.Type.Schema.resolveTypeConversionRules(schema);if(r){let e,o=[];r.forEach((value,e)=>{o.push(e)});for(let i=0,n=o.length;i<n;i++){let n=o[i];if(!n)continue;let s=r.get(n);if("string"===n){if(e=t.toString(value),s.enum&&s.enum.includes(e))break;e=void 0}}if(void 0!==e)return e}}else{let o=e.System.Type.Schema.resolveTypeConversionRules(schema);if(o&&o.has(r)){switch(o.get(r).convert){case"number":return t.toNumber(value);case"string":return t.toString(value);case"boolean":return t.toBoolean(value)}}}let o=e.System.Type.Schema.resolveType(schema);if("string"!=typeof o&&!Array.isArray(o))return null;if(Array.isArray(o)){if("string"===r||"number"===r||"boolean"===r||"object"===r){if(-1!==o.indexOf(r))return value;for(let e=0,r=o.length;e<r;e++){let r;switch(o[e]){case"object":case"array":r=t.toObject(value);break;case"string":r=t.toString(value);break;case"integer":case"number":r=t.toNumber(value);break;case"boolean":r=t.toBoolean(value);break;default:r=null}if(null!==r)return r}}}else switch(o){case"object":case"array":return t.toObject(value);case"string":return t.toString(value);case"integer":case"number":return t.toNumber(value);case"boolean":return t.toBoolean(value)}return null}}t.AngleUnitList={deg:"deg",rad:"rad",turn:"turn",grad:"grad"},t.BorderStyleValueList={Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",None:"None"},t.DimensionUnitList={px:"px","%":"%"},t.FontSizeUnitList={px:"px","%":"%",em:"em",rem:"rem"},t.FontStyleList={Normal:"Normal",Italic:"Italic",Oblique:"Oblique",Auto:"Auto"},t.FontWeightList={Normal:"Normal",Bold:"Bold",Auto:"Auto"},t.HorizontalAlignmentList={Left:"Left",Center:"Center",Right:"Right"},t.ScaleModeStringList={None:"None",ScaleToFill:"ScaleToFill",ScaleToFit:"ScaleToFit",ScaleToFitWidth:"ScaleToFitWidth",ScaleToFitHeight:"ScaleToFitHeight"},t.SizeModeList={Value:"Value",Parent:"Parent"},t.SizeModeWithContentList={Value:"Value",Parent:"Parent",Content:"Content"},t.ToggleStateList={Normal:"Normal",Active:"Active"},t.VerticalAlignmentList={Top:"Top",Center:"Center",Bottom:"Bottom"},t.VisibilityList={Visible:"Visible",Hidden:"Hidden",Collapsed:"Collapsed"},e.ValueConverter=t,function(e){let t;!function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"}(t=e.ConvertDirection||(e.ConvertDirection={}))}(t=e.ValueConverter||(e.ValueConverter={}))}(TcHmi||(TcHmi={})),function(e){e.View=
/**
    * Provides functions to set partials as view.
    * @class View
    * @preserve (Part of the public API)
    */
class{
/**
         * Loads a view partial into the dom.
         * @function load
         * @param {string} url
         * @param {null | function} callback
         * @preserve (Part of the public API)
         */
static load(url,callback=null){!0===TCHMI_DESIGNER?(TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Symbol] Loading an additional view level element in designer context is not allowed and therefore blocked."),"function"==typeof callback&&callback.call(this,{error:e.Errors.E_NOT_ALLOWED})):e.System.Services.viewManager.loadView(url,callback)}
/**
         * Returns the current view object.
         * @function get
         * @returns {TcHmi.Controls.System.baseTcHmiContro}
         * @preserve (Part of the public API)
         */static get(){return!0===TCHMI_DESIGNER?(TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.Symbol] Accessing a view level element is not allowed in designer context and therefore blocked."),null):e.System.Services.viewManager.getView()}}}(TcHmi||(TcHmi={})),function(e){let t,r,o,i;e.isSolidColor=function(colorObject){return null!=colorObject&&"string"==typeof colorObject.color},e.isLinearGradientColor=function(colorObject){if(null==colorObject)return!1;let e=colorObject.angle;return!(!Array.isArray(colorObject.stopPoints)||"number"!=typeof e&&("string"!=typeof e||isNaN(parseFloat(e))))},e.isBackground=
/**
     * Checks if the parameter is a TcHmi.Background
     * @param {object} background
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(e){return null!=e&&(void 0!==e.color&&void 0!==e.image&&void 0!==e.imageWidth&&void 0!==e.imageWidthUnit&&void 0!==e.imageHeight&&void 0!==e.imageHeightUnit&&void 0!==e.imageHorizontalAlignment&&void 0!==e.imageVerticalAlignment&&void 0!==e.imagePadding)},e.isTranslate=
/**
     * Checks if the parameter is a TcHmi.checkTransform
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Translate"===transformObject.transformType},e.isRotate=
/**
     * Checks if the parameter is a TcHmi.Rotate
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Rotate"===transformObject.transformType},e.isScale=
/**
     * Checks if the parameter is a TcHmi.Scale
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Scale"===transformObject.transformType},e.isSkew=
/**
     * Checks if the parameter is a TcHmi.Skew
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Skew"===transformObject.transformType},e.isOrigin=
/**
     * Checks if the parameter is a TcHmi.Origin
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Origin"===transformObject.transformType},e.isPerspective=
/**
     * Checks if the parameter is a TcHmi.Perspective
     * @param {Transform | null} transformObject
     * @returns {boolean}
     * @preserve (Part of the public API)
     */
function(transformObject){return!!transformObject&&"Perspective"===transformObject.transformType},function(e){e.isStaticValue=function(value){return!!value&&"StaticValue"===value.objectType},e.isSymbol=function(value){return!!value&&"Symbol"===value.objectType},e.isEventDataObject=function(value){return!!value&&"EventDataObject"===value.objectType},e.isFunctionExpression=function(value){return!!value&&"FunctionExpression"===value.objectType}}(t=e.IFunction||(e.IFunction={})),function(e){e[e.LittleEndian=0]="LittleEndian",e[e.BigEndian=1]="BigEndian"}(r=e.Endianness||(e.Endianness={})),e.isComparison=function(value){if(!value)return!1;let e=value;return["==","!=","<",">","<=",">=","contains","contains not","== [ignore case]","!= [ignore case]","contains [ignore case]","contains not [ignore case]"].includes(e.comparator)&&(["string","number","boolean"].includes(typeof e.value)||e.value instanceof Date||null===e.value)},e.isLogicOperator=function(value){if(!value)return!1;let e=value.logic;return"AND"===e||"OR"===e},function(e){e[e.Invalid=0]="Invalid",e[e.View=1]="View",e[e.Content=2]="Content",e[e.UserControl=3]="UserControl"}(o=e.PartialType||(e.PartialType={})),function(e){e.isCondition=function(e){return"Condition"===e.objectType},e.isSwitchCase=function(e){return"SwitchCase"===e.objectType},e.isControlApiFunction=function(e){return"ControlApiFunction"===e.objectType},e.isWriteToSymbol=function(e){return"WriteToSymbol"===e.objectType},e.isComment=function(e){return"Comment"===e.objectType},e.isFunction=function(e){return null!==e&&"Function"===e.objectType},e.isJavaScript=function(e){return"JavaScript"===e.objectType},e.isActionTemplate=function(e){return"ActionTemplate"===e.objectType},e.isFunctionExpression=function(e){return null!==e&&"FunctionExpression"===e.objectType},e.isControlAttributeBindingTarget=function(e){return"ControlAttributeBindingTarget"===e.objectType}}(i=e.Trigger||(e.Trigger={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t,r;!function(e){e[e.Invalid=0]="Invalid",e[e.General=1]="General",e[e.Control=2]="Control",e[e.UserControlParameter=3]="UserControlParameter"}(t=e.ControlAttributeType||(e.ControlAttributeType={})),function(e){e[e.Invalid=0]="Invalid",e[e.Simple=1]="Simple",e[e.Complex=2]="Complex"}(r=e.ControlAttributeValueType||(e.ControlAttributeValueType={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){
/**
    * For internal use only. Do not use or manipulate resources from within TcHmi.System in your code.
    * @preserve (Part of the public API)
    */
let t;!function(t){t.resolveControlHierarchy=function(t,r=null){let o=[];if("function"==typeof t.getChildren){const r=t.getChildren();for(var i=0,n=r.length;i<n;i++)o.push(e.System.resolveControlHierarchy(r[i],t))}return{ctrl:t,children_hierarchy:o,pctrl:r}},t.resolveAttributesFromControlElement=function(r){let o={error:e.Errors.NONE,value:{}};const i=r.getAttribute("data-tchmi-target-user-control"),n=r.getAttribute("data-tchmi-type");let s=i?e.System.Data.Caches.partialCompositeConfigCache.get(tchmi_path(i.replace(".usercontrol",".usercontrol.json"))):void 0,l=r.children;for(let r=0;r<l.length;r++){let i=l[r];if(i.hasAttribute("data-tchmi-target-attribute")&&"application/json"===i.getAttribute("type")){const r=i.getAttribute("data-tchmi-target-attribute");let value=null;try{value=JSON.parse(i.innerHTML)}catch(t){o.error=e.Errors.ERROR;let error={code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:"Parsing json of attribute: '"+r+"' failed with exception: '"+t+"'.",domain:"TcHmi.System"};o.details?(o.details.errors||(o.details.errors=[]),o.details.errors.push(error)):o.details={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.System",errors:[error]}}let l={name:r,value:value,valueType:t.ControlAttributeValueType.Complex,type:t.ControlAttributeType.General,descr:e.System.Services.controlManager.getDescriptionAttributeByName(n,r)};if(null!==l.descr&&(l.type=t.ControlAttributeType.Control),s&&s.parameters)for(let e=0,r=s.parameters.length;e<r;e++)s.parameters[e].name.toLowerCase()===l.name.toLowerCase()&&(l.descr=s.parameters[e],null!==l.descr&&(l.type=t.ControlAttributeType.UserControlParameter));o.value[l.name]=l}}for(let i=0;i<r.attributes.length;i++){let l=r.attributes[i],c={name:l.name,value:l.value,type:t.ControlAttributeType.Invalid,valueType:t.ControlAttributeValueType.Simple,descr:e.System.Services.controlManager.getDescriptionAttributeByName(n,l.name)};if(null!==c.descr&&(c.type=t.ControlAttributeType.Control),null!=s&&void 0!==s.parameters&&null!==s.parameters)for(let e=0,r=s.parameters.length;e<r;e++)s.parameters[e].name===c.name&&(c.descr=s.parameters[e],null!==c.descr&&(c.type=t.ControlAttributeType.UserControlParameter));o.value[c.name]=c}return o},t.__beforeunload=function(t){e.Log.debugEx("Browser has raised beforeunload event."),e.System.isUnloaded=!0,e.EventProvider.raise("System.onBeforeUnload",t)},t.__unload=function(t){e.Log.debugEx("Browser has raised unload event."),e.System.isUnloaded=!0,e.EventProvider.raise("System.onUnload",t)},t.resolveQualifiedName=function(name,namespace){return null!=namespace&&""!==namespace?namespace+"."+name:name},t.parseIdFromHtml=function(e){let t=2,r=0,o=0;for(let i=0;i<e.length;i++){switch(e[i]){case"i":1===t&&(t=3);break;case"d":3===t?t=4:6===t||7===t||(t=2);break;case"=":4===t&&(t=5);break;case"'":5===t?(t=6,r=i+1):6===t&&(o=i);break;case'"':5===t?(t=7,r=i+1):7===t&&(o=i);break;case"<":case">":t=1;break;case" ":case"\t":case"\r":case"\n":4===t||5===t||(t=1);break;default:3===t?t=0:6===t||7===t||(t=2)}if(o)break}if(o)return e.slice(r,o)},t.resolveSymbolPathToTokenArray=function(path){let e=[],t=path.split("::");for(let i=0,n=t.length;i<n;i++){let n=t[i],s="";for(var r=0,o=n.length;r<o;r++){let t=n[r];"["===t&&s.length>0?(e.push(s),s="",s+=t):"]"===t?(s+=t,e.push(s),s=""):(s+=t,r===o-1&&s.length>0&&e.push(s))}}return e},t.tchmi_utf8str_base64decode=function(input){try{return decodeURIComponent(Array.prototype.map.call(window.atob(input),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}catch(e){return null}},t.tchmi_utf8str_base64encode=function(input){try{return window.btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt("0x"+t,16))})))}catch(e){return null}},t.resolveElementStyleDimensions=function(t){let r=t.clone(),o=document.createElement("div"),i=$(o);i.css("display","none"),i.append(r),e.System.SharedResources.jqBody.append(i);const n=window.getComputedStyle(r[0],null);let s={width:n.width?n.width:"auto",height:n.height?n.height:"auto",top:n.top?n.top:"auto",left:n.left?n.left:"auto",right:n.right?n.right:"auto",bottom:n.bottom?n.bottom:"auto"};return i.remove(),s},t.toCamelCase=function(text){let e="";if(null==text||""===text)return e;let t=text;for(let r=0,o=t.length;r<o;r++){let o=t[r];0!==r?"-"===t[r-1]?e+=o.toUpperCase():"-"!==o&&(e+=o):e+=o.toUpperCase()}return e},t.toDashCase=function(text){let e="";if(null==text||""===text)return e;let t=text;for(let r=0,o=t.length;r<o;r++){let o=t[r];"-"!==o&&o.toUpperCase()===o&&r>0?e+="-"+o:e+=o}return e.toLowerCase()}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;t=e.SharedResources||(e.SharedResources={})}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t,r;!function(e){let t;t=e.Engineering||(e.Engineering={})}(t=e.Services||(e.Services={})),function(e){let t,r,o;e.packages=new Map,function(e){e.controls={map:new Map,array:[],urlMap:new Map},e.functions={map:new Map,array:[]}}(t=e.Modules||(e.Modules={})),function(e){e.controls={map:new Map,array:[]},e.functions={map:new Map,array:[]}}(r=e.Registrations||(e.Registrations={})),function(e){e.templateMarkupCache=new Map,e.partialMarkupCache=new Map,e.partialCompositeConfigCache=new Map}(o=e.Caches||(e.Caches={})),e.isKeepAlivePartial=new Map}(r=e.Data||(e.Data={})),e.config={basePath:"",tcHmiServer:{websocketIntervalTime:500,websocketSystemTimeout:6e4,websocketTimeout:6e4}},e.isInitialized=!1,e.isUnloaded=!1,e.mapControlNamesFromPackageManifestApi0ToApi1=new Map([["tchmi-bar-chart","TcHmi.Controls.Beckhoff.TcHmiBarChart"],["tchmi-button","TcHmi.Controls.Beckhoff.TcHmiButton"],["tchmi-checkbox","TcHmi.Controls.Beckhoff.TcHmiCheckbox"],["tchmi-combobox","TcHmi.Controls.Beckhoff.TcHmiCombobox"],["tchmi-datagrid","TcHmi.Controls.Beckhoff.TcHmiDatagrid"],["tchmi-date-time-picker","TcHmi.Controls.Beckhoff.TcHmiDateTimePicker"],["tchmi-ellipse","TcHmi.Controls.Beckhoff.TcHmiEllipse"],["tchmi-event-grid","TcHmi.Controls.Beckhoff.TcHmiEventGrid"],["tchmi-iframe","TcHmi.Controls.Beckhoff.TcHmiIFrame"],["tchmi-image","TcHmi.Controls.Beckhoff.TcHmiImage"],["tchmi-keyboard","TcHmi.Controls.Beckhoff.TcHmiKeyboard"],["tchmi-line","TcHmi.Controls.Beckhoff.TcHmiLine"],["tchmi-linear-gauge","TcHmi.Controls.Beckhoff.TcHmiLinearGauge"],["tchmi-line-chart","TcHmi.Controls.Beckhoff.TcHmiLineChart"],["tchmi-polygon","TcHmi.Controls.Beckhoff.TcHmiPolygon"],["tchmi-radial-gauge","TcHmi.Controls.Beckhoff.TcHmiRadialGauge"],["tchmi-rectangle","TcHmi.Controls.Beckhoff.TcHmiRectangle"],["tchmi-textblock","TcHmi.Controls.Beckhoff.TcHmiTextblock"],["tchmi-textbox","TcHmi.Controls.Beckhoff.TcHmiTextbox"],["tchmi-timespan-picker","TcHmi.Controls.Beckhoff.TcHmiTimespanPicker"],["tchmi-toggle-button","TcHmi.Controls.Beckhoff.TcHmiToggleButton"],["tchmi-trend-line-chart","TcHmi.Controls.Beckhoff.TcHmiTrendLineChart"],["tchmi-video","TcHmi.Controls.Beckhoff.TcHmiVideo"],["tchmi-container","TcHmi.Controls.System.TcHmiContainer"],["tchmi-container-control","TcHmi.Controls.System.TcHmiContainerControl"],["tchmi-content","TcHmi.Controls.System.TcHmiContent"],["tchmi-control","TcHmi.Controls.System.TcHmiControl"],["tchmi-grid","TcHmi.Controls.System.TcHmiGrid"],["tchmi-html-host","TcHmi.Controls.System.TcHmiHtmlHost"],["tchmi-partial","TcHmi.Controls.System.TcHmiPartial"],["tchmi-region","TcHmi.Controls.System.TcHmiRegion"],["tchmi-user-control","TcHmi.Controls.System.TcHmiUserControl"],["tchmi-user-control-host","TcHmi.Controls.System.TcHmiUserControlHost"]]),e.mapControlNamesFromPackageManifestApi1ToApi0=new Map([["TcHmi.Controls.Beckhoff.TcHmiBarChart","tchmi-bar-chart"],["TcHmi.Controls.Beckhoff.TcHmiButton","tchmi-button"],["TcHmi.Controls.Beckhoff.TcHmiCheckbox","tchmi-checkbox"],["TcHmi.Controls.Beckhoff.TcHmiCombobox","tchmi-combobox"],["TcHmi.Controls.Beckhoff.TcHmiDatagrid","tchmi-datagrid"],["TcHmi.Controls.Beckhoff.TcHmiDateTimePicker","tchmi-date-time-picker"],["TcHmi.Controls.Beckhoff.TcHmiEllipse","tchmi-ellipse"],["TcHmi.Controls.Beckhoff.TcHmiEventGrid","tchmi-event-grid"],["TcHmi.Controls.Beckhoff.TcHmiIFrame","tchmi-iframe"],["TcHmi.Controls.Beckhoff.TcHmiImage","tchmi-image"],["TcHmi.Controls.Beckhoff.TcHmiKeyboard","tchmi-keyboard"],["TcHmi.Controls.Beckhoff.TcHmiLine","tchmi-line"],["TcHmi.Controls.Beckhoff.TcHmiLinearGauge","tchmi-linear-gauge"],["TcHmi.Controls.Beckhoff.TcHmiLineChart","tchmi-line-chart"],["TcHmi.Controls.Beckhoff.TcHmiPolygon","tchmi-polygon"],["TcHmi.Controls.Beckhoff.TcHmiRadialGauge","tchmi-radial-gauge"],["TcHmi.Controls.Beckhoff.TcHmiRectangle","tchmi-rectangle"],["TcHmi.Controls.Beckhoff.TcHmiTextblock","tchmi-textblock"],["TcHmi.Controls.Beckhoff.TcHmiTextbox","tchmi-textbox"],["TcHmi.Controls.Beckhoff.TcHmiTimespanPicker","tchmi-timespan-picker"],["TcHmi.Controls.Beckhoff.TcHmiToggleButton","tchmi-toggle-button"],["TcHmi.Controls.Beckhoff.TcHmiTrendLineChart","tchmi-trend-line-chart"],["TcHmi.Controls.Beckhoff.TcHmiVideo","tchmi-video"],["TcHmi.Controls.System.TcHmiContainer","tchmi-container"],["TcHmi.Controls.System.TcHmiContainerControl","tchmi-container-control"],["TcHmi.Controls.System.TcHmiContent","tchmi-content"],["TcHmi.Controls.System.TcHmiControl","tchmi-control"],["TcHmi.Controls.System.TcHmiGrid","tchmi-grid"],["TcHmi.Controls.System.TcHmiHtmlHost","tchmi-html-host"],["TcHmi.Controls.System.TcHmiPartial","tchmi-partial"],["TcHmi.Controls.System.TcHmiRegion","tchmi-region"],["TcHmi.Controls.System.TcHmiUserControl","tchmi-user-control"],["TcHmi.Controls.System.TcHmiUserControlHost","tchmi-user-control-host"],["TcHmi.Controls.System.TcHmiView","tchmi-view"]])}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){var t=acorn.tokTypes,r=acorn.tokContexts;r.symbolExpressionOpenTag=new acorn.TokContext("%tag",!1),r.symbolExpressionCloseTag=new acorn.TokContext("%/tag",!1),r.symbolExpressionExpression=new acorn.TokContext("%tag%...%/tag%",!0,!0),t.symbolExpressionTagName=new acorn.TokenType("symbolExpressionTagName"),t.symbolExpressionSymbolName=new acorn.TokenType("symbolExpressionSymbolName",{beforeExpr:!0}),t.symbolExpressionOpenTagStart=new acorn.TokenType("symbolExpressionOpenTagStart"),t.symbolExpressionOpenTagEnd=new acorn.TokenType("symbolExpressionOpenTagEnd"),t.symbolExpressionCloseTagStart=new acorn.TokenType("symbolExpressionCloseTagStart"),t.symbolExpressionCloseTagEnd=new acorn.TokenType("symbolExpressionCloseTagEnd"),t.symbolExpressionOpenTagStart.updateContext=function(){this.context.push(r.symbolExpressionExpression),this.context.push(r.symbolExpressionOpenTag),this.exprAllowed=!1},t.symbolExpressionOpenTagEnd.updateContext=function(e){this.context.pop(),this.exprAllowed=!0},t.symbolExpressionCloseTagStart.updateContext=function(){this.context.pop(),this.context.push(r.symbolExpressionCloseTag),this.exprAllowed=!1},t.symbolExpressionCloseTagEnd.updateContext=function(e){this.context.pop(),this.exprAllowed=!1};var o=acorn.Parser.prototype;o.symbolExpression_readToken=function(){var e="";const r=this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated BEX contents");let o=this.input.charCodeAt(this.pos);switch(o){case 37:return this.pos===this.start?this.getTokenFromCode(o):(e+=this.input.slice(r,this.pos),this.finishToken(t.symbolExpressionSymbolName,e));default:++this.pos}}},o.symbolExpression_readWord=function(){let e,r=this.pos;do{e=this.input.charCodeAt(++this.pos)}while(acorn.isIdentifierChar(e)||45===e);return this.finishToken(t.symbolExpressionTagName,this.input.slice(r,this.pos))},o.symbolExpression_parseString=function(){const value=this.value;return this.next(),value},o.symbolExpression_parseOpeningTagName=function(){const e=this.symbolExpression_parseString();return this.expect(t.symbolExpressionOpenTagEnd),e},o.symbolExpression_parseClosingTagName=function(){const e=this.symbolExpression_parseString();return this.expect(t.symbolExpressionCloseTagEnd),e},o.symbolExpression_parseElementAt=function(e,r){const o=this.startNodeAt(e,r);var i="";const n=this.symbolExpression_parseOpeningTagName();var s="";e:for(;;)switch(this.type){case t.symbolExpressionOpenTagStart:this.next();break;case t.symbolExpressionSymbolName:i=this.symbolExpression_parseString();break;case t.symbolExpressionCloseTagStart:if(this.next(),this.eat(t.slash)){s=this.symbolExpression_parseClosingTagName();break e}default:this.unexpected()}return s!==n&&this.raise(o.start,"Expected corresponding closing tag for %/"+n+"%"),o.passAsSymbol=!1,o.expression=`%${n}%${i}%/${s}%`,this.options.plugins.symbolExpression.onSymbol&&this.options.plugins.symbolExpression.onSymbol(o),this.finishNode(o,"SymbolExpression")},o.symbolExpression_parseElement=function(){var e=this.start,t=this.startLoc;return this.next(),this.symbolExpression_parseElementAt(e,t)},acorn.plugins.symbolExpression=(e,options)=>{var o,i;options&&("object"!=typeof options&&(options={}),Array.isArray(options.onSymbol)&&(o=options.onSymbol,options.onSymbol=function(e){return o.push(e)}),Array.isArray(options.onCallExpression)&&(i=options.onCallExpression,options.onSymbol=expression=>i.push(expression)),e.extend("parseExprAtom",(function(e){return function(r){return this.type===t.symbolExpressionSymbolName?this.parseLiteral(this.value):this.type===t.symbolExpressionOpenTagStart?this.symbolExpression_parseElement():e.call(this,r)}})),e.extend("readToken",(function(e){return function(o){var i=this.curContext();if(i===r.symbolExpressionExpression)return 37===o?(++this.pos,this.finishToken(t.symbolExpressionCloseTagStart)):this.symbolExpression_readToken();if(i===r.symbolExpressionOpenTag||i===r.symbolExpressionCloseTag){if(acorn.isIdentifierStart(o))return this.symbolExpression_readWord();if(37===o)return++this.pos,i===r.symbolExpressionCloseTag?this.finishToken(t.symbolExpressionCloseTagEnd):this.finishToken(t.symbolExpressionOpenTagEnd)}return 37===o&&this.exprAllowed?(++this.pos,this.finishToken(t.symbolExpressionOpenTagStart)):e.call(this,o)}})),e.extend("updateContext",(function(e){return function(t){return e.call(this,t)}})),e.extend("finishNode",(function(e){return function(t,type){return"CallExpression"===type&&this.options.plugins.symbolExpression.onCallExpression&&this.options.plugins.symbolExpression.onCallExpression(t),e.call(this,t,type)}})))}}(t=e.acornSymbolExpressionExtension||(e.acornSymbolExpressionExtension={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){let r;!function(t){t.callSafeCallbacks1Param=function(t,thisArg,data){let r=[];for(let e=0,o=t.length;e<o;e++)r.push(t[e]);for(let o of r){if(-1===t.indexOf(o))continue;let r=e.Callback.callSafe(o,thisArg,data);if(void 0!==r)return r}}}(r=t.Callback||(t.Callback={}))}(e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.InternalSymbolManager=class{constructor(){this.__entries=new Map}add(name,t){let r=t;if(this.__entries.set(name,r),void 0===r.value){let schema=e.Type.getSchema(t.type);schema&&(r.value=e.Type.Schema.resolveDefault(schema))}if(r.persist&&"undefined"!=typeof Storage&&window.localStorage){let e=window.localStorage.getItem("TCHMI_INTERNALSYMBOL_"+name);if(null!==e)try{r.value=JSON.parse(e)}catch(e){}}r.callbacks||(r.callbacks=[])}remove(name){this.__entries.delete(name)}update(name,t){let r=this.__entries.get(name);if(!r)return;let o=!1;tchmi_equal(r.type,t.type)||(r.type=t.type,o=!0);let value=t.value;if(void 0===value){let schema=e.Type.getSchema(t.type);schema&&(value=e.Type.Schema.resolveDefault(schema))}if(tchmi_equal(r.value,value)||(r.value=value,o=!0),tchmi_equal(r.persist,t.persist)||(r.persist=t.persist,o=!0),tchmi_equal(r.readonly,t.readonly)||(r.readonly=t.readonly,o=!0),o){let t=[];for(let e=0,o=r.callbacks.length;e<o;e++)t.push(r.callbacks[e]);for(let o of t)-1!==r.callbacks.indexOf(o)&&e.Callback.callSafe(o.callback,this,{error:e.Errors.NONE,value:r.value,destroy:o.destroy})}}write(name,value,t,callback){let r=[];if(t)for(let e=0,o=t.length;e<o;e++)r.push(t[e]);let o=this.__entries.get(name);if(o)if(o.readonly)e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_READONLY,details:{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:"Internal symbol with name="+name+" is readonly.",domain:"TcHmi.System.InternalSymbolManager"}});else if(tchmi_equal(o.value,value))e.Callback.callSafe(callback,this,{error:e.Errors.NONE});else{if(!t||0===t.length&&o.value&&value&&"object"==typeof o.value&&"object"==typeof value)for(let e in o.value)tchmi_equal(o.value[e],value[e])||r.push("::"+e);let i=o.value;if(o.value=value,o.persist){if("undefined"!=typeof Storage&&window.localStorage)try{window.localStorage.setItem("TCHMI_INTERNALSYMBOL_"+name,JSON.stringify(o.value))}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.InternalSymbolManager] Unexpected exception="+t+".")}}else!0===i&&window.localStorage.removeItem("TCHMI_INTERNALSYMBOL_"+name);let n=[];for(let e=0,t=o.callbacks.length;e<t;e++)n[e]=o.callbacks[e];for(let t of n)-1!==o.callbacks.indexOf(t)&&e.Callback.callSafe(t.callback,this,{error:e.Errors.NONE,value:o.value,dirtyPaths:r,destroy:t.destroy});e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}else e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:"Internal symbol with name="+name+" does not exist.",domain:"TcHmi.System.InternalSymbolManager"}})}read(name,callback){let t=this.__entries.get(name);if(t)return e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:t.value}),null;e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:"Internal symbol with name="+name+" does not exist.",domain:"TcHmi.System.InternalSymbolManager"}})}getType(name,callback){let t=this.__entries.get(name);if(t)return e.Callback.callSafe(callback,this,{error:e.Errors.NONE,type:t.type}),null;e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:"Internal symbol with name="+name+" does not exist.",domain:"TcHmi.System.InternalSymbolManager"}})}watch(name,callback){let t=this.__entries.get(name);if(!t)return e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:"Internal symbol with name="+name+" does not exist.",domain:"TcHmi.System.InternalSymbolManager"}}),function(){};let r=function(){let e=t.callbacks.indexOf(o);-1!==e&&(t.callbacks.splice(e,1),o.callback=null)},o={callback:callback,destroy:r};return t.callbacks.push(o),e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:t.value,destroy:r}),r}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.TemplateParamSymbolManager=class{constructor(){this.__entries=new Map}add(name,type,value){let t;if(void 0===value){let schema=e.Type.getSchema(type);schema&&(t=e.Type.Schema.resolveDefault(schema))}else t=value;let r={name:name,type:type,value:t,callbacks:[]};this.__entries.set(name,r)}remove(name){let t=this.__entries.get(name);t&&(t.value instanceof e.System.Symbol&&t.value.destroy(),t.value=null,this.__entries.delete(name))}get(name){return this.__entries.get(name)}destroy(){this.__entries.forEach(t=>{t.value instanceof e.System.Symbol&&t.value.destroy()}),this.__entries.clear(),this.__entries=null}keepAlive(name){let e=this.__entries.get(name);return!!(e&&e.callbacks.length>0)}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){e.baseTcHmiControl=class{constructor(element,e,t){}}}(t=e.System||(e.System={}))}(t=e.Controls||(e.Controls={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.AccessManager=class{constructor(){this.__lastUserInteraction=Date.now(),this.__lastUserInteractionSentToServer=this.__lastUserInteraction,this.__autoLogoffTimeoutID=0,this.__oldName=null,this.__subscriptionId=null,this.__reload=!0,this.__accessCache=new WeakMap,this.__handleServerResponse=data=>{var t;let r=!1,o=!1,i=!1,n=!1;const s=this.__userConfigOnServer;if(data.error===e.Errors.E_WEBSOCKET_CLOSED)s.state=1,s.errorMessage="Websocket was closed.",n=!0,o=!0,r=!0,i=!0;else if(data.error===e.Errors.E_WEBSOCKET_NOT_READY)s.state=1,s.errorMessage="Communication not ready.",o=!0,r=!0,i=!0;else if(data.error===e.Errors.NONE&&data.response&&void 0!==data.response.error)s.state=1,s.errorMessage="Unknown Server error: "+data.response.error.message,o=!0,r=!0,i=!0,data.response.error.code===e.Server.Error.HMI_E_MISSING_LICENSE_HANDSHAKE&&(!0===TCHMI_ENGINEERING?s.errorMessage="Server is not licensed. Please try in a few seconds again.":s.errorMessage="Server is not licensed.");else if(data.error===e.Errors.NONE){let n=!1;1===s.state&&(n=!0),0===s.state&&(s.state=1),s.errorMessage="Got no valid answer.";let l=data.response.commands;void 0===l&&(l=[]);for(let c=0,d=l.length;c<d;c++){const d=l[c];if("GetCurrentUser"===d.symbol){let l=d;if(void 0!==l.error){s.errorMessage="Got no valid answer for "+l.symbol+". Error code: "+l.error.code,o=!0,r=!0,i=!0;break}if(void 0===l.readValue){s.errorMessage="Got no valid answer for "+l.symbol+".",o=!0,r=!0,i=!0;break}if(s.errorMessage="",void 0!==l.readValue.name&&null!==l.readValue.name&&s.name!==l.readValue.name){if(4===s.state&&void 0!==s.name&&null!==s.name&&"__SystemGuest"===l.readValue.name&&!0===this.__reload)return void window.location.reload(!0);if(!1===this.__reload&&(this.__reload=!0),"ReadWrite"===data.response.requestType&&null!==this.__oldName&&this.__oldName!==l.readValue.name)return s.state=1,e.System.Services.dialogManager.showDialog(null,!1),e.System.Services.dialogManager.updateText("__AccessManager",'Connection to Server recovered but Authentification is not valid anymore. <input type="submit" value="Relogin" style="padding:10px;" onclick="window.location = \'/Logout?Location='+window.location.pathname+"&Name="+encodeURIComponent(e.System.Services.accessManager.__oldName||"")+"'\">",e.DialogManager.DialogSeverity.Error),void e.System.Services.dialogManager.showDialog("__AccessManager",!0,e.DialogManager.DialogType.Overlay);o=!0,r=!0,s.name=l.readValue.name}if(l.readValue.autoLogoff){const t=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/.exec(l.readValue.autoLogoff);if(null===t)break;const o=parseInt(t[2],10)||0,i=parseInt(t[3],10)||0,n=parseInt(t[4],10)||0,c=parseInt(t[5],10)||0,d=parseInt(t[6],10)||0,_=parseInt(t[7],10)||0;let m=1e3*((parseFloat(t[8])||0)+60*(_+60*(d+24*(c+30*i+7*n)+365*o)));s.autoLogOffMilliSeconds!==m&&(s.autoLogOffMilliSeconds=m,r=!0,e.System.Services.accessManager.__rearmAutoLogoffTimer())}(n||void 0!==l.readValue.groups&&!tchmi_equal(s.userIsInGroups.sort(),l.readValue.groups.sort()))&&(r=!0,i=!0,s.userIsInGroups=null!==(t=l.readValue.groups)&&void 0!==t?t:[]),void 0!==l.readValue.domain&&s.domain!==l.readValue.domain&&(r=!0,s.domain=l.readValue.domain),void 0!==l.readValue.session&&s.session!==l.readValue.session&&(r=!0,s.session=l.readValue.session),void 0!==l.readValue.clientCertificate&&s.clientCertificate!==l.readValue.clientCertificate&&(r=!0,s.clientCertificate=l.readValue.clientCertificate),void 0!==l.readValue.clientIp&&s.clientIp!==l.readValue.clientIp&&(r=!0,s.clientIp=l.readValue.clientIp);let c=l.readValue.locale;c&&"client"!==c||(c=void 0),s.locale!==c&&e.System.Services.localizationManager.__loadLocale(c,data=>{data.error===e.Errors.NONE&&(s.locale=c)}),s.configLocale!==l.readValue.configLocale&&(r=!0,s.configLocale=l.readValue.configLocale);let _=l.readValue.timeFormatLocale;_&&"client"!==_||(_=void 0),s.timeFormatLocale!==_&&(r=!0,s.timeFormatLocale=_),s.configTimeFormatLocale!==l.readValue.configTimeFormatLocale&&(r=!0,s.configTimeFormatLocale=l.readValue.configTimeFormatLocale);let m=l.readValue.timeZone;m&&"client"!==m||(m=void 0),s.timeZone!==m&&(r=!0,s.timeZone=m),e.Localization.__rebuildLocalizationCache()}else if("IsAuthRequired"===d.symbol){let e=d;if(void 0!==e.error){s.errorMessage="Got no valid answer for "+e.symbol+". Error code: "+e.error.code;break}if(!0===e.readValue)4!==s.state&&(s.state=4,s.errorMessage="",r=!0);else{if(!1!==e.readValue){s.state=1,s.errorMessage="Got no valid answer for "+e.symbol+".",r=!0;break}2!==s.state&&(s.state=2,s.errorMessage="",r=!0)}}}4===s.state&&(s.name?0===s.userIsInGroups.length&&(r=!0,s.state=1,s.errorMessage="Got no group membership but should have one."):(r=!0,s.state=1,s.errorMessage="Got no user login but should have one."))}r&&!e.System.isUnloaded&&this.__handleConfigChanged({user:o,group:i},n)},this.__clearControlAccessCache=(e,data)=>{this.__accessCache=new WeakMap},this.__updateLastUserinteraction=e=>{this.__sendHeartbeat(),this.__lastUserInteraction=Date.now()},this.__sendHeartbeat=t=>{const r=Date.now();(this.__userConfigOnServer.autoLogOffMilliSeconds&&r-this.__lastUserInteractionSentToServer>this.__userConfigOnServer.autoLogOffMilliSeconds/2||t)&&(this.__lastUserInteractionSentToServer=r,e.Server.requestEx({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:"Heartbeat"}]},{timeout:e.System.config.tcHmiServer.websocketSystemTimeout}))},this.__logoutIfNoInteraction=()=>{this.__userConfigOnServer.autoLogOffMilliSeconds&&Date.now()-this.__lastUserInteraction>this.__userConfigOnServer.autoLogOffMilliSeconds&&(e.Server.logout(),this.__rearmAutoLogoffTimer())},this.__userConfigOnServer={state:0,userIsInGroups:[],name:null,domain:null,locale:void 0,configLocale:"client",timeFormatLocale:void 0,configTimeFormatLocale:"client",timeZone:void 0,autoLogOffMilliSeconds:null,session:null,clientCertificate:null,clientIp:"",errorMessage:"",defaultAuthExtension:"TcHmiUserManagement"},e.EventProvider.register("onWebSocketOpened",this.__onWebsocketOpen()),e.EventProvider.register("onWebSocketClosed",this.__onWebsocketClosed()),e.EventProvider.register("System.AccessConfigChanged",this.__clearControlAccessCache),e.EventProvider.register("System.ParentChanged",this.__clearControlAccessCache)}getCurrentUserConfig(){return this.__userConfigOnServer}enableReload(value){this.__reload=value}__onWebsocketClosed(){return e=>{this.__oldName=this.__userConfigOnServer.name,this.__userConfigOnServer={state:1,userIsInGroups:[],name:null,domain:null,locale:void 0,configLocale:"client",timeFormatLocale:void 0,configTimeFormatLocale:"client",timeZone:void 0,autoLogOffMilliSeconds:null,session:null,clientCertificate:null,clientIp:"",errorMessage:"",defaultAuthExtension:"TcHmiUserManagement"}}}__onWebsocketOpen(){return t=>{e.Server.readSymbol("DefaultAuthExtension",e.Server.__handleServerResponse({error:data=>{if(TCHMI_CONSOLE_LOG_LEVEL>=1){let t;t=data.error!==e.Errors.NONE?data.details:data.results[0].details,e.Log.error("[Source=Framework, Module=TcHmi.System.AccessManager] Internal Error. Failed to load DefaultAuthExtension. Using default TcHmiUserManagement: "+e.Log.buildMessage(t))}this.subscribe()},success:data=>{data.results&&data.results[0]&&data.results[0].value&&data.results[0].value!==this.__userConfigOnServer.defaultAuthExtension&&(this.__userConfigOnServer.defaultAuthExtension=data.results[0].value),this.subscribe()}}))}}unsubscribe(callback){null!==this.__subscriptionId?e.Server.unsubscribe(this.__subscriptionId,data=>{data.error===e.Errors.NONE&&(this.__subscriptionId=null),e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}):e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}subscribe(callback){null===this.__subscriptionId?this.__subscriptionId=e.Server.subscribeEx([{symbol:"IsAuthRequired"},{symbol:"GetCurrentUser"}],1e3,{timeout:e.System.config.tcHmiServer.websocketSystemTimeout},data=>{this.__handleServerResponse(data),e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}):e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}__handleConfigChanged(t,r){if(this.__accessCache=new WeakMap,1===this.__userConfigOnServer.state){const t=e.System.Services.dialogManager.getDialogOwner();"__TcHmiMain"!==t&&"__TcHmiViewAccess"!==t||e.System.Services.dialogManager.showDialog(t,!1),!0!==r&&(e.System.Services.dialogManager.updateText("__AccessManager","Loading User Login Config from Server failed"+(this.__userConfigOnServer.errorMessage?": "+this.__userConfigOnServer.errorMessage:".")+' <input type="submit" value="Logout" style="padding:10px;" onclick="window.location = \'/Logout?Location='+window.location.pathname+"'\">",e.DialogManager.DialogSeverity.Error),e.System.Services.dialogManager.showDialog("__AccessManager",!0,e.DialogManager.DialogType.Overlay)),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.AccessManager] Internal Error. Loading User Login Config from Server failed"+(this.__userConfigOnServer.errorMessage?": "+this.__userConfigOnServer.errorMessage:"."))}if(t.group){2!==this.__userConfigOnServer.state&&4!==this.__userConfigOnServer.state||e.EventProvider.raise("onUserInGroupChanged",this.__userConfigOnServer.userIsInGroups);const t=e.System.Services.viewManager.getView();null!==t&&t.__processAccessConfig()}t.user&&e.EventProvider.raise("onUserChanged",this.__userConfigOnServer.name),e.EventProvider.raise("onUserDataChanged",this.__userConfigOnServer)}checkAccess(control,requestedAccessright){if(!0===TCHMI_DESIGNER)return!0;if(2===this.__userConfigOnServer.state)return!0;if(-1!==this.__userConfigOnServer.userIsInGroups.indexOf("__SystemAdministrators"))return!0;if(1===this.__userConfigOnServer.state)return!1;if(0===this.__userConfigOnServer.state)return null;let t=this.__accessCache.get(control);if(t){const e=t.get(requestedAccessright);if(void 0!==e)return e}else t=new Map,this.__accessCache.set(control,t);let r=!1,o=requestedAccessright,i=control;do{let n=!1,s=i.getVirtualControlRightMappings(),l=i.getAccessConfig();if(!Array.isArray(s)||!Array.isArray(l)){i=null,r=!1;break}for(let e of s)if(e.controlRight===o){o=e.virtualControlRight;break}for(const r of l)if(r.accessright===o&&-1!==this.__userConfigOnServer.userIsInGroups.indexOf(r.group)){if("Allow"===r.permission)return t.set(requestedAccessright,!0),!0;if("Deny"===r.permission)n=!0;else if("Inherit"!==r.permission)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.AccessManager] Access check failed on control "+control.getId()+": Invalid config found! Access rejected!"),!1}if(!0===n){i=null;break}{let t=i.getType(),n=e.System.Services.controlManager.getDescriptionAccessByName(t,o);if(null===n&&"function"==typeof i.getDescriptionAccessByName&&(n=i.getDescriptionAccessByName(o)),null===n||!0!==n.defaultValueInternal&&!1!==n.defaultValueInternal||(r=n.defaultValueInternal),null===i.getParent()){if("TcHmi.Controls.System.TcHmiView"===t){i=null;break}i=null,r=!1;break}i=i.getParent()}}while(null!==i);return t.set(requestedAccessright,r),r}__rearmAutoLogoffTimer(){if(4!==this.__userConfigOnServer.state||null===this.__userConfigOnServer.autoLogOffMilliSeconds||0===this.__userConfigOnServer.autoLogOffMilliSeconds)return;window.clearTimeout(this.__autoLogoffTimeoutID);const e={passive:!0,capture:!0};document.removeEventListener("keydown",this.__updateLastUserinteraction,e),document.removeEventListener("mousemove",this.__updateLastUserinteraction,e),document.removeEventListener("mousedown",this.__updateLastUserinteraction,e),document.removeEventListener("touchstart",this.__updateLastUserinteraction,e),document.addEventListener("keydown",this.__updateLastUserinteraction,e),document.addEventListener("mousemove",this.__updateLastUserinteraction,e),document.addEventListener("mousedown",this.__updateLastUserinteraction,e),document.addEventListener("touchstart",this.__updateLastUserinteraction,e);let t=this.__lastUserInteraction+this.__userConfigOnServer.autoLogOffMilliSeconds-Date.now();t<0?this.__logoutIfNoInteraction():(t>2147483647&&(t=2147483647),this.__autoLogoffTimeoutID=window.setTimeout(this.__logoutIfNoInteraction,t))}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){t.AnimationProvider=class{constructor(){}createAnimationController(e,t){return e.useCss()?new r(e,t):new o(e,t)}};class r{constructor(e,r){this.__hasStarted=!1,this.__animation=e,this.__statusChangeCallback=r,this.__styleManager=t.Services.styleManager}isValid(){return this.__animation.useCss()}run(){let t=()=>{if(e.Controls.get(this.__animation.controlName()))if(this.__animation.state()===e.Animation.Status.CONFIGURE||this.__animation.state()===e.Animation.Status.INITIALIZED){this.__statusChangeCallback(e.Animation.Status.INITIALIZED);const t=this.__animation.animationName();this.__getElement().on("animationstart."+t+".animationcontrol",this.__onAnimationStart()).on("animationiteration."+t+".animationcontrol",this.__onAnimationIteration()).on("animationend."+t+".animationcontrol",this.__onAnimationEnd()),this.__writeAnimationToCss()}else this.__animation.state()===e.Animation.Status.PAUSED&&(this.__setPlayState("running"),this.__hasStarted?this.__statusChangeCallback(e.Animation.Status.RUNNING):this.__statusChangeCallback(e.Animation.Status.INITIALIZED))};this.__animation.state()===e.Animation.Status.ENDED?(this.reset(t),this.__statusChangeCallback(e.Animation.Status.INITIALIZED)):t()}pause(){this.__animation.state()!==e.Animation.Status.RUNNING&&this.__animation.state()!==e.Animation.Status.INITIALIZED||(this.__setPlayState("paused"),this.__statusChangeCallback(e.Animation.Status.PAUSED))}skip(){this.cleanup(!0),this.__statusChangeCallback(e.Animation.Status.ENDED),this.__getElement().off("animationstart."+this.__animation.animationName()+".animationcontrol").off("animationiteration."+this.__animation.animationName()+".animationcontrol").off("animationend."+this.__animation.animationName()+".animationcontrol")}reset(callback){let selector=this.__styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()),styles=this.__styleManager.getExistingStyleOverwrites(this.__animation.controlName());if(void 0===styles[selector]||void 0===styles[selector]["animation-name"])return void requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.__statusChangeCallback(e.Animation.Status.CONFIGURE),"function"==typeof callback&&callback()})});let t=styles[selector]["animation-name"][0].split(",").map((function(e){return e.trim()})).indexOf(this.__animation.animationName());if(-1!==t){for(let e=0,r=styles[selector]["animation-name"].length;e<r;e++){let r=styles[selector]["animation-name"][e].split(",").map((function(e){return e.trim()}));r.splice(t,1,"reset"),styles[selector]["animation-name"][e]=r.join(", ")}for(let e=0,r=styles[selector]["animation-play-state"].length;e<r;e++){let r=styles[selector]["animation-play-state"][e].split(",").map((function(e){return e.trim()}));r.splice(t,1,"paused"),styles[selector]["animation-play-state"][e]=r.join(", ")}this.__styleManager.writeStyles(this.__animation.controlName(),styles),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(void 0!==e.Controls.get(this.__animation.controlName())){for(let e=0,r=styles[selector]["animation-name"].length;e<r;e++){let r=styles[selector]["animation-name"][e].split(",").map((function(e){return e.trim()}));r.splice(t,1,this.__animation.animationName()),styles[selector]["animation-name"][e]=r.join(", ")}this.__styleManager.writeStyles(this.__animation.controlName(),styles),this.__statusChangeCallback(e.Animation.Status.CONFIGURE)}"function"==typeof callback&&callback()})}),this.__hasStarted=!1}else requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.__statusChangeCallback(e.Animation.Status.CONFIGURE),"function"==typeof callback&&callback()})})}cleanup(t=!1){let r=null;if("forwards"===this.__animation.fillMode()||"both"===this.__animation.fillMode()||t)switch(this.__animation.direction()){case"normal":r=1;break;case"reverse":r=0;break;case"alternate":r=this.__animation.iterationCount()%2==0?0:1;break;case"alternate-reverse":r=this.__animation.iterationCount()%2==0?1:0}let selector=this.__styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()),styles=this.__styleManager.getExistingStyleOverwrites(this.__animation.controlName());if(void 0===styles[selector]||void 0===styles[selector]["animation-name"])return;let o=styles[selector]["animation-name"][0].split(",").map((function(e){return e.trim()})).indexOf(this.__animation.animationName());if(-1!==o&&(i("animation-name"),i("animation-duration"),i("animation-delay"),i("animation-iteration-count"),i("animation-direction"),i("animation-timing-function"),i("animation-fill-mode"),i("animation-play-state"),delete styles["@keyframes "+this.__animation.animationName()],this.__styleManager.writeStyles(this.__animation.controlName(),styles),null!==r)){let t=this.__animation.keyframes().filter(e=>e.progressPoint===r);if(0===t.length)return;let o=t[0].styles;e.StyleProvider.setSimpleElementStyle(this.__getElement(),o)}function i(property){if(void 0!==styles[selector][property])for(let e=0,t=styles[selector][property].length;e<t;e++){let t=styles[selector][property][e].split(",").map((function(e){return e.trim()}));t.splice(o,1),styles[selector][property][e]=t.join(", ")}}}__writeAnimationToCss(e=!0){let selector=this.__styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()),styles=this.__styleManager.getExistingStyleOverwrites(this.__animation.controlName());void 0===styles[selector]&&(styles[selector]={});let t=-1;if(void 0!==styles[selector]["animation-name"]){let e=styles[selector]["animation-name"][0].split(",").map((function(e){return e.trim()}));t=e.indexOf(this.__animation.animationName())}function r(property,value){if(void 0===styles[selector][property])styles[selector][property]=[value];else for(let e=0,r=styles[selector][property].length;e<r;e++){let r=o(styles[selector][property][e],",").map((function(e){return e.trim()}));-1===t?r.push(value):r.splice(t,1,value),styles[selector][property][e]=r.join(", ")}}function o(value,e){let t=0,r=0,o=[];for(let i=0,n=value.length;i<n;i++)switch(value.charAt(i)){case"(":r++;break;case")":r>0&&r--;break;case e:0===r&&i>t&&o.push(value.substring(t,i).trim()),t=i+1}return(0===value.length||t<value.length)&&o.push(value.substring(t).trim()),o}r("animation-name",this.__animation.animationName()),r("animation-duration",this.__animation.duration()+"ms"),r("animation-delay",this.__animation.delay()+"ms"),r("animation-iteration-count",this.__animation.iterationCount().toString()),r("animation-direction",this.__animation.direction()),r("animation-timing-function",this.__animation.timingFunction()),r("animation-fill-mode",this.__animation.fillMode()),r("animation-play-state",e?"running":"paused");let i={},n=this.__animation.keyframes();for(let e=0,t=n.length;e<t;e++)i[100*n[e].progressPoint+"%"]=n[e].styles;styles["@keyframes "+this.__animation.animationName()]=i,this.__styleManager.writeStyles(this.__animation.controlName(),styles)}__setPlayState(e){let selector=this.__styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()),styles=this.__styleManager.getExistingStyleOverwrites(this.__animation.controlName());if(void 0===styles[selector]["animation-name"])return;let t=styles[selector]["animation-name"][0].split(",").map((function(e){return e.trim()})).indexOf(this.__animation.animationName());if(-1!==t){for(let r=0,o=styles[selector]["animation-play-state"].length;r<o;r++){let o=styles[selector]["animation-play-state"][r].split(",").map((function(e){return e.trim()}));o.splice(t,1,e),styles[selector]["animation-play-state"][r]=o.join(", ")}this.__styleManager.writeStyles(this.__animation.controlName(),styles)}}__onAnimationStart(){return event=>{const t=event.originalEvent;t.animationName===this.__animation.animationName()&&(this.__statusChangeCallback(e.Animation.Status.RUNNING),this.__animation.eventHandlers().filter(e=>"animationstart"===e.name).forEach(r=>r.callback({error:e.Errors.NONE,animationName:t.animationName,elapsedTime:t.elapsedTime,JQueryEvent:event})))}}__onAnimationIteration(){return event=>{const t=event.originalEvent;t.animationName===this.__animation.animationName()&&this.__animation.eventHandlers().filter(e=>"animationiteration"===e.name).forEach(r=>r.callback({error:e.Errors.NONE,animationName:t.animationName,elapsedTime:t.elapsedTime,JQueryEvent:event}))}}__onAnimationEnd(){return event=>{const t=event.originalEvent;t.animationName===this.__animation.animationName()&&(this.__statusChangeCallback(e.Animation.Status.ENDED),this.__getElement().off("animationstart."+this.__animation.animationName()+".animationcontrol").off("animationiteration."+this.__animation.animationName()+".animationcontrol").off("animationend."+this.__animation.animationName()+".animationcontrol"),this.__animation.cleanup()&&this.cleanup(),this.__animation.eventHandlers().filter(e=>"animationend"===e.name).forEach(r=>r.callback({error:e.Errors.NONE,animationName:t.animationName,elapsedTime:t.elapsedTime,JQueryEvent:event})))}}__getElement(){return $(this.__styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()))}}t.CssAnimationController=r;class o{constructor(e,r){this.__animationFrameID=null,this.__start=null,this.__iteration=0,this.__elapsedTime=0,this.__resetToInitial=!0,this.__delayTimer=null,this.__animation=e,this.__statusChangeCallback=r,this.__element=$(t.Services.styleManager.expandSelector(this.__animation.selector(),this.__animation.controlName()))}isValid(){return!this.__animation.useCss()}run(){if(this.__animation.state()===e.Animation.Status.CONFIGURE||this.__animation.state()===e.Animation.Status.ENDED){this.__animationRunner=this.__getAnimationRunner(),this.__iteration=0,this.__start=null,this.__elapsedTime=0,this.__resetToInitial=!0,this.__animation.delay()>0?this.__delayTimer=new i(()=>{this.__animationFrameID=window.requestAnimationFrame(this.__animationRunner),this.__delayTimer=null},this.__animation.delay()):this.__animationFrameID=window.requestAnimationFrame(this.__animationRunner),this.__statusChangeCallback(e.Animation.Status.INITIALIZED),this.__animatedStyles={};let t=this.__animation.keyframes();for(let e=0,r=t.length;e<r;e++)for(let r in t[e].styles)t[e].styles.hasOwnProperty(r)&&(void 0===this.__animatedStyles[r]&&(this.__animatedStyles[r]=[]),this.__animatedStyles[r].push({progressPoint:t[e].progressPoint,values:t[e].styles[r].map(value=>this.__parseKeyframeStyle(value))}));let r=e.StyleProvider.getSimpleElementStyle(this.__element);this.__initialStyles={};for(let e in this.__animatedStyles)if(this.__animatedStyles.hasOwnProperty(e)){if(this.__animatedStyles[e].sort((a,b)=>a.progressPoint-b.progressPoint),0!==this.__animatedStyles[e][0].progressPoint||1!==this.__animatedStyles[e][this.__animatedStyles[e].length-1].progressPoint)throw new Error("Start and end keyframes with progress points 0 and 1 must be defined for all animated properties.");this.__initialStyles[e]=r&&void 0!==r[e]?r[e]:null}let o=this.__animation.fillMode();if("backwards"===o||"both"===o)switch(this.__animation.direction()){case"normal":case"alternate":e.StyleProvider.setSimpleElementStyle(this.__element,t.filter(e=>0===e.progressPoint)[0].styles);break;case"reverse":case"alternate-reverse":e.StyleProvider.setSimpleElementStyle(this.__element,t.filter(e=>1===e.progressPoint)[0].styles)}}else this.__animation.state()===e.Animation.Status.PAUSED&&(null!==this.__delayTimer?this.__delayTimer.resume():this.__animationFrameID=window.requestAnimationFrame(this.__animationRunner))}pause(){this.__animation.state()===e.Animation.Status.RUNNING?(null!==this.__animationFrameID&&window.cancelAnimationFrame(this.__animationFrameID),this.__statusChangeCallback(e.Animation.Status.PAUSED)):this.__animation.state()===e.Animation.Status.INITIALIZED&&null!==this.__delayTimer&&(this.__delayTimer.pause(),this.__statusChangeCallback(e.Animation.Status.PAUSED))}skip(){this.__animation.state()!==e.Animation.Status.ENDED&&(null!==this.__animationFrameID&&window.cancelAnimationFrame(this.__animationFrameID),this.cleanup(!0),this.__statusChangeCallback(e.Animation.Status.ENDED))}reset(callback){if(this.__resetToInitial&&this.__animation.state()!==e.Animation.Status.CONFIGURE)for(let t in this.__initialStyles)this.__initialStyles.hasOwnProperty(t)&&e.StyleProvider.setSimpleElementStyle(this.__element,t,this.__initialStyles[t]);this.__statusChangeCallback(e.Animation.Status.CONFIGURE),"function"==typeof callback&&callback()}cleanup(t=!1){let r=null;if("forwards"===this.__animation.fillMode()||"both"===this.__animation.fillMode()||t)switch(this.__animation.direction()){case"normal":r=1;break;case"reverse":r=0;break;case"alternate":r=this.__animation.iterationCount()%2==0?0:1;break;case"alternate-reverse":r=this.__animation.iterationCount()%2==0?1:0}null===r?e.StyleProvider.setSimpleElementStyle(this.__element,this.__initialStyles):e.StyleProvider.setSimpleElementStyle(this.__element,this.__animation.keyframes().filter(e=>e.progressPoint===r)[0].styles)}__parseKeyframeStyle(value){let e=/^(-?\d*\.?\d+)(?:%|px)?$/.exec(value);if(null!==e)return[parseFloat(e[1]),value.substring(e[1].length)];let t=[],r=/#[0-9a-fA-F]{6}|#[0-9a-fA-F]{3}/g,o=r.exec(value);for(;null!==o;){let e=o[0].slice(1);t.push({value:n.fromHexString(e),replaceIndex:o.index,replaceLength:o[0].length}),o=r.exec(value)}let i=/rgba?\( *(-?\d+) *, *(-?\d+) *, *(-?\d+) *(?:, *(-?\d*\.?\d+) *)?\)/g,s=i.exec(value);for(;null!==s;){let e=parseInt(s[1],10),r=parseInt(s[2],10),b=parseInt(s[3],10),a=s[4]?parseFloat(s[4]):1;t.push({value:n.fromRgb(e,r,b,a),replaceIndex:s.index,replaceLength:s[0].length}),s=i.exec(value)}let l=/hsla?\( *(-?\d*\.?\d+) *, *(-?\d*\.?\d+)% *, *(-?\d*\.?\d+)% *(?:, *(-?\d*\.?\d+) *)?\)/g,c=l.exec(value);for(;null!==c;){let e=parseFloat(c[1]),r=parseFloat(c[2])/100,o=parseFloat(c[3])/100,a=c[4]?parseFloat(c[4]):1;t.push({value:n.fromHsl(e,r,o,a),replaceIndex:c.index,replaceLength:c[0].length}),c=l.exec(value)}let d=[];if(t.length>0){t.sort((a,b)=>a.replaceIndex-b.replaceIndex);for(let e=t.length-1,r=0;e>=r;e--){let r=t[e].replaceIndex+t[e].replaceLength,o=e<t.length-1?t[e+1].replaceIndex:void 0;r!==o&&r<value.length&&d.unshift(value.substring(r,o)),d.unshift(t[e].value)}t[0].replaceIndex>0&&d.unshift(value.substring(0,t[0].replaceIndex-1))}else d.push(value);let _=/-?\d*\.?\d+/;for(let e=0,t=d.length;e<t;e++){let r=d[e];if("string"==typeof r){let o=_.exec(r);if(null!==o){let i=[],n=0;o.index>0&&(i.push(r.substring(0,o.index)),t++,n++),i.push(parseFloat(o[0])),o.index+o[0].length<r.length&&(i.push(r.substring(o.index+o[0].length)),t++),d.splice(e,1,...i),e+=n}}}return d}__getTimingFunction(){let t=this.__animation.timingFunction();if("function"==typeof t)return t;function r(e,t,r,o){let i=[{x:0,y:0},{x:e,y:t},{x:r,y:o},{x:1,y:1}];return e=>{function t(e,r){let o=[];for(let t=0;t<e.length-1;t++){let i=e[t].x+(e[t+1].x-e[t].x)*r,n=e[t].y+(e[t+1].y-e[t].y)*r;o.push({x:i,y:n})}return 1===o.length?o[0]:t(o,r)}let r={x:0,y:0},o=.5,n=0,s=1;for(let l=0;l<10;l++){if(r=t(i,o),Math.abs(r.x-e)<5e-4)return r.y;r.x<e?n=o:s=o,o=n+(s-n)/2}return r.y}}function o(e,t){let r=1/e;return e=>t?Math.ceil(e/r)*r:Math.floor(e/r)*r}switch(t){case"linear":return e=>e;case"ease":return r(.25,.1,.25,1);case"ease-in":return r(.42,0,1,1);case"ease-out":return r(0,0,.58,1);case"ease-in-out":return r(.42,0,.58,1);case"step-start":return o(1,!0);case"step-end":return o(1,!1);default:let e=/cubic-bezier\( *(1(?:.0+)?|0|0?\.\d+) *, *(-?\d*\.?\d+) *, *(1(?:.0+)?|0|0?\.\d+) *, *(-?\d*\.?\d+) *\)/.exec(t);if(null!==e)return r(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4]));let i=/steps\( *([1-9][0-9]*) *(?:, *(start|end) *)?\)/.exec(t);if(null!==i)return o(parseInt(i[1],10),"start"===i[2])}return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Framework, Module=TcHmi.System.AnimationProvider] Unknown timing function ${t}.`),r(.25,.1,.25,1)}__getAnimationRunner(){let t,r=this.__animation.duration(),o=this.__getTimingFunction();switch(this.__animation.direction()){case"normal":t=e=>e;break;case"reverse":t=e=>1-e;break;case"alternate":t=e=>this.__iteration%2==0?e:1-e;break;case"alternate-reverse":t=e=>this.__iteration%2==0?1-e:e}let i=n=>{if(null===this.__start)this.__started=this.__start=n,this.__statusChangeCallback(e.Animation.Status.RUNNING),this.__animation.eventHandlers().filter(e=>"animationstart"===e.name).forEach(t=>t.callback({error:e.Errors.NONE,animationName:this.__animation.animationName(),elapsedTime:0}));else if(this.__animation.state()===e.Animation.Status.PAUSED){let t=n-this.__elapsedTime-this.__start;this.__start+=t,this.__started+=t,this.__statusChangeCallback(e.Animation.Status.RUNNING)}this.__elapsedTime=n-this.__start;let s=this.__elapsedTime/r;s=t(s);let styles={};for(let e in this.__animatedStyles)if(this.__animatedStyles.hasOwnProperty(e)){let t=this.__getBorderingKeyframes(e,s);if(1===t.length)styles[e]=t[0].values.map(value=>value.join(""));else{let r=(s-t[0].progressPoint)/(t[1].progressPoint-t[0].progressPoint);styles[e]=this.__interpolate(t[0].values,t[1].values,o(r))}}try{e.StyleProvider.setSimpleElementStyle(this.__element,styles)}catch(t){return void this.__statusChangeCallback(e.Animation.Status.PAUSED)}if(s>=0&&s<=1)this.__animationFrameID=window.requestAnimationFrame(i);else{this.__iteration++;let t=this.__animation.iterationCount();"infinite"===t||this.__iteration<t?(this.__start=n,this.__animationFrameID=window.requestAnimationFrame(i),this.__animation.eventHandlers().filter(e=>"animationiteration"===e.name).forEach(t=>t.callback({error:e.Errors.NONE,animationName:this.__animation.animationName(),elapsedTime:(n-this.__started)/1e3}))):(this.__animationFrameID=null,this.__statusChangeCallback(e.Animation.Status.ENDED),this.__animation.cleanup()&&(this.__resetToInitial=!1),this.cleanup(),this.__animation.eventHandlers().filter(e=>"animationend"===e.name).forEach(t=>t.callback({error:e.Errors.NONE,animationName:this.__animation.animationName(),elapsedTime:(n-this.__started)/1e3})))}};return i}__getBorderingKeyframes(e,t){let styles=this.__animatedStyles[e];for(let e=0,r=styles.length;e<r;e++){if(styles[e].progressPoint===t)return[styles[e]];if(styles[e].progressPoint>t)return e<1?[styles[e]]:[styles[e-1],styles[e]]}return[styles[styles.length-1]]}__interpolate(e,t,r){let o=[];function i(e,t){return e+(t-e)*r}for(let s=0,l=Math.min(e.length,t.length);s<l;s++){let l=[];for(let o=0,c=Math.max(e[s].length,t[s].length);o<c;o++){let c=e[s][o],d=t[s][o],_=typeof c,m=typeof d;if(void 0===c){switch(m){case"string":c=d;break;case"number":c=0;break;case"object":c=n.fromRgb(0,0,0,0)}_=m}if(void 0===d){switch(_){case"string":d=c;break;case"number":d=0;break;case"object":d=n.fromRgb(0,0,0,0)}m=_}if(_!==m||"string"===_)l.push(r<.5?c:d);else switch(_){case"number":l.push(i(c,d));break;case"object":l.push(n.fromRgb(i(c.red,d.red),i(c.green,d.green),i(c.blue,d.blue),i(c.alpha,d.alpha)))}}o.push(l.join(""))}return o}}t.JavaScriptAnimationController=o;class i{constructor(callback,e){this.__timerId=0,this.__callback=callback,this.__delay=e,this.__remaining=e,this.resume()}pause(){window.clearTimeout(this.__timerId),this.__remaining-=Date.now()-this.__start}resume(){this.__start=Date.now(),window.clearTimeout(this.__timerId),this.__timerId=window.setTimeout(this.__callback,this.__remaining)}}class n{constructor(e,t,r,o){function i(e,t,r){return e<=t?t:e>=r?r:e}this.red=Math.round(i(e,0,255)),this.green=Math.round(i(t,0,255)),this.blue=Math.round(i(r,0,255)),this.alpha=i(o,0,1)}static fromRgb(e,t,b,a=1){return new n(e,t,b,a)}static fromHsl(e,t,r,a=1){function o(e,t,r){return e<=t?t:e>=r?r:e}let i,s,b;if(e=o(e%360/360,0,1),t=o(t,0,1),r=o(r,0,1),0===t)i=s=b=r;else{let o=(e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e),n=r<.5?r*(1+t):r+t-r*t,l=2*r-n;i=o(l,n,e+1/3),s=o(l,n,e),b=o(l,n,e-1/3)}return new n(255*i,255*s,255*b,a)}static fromHexString(e){return 3===e.length&&(e=e.replace(/./g,"$&$&")),new n(parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16),1)}toString(){return`rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`}}}(e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){class r{constructor(expression,propertyName,control){if(this.__diagGUID="",this.__state=r.State.Invalid,this.__attr=null,this.__attrSchema=null,this.__lockLastWriteError=!1,this.__pendingWriteCount=0,this.__forwardWriteToSymbolResponse=!1,this.__pendingForceReadRequestId=null,this.__onControlAttachedDestroyCallback=null,this.__onControlDetachedDestroyCallback=null,this.__onBindingEventDestroyCallbacks=[],this.__onPropertyChangedDestroyCallback=null,TCHMI_CONSOLE_LOG_LEVEL>=4&&(this.__diagGUID=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor called with:",{expression:expression,propertyName:propertyName,control:control}),!expression){let message="Invalid value: '"+expression+"' for parameter: 'expression'.";throw TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}if(!propertyName){let message="Invalid value: '"+propertyName+"' for parameter: 'propertyName'.";throw TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}if(!control){let message="Invalid value: '"+control+"' for parameter: 'control'.";throw TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}if(this.__expression=expression,this.__propertyName=propertyName,this.__control=control,this.__state=r.State.Initializing,this.__symbol=new t.Symbol(expression),this.__attr=e.System.Services.controlManager.getAttributeByPropertyName(this.__control,this.__propertyName),!this.__attr){let message="The attribute property name: '"+this.__propertyName+"' does not exist for control: '"+control.getId()+"'.";throw TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null==control?void 0:control.getId())+", Property="+propertyName+", Symbol="+expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}this.__attrSchema=e.System.Services.typeManager.getSchema(this.__attr.type),this.__onControlAttachedDestroyCallback=e.EventProvider.register(this.__control.getId()+".System.onAttached",this.__onControlAttached()),this.__onControlDetachedDestroyCallback=e.EventProvider.register(this.__control.getId()+".System.onDetached",this.__onControlDetached())}static __timeIsNewer(a,b){if(27===a.length&&27===b.length)return a>b;{let e=new Date(a),t=new Date(b);if(e>t)return!0;if(e<t)return!1;{let e=null;if(a.indexOf(".")>-1&&a.indexOf("Z")>-1&&(e=a.substring(a.indexOf(".")+1,a.indexOf("Z"))),e&&e.length<6)for(let t=0,r=6-e.length;t<r;t++)e+="0";let t=null;if(b.indexOf(".")>-1&&b.indexOf("Z")>-1&&(t=b.substring(b.indexOf(".")+1,b.indexOf("Z"))),t&&t.length<6)for(let e=0,r=6-t.length;e<r;e++)t+="0";return null!==e&&null!==t&&e>t}}}destroy(){var t,o,i;if(this.__state===r.State.Destroyed)return void(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called and aborted because object is already marked as destroyed."));let n=null===(t=this.__control)||void 0===t?void 0:t.getId(),s=this.__propertyName,l=null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString();if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+n+", Property="+s+", Symbol="+l+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called."),this.__propertyName=null,this.__control=null,this.__destroyWatch&&(this.__destroyWatch(),this.__destroyWatch=null),this.__watchCallback=null,this.__symbol&&(this.__symbol.destroy(),this.__symbol=null),null!==this.__onPropertyChangedDestroyCallback&&(this.__onPropertyChangedDestroyCallback(),this.__onPropertyChangedDestroyCallback=null),this.__onBindingEventDestroyCallbacks)for(;this.__onBindingEventDestroyCallbacks.length>0;){let e=this.__onBindingEventDestroyCallbacks.shift();e(),e=null}null!==this.__onControlAttachedDestroyCallback&&(this.__onControlAttachedDestroyCallback(),this.__onControlAttachedDestroyCallback=null),null!==this.__onControlDetachedDestroyCallback&&(this.__onControlDetachedDestroyCallback(),this.__onControlDetachedDestroyCallback=null),this.__state=r.State.Destroyed,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+n+", Property="+s+", Symbol="+l+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy finished.")}__resume(){var o,i,n,s,l,c,d,_,m,u,g,E;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(o=this.__control)||void 0===o?void 0:o.getId())+", Property="+this.__propertyName+", Symbol="+(null===(n=null===(i=this.__symbol)||void 0===i?void 0:i.getExpression())||void 0===n?void 0:n.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume called."),this.__control.getIsAttached())if(this.__state===r.State.Initializing||this.__state===r.State.Suspended){if(this.__state=r.State.Resuming,this.__attrSchema&&"TcHmi.Symbol"===this.__attrSchema.frameworkInstanceOf)this.__state=r.State.Ready,this.__writeToControl(new e.Symbol(this.__symbol.getExpression().toString()));else{let r=this.__symbol.getExpression().getOptions().BindingMode,o=e.System.Services.controlManager.getAttributeTypeByPropertyName(this.__control,this.__propertyName);if("TwoWay"===r||!r&&o===t.ControlAttributeType.UserControlParameter||!r&&this.__attr&&"TwoWay"===this.__attr.defaultBindingMode){let t=this.__symbol.getExpression().getOptions().BindingEvents;if(t)for(let r=0,o=t.length;r<o;r++){let o=t[r];this.__onBindingEventDestroyCallbacks.push(e.EventProvider.register(this.__control.getId()+"."+o,this.__onBindingEvent()))}else this.__onPropertyChangedDestroyCallback=e.EventProvider.register(this.__control.getId()+".onPropertyChanged<"+this.__propertyName+">",this.__onPropertyChanged())}this.__watchCallback=this.__onWatchCallback(),this.__destroyWatch=this.__symbol.watch(this.__watchCallback)}TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(d=this.__control)||void 0===d?void 0:d.getId())+", Property="+this.__propertyName+", Symbol="+(null===(m=null===(_=this.__symbol)||void 0===_?void 0:_.getExpression())||void 0===m?void 0:m.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume finished.")}else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(u=this.__control)||void 0===u?void 0:u.getId())+", Property="+this.__propertyName+", Symbol="+(null===(E=null===(g=this.__symbol)||void 0===g?void 0:g.getExpression())||void 0===E?void 0:E.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted because control is neither in state 'Initializing' or 'Suspended'.");else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(s=this.__control)||void 0===s?void 0:s.getId())+", Property="+this.__propertyName+", Symbol="+(null===(c=null===(l=this.__symbol)||void 0===l?void 0:l.getExpression())||void 0===c?void 0:c.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. Control is not attached.")}__suspend(){var t,o,i,n,s,l;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(t=this.__control)||void 0===t?void 0:t.getId())+", Property="+this.__propertyName+", Symbol="+(null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __suspend called."),this.__destroyWatch&&(this.__destroyWatch(),this.__destroyWatch=null),this.__watchCallback=null,null!==this.__onPropertyChangedDestroyCallback&&(this.__onPropertyChangedDestroyCallback(),this.__onPropertyChangedDestroyCallback=null),this.__onBindingEventDestroyCallbacks)for(;this.__onBindingEventDestroyCallbacks.length>0;){let e=this.__onBindingEventDestroyCallbacks.shift();e(),e=null}this.__state=r.State.Suspended,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __suspend finished.")}getExpression(){return this.__expression}getSymbol(){return this.__symbol}getPropertyName(){return this.__propertyName}getControl(){return this.__control}__onControlAttached(){return(e,data)=>{this.__resume()}}__onControlDetached(){return(e,data)=>{this.__suspend()}}__onBindingEvent(){return()=>{var t,o,i,n,s,l,c,d,_;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(t=this.__control)||void 0===t?void 0:t.getId())+", Property="+this.__propertyName+", Symbol="+(null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __onBindingEvent called."),this.__state===r.State.Ready){if(this.__lockWriteToControl)TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(c=this.__control)||void 0===c?void 0:c.getId())+", Property="+this.__propertyName+", Symbol="+(null===(_=null===(d=this.__symbol)||void 0===d?void 0:d.getExpression())||void 0===_?void 0:_.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"] __onBindingEvent aborted because of '__lockWriteToControl'.");else if(void 0!==this.__control[this.__attr.propertyGetterName]){let value=this.__control[this.__attr.propertyGetterName].call(this.__control);this.__writeToSymbol(tchmi_clone_object(value))}}else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onBindingEvent because Binding is not in state 'Ready'.")}}__onPropertyChanged(){return(t,data)=>{var o,i,n,s,l,c,d,_,m,u,g,E;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(o=this.__control)||void 0===o?void 0:o.getId())+", Property="+this.__propertyName+", Symbol="+(null===(n=null===(i=this.__symbol)||void 0===i?void 0:i.getExpression())||void 0===n?void 0:n.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onPropertyChanged"),this.__state===r.State.Ready)if(this.__lockWriteToControl)TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(d=this.__control)||void 0===d?void 0:d.getId())+", Property="+this.__propertyName+", Symbol="+(null===(m=null===(_=this.__symbol)||void 0===_?void 0:_.getExpression())||void 0===m?void 0:m.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onPropertyChanged aborted because of '__lockWriteToControl'.");else if(data){if(void 0!==this.__control[this.__attr.propertyGetterName]){let value=this.__control[this.__attr.propertyGetterName].call(this.__control);this.__writeToSymbol(tchmi_clone_object(value))}}else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(u=this.__control)||void 0===u?void 0:u.getId())+", Property="+this.__propertyName+", Symbol="+(null===(E=null===(g=this.__symbol)||void 0===g?void 0:g.getExpression())||void 0===E?void 0:E.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onPropertyChanged aborted because 'data' is not defined.");else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(s=this.__control)||void 0===s?void 0:s.getId())+", Property="+this.__propertyName+", Symbol="+(null===(c=null===(l=this.__symbol)||void 0===l?void 0:l.getExpression())||void 0===c?void 0:c.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onPropertyChanged aborted because Binding is not in state 'Ready'.")}}__onWatchCallback(){return data=>{var t,o,i,n,s,l,c,d,_,m,u,g,E,h,S,p,f,y,T,C,v,M,N,I,O,L,R,w,D,H,A,V,k,P,x,U,G,F,j;let W="";if(TCHMI_CONSOLE_LOG_LEVEL>=4&&(W=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(t=this.__control)||void 0===t?void 0:t.getId())+", Property="+this.__propertyName+", Symbol=",null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback called with:",{data:data}),null!==this.__pendingForceReadRequestId&&(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback release pending forced read request with id: '"+this.__pendingForceReadRequestId+"'."),e.Server.releaseRequest(this.__pendingForceReadRequestId),this.__pendingForceReadRequestId=null),this.__state===r.State.Ready||this.__state===r.State.Resuming)if(this.__lockWriteToControl)TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(m=this.__control)||void 0===m?void 0:m.getId())+", Property="+this.__propertyName+", Symbol="+(null===(g=null===(u=this.__symbol)||void 0===u?void 0:u.getExpression())||void 0===g?void 0:g.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback aborted because of '__lockWriteToControl'.");else if(this.__symbol.getExpression().getType()===e.SymbolType.Server&&this.__lockLastWriteError)TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(E=this.__control)||void 0===E?void 0:E.getId())+", Property="+this.__propertyName+", Symbol="+(null===(S=null===(h=this.__symbol)||void 0===h?void 0:h.getExpression())||void 0===S?void 0:S.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback aborted because of '__lockLastWriteError'.");else{if(this.__symbol.getExpression().getType()===e.SymbolType.Server&&this.__pendingWriteCount>0)return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(p=this.__control)||void 0===p?void 0:p.getId())+", Property="+this.__propertyName+", Symbol="+(null===(y=null===(f=this.__symbol)||void 0===f?void 0:f.getExpression())||void 0===y?void 0:y.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback aborted because '__pendingWriteCount>0'. __pendingWriteCount: '"+this.__pendingWriteCount+"'."),void(this.__forwardWriteToSymbolResponse=!0);if(data.error===e.Errors.NONE)if(this.__state===r.State.Resuming&&(this.__state=r.State.Ready),!TCHMI_DESIGNER&&this.__latestWrite&&this.__symbol.getExpression().getType()===e.SymbolType.Server)if(data.processedStart&&data.processedEnd)if(this.__latestWriteProcessedStart&&this.__latestWriteProcessedEnd)if(r.__timeIsNewer(data.processedStart,this.__latestWriteProcessedEnd))TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(T=this.__control)||void 0===T?void 0:T.getId())+", Property="+this.__propertyName+", Symbol="+(null===(v=null===(C=this.__symbol)||void 0===C?void 0:C.getExpression())||void 0===v?void 0:v.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback calls __writeToControl because watch tick data is newer than last server write."),this.__writeToControl(data.value,data.dirtyPaths);else if(r.__timeIsNewer(this.__latestWriteProcessedStart,data.processedEnd))TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(M=this.__control)||void 0===M?void 0:M.getId())+", Property="+this.__propertyName+", Symbol="+(null===(I=null===(N=this.__symbol)||void 0===N?void 0:N.getExpression())||void 0===I?void 0:I.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback aborted because server read has ended before last server write has started. Data is outdated.");else{TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(O=this.__control)||void 0===O?void 0:O.getId())+", Property="+this.__propertyName+", Symbol="+(null===(R=null===(L=this.__symbol)||void 0===L?void 0:L.getExpression())||void 0===R?void 0:R.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback forces read from server because last write and watch callback were processed at roughly the same time.");let t=this.__symbol.getExpression().getName();this.__pendingForceReadRequestId=e.Server.request({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:t}]},data=>{var r,o,i,n,s,l,c,d,_,m,u,g,E,h,S,p,f,y,T,C,v,M,N,I,O,L,R;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(r=this.__control)||void 0===r?void 0:r.getId())+", Property="+this.__propertyName+", Symbol=",null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback forced read finished with:",{data:data}),this.__pendingForceReadRequestId=null,data.error!==e.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+"] ";return data.details?message+=e.Log.buildMessage(data.details):message+=e.Log.buildMessage({code:data.error,message:e.Errors[data.error]}),void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message))}let w=data.response;if(void 0===w)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(c=this.__control)||void 0===c?void 0:c.getId())+", Property="+this.__propertyName+", Symbol="+(null===(_=null===(d=this.__symbol)||void 0===d?void 0:d.getExpression())||void 0===_?void 0:_.toString())+"] "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.System.Binding"})));if(w&&w.error)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(m=this.__control)||void 0===m?void 0:m.getId())+", Property="+this.__propertyName+", Symbol="+(null===(g=null===(u=this.__symbol)||void 0===u?void 0:u.getExpression())||void 0===g?void 0:g.toString())+"] "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+w.id+"'.",domain:"TcHmi.System.Binding",errors:[w.error]})));let D,commands=w.commands;if(commands){for(let e=0,r=commands.length;e<r;e++){let r=commands[e];if(r&&r.symbol===t){D=r;break}}D?D.error?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(T=this.__control)||void 0===T?void 0:T.getId())+", Property="+this.__propertyName+", Symbol="+(null===(v=null===(C=this.__symbol)||void 0===C?void 0:C.getExpression())||void 0===v?void 0:v.toString())+"] Server responds with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: '"+t+"' in response from server with id: '"+w.id+"'.",domain:"TcHmi.System.Symbol",errors:[D.error]})):void 0!==D.readValue?(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(O=this.__control)||void 0===O?void 0:O.getId())+", Property="+this.__propertyName+", Symbol="+(null===(R=null===(L=this.__symbol)||void 0===L?void 0:L.getExpression())||void 0===R?void 0:R.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback calls __writeToControl with forced read data."),this.__writeToControl(tchmi_clone_object(D.readValue))):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(M=this.__control)||void 0===M?void 0:M.getId())+", Property="+this.__propertyName+", Symbol="+(null===(I=null===(N=this.__symbol)||void 0===N?void 0:N.getExpression())||void 0===I?void 0:I.toString())+"] Server responds with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"Missing property: 'readValue' in command for symbol: '"+t+"' in response from server with id: '"+w.id+"'.",domain:"TcHmi.System.Symbol"})):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(p=this.__control)||void 0===p?void 0:p.getId())+", Property="+this.__propertyName+", Symbol="+(null===(y=null===(f=this.__symbol)||void 0===f?void 0:f.getExpression())||void 0===y?void 0:y.toString())+"] Server responds with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: '"+t+"' in response from server with id: '"+w.id+"'.",domain:"TcHmi.System.Symbol"}))}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(E=this.__control)||void 0===E?void 0:E.getId())+", Property="+this.__propertyName+", Symbol="+(null===(S=null===(h=this.__symbol)||void 0===h?void 0:h.getExpression())||void 0===S?void 0:S.toString())+"] Server responds with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+w.id+"'.",domain:"TcHmi.System.Symbol"}))})}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(w=this.__control)||void 0===w?void 0:w.getId())+", Property="+this.__propertyName+", Symbol="+(null===(H=null===(D=this.__symbol)||void 0===D?void 0:D.getExpression())||void 0===H?void 0:H.toString())+"] Missing property 'processedStart' or 'processedEnd' in response.");else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(A=this.__control)||void 0===A?void 0:A.getId())+", Property="+this.__propertyName+", Symbol="+(null===(k=null===(V=this.__symbol)||void 0===V?void 0:V.getExpression())||void 0===k?void 0:k.toString())+"] Missing property 'processedStart' or 'processedEnd' in response.");else this.__writeToControl(data.value,data.dirtyPaths);else{let t,r=!1;if(data.error===e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE)r=!0,t=e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE;else{let o,i=!1,n=!1,s=t=>{if(t)for(let r=0,l=t.length;r<l;r++){let error=t[r];if(error.code!==e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE){n=!0;break}i=!0,o=e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE,!n&&error&&error.errors&&s(error.errors)}};data.details&&data.details.errors&&(s(data.details.errors),!n&&i&&(r=!0,t=o))}if(r){if(r&&t===e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE){let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(G=this.__control)||void 0===G?void 0:G.getId())+", Property="+this.__propertyName+", Symbol="+(null===(j=null===(F=this.__symbol)||void 0===F?void 0:F.getExpression())||void 0===j?void 0:j.toString())+"] ";message+="A control which was watched by this binding has become unavailable.\nError: ",data.details?message+=e.Log.buildMessage(data.details):message+=e.Log.buildMessage({code:data.error,message:e.Errors[data.error]}),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.warn(message)}}else{let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(P=this.__control)||void 0===P?void 0:P.getId())+", Property="+this.__propertyName+", Symbol="+(null===(U=null===(x=this.__symbol)||void 0===x?void 0:x.getExpression())||void 0===U?void 0:U.toString())+"] ";data.details?message+=e.Log.buildMessage(data.details):message+=e.Log.buildMessage({code:data.error,message:e.Errors[data.error]}),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message)}this.__writeToControl(null)}}else TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(c=this.__control)||void 0===c?void 0:c.getId())+", Property="+this.__propertyName+", Symbol="+(null===(_=null===(d=this.__symbol)||void 0===d?void 0:d.getExpression())||void 0===_?void 0:_.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+W+"] __onWatchCallback aborted because state is neither 'Ready' or 'Resuming'.")}}__writeToSymbol(value,t){var r,o,i,n,s,l;if(void 0===value)return;void 0===t&&(t=null);let c="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(c=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(r=this.__control)||void 0===r?void 0:r.getId())+", Property="+this.__propertyName+", Symbol=",null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+c+"]  __writeToSymbol called with:",{value:value,dirtyPaths:t}),null!==this.__pendingForceReadRequestId&&(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+c+"]  __writeToSymbol release pending forced read request with id: '"+this.__pendingForceReadRequestId+"'."),e.Server.releaseRequest(this.__pendingForceReadRequestId),this.__pendingForceReadRequestId=null,this.__forwardWriteToSymbolResponse=!0),this.__pendingWriteCount++,this.__symbol.writeEx(value,t,data=>{var t,r,o,i,n,s,l,d,_,m,u,g,E,h,S;if(this.__pendingWriteCount--,data.error===e.Errors.NONE)this.__symbol.getExpression().getType()===e.SymbolType.Server&&(this.__latestWrite=!0,data.processedStart&&data.processedEnd?(this.__latestWriteProcessedStart=data.processedStart,this.__latestWriteProcessedEnd=data.processedEnd):(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(t=this.__control)||void 0===t?void 0:t.getId())+", Property="+this.__propertyName+", Symbol="+(null===(o=null===(r=this.__symbol)||void 0===r?void 0:r.getExpression())||void 0===o?void 0:o.toString())+"] Missing property 'processedStart' or 'processedEnd' in response."),this.__lockLastWriteError=!0),!this.__lockLastWriteError&&0===this.__pendingWriteCount&&this.__forwardWriteToSymbolResponse?(this.__writeToControl(data.value),this.__forwardWriteToSymbolResponse=!1):this.__lockLastWriteError?TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(i=this.__control)||void 0===i?void 0:i.getId())+", Property="+this.__propertyName+", Symbol="+(null===(s=null===(n=this.__symbol)||void 0===n?void 0:n.getExpression())||void 0===s?void 0:s.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+c+"]  __writeToSymbol aborted because of '__lockLastWriteError'."):this.__pendingWriteCount>0?TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(l=this.__control)||void 0===l?void 0:l.getId())+", Property="+this.__propertyName+", Symbol="+(null===(_=null===(d=this.__symbol)||void 0===d?void 0:d.getExpression())||void 0===_?void 0:_.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+c+"]  __writeToSymbol aborted because '__pendingWriteCount>0'. __pendingWriteCount: '"+this.__pendingWriteCount+"'."):this.__forwardWriteToSymbolResponse||TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(m=this.__control)||void 0===m?void 0:m.getId())+", Property="+this.__propertyName+", Symbol="+(null===(g=null===(u=this.__symbol)||void 0===u?void 0:u.getExpression())||void 0===g?void 0:g.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+c+"]  __writeToSymbol aborted because '__forwardWriteToSymbolResponse===false'."));else{let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(E=this.__control)||void 0===E?void 0:E.getId())+", Property="+this.__propertyName+", Symbol="+(null===(S=null===(h=this.__symbol)||void 0===h?void 0:h.getExpression())||void 0===S?void 0:S.toString())+"] ";data.details?message+=e.Log.buildMessage(data.details):message+=e.Log.buildMessage({code:data.error,message:e.Errors[data.error]}),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message)}})}__writeToControl(value,t){var r,o,i,n,s,l,c,d,_,m,u,g,E,h,S,p,f,y,T;if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(r=this.__control)||void 0===r?void 0:r.getId())+", Property="+this.__propertyName+", Symbol=",null===(i=null===(o=this.__symbol)||void 0===o?void 0:o.getExpression())||void 0===i?void 0:i.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl called with:",{value:value,dirtyPaths:t}),void 0===value)return;let error;this.__lockWriteToControl=!0;try{TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(n=this.__control)||void 0===n?void 0:n.getId())+", Property="+this.__propertyName+", Symbol="+(null===(l=null===(s=this.__symbol)||void 0===s?void 0:s.getExpression())||void 0===l?void 0:l.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl calling attribute setter."),error=e.System.Services.controlManager.setControlPropertyByAttribute(this.__control,this.__attr,value,t),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(c=this.__control)||void 0===c?void 0:c.getId())+", Property="+this.__propertyName+", Symbol=",null===(_=null===(d=this.__symbol)||void 0===d?void 0:d.getExpression())||void 0===_?void 0:_.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl calling attribute finished with:",{error:error})}catch(t){try{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(m=this.__control)||void 0===m?void 0:m.getId())+", Property="+this.__propertyName+", Symbol="+(null===(g=null===(u=this.__symbol)||void 0===u?void 0:u.getExpression())||void 0===g?void 0:g.toString())+"] Unexpected exception="+t+" in setter function of attribute with propertyName="+this.__propertyName+" of control="+this.__control.getId()+".")}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(E=this.__control)||void 0===E?void 0:E.getId())+", Property="+this.__propertyName+", Symbol="+(null===(S=null===(h=this.__symbol)||void 0===h?void 0:h.getExpression())||void 0===S?void 0:S.toString())+"] Unexpected exception="+t+".")}}finally{this.__lockWriteToControl=!1}error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+(null===(p=this.__control)||void 0===p?void 0:p.getId())+", Property="+this.__propertyName+", Symbol="+(null===(y=null===(f=this.__symbol)||void 0===f?void 0:f.getExpression())||void 0===y?void 0:y.toString())+"] "+e.Log.buildMessage(error),error.exception?"\n":void 0,null!==(T=error.exception)&&void 0!==T?T:void 0)}}t.Binding=r,function(e){let t;!function(e){e[e.Invalid=0]="Invalid",e[e.Initializing=5]="Initializing",e[e.Resuming=7]="Resuming",e[e.Ready=10]="Ready",e[e.Suspended=15]="Suspended",e[e.Destroyed=20]="Destroyed"}(t=e.State||(e.State={}))}(r=t.Binding||(t.Binding={}))}(e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){t.BindingManager=class{constructor(){this.__bindingsByControl=new WeakMap}getBinding(propertyName,control){let t=null,r=this.__bindingsByControl.get(control);if(void 0===r)return t;if(!e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName))return t;let b=r.get(propertyName);return void 0===b||(t=b),t}getBindingsByControl(control){return this.__bindingsByControl.get(control)}createBinding(expression,propertyName,control){this.removeBinding(propertyName,control,!1);let e=this.__bindingsByControl.get(control);void 0===e&&(e=new Map,this.__bindingsByControl.set(control,e));let b=new t.Binding(expression,propertyName,control);return e.set(propertyName,b),b.__resume(),b}removeBinding(propertyName,control,t=!0){let r=this.__bindingsByControl.get(control);if(void 0===r)return;let o=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName);if(!o)return;let b=r.get(propertyName);if(b&&(r.delete(propertyName),b.destroy(),t)){let error;try{error=e.System.Services.controlManager.setControlPropertyByAttribute(control,o,null)}catch(t){try{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.BindingManager] Unexpected exception="+t+" in setter function of attribute with propertyName="+propertyName+" of control="+control.getId()+".")}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.BindingManager] Unexpected exception="+t+".")}}error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.BindingManager] "+e.Log.buildMessage(error))}}}}(e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){class r{constructor(){if(this.__controls=new Map,this.__controlsGeoMap=new Map,this.__controlsPresavedGeoMap=new Map,this.__controlsToRecheckAfterInteraction=new Set,this.__recheckControlsAfterInteraction=()=>{this.checkControlGeometry({delayUserEvents:!1,force:!0,geos:this.__controlsToRecheckAfterInteraction}),this.__controlsToRecheckAfterInteraction.clear()},this.__usercontrolAttrDescrByPropertyName=new Map,this.__usercontrolAttrDescrBySetterName=new Map,this.__usercontrolAttrDescrByGetterName=new Map,this.resolveUcAttributes=()=>{this.__usercontrolAttrDescrByPropertyName.clear(),this.__usercontrolAttrDescrBySetterName.clear(),this.__usercontrolAttrDescrByGetterName.clear(),e.System.Data.Caches.partialCompositeConfigCache.forEach((e,t)=>{if(e&&e.parameters){let r=new Map;this.__usercontrolAttrDescrByPropertyName.set(t,r);let o=new Map;this.__usercontrolAttrDescrBySetterName.set(t,o);let i=new Map;this.__usercontrolAttrDescrByGetterName.set(t,i);const n=e.parameters;for(let e=0,t=n.length;e<t;e++)r.set(n[e].propertyName,n[e]),n[e].propertySetterName&&o.set(n[e].propertySetterName,n[e]),n[e].propertyGetterName&&i.set(n[e].propertyGetterName,n[e])}})},this.__onAttributeMutation=(e,t)=>{let r=new Map;for(let t=0,o=e.length;t<o;t++){let o=e[t].target;if(o.nodeType===Node.ELEMENT_NODE){let e=this.__controlsGeoMap.get(o.id);e&&!r.has(o.id)&&(e.isDirty=!0,r.set(o.id,e));let t=o.querySelectorAll("div[id][data-tchmi-type]");for(let e=0,o=t.length;e<o;e++){let o=this.__controlsGeoMap.get(t[e].id);o&&!r.has(t[e].id)&&(o.isDirty=!0,r.set(t[e].id,o))}}}this.checkControlGeometry({geos:r})},this.__forceDetachList=[],this.__onDomMutation=(t,r)=>{let o=!1;const i=[],n=[];let s=[],l=[],c=[],d=[];const _=(t,r)=>{let i=this.__controlsGeoMap.get(t);if(!i)return;i.ctrl.__getKeepAlive()&&this.__controlsPresavedGeoMap.set(t,i),this.__controlsGeoMap.delete(t);let s=i.ctrl;if(!s)return;let l,c=s.getElement();if(!(c.length<1)&&(l=void 0!==c[0].isConnected?c[0].isConnected:!!document.getElementById(t),!0===r&&(l=!1),!1===l&&!0===s.getIsAttached())){s.__setLifeCycleState(40),e.EventProvider.raise("System.onPrevControlDetached",s),e.EventProvider.raise(t+".System.onPrevDetached",s);try{s.__detach()}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Control __detach of "+s.getId()+" failed with exception="+t+".")}n.push(s),o=!0}};for(let e=0,r=t.length;e<r;e++){let r=t[e];for(let e=0,t=r.removedNodes.length;e<t;e++){let t=r.removedNodes[e];if(t.nodeType!==Node.ELEMENT_NODE)continue;let o=t.querySelectorAll("div[id][data-tchmi-type]");for(let e=0,t=o.length;e<t;e++)c.push(o[e].id);t.id&&c.push(t.id)}for(let e=0,t=r.addedNodes.length;e<t;e++){let t=r.addedNodes[e];if(t.nodeType!==Node.ELEMENT_NODE)continue;t.id&&d.push(this.__controls.get(t.id)),this.__attributeMutationObserver.observe(t,{attributes:!0,attributeFilter:["style","class"],subtree:!0});let o=t.querySelectorAll("div[id][data-tchmi-type]");for(let e=0,t=o.length;e<t;e++)d.push(this.__controls.get(o[e].id))}}this.__forceDetachList.forEach(e=>{_(e.getId(),!0)}),this.__forceDetachList=[],c.forEach(e=>{_(e,!1)}),d.forEach(e=>{if(!e)return;if(e.getElement().length<1)return;const t=e.getId();let r={ctrl:e,layoutData:{moved:!1,resized:!1,bounds:{offsetLeft:null,offsetTop:null,width:null,height:null},computedStyles:{left:null,top:null,right:null,bottom:null,width:null,height:null}},isDirty:!0};if(e.__getKeepAlive()){let e=this.__controlsPresavedGeoMap.get(t);e&&(r=e)}this.__controlsGeoMap.set(t,r);let o=this.checkControlGeometry({geos:r,delayUserEvents:!0});s=s.concat(o.skippedMovedEventList),l=l.concat(o.skippedResizedEventList)}),d.forEach(t=>{if(!t)return;let r=t.getElement();if(r.length<1)return;const n=t.getId();let s;if(s=void 0!==r[0].isConnected?r[0].isConnected:!!document.getElementById(n),!0===s&&!1===t.getIsAttached()){t.__setLifeCycleState(30),e.EventProvider.raise("System.onPrevControlAttached",t),e.EventProvider.raise(n+".System.onPrevAttached",t);try{t.__attach()}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Control __attach of "+n+" failed with exception="+t+".")}i.push(t),o=!0}}),l.length&&e.EventProvider.raise("System.onControlsResized",l),s.length&&e.EventProvider.raise("System.onControlsMoved",s),s.forEach((function(t){e.EventProvider.raise(t.getId()+".onMoved",t)})),l.forEach((function(t){e.EventProvider.raise(t.getId()+".onResized",t)})),l=[],s=[],o&&this.checkControlGeometry(),0!==n.length&&e.EventProvider.raise("System.onPrevControlsDetached",n),0!==i.length&&e.EventProvider.raise("System.onPrevControlsAttached",i)},"function"==typeof Proxy){let t=this;e.control=new Proxy(e.control,{get:function(e,name){return t.__controls.get(name)},ownKeys:function(e){let r=[];return t.__controls.forEach((function(control,e){r.push(e)})),r},getOwnPropertyDescriptor:function(e,t){return{enumerable:!0,configurable:!0}}})}this.__domMutationObserver=new MutationObserver(this.__onDomMutation),this.__domMutationObserver.observe(document.body,{childList:!0,subtree:!0}),this.__attributeMutationObserver=new MutationObserver(this.__onAttributeMutation),window.addEventListener("resize",this.__onWindowResized()),e.EventProvider.register("System.onUserControlConfigCreated",this.resolveUcAttributes),e.EventProvider.register("System.onUserControlConfigChanged",this.resolveUcAttributes),e.EventProvider.register("System.onUserControlConfigRemoved",this.resolveUcAttributes),e.EventProvider.register("System.onControlSizeParameterChanged",this.__recheckControlsAfterInteraction),e.EventProvider.register("System.onControlPositionParameterChanged",this.__recheckControlsAfterInteraction)}__onWindowResized(){return e=>{this.checkControlGeometry({force:!0})}}forceDetach(e){e&&this.__forceDetachList.push(e)}checkControlGeometry(options){let t=this.__controlsGeoMap;options&&options.geos&&(t=options.geos);let r=!1;options&&options.delayUserEvents&&(r=options.delayUserEvents);let o=!1;if(options&&options.force&&(o=options.force),TCHMI_DESIGNER&&(!0===e.System.Services.Engineering.designerModeManager.controlResizeManager.getControlResizing()||!0===e.System.Services.Engineering.designerModeManager.controlMoveManager.getControlMoveActive()))return t instanceof Map||t instanceof Set?t.forEach(e=>{this.__controlsToRecheckAfterInteraction.add(e)}):this.__controlsToRecheckAfterInteraction.add(t),{skippedResizedEventList:[],skippedMovedEventList:[]};let i=this,n=[],s=[],l=[],c=[],d=function(t){if(!o&&!t.isDirty)return;let r=t.ctrl;if(!r)return;if(r.getIsDestroyed())return;let l=r.getElement()[0],c=l.getBoundingClientRect();t.layoutData.computedStyles=e.StyleProvider.getComputedElementStyle(l,["left","top","right","bottom","width","height"]);let d=l.offsetLeft,_=l.offsetTop,m=r.getParent();if(m)if("TcHmi.Controls.System.TcHmiGrid"!==m.getType()){let t=e.StyleProvider.getComputedElementStyle(m.getElement()[0],["border-left-width","border-top-width"]);d+=parseFloat(t["border-left-width"]),_+=parseFloat(t["border-top-width"])}else{let t=e.StyleProvider.getComputedElementStyle(r.getElement()[0].parentElement.parentElement,["border-left-width","padding-left","border-top-width","padding-top"]);d+=parseFloat(t["border-left-width"])+parseFloat(t["padding-left"]),_+=parseFloat(t["border-top-width"])+parseFloat(t["padding-top"])}let u=!1;i.__checkResize(t.layoutData,c.width,c.height)&&(t.layoutData.resized=!0,n.push(t),u=!0),i.__checkMoved(t.layoutData,d,_)&&(t.layoutData.moved=!0,s.push(t),u=!0),u&&r.__injectRenderedDimensions(t.layoutData),t.isDirty=!1};t instanceof Map||t instanceof Set?t.forEach(d):d(t);for(let t=0,o=n.length;t<o;t++){let o=n[t];e.EventProvider.raise(o.ctrl.getId()+".System.onPrevResized",o),r?c.push(o.ctrl):(e.EventProvider.raise(o.ctrl.getId()+".onResized",o.ctrl),e.EventProvider.raise("System.onControlsResized",[o.ctrl]))}for(let t=0,o=s.length;t<o;t++){let o=s[t];e.EventProvider.raise(o.ctrl.getId()+".System.onPrevMoved",o),r?l.push(o.ctrl):(e.EventProvider.raise(o.ctrl.getId()+".onMoved",o.ctrl),e.EventProvider.raise("System.onControlsMoved",[o.ctrl]))}return{skippedResizedEventList:c,skippedMovedEventList:l}}checkControlGeometryByControl(control){let e=this.__controlsGeoMap.get(control.getId());e&&this.checkControlGeometry({geos:e})}__checkResize(e,t,r){let o=!1;return t=Math.round(t),r=Math.round(r),null===e.bounds.width&&null===e.bounds.height?(e.bounds.width=t,e.bounds.height=r,o=!0):e.bounds.width===t&&e.bounds.height===r||(e.bounds.width=t,e.bounds.height=r,o=!0),o}__checkMoved(e,t,r){let o=!1;return null===e.bounds.offsetTop&&null===e.bounds.offsetLeft?(e.bounds.offsetTop=t,e.bounds.offsetLeft=r,o=!0):e.bounds.offsetTop===t&&e.bounds.offsetLeft===r||(e.bounds.offsetTop=t,e.bounds.offsetLeft=r,o=!0),o}getControlsCache(){return this.__controls}static _procConstructor(t,element,r,o){try{if(t.reg.nativeEs6Control)return new t.reg.ctrlConstructor(element,r,o);var i=Reflect.construct(t.reg.nearestEs6Constructor,[element,r,o],t.reg.ctrlConstructor);return t.reg.ctrlConstructor.apply(i,[element,r,o]),i}catch(t){return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Constructor of control of type: '"+element.attr("data-tchmi-type")+"' and with id: '"+element.attr("id")+"' has thrown an unexpected exception: '"+t+"'."))}}static _procPrevinit(t){try{return t.__previnit(),!0}catch(r){try{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Function: '__previnit' of control of type: '"+t.getType()+"' and with id: '"+t.getId()+"' has thrown an unexpected exception: '"+r+"'."),t.destroy()}catch(e){}return!1}}static _procInit(t){try{return t.__init(),!0}catch(r){try{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Function: '__init' of control of type: '"+t.getType()+"' and with id: '"+t.getId()+"' has thrown an unexpected exception: '"+r+"'."),t.destroy()}catch(e){}return!1}}setControlProperty(control,propertyName,valueNew,t){let r=this.getAttributeByPropertyName(control,propertyName);if(!r){let t="";return propertyName&&(t=`Missing attribute description of attribute property: ${propertyName} for control type: ${control.getType()}.`),{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:t,domain:"TcHmi.System.ControlManager"}}return r.readOnly?{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:`Property: ${propertyName} of control type: ${control.getType()} is readonly.`,domain:"TcHmi.System.ControlManager"}:r.propertySetterName?this.setControlPropertyByAttribute(control,r,valueNew,t):{code:e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION],reason:`Missing propertySetterName in configuration of attribute property: ${propertyName} of control type: ${control.getType()}.`,domain:"TcHmi.System.ControlManager"}}setControlPropertyByAttribute(control,r,valueNew,o){let i=control[r.propertySetterName];if("function"!=typeof i)return{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:`Missing implementation of setter function: ${r.propertySetterName} for attribute property: ${r.propertyName} of control type: ${control.getType()}.`,domain:"TcHmi.System.ControlManager"};let n=!1,s={error:e.Errors.NONE,value:valueNew};if(null===valueNew){const o=t.Services.themeManager.getDefaultPropertyValue(control,r.propertyName);"tchmi:framework#/definitions/Path"===r.type&&"string"==typeof o.value&&o.value.length>0?s.value=e.Theme.Resources.resolveBasePath(control,o)+o.value:s.value=o.value,n=!0}if(s=e.ValueConverter.toTypeEx(s.value,r.type),null===s.value&&(null!==s.value||null!==valueNew))return this.setControlPropertyByAttribute(control,r,null),{code:e.Errors.E_VALUE_INVALID,message:e.Errors[e.Errors.E_VALUE_INVALID],reason:`Unable to convert value of type: ${typeof valueNew} to type: ${r.type} for attribute property: ${r.propertyName} of control of type: ${control.getType()} with id: ${control.getId()}.`,domain:"TcHmi.System.ControlManager",errors:s.details?[s.details]:void 0};try{i.call(control,s.value,o)}catch(t){return{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:`Unexpected exception in setter function: ${r.propertySetterName} of attribute property: ${r.propertyName} of control of type: ${control.getType()} with id: ${control.getId()}. Exception: ${t}`,domain:"TcHmi.System.ControlManager",exception:t}}return n?t.Services.themeManager.watchAttributeDefaults(control,r.propertyName):t.Services.themeManager.unwatchAttributeDefaults(control,r.propertyName),{code:e.Errors.NONE,message:e.Errors[e.Errors.NONE],domain:"TcHmi.System.ControlManager"}}destruct(t){this.__controls.has(t.getId())?(this.__controls.delete(t.getId()),"function"!=typeof Proxy&&delete e.control[t.getId()]):TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ControlManager] Unable to destroy control with id="+t.getId()+" because its already destroyed!")}compile(o,parent,options){var i,n,s;const l=o.getAttribute("data-tchmi-type");if(!l)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to compile control. Missing required attribute=data-tchmi-type in html="+o.outerHTML+"."));const c=o.id;if(!c)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to compile control. Missing required attribute=id in html="+o.outerHTML+"."));let d=e.System.Data.Modules.controls.map.get(l);if(!d)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to compile control. Missing meta data for control type: '"+l+"'."));if(d.error!==e.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.ControlManager] "+e.Log.buildMessage(d.errorDetails);return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message))}if(d.reg.error!==e.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.ControlManager] "+e.Log.buildMessage(d.reg.errorDetails);return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message))}if(TCHMI_DESIGNER&&options&&!0===options.designerIgnore&&o.setAttribute("data-tchmi-designer-ignore",""),TCHMI_DESIGNER&&"TcHmi.Controls.System.TcHmiUserControl"===l){if(tchmi_path(o.getAttribute("data-tchmi-partial-url"))===TCHMI_TARGET_PARTIAL){let t=o.outerHTML;let r=new e.System.SymbolExpressionParser(t).resolveExpressionsBySymbolType(e.SymbolType.PartialParam);if(r){for(let e=0,o=r.length;e<o;e++){let o=r[e];t=t.replace(new RegExp(tchmi_escape_regex(""+o.toString()),"g"),`%pp%TCHMI_TARGET_DESIGNER_PARTIALPARAM::${o.getContent()}%/pp%`)}let e=document.createElement("div");e.innerHTML=t,o=e.firstElementChild}}}let _=$(o.cloneNode(!0)),m=e.System.resolveAttributesFromControlElement(o);if(!TCHMI_ENGINEERING&&m.error!==e.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.ControlManager] Error while parsing attributes of control: '"+c+"'. Details: "+e.Log.buildMessage(m.details);TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(message)}o.textContent="";let u=this.__controls.get(c);if(void 0!==u){const t=u.getElement().attr("data-tchmi-partial-url");return void(!e.System.isInitialized&&t&&t===o.getAttribute("data-tchmi-partial-url")||TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to create instance of control. The id: '"+c+"' does already exist."))}let g=r._procConstructor(d,$(o),_,m.value);if(void 0===g)return;if(parent||g.__setParent(null),this.__controls.set(c,g),"function"!=typeof Proxy&&(e.control[c]=g),parent){let e=options?options.pos:void 0;parent.__addChild(g,e)}if(d.descriptionExpanded.inheritedTemplate){let t=e.System.Data.Caches.templateMarkupCache.get(d.descriptionExpanded.inheritedTemplate);if(void 0!==t){let e=document.createElement("div");e.innerHTML=t.replace(/{Id}/g,c);let r=e.firstElementChild;if(r){let e=this,t=function(r){let o=r.children;for(let r=0,i=o.length;r<i;r++){let i=o[r];if(i.hasAttribute("data-tchmi-type")){let t=e.compile(i,g);g.__addChild(t)}else i.hasChildNodes()&&t(i)}};t(r),o.appendChild(r)}}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Template markup for control type: '"+g.getType()+"' is not available.")}if(!0!==r._procPrevinit(g))return this.__controls.delete(c),void("function"!=typeof Proxy&&delete e.control[c]);let E=new Map;for(let t in m.value){let r=m.value[t];if(void 0===r.descr||null===r.descr)continue;const o=t.toLowerCase();if(E.set(o,!0),"data-tchmi-trigger"!==t)if(!0===r.descr.readOnly);else if(e.Symbol.isSymbolExpression(r.value))this.setControlPropertyByAttribute(g,r.descr,null),e.System.Services.bindingManager.createBinding(r.value,r.descr.propertyName,g);else{let error=this.setControlPropertyByAttribute(g,r.descr,r.value);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to set property: '"+r.descr.propertyName+"' of control: '"+c+"'."+e.Log.buildMessage(error),error.exception?"\n":void 0,null!==(i=error.exception)&&void 0!==i?i:void 0)}}e.Engineering.ErrorPane.remove(c+".requiredAttributeMissing");const h=this.getDescriptionAttributes(l);for(let t of h){if(E.get(t.name.toLowerCase()))continue;if(t.readOnly)continue;if(t.requiredOnCompile)return e.Engineering.ErrorPane.add(c+".requiredAttributeMissing","Error compiling control id="+c+" type="+g.getType()+". Attribute "+t.propertyName+" is required but has not been set in HTML.",e.Engineering.ErrorPane.MessageType.Error),this.__controls.delete(c),void("function"!=typeof Proxy&&delete e.control[c]);let error=this.setControlPropertyByAttribute(g,t,null);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to set property: '"+t.propertyName+"' of control: '"+c+"'."+e.Log.buildMessage(error),error.exception?"\n":void 0,null!==(n=error.exception)&&void 0!==n?n:void 0)}t.Services.themeManager.startAttributeSetterWatcher(g);let S=m.value["data-tchmi-trigger"];if(null!=S&&void 0!==S.descr&&null!==S.descr)if(!0===S.descr.readOnly);else if(e.Symbol.isSymbolExpression(S.value))e.System.Services.bindingManager.createBinding(S.value,S.descr.propertyName,g);else{let error=this.setControlPropertyByAttribute(g,S.descr,S.value);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ControlManager] Failed to set property: 'Trigger' of control: '"+c+"'."+e.Log.buildMessage(error),error.exception?"\n":void 0,null!==(s=error.exception)&&void 0!==s?s:void 0)}return g.__setLifeCycleState(15),!0!==r._procInit(g)?(this.__controls.delete(c),void("function"!=typeof Proxy&&delete e.control[c])):g}__resolveDescriptionTypes(r){r.descriptionExpanded.inheritedTypes=[];let o=r.descriptionExpanded.base;if(null!=o){let i=e.System.Data.Modules.controls.map.get(o);if(!i)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Base control: '"+o+"' of control: '"+r.descriptionExpanded.name+"' not found."));if(i.error!==e.Errors.NONE)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Control module: '"+o+"' contains errors:"+e.Log.buildMessage(i.errorDetails)));this.__resolveDescriptionTypes(i);let n=this.getDescriptionTypes(o);for(let e=0,o=n.length;e<o;e++){let o=n[e];if(r.descriptionExpanded.inheritedTypes.indexOf(o)<0&&r.descriptionExpanded.inheritedTypes.push(o),t.mapControlNamesFromPackageManifestApi1ToApi0.has(o)){let e=t.mapControlNamesFromPackageManifestApi1ToApi0.get(o);r.descriptionExpanded.inheritedTypes.indexOf(e)<0&&r.descriptionExpanded.inheritedTypes.push(e)}}}let type=e.System.resolveQualifiedName(r.description.name,r.description.namespace);r.descriptionExpanded.inheritedTypes.push(type),t.mapControlNamesFromPackageManifestApi1ToApi0.has(type)&&r.descriptionExpanded.inheritedTypes.push(t.mapControlNamesFromPackageManifestApi1ToApi0.get(type))}__resolveDescriptionAttributes(t){let r=[],o=[];t.descriptionExpanded.inheritedAttributes=[],t.descriptionExpanded.inheritedAttributesNameMap=new Map,t.descriptionExpanded.inheritedAttributesPropertyNameMap=new Map,t.descriptionExpanded.inheritedAttributesPropertyGetterNameMap=new Map,t.descriptionExpanded.inheritedAttributesPropertySetterNameMap=new Map,t.descriptionExpanded.inheritedAccess=[];let i=t.descriptionExpanded.base;if(null!=i){let n=e.System.Data.Modules.controls.map.get(i);if(!n)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Base control: '"+t.descriptionExpanded.base+"' of control: '"+t.descriptionExpanded.name+"' not found."));if(n.error!==e.Errors.NONE)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Control module: '"+i+"' contains errors:"+e.Log.buildMessage(t.errorDetails)));this.__resolveDescriptionAttributes(n);let s=n.descriptionExpanded.inheritedAttributes;if(void 0!==s)for(let e=0,t=s.length;e<t;e++)!1!==s[e].heritable&&r.push(s[e]);let l=n.descriptionExpanded.inheritedAccess;void 0!==l&&0!==l.length&&(o=o.concat(l))}let attributes=tchmi_clone_object(t.descriptionExpanded.attributes);null==attributes&&(attributes=[]);for(let e=0,o=r.length;e<o;e++){let o=!1;for(let t=0,i=attributes.length;t<i;t++)if(attributes[t].name.toLowerCase()===r[e].name.toLowerCase()){o=!0;break}!1===o&&t.descriptionExpanded.inheritedAttributes.push(r[e])}t.descriptionExpanded.inheritedAttributes=t.descriptionExpanded.inheritedAttributes.concat(attributes);for(let r=0,o=t.descriptionExpanded.inheritedAttributes.length;r<o;r++){let o=t.descriptionExpanded.inheritedAttributes[r];t.descriptionExpanded.inheritedAttributesNameMap.set(o.name.toLowerCase(),o),o.propertyName?t.descriptionExpanded.inheritedAttributesPropertyNameMap.set(o.propertyName.toLowerCase(),o):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error('[Source=Framework, Module=TcHmi.System.ControlManager] Description.json of control type "'+t.descriptionExpanded.displayName+'" attribute "'+o.name+'" has no propertyName entry. Handling this attribute will not work.'),o.propertyGetterName?t.descriptionExpanded.inheritedAttributesPropertyGetterNameMap.set(o.propertyGetterName.toLowerCase(),o):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error('[Source=Framework, Module=TcHmi.System.ControlManager] Description.json of control type "'+t.descriptionExpanded.displayName+'" attribute "'+o.name+'" has no propertyGetterName entry. Handling this attribute will not work.'),o.propertySetterName?t.descriptionExpanded.inheritedAttributesPropertySetterNameMap.set(o.propertySetterName.toLowerCase(),o):o.readOnly||TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error('[Source=Framework, Module=TcHmi.System.ControlManager] Description.json of control type "'+t.descriptionExpanded.displayName+'" attribute "'+o.name+'" has no propertySetterName entry. Handling this attribute will not work.')}let n=t.descriptionExpanded.access;null==n&&(n=[]);for(let e=0,r=o.length;e<r;e++){let r=!1;for(let t=0,i=n.length;t<i;t++)if(n[t].name===o[e].name){r=!0;break}!1===r&&t.descriptionExpanded.inheritedAccess.push(o[e])}0!==n.length&&(t.descriptionExpanded.inheritedAccess=t.descriptionExpanded.inheritedAccess.concat(n))}__resolveInheritanceHierarchy(t){if(!t||t.error!==e.Errors.NONE)return null;const r={controlType:e.System.resolveQualifiedName(t.descriptionExpanded.name,t.descriptionExpanded.namespace),children:[]};if(t.descriptionExpanded.base){let o=(r,i)=>{if(!i){let r=e.System.Data.Modules.controls.map.get(t.descriptionExpanded.base);return this.__resolveInheritanceHierarchy(r)}if(r===i.controlType)return i;for(let e=0;e<i.children.length;e++){let t=i.children[e],n=o(r,t);if(n)return n}return null},i=o(t.descriptionExpanded.base,this.__inheritanceHierarchyTree);if(i){for(let r=0;r<i.children.length;r++){let o=i.children[r];if(o.controlType===e.System.resolveQualifiedName(t.descriptionExpanded.name,t.descriptionExpanded.namespace))return o}i.children.push(r)}else{let o=e.System.Data.Modules.controls.map.get(t.descriptionExpanded.base),i=this.__resolveInheritanceHierarchy(o);if(!i)return null;i.children.push(r)}}else{if(this.__inheritanceHierarchyTree)return this.__inheritanceHierarchyTree;this.__inheritanceHierarchyTree=r}return r}__resolveTemplateInheritation(t){if(!t)return;let r=function(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE?t.descriptionExpanded.template?tchmi_path(t.package.basePath+"/"+t.manifestData.basePath+"/"+t.descriptionExpanded.template):r(t.descriptionExpanded.base):null};if(t.descriptionExpanded)if(t.descriptionExpanded.template){let e=tchmi_path(t.package.basePath+"/"+t.manifestData.basePath+"/"+t.descriptionExpanded.template);t.descriptionExpanded.inheritedTemplate=e}else t.descriptionExpanded.inheritedTemplate=r(t.descriptionExpanded.base)}__validateDescriptionAttributes(r){r&&r.description&&r.description.attributes.forEach(o=>{const i=e.System.Services.typeManager.getSchemaEx(o.type);i.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Attribute "+o.propertyName+" of control "+t.resolveQualifiedName(r.description.name,r.description.namespace)+" uses invalid data type "+o.type+": "+e.Log.buildMessage(i.details))})}resolveDescriptionInheritation(){try{let t=this,r=[];e.System.Data.Modules.controls.array.forEach((e,t)=>{r.push(e)}),r.sort((a,b)=>a.descriptionExpanded.base===b.descriptionExpanded.name?1:b.descriptionExpanded.base===a.descriptionExpanded.name?-1:0);for(let e=0,o=r.length;e<o;e++){let o=r[e];o.descriptionExpanded.inheritationResolved||(t.__resolveDescriptionTypes(o),t.__resolveDescriptionAttributes(o),t.__resolveInheritanceHierarchy(o),t.__resolveTemplateInheritation(o),o.descriptionExpanded.inheritationResolved=!0,t.__validateDescriptionAttributes(o))}}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ControlManager] Unexpected exception="+t)}}getInheritanceTree(){return this.__inheritanceHierarchyTree}getDescription(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE&&t.descriptionExpanded&&t.descriptionExpanded.inheritedTypes?t.description:null}getDescriptionTypes(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE&&t.descriptionExpanded&&t.descriptionExpanded.inheritedTypes?t.descriptionExpanded.inheritedTypes:[]}isRegisteredDescriptionType(type){return e.System.Data.Modules.controls.map.has(type)}getDescriptionPath(type){let t=e.System.Data.Modules.controls.map.get(type);return t||t.error===e.Errors.NONE?tchmi_path(t.package.basePath+"/"+t.manifestData.basePath+"/"+t.manifestData.descriptionFile):null}getDescriptionAttributes(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE&&t.descriptionExpanded&&t.descriptionExpanded.inheritedAttributes?t.descriptionExpanded.inheritedAttributes:null}getDescriptionAccess(type){let t=e.System.Data.Modules.controls.map.get(type);return t&&t.error===e.Errors.NONE&&t.descriptionExpanded&&t.descriptionExpanded.inheritedAccess?t.descriptionExpanded.inheritedAccess:null}getDescriptionAttributeByName(type,name){if(!name)return null;const t=name.toLowerCase();let r=e.System.Data.Modules.controls.map.get(type);if(r&&r.error===e.Errors.NONE&&r.descriptionExpanded){let e=r.descriptionExpanded.inheritedAttributesNameMap.get(t);return e||null}return null}getDescriptionAttributeByPropertyName(type,propertyName){if(!propertyName)return null;const t=propertyName.toLowerCase();let r=e.System.Data.Modules.controls.map.get(type);if(r&&r.error===e.Errors.NONE&&r.descriptionExpanded){let e=r.descriptionExpanded.inheritedAttributesPropertyNameMap.get(t);return e||null}return null}getUserControlConfigAttributeByPropertyName(e,propertyName){let t=this.__usercontrolAttrDescrByPropertyName.get(e);if(!t)return null;let r=t.get(propertyName);return r||null}getDescriptionAttributeByPropertySetterName(type,t){if(null==t)return null;const r=t.toLowerCase();let o=e.System.Data.Modules.controls.map.get(type);if(o&&o.error===e.Errors.NONE&&o.descriptionExpanded){let e=o.descriptionExpanded.inheritedAttributesPropertySetterNameMap.get(r);return e||null}return null}getDescriptionAttributeByPropertyGetterName(type,t){if(!t)return null;const r=t.toLowerCase();let o=e.System.Data.Modules.controls.map.get(type);if(o&&o.error===e.Errors.NONE&&o.descriptionExpanded){let e=o.descriptionExpanded.inheritedAttributesPropertyGetterNameMap.get(r);return e||null}return null}getAttributeByPropertyName(control,propertyName){let type=control.getType(),e=this.getDescriptionAttributeByPropertyName(type,propertyName);if(e)return e;if("TcHmi.Controls.System.TcHmiUserControlHost"===type){let t=control.getTargetUserControl();if(t){let r=tchmi_path(t.replace(".usercontrol",".usercontrol.json"));if(e=this.getUserControlConfigAttributeByPropertyName(r,propertyName),e)return e}}return null}getAttributeTypeByPropertyName(control,propertyName){if(!control)return t.ControlAttributeType.Invalid;let type=control.getType(),e=this.getDescriptionAttributeByPropertyName(type,propertyName);if(e)return t.ControlAttributeType.Control;if("TcHmi.Controls.System.TcHmiUserControlHost"===type){let r=control.getTargetUserControl();if(r){const o=tchmi_path(r.replace(".usercontrol",".usercontrol.json"));if(e=this.getUserControlConfigAttributeByPropertyName(o,propertyName),e)return t.ControlAttributeType.UserControlParameter}}return t.ControlAttributeType.Invalid}getAttributeByPropertySetterName(control,t){if(!control)return null;let type=control.getType(),r=e.System.Services.controlManager.getDescriptionAttributeByPropertySetterName(type,t);if(r)return r;if("TcHmi.Controls.System.TcHmiUserControlHost"===type){let e=control.getTargetUserControl();if(e){let r=tchmi_path(e.replace(".usercontrol",".usercontrol.json")),o=this.__usercontrolAttrDescrBySetterName.get(r);if(o){let e=o.get(t);if(e)return e}}}return null}getAttributeByPropertyGetterName(control,t){if(!control)return null;let type=control.getType(),r=e.System.Services.controlManager.getDescriptionAttributeByPropertyGetterName(type,t);if(r)return r;if("TcHmi.Controls.System.TcHmiUserControlHost"===type){let e=control.getTargetUserControl();if(e){let r=tchmi_path(e.replace(".usercontrol",".usercontrol.json")),o=this.__usercontrolAttrDescrByGetterName.get(r);if(o){let e=o.get(t);if(e)return e}}}return null}getDescriptionAccessByName(type,name){let e=null;if(!name)return null;let t=this.getDescriptionAccess(type);if(null!=t)for(let r=0,o=t.length;r<o;r++){let o=t[r];if(o.name===name){e=o;break}}return e}}t.ControlManager=r}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.DialogManager=class{constructor(){this.__currentDialogType=0,this.__dialogOwner=null;let e=document.createElement("div");e.innerHTML='<div id="tchmi-overlaysystemdialog-container" class="tchmi-box"><div id="tchmi-overlaysystemdialog-background" class="tchmi-box"></div><div class="tchmi-overlaysystemdialog-message tchmi-box"></div><input id="tchmi-overlaysystemdialog-dismissbutton" type="button" value="Close" style="display:none;"></input></div>',this.__elementOverlayDialogContainer=e.firstElementChild;const t=function(e){e.stopPropagation()};let r,o=this.__elementOverlayDialogContainer.querySelector("#tchmi-overlaysystemdialog-background");r=!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&{passive:!1,capture:!1},o.addEventListener("mousedown",t,r),o.addEventListener("click",t,r),o.addEventListener("mouseup",t,r),o.addEventListener("touchstart",t,r),o.addEventListener("touchend",t,r)}showDialog(dialogOwner,bVisibility,dialogType,options){if((!options||!0!==options.force)&&null!==dialogOwner&&null!==this.__dialogOwner&&this.__dialogOwner!==dialogOwner)return!1;if(this.__dialogOwner=dialogOwner,!0===bVisibility){if(this.__currentDialogType=dialogType,dialogType===e.DialogManager.DialogType.Overlay){const t=this.__elementOverlayDialogContainer.querySelector("#tchmi-overlaysystemdialog-dismissbutton");options&&!0===options.cancelable?(t.addEventListener("click",()=>{e.System.Services.dialogManager.showDialog(null,!1)}),t.style.display=""):t.style.display="none",document.body&&!document.body.contains(this.__elementOverlayDialogContainer)&&document.body.appendChild(this.__elementOverlayDialogContainer)}}else!1===bVisibility&&(this.__elementOverlayDialogContainer.parentElement&&this.__elementOverlayDialogContainer.parentElement.removeChild(this.__elementOverlayDialogContainer),this.__dialogOwner=null);return!0}updateText(dialogOwner,t,severity=e.DialogManager.DialogSeverity.Info){if(null!==dialogOwner&&null!==this.__dialogOwner&&this.__dialogOwner!==dialogOwner)return!1;this.__dialogOwner=dialogOwner;let r=this.__elementOverlayDialogContainer.querySelector(".tchmi-overlaysystemdialog-message");switch(r&&(r.innerHTML=t),r.style.display=t?"":"none",severity){case e.DialogManager.DialogSeverity.Info:this.__elementOverlayDialogContainer.classList.remove("tchmi-overlaysystemdialog-error");break;case e.DialogManager.DialogSeverity.Error:this.__elementOverlayDialogContainer.classList?this.__elementOverlayDialogContainer.classList.add("tchmi-overlaysystemdialog-error"):this.__elementOverlayDialogContainer.className+=" tchmi-overlaysystemdialog-error"}return!0}getDialogOwner(){return this.__dialogOwner}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.SplashScreen=class{constructor(){this.__isVisibile=!1;let e=document.createElement("div");e.innerHTML='<div id="tchmi-splash-container">   <div class="tchmi-splash-content-container">       <div class="tchmi-splash-stage-progress-container"><div class="tchmi-splash-stage-progress"></div></div>       <div class="tchmi-splash-stage-info">Loading...</div>       <div class="tchmi-splash-version-info">Version: ?.?.?.?</div>   </div></div>',this.__elementSplashScreenContainer=e.firstElementChild,this.__elementSplashProgress=this.__elementSplashScreenContainer.querySelector(".tchmi-splash-stage-progress"),this.__elementSplashInfo=this.__elementSplashScreenContainer.querySelector(".tchmi-splash-stage-info"),this.__elementVersionInfo=this.__elementSplashScreenContainer.querySelector(".tchmi-splash-version-info")}isVisible(){return this.__isVisibile}updateVersionInfo(message){this.__elementVersionInfo&&(this.__elementVersionInfo.innerText=message)}updateStageInfo(message){this.__elementSplashInfo&&(this.__elementSplashInfo.innerText=message)}updateStageProgress(e){this.__elementSplashProgress&&(this.__elementSplashProgress.style.width=e.toString()+"%")}show(){this.__isVisibile||e.System.isInitialized||document.body&&!document.body.contains(this.__elementSplashScreenContainer)&&(this.__elementSplashScreenContainer.parentElement&&this.__elementSplashScreenContainer.parentElement.removeChild(this.__elementSplashScreenContainer),document.body.appendChild(this.__elementSplashScreenContainer),this.__isVisibile=!0,e.EventProvider.raise("System.onSplashScreenShow"))}hide(){this.__isVisibile&&(this.__elementSplashScreenContainer.parentElement&&this.__elementSplashScreenContainer.parentElement.removeChild(this.__elementSplashScreenContainer),this.__isVisibile=!1,e.EventProvider.raise("System.onSplashScreenHide"))}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){class r{constructor(e){this.__comparisons=[],this.__subfilters=[],this.__parent=null,this.__logic=e}static parse(data,schema){if(schema&&("array"!==schema.type||!schema.items))throw new Error("Filter schema must describe an array.");if(!data||0===data.length)return new r("AND");if(!Array.isArray(data))throw new Error("Filter must be an array.");if(1===data.length){let t=data[0];if(e.isComparison(t)){let e=new r("AND");return schema&&(t=this.__parseComparison(t,schema)),e.__comparisons.push(t),e}if(Array.isArray(t))return this.parse(t,schema);throw new Error("Invalid filter. Expected comparison or nested filter at position 0.")}let t=data[0],o=data[1];if(!e.isLogicOperator(o))throw new Error("Invalid filter. Expected logic operator at position 1.");let i=(t,expression,r)=>{if(e.isComparison(expression))schema&&(expression=this.__parseComparison(expression,schema)),t.__comparisons.push(expression);else{if(!Array.isArray(expression))throw new Error(`Invalid filter. Expected comparison or nested filter at position ${r}.`);t.__subfilters.push(this.parse(expression,schema))}},n=new r(o.logic);i(n,t,0);let s=n,l=null,c="comparison";for(let t=2,o=data.length;t<o;t++)switch(c){case"comparison":l=data[t],c="logic";break;case"logic":let o=data[t];if(!e.isLogicOperator(o))throw new Error(`Invalid filter. Expected logic operator at position ${t}.`);let d=o.logic;if(d===s.__logic)i(s,l,t-1);else if("OR"===d)if(i(s,l,t-1),s.__parent&&s.__parent.__logic===d)s=s.__parent;else{let e=new r(d);e.__subfilters.push(s),e.__parent=s.__parent,s.__parent=e,null===e.__parent&&(n=e),s=e}else if("AND"===d){let e=new r(d);i(e,l,t-1),e.__parent=s,s.__subfilters.push(e),s=e}c="comparison"}if("comparison"===c)throw new Error("Filter must not end with a logic operator.");return i(s,l,data.length-1),n}test(e,t=""){for(let r=0,o=this.__comparisons.length;r<o;r++){let o=this.__resolveComparison(this.__comparisons[r],e,t);if(o&&"OR"===this.__logic)return!0;if(!o&&"AND"===this.__logic)return!1}for(let r=0,o=this.__subfilters.length;r<o;r++){let o=this.__subfilters[r].test(e,t);if(o&&"OR"===this.__logic)return!0;if(!o&&"AND"===this.__logic)return!1}return"AND"===this.__logic}static __parseComparison(e,schema){e=tchmi_clone_object(e);let t=r=>{if(r.oneOf)for(let e=0,o=r.oneOf.length;e<o;e++){let o=t(r.oneOf[e]);if(o)return o}else if(r.anyOf)for(let e=0,o=r.anyOf.length;e<o;e++){let o=t(r.anyOf[e]);if(o)return o}else if("object"===r.type&&r.properties){if(r.properties.path){if("string"!==r.properties.path.type)return null;if(-1!==r.required.indexOf("path")){if(!e.path)return null;if(r.properties.path.enum&&-1===r.properties.path.enum.indexOf(e.path))return null}}return r.properties.comparator&&r.properties.comparator.enum&&-1!==r.properties.comparator.enum.indexOf(e.comparator)&&(r.properties.value&&r.properties.value.type===typeof e.value)?r:null}return null},r=null;if(Array.isArray(schema.items))for(let e=0,o=schema.items.length;e<o;e++){let o=t(schema.items[e]);if(o){r=o;break}}else r=t(schema.items);if(r&&"date-time"===r.properties.value.format&&"string"==typeof e.value){let date=new Date(e.value);if(isNaN(date.getTime()))throw new Error(`Filter contains an invalid date: "${e.value}".`);e.value=new Date(e.value)}return e}__resolveComparison(e,r,o){let i=r,n=e.value;if(e.path&&"{value}"!==e.path)if("{key}"===e.path)i=o;else{let r=t.resolveSymbolPathToTokenArray(e.path);for(let e=0,t=r.length;e<t;e++){let t=r[e],o=!1;if(t.match(/\[.*\]/)&&(t=t.slice(1,-1),o=!0),Array.isArray(i)&&o){let e=parseInt(t,10);i=i[isNaN(e)?t:e.toString()]}else{if("object"!=typeof i)throw new Error(`Could not read property ${t} of type ${typeof i}`);i=i[t]}}}if(void 0===i)return!1;if(typeof n!=typeof i)if("string"==typeof n){const t=/^[1-2]\d{3}(-?)[0-1]\d\1[0-3]\d(?:T[0-2]\d(?:(:?)[0-5]\d(?:\2[0-5]\d)?)?(?:[.,]\d+)?(?:Z|[+-][0-1]\d(?::?[0-5]\d)?)?)?$/;switch(typeof i){case"boolean":"true"===n.toLowerCase()?(e.originalValue=n,e.value=n=!0):"false"===n.toLowerCase()&&(e.originalValue=n,e.value=n=!1);break;case"number":if(/^[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?$/.test(n)){let t=parseFloat(n);Number.isNaN(t)||(e.originalValue=n,e.value=n=t)}break;case"object":if(i instanceof Date&&t.test(n)){let t=new Date(n);Number.isNaN(t.getTime())||(e.originalValue=n,e.value=n=t)}else null===i&&("null"===n.toLowerCase()?(e.originalValue=n,e.value=n=null):t.test(n)&&0===new Date(n).getTime()&&(n=null))}}else void 0!==e.originalValue&&typeof i==typeof e.originalValue&&(n=e.originalValue);else n instanceof Date&&0===n.getTime()&&null===i&&(n=null);i instanceof Date&&n instanceof Date&&(i=i.getTime(),n=n.getTime());const s=Math.pow(2,-23);switch(e.comparator){case"==":return"number"==typeof i&&"number"==typeof n?i===n||Math.abs(i-n)<=s:i===n;case"!=":return"number"==typeof i&&"number"==typeof n?i!==n&&Math.abs(i-n)>s:i!==n;case"<":if("number"==typeof i&&"number"==typeof n)return n-i>s;throw new Error(`Cannot compare ${typeof i} with ${typeof n} using <.`);case">":if("number"==typeof i&&"number"==typeof n)return i-n>s;throw new Error(`Cannot compare ${typeof i} with ${typeof n} using >.`);case"<=":if("number"==typeof i&&"number"==typeof n)return!(i-n>s);throw new Error(`Cannot compare ${typeof i} with ${typeof n} using <=.`);case">=":if("number"==typeof i&&"number"==typeof n)return!(n-i>s);throw new Error(`Cannot compare ${typeof i} with ${typeof n} using >=.`);case"contains":if("string"==typeof i&&"string"==typeof n)return-1!==i.indexOf(n);throw new Error(`Cannot compare ${typeof i} with ${typeof n} using contains.`);case"contains not":if("string"==typeof i&&"string"==typeof n)return-1===i.indexOf(n);throw new Error(`Cannot compare ${typeof i} with ${typeof n} using contains not.`);case"== [ignore case]":if("string"==typeof i&&"string"==typeof n)return i.toLowerCase()===n.toLowerCase();throw new Error(`Cannot compare ${typeof i} with ${typeof n} using == [ignore case].`);case"!= [ignore case]":if("string"==typeof i&&"string"==typeof n)return i.toLowerCase()!==n.toLowerCase();throw new Error(`Cannot compare ${typeof i} with ${typeof n} using != [ignore case].`);case"contains [ignore case]":if("string"==typeof i&&"string"==typeof n)return-1!==i.toLowerCase().indexOf(n.toLowerCase());throw new Error(`Cannot compare ${typeof i} with ${typeof n} using contains [ignore case].`);case"contains not [ignore case]":if("string"==typeof i&&"string"==typeof n)return-1===i.toLowerCase().indexOf(n.toLowerCase());throw new Error(`Cannot compare ${typeof i} with ${typeof n} using contains not [ignore case].`)}}}t.Filter=r}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.Functions=class{static checkDescription(t){let r=e.System.resolveQualifiedName(t.function.name,t.function.namespace);if(t.function.returnValue&&t.function.returnValue.type){const o=e.System.Services.typeManager.getSchemaEx(t.function.returnValue.type);o.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Functions] ReturnValue of function "+r+" uses invalid data type "+t.function.returnValue.type+": "+e.Log.buildMessage(o.details))}t.function.arguments&&t.function.arguments.forEach((t,o)=>{const i=e.System.Services.typeManager.getSchemaEx(t.type);i.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Functions] Argument#"+o+" "+t.name+" of function "+r+" uses invalid data type "+t.type+": "+e.Log.buildMessage(i.details))})}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.FunctionExpression=class{constructor(t,r=!1){this.__isDestroyed=!1,this.__symbolExpressions=[],this.__functionCallExpressions=[],this.__watchMap=new Map,this.__callbacks=[],this.__expression=t,this.__enableWatchMode=r;try{this.__originalAst=acorn.parse(t,{plugins:{symbolExpression:{onSymbol:this.__symbolExpressions,onCallExpression:t=>{let r=this.__resolveCallExpressionName(t.callee);const o=e.System.Data.Modules.functions.map.get(r);if(o)if(o.error===e.Errors.NONE){let s=o.description,l=0;if(!s){let error={code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],reason:'Target function expression: "'+this.__expression+'", Missing description file (*.function.json) for function with registered name: "'+r+'".',domain:"TcHmi.System.FunctionExpression"};this.__error?this.__error.errors?this.__error.errors.push(error):this.__error.errors=[error]:this.__error={code:e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR],reason:'Target function expression: "'+this.__expression+'", At least one error occured while parsing the function expression.',domain:"TcHmi.System.FunctionExpression",errors:[error]}}if(s&&!s.function){let error={code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],reason:'Target function expression: "'+this.__expression+'", Invalid description file(*.function.json) for function with registered name: "'+r+'".Missing  property: "function".',domain:"TcHmi.System.FunctionExpression"};this.__error?this.__error.errors?this.__error.errors.push(error):this.__error.errors=[error]:this.__error={code:e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR],reason:'Target function expression: "'+this.__expression+'", At least one error occured while parsing the function expression.',domain:"TcHmi.System.FunctionExpression",errors:[error]}}if(s&&s.function&&!0===s.function.injectContextObject&&l++,s&&s.function&&void 0!==t.arguments&&null!==t.arguments)for(var i=0,n=t.arguments.length;i<n;i++)if("SymbolExpression"===t.arguments[i].type&&s&&s.function&&s.function.arguments){let r;if(i+l<s.function.arguments.length?r=s.function.arguments[i+l]:(r=s.function.arguments[s.function.arguments.length-1],!0!==r.restParameter&&(r=null)),r){let o=e.System.Services.typeManager.getSchema(r.type);o&&"TcHmi.Symbol"===o.frameworkInstanceOf&&(t.arguments[i].passAsSymbol=!0)}}this.__functionCallExpressions.push(t)}else this.__error?this.__error.errors?this.__error.errors.push(o.errorDetails):this.__error.errors=[o.errorDetails]:this.__error={code:e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR],reason:'Target function expression: "'+this.__expression+'", At least one error occured while parsing the function expression.',domain:"TcHmi.System.FunctionExpression",errors:[o.errorDetails]}}}}})}catch(t){let error={code:e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION],reason:'Target function expression: "'+this.__expression+'", Exception: "'+t+'"',domain:"TcHmi.System.FunctionExpression"};this.__error?this.__error.errors?this.__error.errors.push(error):this.__error.errors=[error]:this.__error={code:e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_PARSER_ERROR],reason:'Target function expression: "'+this.__expression+'", At least one error occured while parsing the function expression.',domain:"TcHmi.System.FunctionExpression",errors:[error]}}r&&!this.__error&&(this.__fillWatchMap(),this.__doWatch())}__resolveCallExpressionName(expression){let e="";return"MemberExpression"===expression.type?(e+=this.__resolveCallExpressionName(expression.object),e+=".",e+=this.__resolveCallExpressionName(expression.property)):"Identifier"===expression.type&&(e+=expression.name),e}__fillWatchMap(){let r=this;for(let o=0,i=this.__symbolExpressions.length;o<i;o++)expression=this.__symbolExpressions[o],r.__watchMap.has(expression.expression)||r.__watchMap.set(expression.expression,{symbol:new t.Symbol(expression.expression),ready:!1,error:e.Errors.NONE});var expression}__doWatch(){this.__watchMap.forEach((e,t)=>{e.destroy=e.symbol.watch(this.__onSubSymbolWatch())})}__onSubSymbolWatch(){let t=this;return function(data){let r=t.__watchMap.get(this.getExpression().toString());if(!r)return;data.error===e.Errors.NONE?(r.value=data.value,r.error=null,r.details=null,r.ready=!0):(r.value=null,r.error=data.error,r.details=data.details,r.ready=!0);let o=!0,i=Array.from(t.__watchMap.keys());for(let e=0,r=i.length;e<r;e++){let r=t.__watchMap.get(i[e]);if(r&&!1===r.ready){o=!1;break}}if(o){let r=!1;t.execute({success:function(o){if(r)return;r=!0;let i=[];for(let e=0,r=t.__callbacks.length;e<r;e++)i.push(t.__callbacks[e]);for(let r of i)-1!==t.__callbacks.indexOf(r)&&e.Callback.callSafe(r.callback,t,{error:e.Errors.NONE,value:tchmi_clone_object(o),destroy:r.destroy})},error:function(error,o){if(r)return;r=!0;let i=[];for(let e=0,r=t.__callbacks.length;e<r;e++)i.push(t.__callbacks[e]);for(let r of i)-1!==t.__callbacks.indexOf(r)&&e.Callback.callSafe(r.callback,t,{error:error,details:o,destroy:r.destroy})}})}}}execute(t={success:function(){},error:function(){}}){if(this.__error)return void t.error(this.__error.code,this.__error);let r=this,o=void 0,i=[],n=[];if(TCHMI_DESIGNER){let r=!1;if(this.__symbolExpressions)for(let t=0,o=this.__symbolExpressions.length;t<o;t++){let o=new e.SymbolExpression(this.__symbolExpressions[t].expression);if(!o){r=!0;break}if(o.getType()===e.SymbolType.Server){r=!0;break}}if(r)return void t.success(null)}let s=function(t){let o=function(s){let l=!1;!function(t,o){if(!o)return void t.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:r.__expression,domain:"TcHmi.System.FunctionExpression"});let name=r.__resolveCallExpressionName(o.callee),s=[],l=e.System.Data.Modules.functions.map.get(name);if(!l)return void t.error(e.Errors.E_MODULE_MISSING,{code:e.Errors.E_MODULE_MISSING,message:e.Errors[e.Errors.E_MODULE_MISSING],reason:r.__expression,domain:"TcHmi.System.FunctionExpression"});if(l.error!==e.Errors.NONE)return void t.error(e.Errors.E_MODULE_ERROR,{code:e.Errors.E_MODULE_ERROR,message:e.Errors[e.Errors.E_MODULE_ERROR],reason:r.__expression,domain:"TcHmi.System.FunctionExpression",errors:[l.errorDetails]});if(!l.description)return void t.error(e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION,{code:e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION,message:e.Errors[e.Errors.E_FUNCTION_MISSING_FUNCTION_DESCRIPTION],reason:r.__expression,domain:"TcHmi.System.FunctionExpression"});if(!l.reg.func)return void t.error(e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,{code:e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE,message:e.Errors[e.Errors.E_FUNCTION_MISSING_FUNCTION_REFERENCE],reason:r.__expression,domain:"TcHmi.System.FunctionExpression"});let c=0;if("Asynchronous"===l.description.function.waitMode){if(!0!==l.description.function.injectContextObject)return void t.error(e.Errors.E_FUNCTION_INVALID_CONFIGURATION,{code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],reason:'Target function expression: "'+r.__expression+'", Invalid configuration for hmi function with name='+name+". Setting waitMode=Asynchronous and injectContextObject="+l.description.function.injectContextObject+" is an invalid function configuration. Please define a context object if you want to use waitMode=Asynchronous.",domain:"TcHmi.System.FunctionExpression"});{let e=!1;s.unshift({success:function(r){e||(e=!0,t.success(r))},error:function(error,r){e||(e=!0,t.error(error,r))}}),c++}}else!0===l.description.function.injectContextObject&&(s.unshift({}),c++);let d;o.start,o.end;for(let d=0,_=o.arguments.length;d<_;d++){let _=null;if(l&&l.error===e.Errors.NONE)if(d+c<l.description.function.arguments.length)_=l.description.function.arguments[d+c];else if(_=l.description.function.arguments[l.description.function.arguments.length-1],!0!==_.restParameter)return void t.error(e.Errors.E_FUNCTION_RESTPARAMETER_DEFINITION_MISSING,{code:e.Errors.E_FUNCTION_RESTPARAMETER_DEFINITION_MISSING,message:e.Errors[e.Errors.E_FUNCTION_RESTPARAMETER_DEFINITION_MISSING],domain:"TcHmi.System.FunctionExpression"});if(!_)return void t.error(e.Errors.E_FUNCTION_INVALID_CONFIGURATION,{code:e.Errors.E_FUNCTION_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_FUNCTION_INVALID_CONFIGURATION],domain:"TcHmi.System.FunctionExpression"});let m=e.System.Services.typeManager.getSchema(_.type);if(!m)return void t.error(e.Errors.E_UNKNOWN_TYPE,{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],domain:"TcHmi.System.FunctionExpression"});let u=o.arguments[d].start,g=o.arguments[d].end,expression=r.__expression.substr(u,g-u);if(e.Symbol.isSymbolExpression(expression)){let value;for(let e=0,t=r.__symbolExpressions.length;e<t;e++){let t=r.__symbolExpressions[e],o=t.start,n=t.end;if(o>=u&&n<=g){value=i[e],t.handled=!0;break}}if("TcHmi.Symbol"===m.frameworkInstanceOf){if(!(value instanceof e.Symbol))return void t.error(e.Errors.E_TYPE_INVALID,{code:e.Errors.E_TYPE_INVALID,message:e.Errors[e.Errors.E_TYPE_INVALID],domain:"TcHmi.System.FunctionExpression"});s[d+c]=value}else{let o=e.ValueConverter.toSchemaType(value,m);if(null===o&&null!==value)return void t.error(e.Errors.E_TYPE_INVALID,{code:e.Errors.E_TYPE_INVALID,message:e.Errors[e.Errors.E_TYPE_INVALID],reason:'Target function expression: "'+r.__expression+'", Unable to cast value: "'+value+'" of type: "'+typeof value+'" for parameter: "'+_.name+'" of function: "'+e.System.resolveQualifiedName(l.description.function.name,l.description.function.namespace)+'" to type "'+_.type+'".',domain:"TcHmi.System.FunctionExpression"});s[d+c]=o}}else{let value,o=expression.split("");for(let e=0,t=r.__symbolExpressions.length;e<t;e++){let t=r.__symbolExpressions[e],n=t.start,s=t.end,l=n-u,c=l+(s-n);if(n>=u&&s<=g){for(let e=l,t=c;e<t;e++)o[e]="";"string"==typeof i[e]?o[l]=`'${i[e]}'`:o[l]=i[e],t.handled=!0}}for(let e=0,t=r.__functionCallExpressions.length;e<t;e++){let t=r.__functionCallExpressions[e],i=t.start,s=t.end,l=i-u,c=l+(s-i);if(i>=u&&s<=g){for(let e=l,t=c;e<t;e++)o[e]="";"string"==typeof n[e]?o[l]=`'${n[e]}'`:o[l]=n[e],t.handled=!0}}let E="";for(let e=0,t=o.length;e<t;e++)E+=o[e];E+="\n//# sourceURL=TcHmi_System_FunctionExpression_resolveExpression_Eval";try{value=gIsolatedEval_TcHmi_System_FunctionExpression(E)}catch(o){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(o),void t.error(e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,{code:e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION],reason:'Target function expression: "'+r.__expression+'", Exception: "'+o+'"',domain:"TcHmi.System.FunctionExpression"})}let h=e.ValueConverter.toSchemaType(value,m);if(null===h&&null!==value)return void t.error(e.Errors.E_TYPE_INVALID,{code:e.Errors.E_TYPE_INVALID,message:e.Errors[e.Errors.E_TYPE_INVALID],reason:'Target function expression: "'+r.__expression+'", Unable to cast value: "'+value+'" of type: "'+typeof value+'" for parameter: "'+_.name+'" of function: "'+l.description.function.name+'" to type: "'+_.type+'".',domain:"TcHmi.System.FunctionExpression"});s[d+c]=h}}try{d=l.reg.func(...s)}catch(o){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(o),void t.error(e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,{code:e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION],reason:'Target function expression: "'+r.__expression+'", Exception: "'+o+'"',domain:"TcHmi.System.FunctionExpression"})}"Asynchronous"===l.description.function.waitMode||t.success(d)}({success:function(e){l||(l=!0,n[s]=e,s+1<r.__functionCallExpressions.length?o(s+1):t.success())},error:function(error,e){l||(l=!0,t.error(error,e))}},r.__functionCallExpressions[s])};r.__functionCallExpressions.length>0?o(0):t.success()},l=!1;return function(t){let o=function(n){let s=r.__symbolExpressions[n],l=!1;!function(t,o){if(o){if(!o.passAsSymbol){if(!0===r.__enableWatchMode){let e=r.__watchMap.get(o.expression);return e?e.error?void t.error(e.error,e.details):void t.success(tchmi_clone_object(e.value)):void 0}{let r=new e.System.Symbol(o.expression);return void r.read((function(data){return data.error?(t.error(data.error,data.details),r.destroy(),void(r=null)):(t.success(data.value),r.destroy(),void(r=null))}))}}{let r=new e.Symbol(o.expression);t.success(r)}}else t.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:r.__expression,domain:"TcHmi.System.FunctionExpression"})}({success:function(e){l||(l=!0,i[n]=e,n+1<r.__symbolExpressions.length?o(n+1):t.success())},error:function(error,e){l||(l=!0,t.error(error,e))}},s)};r.__symbolExpressions.length>0?o(0):t.success()}({success:function(c){if(l)return;l=!0;let d=!1;s({success:function(s){if(d)return;d=!0;let l=!1;!function(t){let s=r.__expression.split("");for(let e=0,t=r.__symbolExpressions.length;e<t;e++){let t=r.__symbolExpressions[e];if(t&&!t.handled){let r=[];for(let e=0,o=t.end-t.start;e<o;e++)r.push("");s.splice(t.start,t.end-t.start,...r),s[t.start]="resSE["+e+"]"}}for(let e=0,t=r.__functionCallExpressions.length;e<t;e++){let t=r.__functionCallExpressions[e];if(t&&!t.handled){let r=[];for(let e=0,o=t.end-t.start;e<o;e++)r.push("");s.splice(t.start,t.end-t.start,...r),s[t.start]="resFCE["+e+"]"}}try{let e="";for(let t=0,r=s.length;t<r;t++)e+=s[t];e+="\n//# sourceURL=TcHmi_System_FunctionExpression_resolveExpression_Results_Eval",o=gIsolatedEval_TcHmi_System_FunctionExpression_Results(e,i,n)}catch(o){return void t.error(e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,{code:e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_FUNCTION_EXPRESSION_EXCEPTION],reason:'Target function expression "'+r.__expression+'" throwed the Exception: "'+o+'"',domain:"TcHmi.System.FunctionExpression"})}t.success(o)}({success:function(e){l||(l=!0,o=e,t.success(e))},error:function(error,e){l||(l=!0,t.error(error,e))}})},error:function(error,e){d||(d=!0,t.error(error,e))}})},error:function(error,e){l||(l=!0,t.error(error,e))}}),o}watch(callback){if(!0===this.__isDestroyed)return e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,destroy:function(){},details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Function Expression already destroyed",domain:"TcHmi.System.FunctionExpression"}}),function(){};if(!1===this.__enableWatchMode)return e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,destroy:function(){},details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Function Expression has no watch mode",domain:"TcHmi.System.FunctionExpression"}}),function(){};let t=this,r=function(){let e=t.__callbacks.indexOf(o);-1!==e&&t.__callbacks.splice(e,1)},o={callback:callback,destroy:r};this.__callbacks.push(o);let i=!0,n=Array.from(t.__watchMap.keys());for(let e=0,r=n.length;e<r;e++){let r=t.__watchMap.get(n[e]);if(r&&!1===r.ready){i=!1;break}}if(i){let t=!1;this.execute({success:function(o){t||(t=!0,e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:tchmi_clone_object(o),destroy:r}))},error:function(error,o){t||(t=!0,e.Callback.callSafe(callback,this,{error:error,details:o,destroy:r}))}})}return r}destroy(){!0!==this.__isDestroyed&&(!0===this.__enableWatchMode&&(this.__watchMap.forEach((e,t)=>{e.destroy&&e.destroy(),e.symbol.destroy(),e=null}),this.__watchMap.clear()),this.__isDestroyed=!0)}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.StyleManager=class{constructor(){this.__styleOverwriteCache=new Map,e.EventProvider.register("System.onPrevControlsAttached",this.__onPrevControlsAttached()),e.EventProvider.register("System.onPrevControlsDetached",this.__onPrevControlsDetached()),e.EventProvider.register("onControlDestroyed",this.__onControlDestroyed())}__onPrevControlsAttached(){return(event,e)=>{this.writeStylesFromCache(e)}}__onPrevControlsDetached(){return(event,e)=>{this.removeStylesFromDom(e)}}__onControlDestroyed(){return(event,control)=>{if(!control)return;let e=this.__styleOverwriteCache.get(control);if(e){const t=e[0].elementInHead;null!==t&&document.head.removeChild(t),this.__styleOverwriteCache.delete(control)}}}__getElementStyle(element,propertyName,e=!1){let t,r,o={};if(!element||"object"!=typeof element)return o;if(void 0!==element.length){if(!element[0])return o;t=element[0]}else t=element;if(r=e?window.getComputedStyle(t):t.style,r&&r.getPropertyValue)if(null!=propertyName){if("string"==typeof propertyName){let value=r.getPropertyValue(propertyName);value&&(o[propertyName]=value)}else if(Array.isArray(propertyName))for(let e=0;e<propertyName.length;e++){let t=propertyName[e],i=r.getPropertyValue(t);i&&(o[t]=i)}}else if(void 0!==r.length&&0!==r.length)for(let e=0;e<r.length;e++){let t=r[e];o[t]=r.getPropertyValue(t)}return o}__setSimpleElementStyle(element,property,value=null){let t;if(element&&"object"==typeof element){if(void 0!==element.length){if(!element[0])return;t=element}else t=[element];for(let r=0,o=t.length;r<o;r++){const o=t[r].style;if(o&&o.removeProperty&&o.setProperty){if("string"==typeof property)if("string"==typeof value&&""!==value)o.setProperty(property,value);else if(Array.isArray(value))for(let e=0;e<value.length;e++)o.setProperty(property,value[e]);else o.removeProperty(property);else if(null!==property)for(const e in property)if(property.hasOwnProperty(e)){const t=property[e];if("string"==typeof t&&""!==t)o.setProperty(e,t);else if(Array.isArray(t))for(let r=0;r<t.length;r++)o.setProperty(e,t[r]);else o.removeProperty(e)}}else t[r].nodeType===Node.ELEMENT_NODE?t[r].id?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.StyleManager] Internal error: Element with the id "+t[r].id+" has no CSSStyleDeclaration in this browser."):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.StyleManager] Internal error: Element of type "+t[r].nodeName+" has no CSSStyleDeclaration in this browser."):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.StyleManager] Internal error: Setting style for Elements of type "+t[r].nodeName+" not supported.")}}}writeStylesFromCache(e){let t=document.createDocumentFragment();for(let r=0,o=e.length;r<o;r++){let control=e[r],o=this.__styleOverwriteCache.get(control);if(o)for(let e=0;e<o.length;e++){if(!o[e].strCss)continue;let r=document.createElement("style");r.type="text/css",r.className=o[e].strClass,r.appendChild(document.createTextNode(o[e].strCss)),t.appendChild(r),o[e].elementInHead=r}}t.childElementCount&&document.head.appendChild(t)}removeStylesFromDom(e){for(let r=0,o=e.length;r<o;r++){let control=e[r],o=this.__styleOverwriteCache.get(control);if(o){var t=o[0].elementInHead;null!==t&&(document.head.removeChild(t),o[0].elementInHead=null)}}}getExistingStyleOverwrites(controlName){var t="";const r=this.__styleOverwriteCache.get(e.Controls.get(controlName))||[{strClass:"",strCss:""}];for(let e=0;e<r.length;e++)-1!==r[e].strClass.indexOf("overwrite")&&(t+=r[e].strCss);return this.__deserializeCss(t)}__deserializeCss(e){for(var t={},r=0,o=(e=this.__removeComments(e.trim())).indexOf("@charset",r);-1!==o;){var i=this.__splitOutsideOfBraces(e.substring(o),";")[0];void 0===t["@-rules"]&&(t["@-rules"]=[]),t["@-rules"].push(i),r=o+i.length+1,o=e.indexOf("@charset",r)}for(var n=e.indexOf("@import",r);-1!==n;){var s=this.__splitOutsideOfBraces(e.substring(n),";")[0];void 0===t["@-rules"]&&(t["@-rules"]=[]),t["@-rules"].push(s),r=n+s.length+1,n=e.indexOf("@import",r)}for(var l=e.indexOf("@namespace",r);-1!==l;){var c=this.__splitOutsideOfBraces(e.substring(l),";")[0];void 0===t["@-rules"]&&(t["@-rules"]=[]),t["@-rules"].push(c),r=l+c.length+1,l=e.indexOf("@namespace",r)}function d(e,t){for(var property in t)if(t.hasOwnProperty(property))if(void 0===e[property])e[property]=t[property];else for(var r=0,o=t[property].length;r<o;r++)-1===e[property].indexOf(t[property][r])&&e[property].push(t[property][r]);return e}for(;r<e.length;){var _=e.indexOf("{",r),m=this.__findMatchingBrace(e,_),selector=e.substring(r,_).trim(),u=e.substring(_+1,m);if(selector.startsWith("@")){var g=this.__deserializeCss(u);if(void 0===t[selector])t[selector]=g;else for(var E in g)g.hasOwnProperty(E)&&(void 0===t[selector][E]?t[selector][E]=g[E]:t[selector][E]=d(t[selector][E],g[E]))}else{var h=this.__getDeclarations(u);void 0===t[selector]?t[selector]=h:t[selector]=d(t[selector],h)}r=m+1}return t}__getDeclarations(e){for(var t={},r=this.__splitOutsideOfBraces(e,";"),o=0,i=r.length;o<i;o++){var n=r[o].indexOf(":");if(n>-1){var property=r[o].substring(0,n).trim().toLowerCase(),value=r[o].substring(n+1).trim();void 0===t[property]?t[property]=[value]:-1===t[property].indexOf(value)&&t[property].push(value)}}return t}__removeComments(e){if(-1===e.indexOf("/*"))return e;var t="",r=!1;function o(e){r||(t+=e)}for(var i=0,n=e.length;i<n;i++){var s=e.charAt(i);switch(s){case"/":i+1<n&&"*"===e.charAt(i+1)&&(r=!0,i++),o(s);break;case"*":o(s),i+1<n&&"/"===e.charAt(i+1)&&(r=!1,i++);break;case'"':case"'":var l=this.__findMatchingQuote(e,i);l>i&&(o(e.substring(i,l+1)),i=l);break;default:o(s)}}return t}__getExistingStyleOverwritesForSelector(e,selector){var t=e;return t[selector]||(t[selector]={}),t[selector]}getStyle(controlName,selector,propertyName){if(!selector){const t=e.Controls.get(controlName);if(void 0!==t&&0!==t.getElement().length){if(null==propertyName)return;return[e.StyleProvider.getSimpleElementStyle(t.getElement(),propertyName)[propertyName]]}}selector=this.expandSelector(selector,controlName);var t=this.getExistingStyleOverwrites(controlName),r=this.__getExistingStyleOverwritesForSelector(t,selector);if(void 0!==r)return null!=propertyName?r[propertyName]:r}writeStyles(controlName,styles){var t=this.__serializeCss(styles);let control=e.Controls.get(controlName),r=this.__styleOverwriteCache.get(control);if(void 0===r)r=[{strClass:"tchmi-theme overwrite "+controlName,strCss:t,elementInHead:null}],this.__styleOverwriteCache.set(control,r);else{let e=!1;for(let o=0;o<r.length;o++)if(-1!==r[o].strClass.indexOf("overwrite")){r[o].strCss=t,e=!0;break}e||r.push({strClass:"tchmi-theme overwrite "+controlName,strCss:t,elementInHead:null})}for(let e=0;e<r.length;e++)if(-1!==r[e].strClass.indexOf("overwrite"))if(null===r[e].elementInHead){if(!control||!control.getIsAttached()||!r[e].strClass)continue;let t=document.createElement("style");t.className=r[e].strClass,t.appendChild(document.createTextNode(r[e].strCss)),document.head.appendChild(t),r[e].elementInHead=t}else r[e].elementInHead.innerHTML=r[e].strCss}__serializeCss(styles){var e="";function t(selector,r,o=""){for(var property in e+=o+selector+" {\n",r)if(r.hasOwnProperty(property)&&void 0!==r[property]&&null!==r[property]&&"@-rules"!==property)if(selector.startsWith("@"))t(property,r[property],o+"\t");else for(var i=0,n=r[property].length;i<n;i++)void 0!==r[property][i]&&null!==r[property][i]&&""!==r[property][i]&&(e+=o+"\t"+property+": "+r[property][i]+";\n");e+=o+"}\n\n"}if(void 0!==styles["@-rules"])for(var r=0,o=styles["@-rules"].length;r<o;r++)e+=styles["@rules"][r]+";\n";for(var selector in e+="\n",styles)styles.hasOwnProperty(selector)&&void 0!==styles[selector]&&null!==styles[selector]&&"@-rules"!==selector&&0!==Object.keys(styles[selector]).length&&t(selector,styles[selector]);return e=e.trim()}expandSelector(selector,e){(e=tchmi_css_escape_selector(e)).startsWith(".")||e.startsWith("#")||(e="#"+e);for(var t=this.__splitOutsideOfBraces(selector,",",["(","["]),r=0,o=t.length;r<o;r++)-1===t[r].indexOf(e)&&(-1===t[r].indexOf("%id%")?t[r]=e+" "+t[r]:t[r]=t[r].replace("%id%",e));return t.join(", ").trim()}__splitOutsideOfBraces(value,e,t=["("]){for(var r=0,o=[],i=0,n=value.length;i<n;i++){var s=value.charAt(i);if(-1!==t.indexOf(s)){var l=this.__findMatchingBrace(value,i);l>i&&(i=l)}else if('"'===s||"'"===s){var c=this.__findMatchingQuote(value,i);c>i&&(i=c)}else s===e&&(i>r&&o.push(value.substring(r,i).trim()),r=i+1)}return(0===value.length||r<value.length)&&o.push(value.substring(r).trim()),o}__findMatchingBrace(value,e){var t=value.charAt(e),r="";switch(t){case"(":r=")";break;case"{":r="}";break;case"[":r="]";break;case"<":r=">";break;default:return-1}for(var o=0,i=e+1,n=value.length;i<n;i++)switch(value.charAt(i)){case t:o++;break;case r:if(0===o)return i;o--;break;case'"':case"'":var s=this.__findMatchingQuote(value,i);s>0&&(i=s)}return-1}__findMatchingQuote(value,e){for(var t=value.charAt(e),r=e+1,o=value.length;r<o;r++)switch(value.charAt(r)){case"\\":r++;break;case t:return r}return-1}processGenericStyle(controlName,selector,property,value=null){if(!selector){const t=e.Controls.get(controlName);if(void 0!==t&&0!==t.getElement().length){if(null==property)return;return void e.StyleProvider.setSimpleElementStyle(t.getElement(),property,value)}}selector=this.expandSelector(selector,controlName);var t=this.getExistingStyleOverwrites(controlName),r=this.__getExistingStyleOverwritesForSelector(t,selector);if("string"==typeof property)"string"==typeof value?""===value?delete r[property]:r[property]=[value]:null===value?delete r[property]:r[property]=value;else if(null!=property)for(const e in property)if(property.hasOwnProperty(e)){const t=property[e];"string"==typeof t?""===t?delete r[e]:r[e]=[t]:null===t?delete r[e]:r[e]=t}this.writeStyles(controlName,t)}processBackground(element,valueNew){let styles={};if(valueNew){let t=!1,r=!1,o=()=>{let o=null,i=null,n=e.StyleProvider.getSimpleElementStyle(element,"background-image")["background-image"],s=[];if(void 0!==n&&(s=this.__splitOutsideOfBraces(n,",")),void 0!==valueNew.image?o=null!==valueNew.image&&""!==valueNew.image?`url("${valueNew.image}")`:null:s.length>0&&s[0].startsWith("url(")&&(o=s[0]),void 0!==valueNew.color)i=null!==valueNew.color?e.isLinearGradientColor(valueNew.color)?e.StyleProvider.resolveLinearGradientColorAsCssValue(valueNew.color):"none":null;else if(s.length>0){let e=s.length>1?s[1]:s[0];(e.startsWith("linear-gradient(")||e.startsWith("radial-gradient("))&&(i=e)}if(t=null!==o,r=null!==i&&"none"!==i,null===o&&null===i)s.length>0&&(styles["background-image"]=null);else{let e=[];t&&e.push(o),(r||"none"===i&&!t&&null!==styles["background-color"])&&e.push(i),styles["background-image"]=e.length>0?e:null}},i=()=>{if(t){let e="auto",t="auto";if(void 0!==valueNew.imageWidth&&null!==valueNew.imageWidth&&(e=valueNew.imageWidth+(valueNew.imageWidthUnit||"px")),void 0!==valueNew.imageHeight&&null!==valueNew.imageHeight&&(t=valueNew.imageHeight+(valueNew.imageHeightUnit||"px")),void 0!==valueNew.imagePadding&&null!==valueNew.imagePadding){if("%"===valueNew.imageWidthUnit&&valueNew.imageWidth){let t="";valueNew.imagePadding.left>0&&(t+=" - "+valueNew.imagePadding.left*(valueNew.imageWidth?valueNew.imageWidth/100:1)+(valueNew.imagePadding.leftUnit||"px")),valueNew.imagePadding.right>0&&(t+=" - "+valueNew.imagePadding.right*(valueNew.imageWidth?valueNew.imageWidth/100:1)+(valueNew.imagePadding.rightUnit||"px")),""!==t&&(e=`calc(${e}${t})`)}if("%"===valueNew.imageHeightUnit&&valueNew.imageHeight){let e="";valueNew.imagePadding.top>0&&(e+=" - "+valueNew.imagePadding.top*(valueNew.imageHeight?valueNew.imageHeight/100:1)+(valueNew.imagePadding.topUnit||"px")),valueNew.imagePadding.bottom>0&&(e+=" - "+valueNew.imagePadding.bottom*(valueNew.imageHeight?valueNew.imageHeight/100:1)+(valueNew.imagePadding.bottomUnit||"px")),""!==e&&(t=`calc(${t}${e})`)}}styles["background-size"]=[e+" "+t],r&&styles["background-size"].push("auto auto")}else styles["background-size"]=null},n=()=>{if(t){let e="50%",t="50%";switch(valueNew.imageHorizontalAlignment){case"Left":e="0%";break;case"Center":e="50%";break;case"Right":e="100%"}switch(valueNew.imageVerticalAlignment){case"Top":t="0%";break;case"Center":t="50%";break;case"Bottom":t="100%"}if(void 0!==valueNew.imagePadding&&null!==valueNew.imagePadding){let r="";valueNew.imagePadding.left>0&&"Right"!==valueNew.imageHorizontalAlignment&&(r+=" + "+valueNew.imagePadding.left*("Center"===valueNew.imageHorizontalAlignment?.5:1)+(valueNew.imagePadding.leftUnit||"px")),valueNew.imagePadding.right>0&&"Left"!==valueNew.imageHorizontalAlignment&&(r+=" - "+valueNew.imagePadding.right*("Center"===valueNew.imageHorizontalAlignment?.5:1)+(valueNew.imagePadding.rightUnit||"px")),""!==r&&(e=`calc(${e}${r})`);let o="";valueNew.imagePadding.top>0&&"Bottom"!==valueNew.imageVerticalAlignment&&(o+=" + "+valueNew.imagePadding.top*("Center"===valueNew.imageVerticalAlignment?.5:1)+(valueNew.imagePadding.topUnit||"px")),valueNew.imagePadding.bottom>0&&"Top"!==valueNew.imageVerticalAlignment&&(o+=" - "+valueNew.imagePadding.bottom*("Center"===valueNew.imageVerticalAlignment?.5:1)+(valueNew.imagePadding.bottomUnit||"px")),""!==o&&(t=`calc(${t}${o})`)}styles["background-position"]=[e+" "+t],r&&styles["background-position"].push("50% 50%")}else styles["background-position"]=null},s=(name,value)=>{t?(styles[name]=[value],r&&styles[name].push(value)):styles[name]=null};(()=>{if(void 0!==valueNew.color)if(e.isSolidColor(valueNew.color)){let t=e.StyleProvider.resolveSolidColorAsCssValue(valueNew.color);styles["background-color"]=null!==t?[t]:null}else styles["background-color"]=null})(),o(),i(),n(),s("background-repeat","no-repeat"),s("background-attachment","scroll"),s("background-clip","border-box"),s("background-origin","padding-box")}else{let e=["color","image","size","position","repeat","origin","clip","attachment"];for(let t=0,r=e.length;t<r;t++)styles["background-"+e[t]]=null}let t={};for(let e in styles)styles.hasOwnProperty(e)&&(null===styles[e]?t[e]=null:t[e]=styles[e].join(", "));e.StyleProvider.setSimpleElementStyle(element,t)}processFillColor(element,valueNew){let t;if(element&&"object"==typeof element){if(void 0!==element.length){if(!element[0])return;t=element}else t=[element];for(let s=0,l=t.length;s<l;s++){const l=t[s];if(!(l instanceof l.ownerDocument.defaultView.SVGElement))continue;let c=l.ownerSVGElement||l,d=c.querySelector("defs");if(d){let t="",r=e.StyleProvider.getSimpleElementStyle(l,"fill").fill;if(r){t=r.replace(/url\('?"?\#|'?"?\)/g,"");let e=d.querySelectorAll("linearGradient.tchmi-styleprovider-linear-gradient");for(let r=0;r<e.length;r++){let o=e[r];if(t===o.id){o.parentElement.removeChild(o);break}}}}else e.isLinearGradientColor(valueNew)&&(d=l.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),c.insertBefore(d,c.firstElementChild));if(valueNew){if(e.isSolidColor(valueNew))l.style.fill=e.StyleProvider.resolveSolidColorAsCssValue(valueNew);else if(e.isLinearGradientColor(valueNew)){let e=valueNew,t=l.ownerDocument.createElementNS("http://www.w3.org/2000/svg","linearGradient");t.setAttribute("x1","0"),t.setAttribute("y1","1"),t.setAttribute("x2","0"),t.setAttribute("y2","0"),t.classList.add("tchmi-styleprovider-linear-gradient"),t.id="tchmi-styleprovider-"+tchmi_create_guid(),t.setAttribute("gradientTransform","rotate("+e.angle+", 0.5, 0.5)");for(var r=0,o=e.stopPoints.length;r<o;r++){let s=e.stopPoints[r];if(void 0===s.stop||null===s.stop)if(0===r)s.stop="0%";else if(r===o-1)s.stop="100%";else{let t=0;e.stopPoints[r-1].stop&&(t=parseFloat(e.stopPoints[r-1].stop));let o=null;for(var i=r+1,n=e.stopPoints.length;i<n;i++){let t=e.stopPoints[i].stop;if(null!=t){o=parseFloat(t);break}}null===o&&(o=100,i--);let l="";e.stopPoints[r-1].stop&&(l=e.stopPoints[r-1].stop.replace(/[0-9\.]/g,"")),s.stop=t+(o-t)/(i-r)+l}let l=document.createElementNS("http://www.w3.org/2000/svg","stop");l.setAttribute("offset",s.stop),l.setAttribute("stop-color",s.color),t.appendChild(l)}d.appendChild(t),l.style.fill="url(#"+t.id+")"}}else l.style.fill=""}}}processStrokeColor(element,valueNew){e.isSolidColor(valueNew)?e.StyleProvider.setSimpleElementStyle(element,"stroke",e.StyleProvider.resolveSolidColorAsCssValue(valueNew)):e.StyleProvider.setSimpleElementStyle(element,"stroke",null)}processTextColor(element,valueNew){e.isSolidColor(valueNew)?e.StyleProvider.setSimpleElementStyle(element,"color",e.StyleProvider.resolveSolidColorAsCssValue(valueNew)):e.StyleProvider.setSimpleElementStyle(element,"color",null)}processBorderColor(element,valueNew){let styles={};if(e.isSolidColor(valueNew))styles["border-color"]=e.StyleProvider.resolveSolidColorAsCssValue(valueNew),styles["border-image-source"]=null,styles["border-image-slice"]=null;else if(e.isLinearGradientColor(valueNew))styles["border-image-source"]=e.StyleProvider.resolveLinearGradientColorAsCssValue(valueNew),styles["border-image-slice"]="1",styles["border-color"]=null;else{let e=["color","image","image-source","image-slice"];for(let t=0,r=e.length;t<r;t++)styles["border-"+e[t]]=null}e.StyleProvider.setSimpleElementStyle(element,styles)}processBorderWidth(element,valueNew){const t=["top","right","bottom","left"];let r={};for(var o=0,i=t.length;o<i;o++)if(valueNew){let value=valueNew[t[o]];r["border-"+t[o]+"-width"]=null==value?"":value+"px"}else r["border-"+t[o]+"-width"]="";e.StyleProvider.setSimpleElementStyle(element,r)}processBorderRadius(element,valueNew){const t=["topLeft","topRight","bottomRight","bottomLeft"],r=["top-left","top-right","bottom-right","bottom-left"];let o={};for(var i=0,n=t.length;i<n;i++)if(valueNew){var value=valueNew[t[i]],s=valueNew[t[i]+"Unit"];s=s||"px",o[`border-${r[i]}-radius`]=null==value?"":value+s}else o[`border-${r[i]}-radius`]="";e.StyleProvider.setSimpleElementStyle(element,o)}processBorderStyle(element,valueNew){const t=["top","right","bottom","left"];let r={};for(var o=0,i=t.length;o<i;o++)if(valueNew){var value,n=valueNew[t[o]];switch(n){case"Solid":case"Dotted":case"Dashed":case"None":value=n.toLowerCase();break;default:value=""}r[`border-${t[o]}-style`]=value}else r[`border-${t[o]}-style`]="";e.StyleProvider.setSimpleElementStyle(element,r)}processBoxShadow(element,valueNew){if(valueNew)if(0===valueNew.length)e.StyleProvider.setSimpleElementStyle(element,"box-shadow","none");else{let t=[];for(let r=0,o=valueNew.length;r<o;r++){let o="";valueNew[r].inset&&(o+="inset "),valueNew[r].offsetX?o+=valueNew[r].offsetX+(valueNew[r].offsetXUnit||"px")+" ":o+="0px ",valueNew[r].offsetY?o+=valueNew[r].offsetY+(valueNew[r].offsetYUnit||"px")+" ":o+="0px ",valueNew[r].blur?o+=valueNew[r].blur+(valueNew[r].blurUnit||"px")+" ":o+="0px ",valueNew[r].spread?o+=valueNew[r].spread+(valueNew[r].spreadUnit||"px")+" ":o+="0px ",e.isSolidColor(valueNew[r].color)?o+=e.StyleProvider.resolveSolidColorAsCssValue(valueNew[r].color):o+="transparent",t.push(o)}e.StyleProvider.setSimpleElementStyle(element,"box-shadow",t.join(", "))}else e.StyleProvider.setSimpleElementStyle(element,"box-shadow",null)}processFontFamily(element,valueNew){e.StyleProvider.setSimpleElementStyle(element,"font-family",valueNew)}processFontSize(element,valueNew,unitNew){null==valueNew?e.StyleProvider.setSimpleElementStyle(element,"font-size",null):e.StyleProvider.setSimpleElementStyle(element,"font-size",valueNew+unitNew)}processFontStyle(element,valueNew){var value;switch(valueNew){case"Normal":case"Italic":case"Oblique":value=valueNew.toLowerCase();break;case"Auto":default:value=null}e.StyleProvider.setSimpleElementStyle(element,"font-style",value)}processFontWeight(element,valueNew){var value;switch(valueNew){case"Normal":case"Bold":value=valueNew.toLowerCase();break;case"Auto":default:value=null}e.StyleProvider.setSimpleElementStyle(element,"font-weight",value)}processVisibility(element,valueNew){let t={};switch(valueNew){case"Collapsed":t.display="none",t.visibility="";break;case"Hidden":t.display="",t.visibility="hidden";break;case"Visible":default:t.display="",t.visibility=""}e.StyleProvider.setSimpleElementStyle(element,t)}processContentHorizontalAlignment(element,valueNew){let t={};switch(valueNew){case"Center":t.display="flex",t["justify-content"]="center";break;case"Right":t.display="flex",t["justify-content"]="flex-end";break;case"Left":t.display="flex",t["justify-content"]="flex-start";break;default:t.display="",t["justify-content"]=""}e.StyleProvider.setSimpleElementStyle(element,t)}processContentVerticalAlignment(element,valueNew){let t={};switch(valueNew){case"Center":t.display="flex",t["align-items"]="center";break;case"Bottom":t.display="flex",t["align-items"]="flex-end";break;case"Top":t.display="flex",t["align-items"]="flex-start";break;default:t.display="",t["align-items"]=""}e.StyleProvider.setSimpleElementStyle(element,t)}processContentPadding(element,valueNew){const t=["top","right","bottom","left"];let r={};for(var o=0,i=t.length;o<i;o++)if(valueNew){var value=valueNew[t[o]],n=valueNew[t[o]+"Unit"];n=n||"px",r["padding-"+t[o]]=null==value?"":value+n}else r["padding-"+t[o]]="";e.StyleProvider.setSimpleElementStyle(element,r)}processTransform(element,valueNew,order){let t={};if(void 0===order&&(t={"transform-origin":"","-webkit-transform-origin":"",perspective:"","-webkit-perspective":"","perspective-origin":"","-webkit-perspective-origin":""}),valueNew){for(var r,o=[],i=0,n=(r=Array.isArray(valueNew)?valueNew:[valueNew]).length;i<n;i++){var s="",l=r[i];switch(l.transformType){case"Translate":l.x=l.x||0,l.xUnit=l.xUnit||"px",l.y=l.y||0,l.yUnit=l.yUnit||"px",l.z=l.z||0,l.zUnit=l.zUnit||"px",s="translate3d("+l.x+l.xUnit+", "+l.y+l.yUnit+", "+l.z+l.zUnit+")";break;case"Rotate":s=void 0===l.vector?"rotate(":`rotate3d(${l.vector.x}, ${l.vector.y}, ${l.vector.z}, `,s+=l.angle+(void 0!==l.angleUnit?l.angleUnit:"deg"),s+=")";break;case"Scale":s="scale3d(",s+=(void 0!==l.x?l.x:1)+", ",s+=(void 0!==l.y?l.y:1)+", ",s+=void 0!==l.z?l.z:1,s+=")";break;case"Skew":for(var c=[l.xAngle,l.yAngle],d=[l.xAngleUnit,l.xAngleUnit],_=0,m=c.length;_<m;_++)switch(c[_]=c[_]||0,d[_]){case"grad":c[_]=c[_]*(Math.PI/200);break;case"turn":c[_]=c[_]*(Math.PI/.5);break;case"rad":break;case"deg":default:c[_]=c[_]*(Math.PI/180)}s=`matrix(1, ${Math.tan(c[1])}, ${Math.tan(c[0])}, 1, 0, 0)`;break;case"Origin":void 0===l.x&&(l.x=50,l.xUnit="%"),void 0===l.y&&(l.y=50,l.yUnit="%"),void 0===l.z&&(l.z=0,l.zUnit=void 0),t["-webkit-transform-origin"]=l.x+(void 0!==l.xUnit?l.xUnit:"px")+" "+l.y+(void 0!==l.yUnit?l.yUnit:"px")+" "+l.z+(void 0!==l.zUnit?l.zUnit:"px"),t["transform-origin"]=t["-webkit-transform-origin"];break;case"Perspective":t["-webkit-perspective"]=l.distance+(void 0!==l.distanceUnit?l.distanceUnit:"px"),t.perspective=t["-webkit-perspective"],void 0!==l.origin&&(void 0===l.origin.x&&(l.origin.x=50,l.origin.xUnit="%"),void 0===l.origin.y&&(l.origin.y=50,l.origin.yUnit="%"),t["-webkit-perspective-origin"]=l.origin.x+(void 0!==l.origin.xUnit?l.origin.xUnit:"px")+" "+l.origin.y+(void 0!==l.origin.yUnit?l.origin.yUnit:"px"),t["perspective-origin"]=t["-webkit-perspective-origin"])}o.push(s)}t["-webkit-transform"]=o.join(" "),t.transform=t["-webkit-transform"]}else t["-webkit-transform"]="",t.transform="";e.StyleProvider.setSimpleElementStyle(element,t)}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r{}r.Raw=new Map,r.Resolved=new Map,t.SharedCache=r;t.TypeManager=class{constructor(){this.__error=e.Errors.NONE,this.__watching=!1,this.__subscrId=null,this.__subscrCommands=[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"GetDefinitions",writeValue:{resolve:"None",type:"general"}},{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"GetDefinitions",writeValue:{resolve:"None",type:"framework"}},{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"GetDefinitions",writeValue:{resolve:"None",type:"server"}},{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"GetDefinitions",writeValue:{resolve:"None",type:"project"}}],this.__hasCalledInitCallbackOnce=!1,this.__typesInitializing={general:!0,server:!0,framework:!0,project:!0},e.EventProvider.register("onWebSocketOpened",this.__onWebSocketOpened()),e.EventProvider.register("onWebSocketClosed",this.__onWebSocketClosed())}__onWebSocketOpened(){let t=this;return function(event,data){!0===t.__hasCalledInitCallbackOnce&&t.__error!==e.Errors.NONE&&(t.__error=e.Errors.NONE,t.doWatchSchemaDefinitions())}}__onWebSocketClosed(){let t=this;return function(event,data){t.__error=e.Errors.E_WEBSOCKET_NOT_READY}}__cacheRawSchemaDefinitions(e,t){void 0!==e.definitions&&r.Raw.set(t,e)}__processGetDefinitionsResponse(data){if(this.__error!==e.Errors.NONE)return{code:this.__error,message:e.Errors[this.__error],domain:"TcHmi.System.Type.TypeManager"};if(!data)return{code:e.Errors.ERROR,reason:"Failed to resolve types due to invalid response. Missing data.",domain:"TcHmi.System.Type.TypeManager"};if(data.error!==e.Errors.NONE)return data.details?data.details:{code:data.error};let t=data.response;if(!t)return{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.System.Type.TypeManager"};if(t.error)return{code:e.Errors.E_SERVER_RESPONSE_ERROR,reason:"Error in response from server with id: '"+t.id+"'.",domain:"TcHmi.System.Type.TypeManager",errors:[t.error]};let commands=t.commands;if(!commands)return{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+t.id+"'.",domain:"TcHmi.System.Type.TypeManager"};let o=!(Object.keys(this.__typesInitializing).length>0);for(let r=0,o=commands.length;r<o;r++){let o=commands[r];if(!o)return{code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: 'GetDefinitions' in response from server with id: '"+t.id+"'.",domain:"TcHmi.System.Type.TypeManager"};if(o.error)return{code:e.Errors.E_SERVER_COMMAND_ERROR,reason:"Error in command for symbol: 'GetDefinitions' in response from server with id: '"+t.id+"'.",domain:"TcHmi.System.Type.TypeManager",errors:[o.error]};let i=o.writeValue;if(!i){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Type.TypeManager] Failed to resolve type due to invalid response command for symbol="+o.symbol+". Missing writeValue property.");continue}if(!i.type){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Type.TypeManager] Failed to resolve type due to invalid response command for symbol="+o.symbol+". Missing type property in writeValue.");continue}let n=o.readValue;if(n)switch(i.type){case"general":this.__cacheRawSchemaDefinitions(n,i.type),delete this.__typesInitializing.general;break;case"framework":this.__cacheRawSchemaDefinitions(n,i.type),delete this.__typesInitializing.framework;break;case"server":this.__cacheRawSchemaDefinitions(n,i.type),delete this.__typesInitializing.server;break;case"project":this.__cacheRawSchemaDefinitions(n,i.type),delete this.__typesInitializing.project}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Type.TypeManager] Failed to resolve types for namespace="+i.type+" due to invalid response command for symbol="+o.symbol+". Missing readValue property.")}let i=Object.keys(this.__typesInitializing);if(i.length>0)return{code:e.Errors.ERROR,reason:"Failed to resolve type definitions for namespace="+i.join(", "),domain:"TcHmi.System.Type.TypeManager"};if(o){let t=[];r.Resolved.forEach((value,e)=>{t.push(e)}),r.Resolved.clear();for(let r=0,o=t.length;r<o;r++){let o=t[r],i=this.getSchemaEx(o);i.error===e.Errors.NONE&&(e.EventProvider.raise("System.onTypeDefinitionChanged<"+o+">",{typeId:o,typeSchema:i.schema}),e.EventProvider.raise("System.onTypeDefinitionChanged",{typeId:o,typeSchema:i.schema}))}}return{code:e.Errors.NONE}}doWatchSchemaDefinitions(callback){if(this.__watching)return void e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,reason:"Multiple calls to watch for type definition change detected.",domain:"TcHmi.System.Type.TypeManager"}});if(!1===e.Server.isWebsocketReady())return void e.Callback.callSafe(callback,this,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,reason:"Websocket connection not ready.",domain:"TcHmi.System.Type.TypeManager"}});let t=this,interval=5e3;TCHMI_ENGINEERING&&(interval=1e3),this.__watching=!0;let r=e.System.config.tcHmiServer.websocketSystemTimeout;this.__subscrId=e.Server.subscribeEx(this.__subscrCommands,interval,{timeout:r},(function(data){let error=t.__processGetDefinitionsResponse(data);t.__hasCalledInitCallbackOnce||(e.Callback.callSafe(callback,t,{error:error.code,details:error}),t.__hasCalledInitCallbackOnce=!0)}))}doForceSchemaDefinitions(callback){let t=this,r=e.System.config.tcHmiServer.websocketSystemTimeout;e.Server.requestEx({requestType:"ReadWrite",commands:this.__subscrCommands},{timeout:r},(function(data){let error=t.__processGetDefinitionsResponse(data);e.Callback.callSafe(callback,t,{error:error.code,details:error})}))}getSchema(id){let t=this.getSchemaEx(id);return t.error===e.Errors.NONE&&t.schema?t.schema:null}getSchemaEx(id){let t;try{t=o.Helper.__resolveRawSchemaDefinition(id,null,new Map)}catch(r){t={error:e.Errors.E_EXCEPTION,details:{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r,domain:"TcHmi.System.Type.TypeManager"}}}return t}};class o{static resolveRefs(schema,e){return e||(e=null),o.Helper.__resolveRawSchema(schema,e,new Map).schema}static resolveType(schema){if(schema.convert)return;let e=schema.type;if(!e){let t=schema.oneOf;if(t||(t=schema.anyOf),t){e=[];for(let r=0,i=t.length;r<i;r++){let i=t[r];if(!i.convert){let t=o.resolveType(i);if(Array.isArray(t))for(let r=0,o=t.length;r<o;r++)-1===e.indexOf(t[r])&&e.push(t[r]);else t&&-1===e.indexOf(t)&&e.push(t)}}0===e.length?e=void 0:1===e.length&&(e=e[0])}else e=["string","number","object","boolean","integer","array","null"]}return e}static resolveTypeConversionRules(schema){let e=new Map;if(schema.type&&"string"==typeof schema.type){let t=schema.convert;t&&e.set(schema.type,{convert:t,enum:schema.enum})}else if(schema.type&&Array.isArray(schema.type)){let t=schema.convert;if(t)for(let r=0,o=schema.type.length;r<o;r++)e.set(schema.type[r],{convert:t,enum:schema.enum})}else{let t=schema.oneOf;if(t||(t=schema.anyOf),t)for(let r=0,i=t.length;r<i;r++){let i=o.resolveTypeConversionRules(t[r]);i&&i.forEach((value,t)=>{e.set(t,value)})}else{let t=["string","number","object","boolean","integer","array","null"],r=schema.convert;if(r)for(let o=0,i=t.length;o<i;o++)e.set(t[o],{convert:r,enum:schema.enum})}}return e}static resolveDefault(schema){if(!schema)return null;let t,r=o.resolveTypeConversionRules(schema);if(schema.default)return tchmi_clone_object(e.ValueConverter.toSchemaType(schema.default,schema));if(schema.type)if(Array.isArray(schema.type)){let e=schema.type[0];e&&(t=e)}else t=schema.type;if(t&&r){let e=r.get(t);e&&e.convert&&(t=e.convert)}switch(t){case"object":{let e={},t=schema.properties;if(t)for(let property in t){let r=t[property];e[property]=o.resolveDefault(r)}return e}case"array":{let e=[],t=schema.items;if(t&&schema.minItems){let r;r=Array.isArray(t)?t[0]:t;let value=o.resolveDefault(r);for(let t=0;t<schema.minItems;t++)e.push(value)}return e}case"string":return"";case"integer":case"number":return 0;case"boolean":return!1}return schema.oneOf?o.resolveDefault(schema.oneOf[0]):schema.anyOf?o.resolveDefault(schema.anyOf[0]):null}}t.Schema=o,function(t){class o{static __resolveRawSchemaDefinitionPart(obj,t,path,o){t?o.set("tchmi:"+t+"#"+path,null):o.set("#"+path,null);let i=Object.keys(obj);for(let n=0,s=i.length;n<s;n++){let s=i[n],l=obj[s];if(s&&l){if("$ref"===s){let i,n=!1;if(o.has(l))n=!0;else if(0===l.indexOf("#")){let e="tchmi:"+t+l;o.has(e)&&(n=!0)}if(n)return i=obj,{error:e.Errors.NONE,part:i};if(r.Resolved.has(l)&&(i=r.Resolved.get(l)),!i){let r=new Map;o.forEach((value,e)=>{r.set(e,value)});let n=this.__resolveRawSchemaDefinition(l,t,r);if(!n||n.error!==e.Errors.NONE)return n;i=n.schema}let s=tchmi_clone_object(i);return s.id=l,{error:e.Errors.NONE,part:s}}if("allOf"===s){let r={};for(let i=0,n=l.length;i<n;i++){let n=l[i],s=new Map;o.forEach((value,e)=>{s.set(e,value)});let newPath=path+"/allOf/"+i;s.set("tchmi:"+t+"#"+path,null);let c=this.__resolveRawSchemaDefinitionPart(n,t,newPath,s);if(c.error!==e.Errors.NONE)return c;let d=Object.keys(c.part);for(let e=0,t=d.length;e<t;e++){let t=d[e];r[t]=c.part[t]}}return{error:e.Errors.NONE,part:r}}if("object"==typeof l){let r=new Map;o.forEach((value,e)=>{r.set(e,value)});let newPath=path+"/"+s;r.set("tchmi:"+t+"#"+path,null);let i=this.__resolveRawSchemaDefinitionPart(l,t,newPath,r);if(i.error!==e.Errors.NONE)return i;obj[s]=i.part}}}return{error:e.Errors.NONE,part:obj}}static __resolveRawSchemaDefinition(id,t,i){let schema=r.Resolved.get(id);if(schema)return{error:e.Errors.NONE,schema:schema};if(id.startsWith("tchmi:")){let t=id.indexOf("#");if(-1===t)return{error:e.Errors.E_SCHEMA_INVALID_REF_ID,details:{code:e.Errors.E_SCHEMA_INVALID_REF_ID,message:e.Errors[e.Errors.E_SCHEMA_INVALID_REF_ID],reason:"Reference id: '"+id+"' is not valid. Missing '#'.",domain:"TcHmi.System.Type.TypeManager"}};let n=id.substr(6,t-6);if(!n)return{error:e.Errors.E_SCHEMA_INVALID_REF_ID,details:{code:e.Errors.E_SCHEMA_INVALID_REF_ID,message:e.Errors[e.Errors.E_SCHEMA_INVALID_REF_ID],reason:"Reference id: '"+id+"' is not valid. Missing name of file between 'tchmi:' and '#'.",domain:"TcHmi.System.Type.TypeManager"}};let s=r.Raw.get(n);if(!s)return{error:e.Errors.E_SCHEMA_UNKNOWN_FILE,details:{code:e.Errors.E_SCHEMA_UNKNOWN_FILE,message:e.Errors[e.Errors.E_SCHEMA_UNKNOWN_FILE],reason:"Can't find file for filename: '"+n+"' like targeted within ref: '"+id+"'.",domain:"TcHmi.System.Type.TypeManager"}};let path=id.substr(t+2,id.length-t+2),l=path.split("/"),c=s;for(let e=0;e<l.length&&c;e++){c=c[l[e]]}if(!c)return{error:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,details:{code:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,message:e.Errors[e.Errors.E_SCHEMA_UNKNOWN_DEFINITION],reason:"Can't find definition for path: '"+path+"' in file: '"+n+"' like targeted within ref: '"+id+"'.",domain:"TcHmi.System.Type.TypeManager"}};let d=tchmi_clone_object(c),_=new Map;i.forEach((value,e)=>{_.set(e,value)}),_.set(id,null);let m=o.__resolveRawSchemaDefinitionPart(d,n,"/"+path,_);return m.error!==e.Errors.NONE?m:(m.part.id=id,r.Resolved.set(id,m.part),{error:e.Errors.NONE,schema:m.part})}if(id.startsWith("#")&&t){let n=id.indexOf("#");if(-1===n)return{error:e.Errors.E_SCHEMA_INVALID_REF_ID,details:{code:e.Errors.E_SCHEMA_INVALID_REF_ID,message:e.Errors[e.Errors.E_SCHEMA_INVALID_REF_ID],reason:"Reference id: '"+id+"' is not valid. Missing '#'.",domain:"TcHmi.System.Type.TypeManager"}};let s=r.Raw.get(t);if(!s)return{error:e.Errors.E_SCHEMA_UNKNOWN_FILE,details:{code:e.Errors.E_SCHEMA_UNKNOWN_FILE,message:e.Errors[e.Errors.E_SCHEMA_UNKNOWN_FILE],reason:"Can't find file for filename: '"+t+"' like targeted within ref: '"+id+"'.",domain:"TcHmi.System.Type.TypeManager"}};let path=id.substr(n+2,id.length-n+2),l=path.split("/"),c=s;for(let e=0;e<l.length&&c;e++){c=c[l[e]]}if(!c)return{error:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,details:{code:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,message:e.Errors[e.Errors.E_SCHEMA_UNKNOWN_DEFINITION],reason:"Can't find definition for path: '"+path+"' in file: '"+t+"' like targeted within ref: '"+id+"'.",domain:"TcHmi.System.Type.TypeManager"}};let d=tchmi_clone_object(c),_=s.id+id.replace("#","/");_=_.replace(/\/\//g,"/"),d.id=_;let m=new Map;i.forEach((value,e)=>{m.set(e,value)}),m.set(id,null);let u=o.__resolveRawSchemaDefinitionPart(d,t,"/"+path,m);return u.error!==e.Errors.NONE?u:{error:e.Errors.NONE,schema:u.part}}return{error:e.Errors.E_SCHEMA_INVALID_REF_ID,details:{code:e.Errors.E_SCHEMA_INVALID_REF_ID,message:e.Errors[e.Errors.E_SCHEMA_INVALID_REF_ID],reason:"Reference id: '"+id+"' is not valid.",domain:"TcHmi.System.Type.TypeManager"}}}static __resolveRawSchema(schema,t,r){let i=tchmi_clone_object(schema),n=new Map;r.forEach((value,e)=>{n.set(e,value)});let s=o.__resolveRawSchemaDefinitionPart(i,t,"",n);return s.error!==e.Errors.NONE?s:(t&&s.part&&s.part.id&&-1===s.part.id.indexOf("tchmi:")&&(s.part.id="tchmi:"+t+s.part.id),{error:e.Errors.NONE,schema:s.part})}}t.Helper=o}(o=t.Schema||(t.Schema={}))}(r=t.Type||(t.Type={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){let r;!function(e){e[e.Invalid=0]="Invalid",e[e.Ready=10]="Ready",e[e.Destroyed=20]="Destroyed"}(r=t.SymbolState||(t.SymbolState={}));class o{constructor(expression){if(this.__diagGUID="",this.__expression=null,this.__state=r.Invalid,this.__schema=null,this.__destroyTypeDefinitionChanged=null,TCHMI_CONSOLE_LOG_LEVEL>=4&&(this.__diagGUID=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor called with:",{expression:expression}),this.__expression=new e.SymbolExpression(expression),this.__expression.getType()===e.SymbolType.Invalid){let message="Expression: '"+expression+"' is not a valid symbol expression.";throw TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new SyntaxError(message)}this.__state=r.Ready}static resolveServerSymbolSchemaCache(callback){let t=this;e.Server.requestEx({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:"ListSymbols"}]},null,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,t,{error:data.error,details:data.details});else{let r=data.results[0];e.Callback.callSafe(callback,t,{error:r.error,details:r.details})}},success:data=>{let r=data.results[0].value;if(r){for(let o in r){let i=r[o].SCHEMA;if(i){let r=e.System.Type.Schema.Helper.__resolveRawSchema(i,null,new Map);r.error===e.Errors.NONE&&(t.__SERVER_SYMBOL_SCHEMA_CACHE[o]=r.schema)}}e.Callback.callSafe(callback,t,{error:e.Errors.NONE})}else e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_READVALUE_MISSING,details:{code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"ListSymbols has no valid content.",domain:"TcHmi.System.Symbol"}})}}))}__onTypeDefinitionChanged(){let t=this;return function(r,data){t.__schema=null;let o=e.System.Services.typeManager.getSchema(data.typeId);o&&t.resolveSubSchema(o,t.__expression.getPathTokens(),(function(data){data.error===e.Errors.NONE&&(t.__schema=tchmi_clone_object(data.schema))}))}}getExpression(){return this.__expression}getState(){return this.__state}isDestroyed(){return this.__state===r.Destroyed}isReady(){return this.__state===r.Ready}destroy(){if(this.isDestroyed())return void(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called and aborted because object is already marked as destroyed."));let t=this.__expression.toString();TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+t+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called."),this.__destroyTypeDefinitionChanged&&(this.__destroyTypeDefinitionChanged(),this.__destroyTypeDefinitionChanged=null),this.__expression=null,this.__state=r.Destroyed,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+t+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy finished.")}__readSubValue(obj,t,callback){if(!obj||"object"!=typeof obj)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because current value is not a valid object. Are all default values and written values valid for this schema?",domain:"TcHmi.System.Symbol"}});let r=obj,o=tchmi_clone_object(t),i="",n=o.shift();for(;;){let t=!1;if(n.startsWith("[")&&n.endsWith("]")&&(t=!0,n=n.replace("[","").replace("]","")),void 0===r[n])return void e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because the token: '"+n+"' does not exist below path: '"+this.__expression.getName()+i+"' in current value.",domain:"TcHmi.System.Symbol"}});if(!(o.length>0))break;r=r[n],i+=t?"["+n+"]":"::"+n,n=o.shift()}void 0!==r[n]?e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:r[n]}):e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because the token: '"+n+"' does not exist below path: '"+this.__expression.getName()+i+"' in current value.",domain:"TcHmi.System.Symbol"}})}__writeSubValue(obj,value,t,callback){if(!obj||"object"!=typeof obj)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because current value is not a valid object. Are all default values and written values valid for this schema?",domain:"TcHmi.System.Symbol"}});let r=obj,o=tchmi_clone_object(t),i="",n=o.shift();for(;;){let t=!1;if(n.startsWith("[")&&n.endsWith("]")&&(t=!0,n=n.replace("[","").replace("]","")),void 0===r[n])return void e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because the token: '"+n+"' does not exist below path: '"+this.__expression.getName()+i+"' in current value.",domain:"TcHmi.System.Symbol"}});if(!(o.length>0))break;r=r[n],i+=t?"["+n+"]":"::"+n,n=o.shift()}void 0!==r[n]?(r[n]=value,e.Callback.callSafe(callback,this,{error:e.Errors.NONE})):e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:this.__expression.toString()+": Failed to read value by path because the token: '"+n+"' does not exist below path: '"+this.__expression.getName()+i+"' in current value.",domain:"TcHmi.System.Symbol"}})}resolveSubSchema(schema,t,callback){let r=schema,o="",i=tchmi_clone_object(t);if(t&&0!==t.length)if(null!=r&&"object"==typeof r){for(;i.length>0;){let t=i.shift();if(r&&"TcHmi.Controls.System.TcHmiControl"===r.frameworkInstanceOf)if(r.frameworkUserControlConfig){let o=e.System.Services.controlManager.getUserControlConfigAttributeByPropertyName(r.frameworkUserControlConfig,t);if(!o){r=null;break}if(r=e.Type.getSchema(o.type),0===i.length)break}else{let o=e.System.Services.controlManager.getDescriptionAttributeByPropertyName(r.frameworkControlType,t);if(!o){r=null;break}if(r=e.Type.getSchema(o.type),0===i.length)break}if(r&&"TcHmi.Controls.System.TcHmiControl"===r.frameworkInstanceOf)continue;let n=[],s=t.split(""),l=0;for(;s.length>0;){let e=s.shift();"["===e&&void 0!==n[l]&&n[l].length>0&&l++,void 0===n[l]&&(n[l]=""),n[l]=n[l]+e,"]"===e&&l++}let c=!1;for(;n.length>0;){let e=n.shift();if(e.match(/\[*.\]/g)){if(void 0!==r.items&&"object"==typeof r.items&&!Array.isArray(r.items)){r=r.items,c=!0,o+="["+t+"]";continue}}else if(void 0!==r.properties&&"object"==typeof r.properties&&!1===Array.isArray(r.properties)){if(void 0!==r.properties[e]){r=r.properties[e],c=!0,o+="::"+t;continue}}else void 0!==r.additionalProperties&&"object"==typeof r.additionalProperties&&!1===Array.isArray(r.additionalProperties)&&(r=r.additionalProperties,c=!0,o+="::"+t)}if(!1===c)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_SCHEMA_INVALID_PATH,details:{code:e.Errors.E_SCHEMA_INVALID_PATH,message:e.Errors[e.Errors.E_SCHEMA_INVALID_PATH],reason:this.__expression.toString()+", Failed to read schema by path because token: '"+t+"' does not exist below path: '"+o+"' in schema with id: '"+schema.id+"'.",domain:"TcHmi.System.Symbol"}})}null!=r&&"object"==typeof r?e.Callback.callSafe(callback,this,{error:e.Errors.NONE,schema:r}):e.Callback.callSafe(callback,this,{error:e.Errors.E_SCHEMA_INVALID,details:{code:e.Errors.E_SCHEMA_INVALID,message:e.Errors[e.Errors.E_SCHEMA_INVALID],reason:this.__expression.toString()+", Failed to read schema by path because there is no valid schema below path: '"+o+"' in schema with id: '"+schema.id+"'.",domain:"TcHmi.System.Symbol"}})}else e.Callback.callSafe(callback,this,{error:e.Errors.E_SCHEMA_INVALID,details:{code:e.Errors.E_SCHEMA_INVALID,message:e.Errors[e.Errors.E_SCHEMA_INVALID],reason:this.__expression.toString(),domain:"TcHmi.System.Symbol"}});else e.Callback.callSafe(callback,this,{error:e.Errors.NONE,schema:r})}resolveSchema(callback){let r=this;if(null!==this.__schema)return void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:this.__schema});let i=this.__expression.getType();if(i===e.SymbolType.Server){let schema,name=this.__expression.getName(),i=()=>{if(schema=o.__SERVER_SYMBOL_SCHEMA_CACHE[name],!schema){let i,n,s,l=r.__expression.toString().match(e.SymbolExpression.RegExpExpression);if(null!=l&&3===l.length){let r=l[2].match(e.SymbolExpression.RegExpExpressionGroupByPipe);if(null!=r&&r.length>0){let e=r[0].indexOf("["),o=r[0].indexOf("::"),l=-1;l=-1===e?o:-1===o||e<o?e:o,-1!==l?(i=r[0].substring(0,l),n=r[0].substring(l),s=t.resolveSymbolPathToTokenArray(n)):(i=r[0],n="")}}let c=o.__SERVER_SYMBOL_SCHEMA_CACHE[i];c&&r.resolveSubSchema(c,s,(function(data){data&&data.error===e.Errors.NONE&&(schema=data.schema)}))}},n=()=>schema?(this.__schema=schema,this.__destroyTypeDefinitionChanged&&(this.__destroyTypeDefinitionChanged(),this.__destroyTypeDefinitionChanged=null),this.__schema.id&&(this.__destroyTypeDefinitionChanged=e.EventProvider.register("System.onTypeDefinitionChanged<"+this.__schema.id+">",this.__onTypeDefinitionChanged())),void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,schema:schema})):(r.__destroyTypeDefinitionChanged&&(r.__destroyTypeDefinitionChanged(),r.__destroyTypeDefinitionChanged=null),void e.Callback.callSafe(callback,r,{error:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,details:{code:e.Errors.E_SCHEMA_UNKNOWN_DEFINITION,message:e.Errors[e.Errors.E_SCHEMA_UNKNOWN_DEFINITION],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}}));i(),schema?n():o.resolveServerSymbolSchemaCache(data=>{i(),n()})}else{if(i!==e.SymbolType.Internal){if(i===e.SymbolType.LocalizedText){let schema=e.System.Services.typeManager.getSchema("tchmi:general#/definitions/String");return schema?(this.__schema=schema,void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:this.__schema})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}if(i===e.SymbolType.Function)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});if(i===e.SymbolType.Control){let name=this.__expression.getName(),t=this.__expression.getPathTokens(),control=e.Controls.get(name);if(!control)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:r.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"}});let propertyName=null;if(t&&t.length>0){let o=tchmi_clone_object(t);propertyName=o.shift();let i=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName);if(null==i)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});{let t=e.System.Services.typeManager.getSchema(i.type);return t?void r.resolveSubSchema(t,o,(function(data){if(data.error===e.Errors.NONE){let schema=tchmi_clone_object(data.schema);return schema?(r.__schema=schema,r.__destroyTypeDefinitionChanged&&(r.__destroyTypeDefinitionChanged(),r.__destroyTypeDefinitionChanged=null),r.__destroyTypeDefinitionChanged=e.EventProvider.register("System.onTypeDefinitionChanged<"+i.type+">",r.__onTypeDefinitionChanged()),void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:r.__schema})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}}return void e.Callback.callSafe(callback,r,{error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}if(i===e.SymbolType.PartialParam){let name=this.__expression.getName(),t=tchmi_clone_object(this.__expression.getPathTokens()),o=!1;"TCHMI_TARGET_DESIGNER_PARTIALPARAM"===name&&(o=!0);let propertyName=null,i=null,n=null;if(!t)return void(o?e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: TCHMI_TARGET_DESIGNER_PARTIALPARAM::Parameter",domain:"TcHmi.System.Symbol"}}):e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: UserControlHost::Parameter",domain:"TcHmi.System.Symbol"}}));if(propertyName=t.shift(),o){if(n=e.System.Services.Engineering.designerModeManager.userControlParameterManager.get(propertyName),!n)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});i=n.descr}else{let control=e.Controls.get(name);if(!control)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:r.__expression.toString()+", Can't find control instance with id: "+name+".",domain:"TcHmi.System.Symbol"}});i=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName)}if(null==i)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});{let o=e.System.Services.typeManager.getSchema(i.type);return o?void r.resolveSubSchema(o,t,(function(data){if(data.error===e.Errors.NONE){let schema=tchmi_clone_object(data.schema);return schema?(r.__schema=schema,r.__destroyTypeDefinitionChanged&&(r.__destroyTypeDefinitionChanged(),r.__destroyTypeDefinitionChanged=null),r.__destroyTypeDefinitionChanged=e.EventProvider.register("System.onTypeDefinitionChanged<"+i.type+">",r.__onTypeDefinitionChanged()),void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:r.__schema})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}}if(i===e.SymbolType.TemplateParam){let name=this.__expression.getName(),o=this.__expression.getPathTokens(),i=t.Services.templateParamSymbolManager.get(name);if(!i||!i.type)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});let n=e.System.Services.typeManager.getSchema(i.type);return n?void r.resolveSubSchema(n,o,(function(data){if(data.error===e.Errors.NONE){let schema=tchmi_clone_object(data.schema);return schema?(r.__schema=schema,r.__destroyTypeDefinitionChanged&&(r.__destroyTypeDefinitionChanged(),r.__destroyTypeDefinitionChanged=null),r.__destroyTypeDefinitionChanged=e.EventProvider.register("System.onTypeDefinitionChanged<"+i.type+">",r.__onTypeDefinitionChanged()),void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:r.__schema})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}return void e.Callback.callSafe(callback,r,{error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}{let name=this.__expression.getName(),t=this.__expression.getPathTokens();e.System.Services.internalSymbolManager.getType(name,(function(data){if(data.error===e.Errors.NONE){let o=data.type,i=e.System.Services.typeManager.getSchema(o);return i?void r.resolveSubSchema(i,t,(function(data){if(data.error===e.Errors.NONE){let schema=tchmi_clone_object(data.schema);return schema?(r.__schema=schema,r.__destroyTypeDefinitionChanged&&(r.__destroyTypeDefinitionChanged(),r.__destroyTypeDefinitionChanged=null),r.__destroyTypeDefinitionChanged=e.EventProvider.register("System.onTypeDefinitionChanged<"+o+">",r.__onTypeDefinitionChanged()),void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,schema:r.__schema})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.E_UNKNOWN_TYPE,details:{code:e.Errors.E_UNKNOWN_TYPE,message:e.Errors[e.Errors.E_UNKNOWN_TYPE],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}})}e.Callback.callSafe(callback,r,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0}})}))}}}resolveAttributes(callback){this.resolveSchema(data=>{data.error===e.Errors.NONE?data.schema&&data.schema.attributes?e.Callback.callSafe(callback,this,{error:e.Errors.NONE,attributes:tchmi_clone_object(data.schema.attributes)}):e.Callback.callSafe(callback,this,{error:e.Errors.NONE,attributes:{}}):e.Callback.callSafe(callback,this,{error:data.error,details:data.details})})}resolveAttribute(name,callback){this.resolveAttributes(data=>{data.error===e.Errors.NONE?data.attributes&&void 0!==data.attributes[name]?e.Callback.callSafe(callback,this,{error:e.Errors.NONE,name:name,value:tchmi_clone_object(data.attributes[name])}):e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN_ATTRIBUTE,details:{code:e.Errors.E_SYMBOL_UNKNOWN_ATTRIBUTE,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN_ATTRIBUTE],reason:this.__expression.toString(),domain:"TcHmi.System.Symbol"}}):e.Callback.callSafe(callback,this,{error:data.error,details:data.details})})}read(callback){var t,r;let o="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(o=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(t=this.__expression)||void 0===t?void 0:t.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read called.");let i=null,n=this.__expression.getType();if(n===e.SymbolType.Server)i=this.__readSymbolTypeServer(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.Internal)this.__readSymbolTypeInternal(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.LocalizedText)this.__readSymbolTypeLocalizedText(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.Function)this.__readSymbolTypeFunction(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.Control)this.__readSymbolTypeControl(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.PartialParam)this.__readSymbolTypePartialParam(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else if(n===e.SymbolType.TemplateParam)this.__readSymbolTypeTemplateParam(data=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(t=this.__expression)||void 0===t?void 0:t.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",{data:data}),e.Callback.callSafe(callback,this,data)});else{let t={error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:this.__expression.toString(),domain:"TcHmi.System.Symbol"}};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read finished with:",t),e.Callback.callSafe(callback,this,t)}return()=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(t=this.__expression)||void 0===t?void 0:t.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] read destroy called."),i&&i()}}__readSymbolTypeServer(callback){let t=this,r=this.__expression.getName();if(TCHMI_DESIGNER)return this.resolveSchema(data=>{if(data.error===e.Errors.NONE){let value=e.Type.Schema.resolveDefault(data.schema);e.Callback.callSafe(callback,t,{error:e.Errors.NONE,value:value})}else e.Callback.callSafe(callback,t,{error:data.error,details:data.details})}),()=>{};{let message={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:r}]},o=this.__expression.getOptions().Timeout,i=t.__expression.getOptions().Parallel;i||(i=!1);let requestId=e.Server.requestEx(message,{timeout:o,parallel:i},(function(o){if(o.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,t,{error:o.error});let i=o.response;if(void 0===i)return void e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_INVALID_RESPONSE,details:{code:e.Errors.E_SERVER_INVALID_RESPONSE,message:e.Errors[e.Errors.E_SERVER_INVALID_RESPONSE],reason:t.__expression.toString()+": Missing response from server.",domain:"TcHmi.System.Symbol"},response:i});if(i&&i.error&&i.error)return void e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_RESPONSE_ERROR,details:{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:t.__expression.toString()+": Error in response from server with id: '"+i.id+"'.",domain:"TcHmi.System.Symbol",errors:[i.error]},response:i});let commands=i.commands;if(!commands)return void e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_COMMANDS_MISSING,details:{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:t.__expression.toString()+": Missing commands in response from server with id: '"+i.id+"'.",domain:"TcHmi.System.Symbol"},response:i});let n=commands[0];if(n)return n.error?void e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_COMMAND_ERROR,details:{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:t.__expression.toString()+": Error in command for symbol: '"+r+"' in response from server with id: '"+i.id+"'.",domain:"TcHmi.System.Symbol",errors:[n.error]},value:n.readValue,response:i}):void t.resolveSchema(data=>{if(data.error===e.Errors.NONE){let r=e.ValueConverter.toSchemaType(n.readValue,data.schema);if(null===r&&null!==n.readValue){let r,value=n.readValue,schema=data.schema;r="object"==typeof value&&__tchmi_is_instanced_object(value)?t.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?t.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":t.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",e.Callback.callSafe(callback,t,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:r,domain:"TcHmi.System.Symbol"},value:n.readValue,response:i})}else e.Callback.callSafe(callback,t,{error:e.Errors.NONE,value:r,response:i})}else e.Callback.callSafe(callback,t,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:t.__expression.toString()+", Resolving schema failed.",domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},value:n.readValue,response:i})});e.Callback.callSafe(callback,t,{error:e.Errors.E_SERVER_COMMAND_MISSING,details:{code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:t.__expression.toString()+": Missing command for symbol: '"+r+"' in response from server with id: '"+i.id+"'.",domain:"TcHmi.System.Symbol"},response:i})}));return()=>{e.Server.releaseRequest(requestId)}}}__readSymbolTypeInternal(callback){let name=this.__expression.getName(),r=this;t.Services.internalSymbolManager.read(name,(function(data){if(data.error===e.Errors.NONE){let t=r.__expression.getPathTokens();return t&&t.length>0?void r.__readSubValue(data.value,t,(function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)}):e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)})}e.Callback.callSafe(callback,r,{error:data.error})}))}__readSymbolTypeLocalizedText(callback){let name=this.__expression.getName(),r=t.Services.localizationManager.get(name);if(void 0!==r)try{return void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:r.text})}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),void e.Callback.callSafe(callback,this,{error:e.Errors.E_EXCEPTION,details:{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:this.__expression.toString()+", Exception: '"+t+"'",domain:"TcHmi.System.Symbol"}})}else e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:this.__expression.toString(),domain:"TcHmi.System.Symbol"}})}__readSymbolTypeFunction(callback){let r=this,o=new t.FunctionExpression(this.__expression.getContent()),i=!1;o.execute({success:function(t){i||(i=!0,e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:t}))},error:function(error,t){i||(i=!0,e.Callback.callSafe(callback,r,{error:error,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:r.__expression.toString()+", could not read function value",domain:"TcHmi.System.Symbol",errors:[t]}}))}})}__readSymbolTypeControl(callback){let t=this,name=this.__expression.getName(),r=tchmi_clone_object(this.__expression.getPathTokens()),control=e.Controls.get(name);if(control){if(null!==r){let propertyName=null;r&&r.length>0&&(propertyName=r.shift());let o=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName);if(null==o)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+propertyName+"'.",domain:"TcHmi.System.Symbol"}});let i=tchmi_clone_object(control[o.propertyGetterName].call(control));if(r&&r.length>0){let n=e.Type.getSchema(o.type);if(n&&n.frameworkInstanceOf&&"TcHmi.Controls.System.TcHmiControl"===n.frameworkInstanceOf){let o=i.getId();return void new e.System.Symbol("%ctrl%"+o+"::"+r.join("::")+"%/ctrl%").read((function(r){r.error===e.Errors.NONE?e.Callback.callSafe(callback,t,{error:e.Errors.NONE,value:tchmi_clone_object(r.value)}):e.Callback.callSafe(callback,t,{error:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,details:{code:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,message:e.Errors[e.Errors.E_SYMBOL_SUBSYMBOL_ERROR],reason:t.__expression.toString(),domain:"TcHmi.System.Symbol",errors:r.details?[r.details]:void 0}})}))}return void this.__readSubValue(i,r,(function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,t,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)}):e.Callback.callSafe(callback,t,{error:data.error,details:data.details})}))}return void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:i})}e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:control})}else e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"}})}__readSymbolTypePartialParam(callback){let t,r=this,name=this.__expression.getName(),o=tchmi_clone_object(this.__expression.getPathTokens()),propertyName=null,i=null,n=null,s=!1;if("TCHMI_TARGET_DESIGNER_PARTIALPARAM"===name&&(s=!0),o){if(propertyName=o.shift(),s){if(n=e.System.Services.Engineering.designerModeManager.userControlParameterManager.get(propertyName),!n)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});if(i=n.descr,!i)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+name+"'.",domain:"TcHmi.System.Symbol"}});t=n.value}else{let control=e.Controls.get(name);if(!control)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"}});if(i=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName),null==i)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+propertyName+"'.",domain:"TcHmi.System.Symbol"}});try{t=control[i.propertyGetterName].call(control)}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),void e.Callback.callSafe(callback,this,{error:e.Errors.E_EXCEPTION,details:{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:this.__expression.toString()+", Exception: '"+t+"'",domain:"TcHmi.System.Symbol"}})}}if(o&&o.length>0){let n=e.Type.getSchema(i.type);if(n&&n.frameworkInstanceOf&&"TcHmi.Controls.System.TcHmiControl"===n.frameworkInstanceOf){let i=t.getId();return void new e.System.Symbol("%ctrl%"+i+"::"+o.join("::")+"%/ctrl%").read((function(t){t&&t.error!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,details:{code:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,message:e.Errors[e.Errors.E_SYMBOL_SUBSYMBOL_ERROR],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:t.details?[t.details]:void 0}}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(t.value)})}))}this.__readSubValue(t,o,(function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)}):e.Callback.callSafe(callback,r,{error:data.error,details:data.details})}))}else e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:tchmi_clone_object(t)})}else s?e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: TCHMI_TARGET_DESIGNER_PARTIALPARAM::Parameter",domain:"TcHmi.System.Symbol"}}):e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: UserControlHost::Parameter",domain:"TcHmi.System.Symbol"}})}__readSymbolTypeTemplateParam(callback){let r=this,name=this.__expression.getName(),path=this.__expression.getPath(),o=this.__expression.getPathTokens(),i=t.Services.templateParamSymbolManager.get(name);if(!(i.value instanceof e.SymbolExpression))return o&&o.length>0?void r.__readSubValue(i.value,o,(function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)}):e.Callback.callSafe(callback,r,{error:data.error,details:data.details})})):void e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(i.value)});{let t=i.value,n=t.getTag(),s=t.getName(),l=t.getPath(),c="%"+n+"%"+s;null!==l&&(c+=l),o&&o.length>0&&(c+=path),c+="%/"+n+"%";let d=new e.System.Symbol(c);d.read((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.NONE,value:tchmi_clone_object(data.value)}):e.Callback.callSafe(callback,r,{error:data.error,details:data.details}),d.destroy(),d=null}))}}write(value,callback){let e=this.writeEx(value,null,callback);return()=>{e&&e()}}writeEx(value,t,callback){var r,o,i,n;let s="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(s=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx called with:",{value:value,dirtyPaths:t});let l=null;switch(this.__expression.getType()){case e.SymbolType.Server:l=this.__writeSymbolTypeServer(value,t,(data,t)=>{var r,o;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",{data:data}),t&&t.equal&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(o=this.__expression)||void 0===o?void 0:o.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished without error because of data equality."),e.Callback.callSafe(callback,this,data)});break;case e.SymbolType.Internal:this.__writeSymbolTypeInternal(value,t,(data,t)=>{var r,o;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",{data:data}),t&&t.equal&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(o=this.__expression)||void 0===o?void 0:o.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished without error because of data equality."),e.Callback.callSafe(callback,this,data)});break;case e.SymbolType.LocalizedText:{let t={error:e.Errors.E_SYMBOL_READONLY,details:{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:this.__expression.toString()+": LocalizedText symbols are readonly.",domain:"TcHmi.System.Symbol"}};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(o=this.__expression)||void 0===o?void 0:o.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",t),e.Callback.callSafe(callback,this,t)}break;case e.SymbolType.Function:{let t={error:e.Errors.E_SYMBOL_READONLY,details:{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:this.__expression.toString()+": Function symbols are readonly.",domain:"TcHmi.System.Symbol"}};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(i=this.__expression)||void 0===i?void 0:i.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",t),e.Callback.callSafe(callback,this,t)}break;case e.SymbolType.Control:this.__writeSymbolTypeControl(value,t,(data,t)=>{var r,o;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",{data:data}),t&&t.equal&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(o=this.__expression)||void 0===o?void 0:o.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished without error because of data equality."),e.Callback.callSafe(callback,this,data)});break;case e.SymbolType.PartialParam:this.__writeSymbolTypePartialParam(value,t,(data,t)=>{var r,o;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",{data:data}),t&&t.equal&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(o=this.__expression)||void 0===o?void 0:o.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished without error because of data equality."),e.Callback.callSafe(callback,this,data)});break;case e.SymbolType.TemplateParam:this.__writeSymbolTypeTemplateParam(value,t,(data,t)=>{var r,o;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(r=this.__expression)||void 0===r?void 0:r.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",{data:data}),t&&t.equal&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(o=this.__expression)||void 0===o?void 0:o.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished without error because of data equality."),e.Callback.callSafe(callback,this,data)});break;default:{let t={error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:this.__expression.toString(),domain:"TcHmi.System.Symbol"}};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",null===(n=this.__expression)||void 0===n?void 0:n.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx finished with:",t),e.Callback.callSafe(callback,this,t)}}return()=>{var t;TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(t=this.__expression)||void 0===t?void 0:t.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+s+"] writeEx destroy called."),l&&l()}}__writeSymbolTypeServer(value,o,callback){let i=this,name=this.__expression.getName();if(TCHMI_DESIGNER)return this.resolveSchema(data=>{if(data.error===e.Errors.NONE){let value=e.Type.Schema.resolveDefault(data.schema);e.Callback.callSafe(callback,i,{error:e.Errors.NONE,value:value})}else e.Callback.callSafe(callback,i,{error:data.error,details:data.details})}),()=>{};{let n=tchmi_clone_object(value),s=!1,requestId=null;return this.resolveSchema((function(l){if(s)return;if(i.__state!==r.Ready)return void e.Callback.callSafe(callback,i,{error:e.Errors.E_SYMBOL_STATE_INVALID,details:{code:e.Errors.E_SYMBOL_STATE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_STATE_INVALID],reason:i.__expression.toString(),domain:"TcHmi.System.Symbol",errors:l.details?[l.details]:void 0}});if(l.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,i,{error:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,details:{code:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,message:e.Errors[e.Errors.E_SYMBOL_RESOLVE_SCHEMA],reason:i.__expression.toString(),domain:"TcHmi.System.Symbol",errors:l.details?[l.details]:void 0}});let c,message={requestType:"ReadWrite",commands:[]},error=e.Errors.NONE,schema=i.__schema;if(o)for(let r=0,s=o.length;r<s;r++){let s,l,d,path=o[r],_=t.resolveSymbolPathToTokenArray(path),m=e.Errors.NONE;i.resolveSubSchema(schema,_,(function(data){data.error===e.Errors.NONE?s=tchmi_clone_object(data.schema):(m=data.error,l=data.details)}));let u,g=e.Errors.NONE;if(i.__readSubValue(n,_,(function(data){data.error===e.Errors.NONE?d=tchmi_clone_object(data.value):(g=data.error,u=data.details)})),m===e.Errors.NONE&&g===e.Errors.NONE){let t=e.ValueConverter.toSchemaType(d,s,{convertDirection:e.ValueConverter.ConvertDirection.Backward});if(null===t&&null!==d){let t,value=d,schema=s;t="object"==typeof value&&__tchmi_is_instanced_object(value)?i.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?i.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":i.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",error=e.Errors.E_SYMBOL_VALUE_INVALID,c||(c={code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"})}else message.commands.push({commandOptions:["SendErrorMessage"],symbol:name+path,writeValue:t})}else error=e.Errors.ERROR,c||(c={code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:i.__expression.toString(),domain:"TcHmi.System.Symbol"}),m===e.Errors.NONE&&(c.errors||(c.errors=[]),c.errors.push(l)),g===e.Errors.NONE&&(c.errors||(c.errors=[]),c.errors.push(u))}else{let t=e.ValueConverter.toSchemaType(n,schema,{convertDirection:e.ValueConverter.ConvertDirection.Backward,resolveFunctionWriteValue:!0});if(null===t&&null!==n){let t,value=n;t="object"==typeof value&&__tchmi_is_instanced_object(value)?i.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?i.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":i.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",error=e.Errors.E_SYMBOL_VALUE_INVALID,c||(c={code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"})}else message.commands.push({commandOptions:["SendErrorMessage"],symbol:name,writeValue:t})}if(error!==e.Errors.NONE)return void e.Callback.callSafe(callback,i,{error:error,details:c});let d=i.__expression.getOptions().Timeout,_=i.__expression.getOptions().Parallel;_||(_=!1),requestId=e.Server.requestEx(message,{timeout:d,parallel:_},(function(t){if(t.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,i,{error:t.error,details:t.details});let r=t.response;if(!r)return void e.Callback.callSafe(callback,i,{error:e.Errors.E_SERVER_RESPONSE_MISSING,details:{code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:i.__expression.toString()+": Missing response from server.",domain:"TcHmi.System.Symbol"}});if(r&&r.error&&r.error)return void e.Callback.callSafe(callback,i,{error:e.Errors.E_SERVER_RESPONSE_ERROR,details:{code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:i.__expression.toString()+": Error in response from server with id: '"+r.id+"'.",domain:"TcHmi.System.Symbol",errors:[r.error]},response:r});let commands=r.commands;if(!commands)return void e.Callback.callSafe(callback,i,{error:e.Errors.E_SERVER_COMMANDS_MISSING,details:{code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:i.__expression.toString()+": Missing commands in response from server with id: '"+r.id+"'.",domain:"TcHmi.System.Symbol"},response:r});let o=commands[0];if(o)return o.error?void e.Callback.callSafe(callback,i,{error:e.Errors.E_SERVER_COMMAND_ERROR,details:{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:i.__expression.toString()+": Error in command for symbol: '"+name+"' in response from server with id: '"+r.id+"'.",domain:"TcHmi.System.Symbol",errors:[o.error]},response:r}):void(o.processedStart&&o.processedEnd?e.Callback.callSafe(callback,i,{error:e.Errors.NONE,value:o.readValue,processedStart:o.processedStart,processedEnd:o.processedEnd,response:r}):e.Callback.callSafe(callback,i,{error:e.Errors.NONE,value:o.readValue,response:r}));e.Callback.callSafe(callback,i,{error:e.Errors.E_SERVER_COMMAND_MISSING,details:{code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:i.__expression.toString()+": Missing command for symbol: '"+name+"' in response from server with id: '"+r.id+"'.",domain:"TcHmi.System.Symbol"},response:r})}))})),()=>{s=!0,null!=requestId&&e.Server.releaseRequest(requestId)}}}__writeSymbolTypeInternal(value,r,callback){let o=this,name=this.__expression.getName(),path=this.__expression.getPath(),i=this.__expression.getPathTokens();this.resolveSchema((function(n){if(n&&n.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,details:{code:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,message:e.Errors[e.Errors.E_SYMBOL_RESOLVE_SCHEMA],reason:o.__expression.toString(),domain:"TcHmi.System.Symbol",errors:n.details?[n.details]:void 0}});let schema=o.__schema,s=tchmi_clone_object(value),l=[];if(i&&i.length>0){if(r)for(let e=0,t=r.length;e<t;e++)l.push(path+r[e]);else l.push(path);t.Services.internalSymbolManager.read(name,(function(r){if(r.error===e.Errors.NONE){let n,c,d=tchmi_clone_object(r.value),_=e.Errors.NONE;if(o.__readSubValue(d,i,(function(data){data.error===e.Errors.NONE?n=tchmi_clone_object(data.value):(_=data.error,c=data.details)})),_)return void e.Callback.callSafe(callback,o,{error:_,details:c});let m=e.ValueConverter.toSchemaType(s,schema);if(null===m&&null!==s){let t,value=s;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?o.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?o.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":o.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}if(tchmi_equal(n,m))return void e.Callback.callSafe(callback,o,{error:e.Errors.NONE},{equal:!0});o.__writeSubValue(d,m,i,(function(data){data.error===e.Errors.NONE?t.Services.internalSymbolManager.write(name,d,l,(function(t){e.Callback.callSafe(callback,o,{error:t.error,details:t.details})})):e.Callback.callSafe(callback,o,{error:data.error,details:data.details})}))}else e.Callback.callSafe(callback,o,{error:r.error})}))}else{let r=e.ValueConverter.toSchemaType(s,schema);if(null===r&&null!==s){let t,value=s;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?o.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?o.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":o.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}t.Services.internalSymbolManager.write(name,r,null,(function(data){e.Callback.callSafe(callback,o,{error:data.error,details:data.details})}))}}))}__writeSymbolTypeControl(value,t,callback){let r=this,name=this.__expression.getName(),o=tchmi_clone_object(this.__expression.getPathTokens()),control=e.Controls.get(name);if(control)if(null!==o){let propertyName=null;o&&o.length>0&&(propertyName=o.shift());let i=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName);if(null==i)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:r.__expression.toString()+", Can't find attribute with property name: '"+propertyName+"' in control: '"+control.getId()+"'.",domain:"TcHmi.System.Symbol"}});if(i.readOnly&&0===o.length)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_READONLY,details:{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:r.__expression.toString()+", Writing to readonly symbol is not allowed. Symbol is readonly because attribute with property name: '"+propertyName+"' in control: '"+control.getId()+"' is readonly.",domain:"TcHmi.System.Symbol"}});this.resolveSchema((function(n){if(n&&n.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,details:{code:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,message:e.Errors[e.Errors.E_SYMBOL_RESOLVE_SCHEMA],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:n.details?[n.details]:void 0}});let s,schema=r.__schema,l=tchmi_clone_object(value);try{s=control[i.propertyGetterName].call(control)}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),void e.Callback.callSafe(callback,r,{error:e.Errors.E_EXCEPTION,details:{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r.__expression.toString()+": Exception: '"+t+"'",domain:"TcHmi.System.Symbol"}})}let c=tchmi_clone_object(s);if(!i.readOnly||__tchmi_is_instanced_object(c)){if(o&&o.length>0){let n=e.Type.getSchema(i.type);if(n&&n.frameworkInstanceOf&&"TcHmi.Controls.System.TcHmiControl"===n.frameworkInstanceOf){if(!(c instanceof e.Controls.System.baseTcHmiControl))return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:r.__expression.toString()+", Missing control instance for parameter: '"+i.propertyName+"'.",domain:"TcHmi.System.Symbol"}});{let i=c.getId();new e.System.Symbol("%ctrl%"+i+"::"+o.join("::")+"%/ctrl%").writeEx(value,t,(function(t){t.error===e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.NONE}):e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,details:{code:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,message:e.Errors[e.Errors.E_SYMBOL_SUBSYMBOL_ERROR],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:t.details?[t.details]:void 0}})}))}return}{let n,s=[];if(t)for(let e=0,r=t.length;e<r;e++)s.push("::"+o.join("::")+t[e]);else s.push("::"+o.join("::"));let d,_=e.Errors.NONE;if(r.__readSubValue(c,o,(function(data){data.error===e.Errors.NONE?n=tchmi_clone_object(data.value):(_=data.error,d=data.details)})),_)return void e.Callback.callSafe(callback,r,{error:_,details:d});let m=e.ValueConverter.toSchemaType(l,schema);if(null===m&&null!==l){let t,value=l;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?r.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?r.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":r.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}return tchmi_equal(n,m)?void e.Callback.callSafe(callback,r,{error:e.Errors.NONE},{equal:!0}):void r.__writeSubValue(c,m,o,(function(data){if(data.error===e.Errors.NONE){let error=e.System.Services.controlManager.setControlPropertyByAttribute(control,i,c,s);error&&error.code!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:error.code,details:error}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE})}else e.Callback.callSafe(callback,r,{error:data.error,details:data.details})}))}}if(!tchmi_equal(c,l)){let t=e.ValueConverter.toSchemaType(l,schema);if(null===t&&null!==l){let t,value=l;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?r.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?r.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":r.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}let error=e.System.Services.controlManager.setControlPropertyByAttribute(control,i,tchmi_clone_object(t));return void(error&&error.code!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:error.code,details:error}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE}))}e.Callback.callSafe(callback,r,{error:e.Errors.NONE},{equal:!0})}else e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_READONLY,details:{code:e.Errors.E_SYMBOL_READONLY,message:e.Errors[e.Errors.E_SYMBOL_READONLY],reason:r.__expression.toString()+", Writing to readonly symbol is not allowed. Symbol is readonly because attribute with property name: '"+propertyName+"' in control: '"+control.getId()+"' is readonly.",domain:"TcHmi.System.Symbol"}})}))}else e.Callback.callSafe(callback,r,{error:e.Errors.E_NOT_ALLOWED,details:{code:e.Errors.E_NOT_ALLOWED,message:e.Errors[e.Errors.E_NOT_ALLOWED],reason:r.__expression.toString()+", Writing on control instance symbol is not allowed.",domain:"TcHmi.System.Symbol"}});else e.Callback.callSafe(callback,r,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:r.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"}})}__writeSymbolTypePartialParam(value,t,callback){let r=this,name=this.__expression.getName(),o=tchmi_clone_object(this.__expression.getPathTokens()),i=!1;"TCHMI_TARGET_DESIGNER_PARTIALPARAM"===name&&(i=!0);let control,propertyName=null,n=null,s=null;if(o){if(propertyName=o.shift(),i){if(s=e.System.Services.Engineering.designerModeManager.userControlParameterManager.get(propertyName),!s)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol"}});if(n=s.descr,!n)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+name+"'.",domain:"TcHmi.System.Symbol"}})}else{if(control=e.Controls.get(name),!control)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"}});if(n=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName),null==n)return void e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+propertyName+"'.",domain:"TcHmi.System.Symbol"}})}this.resolveSchema((function(l){if(l&&l.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,details:{code:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,message:e.Errors[e.Errors.E_SYMBOL_RESOLVE_SCHEMA],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:l.details?[l.details]:void 0}});let c,schema=r.__schema,d=tchmi_clone_object(value);if(i)c=s.value;else try{c=control[n.propertyGetterName].call(control)}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),void e.Callback.callSafe(callback,r,{error:e.Errors.E_EXCEPTION,details:{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r.__expression.toString()+": Exception: '"+t+"'",domain:"TcHmi.System.Symbol"}})}let _=tchmi_clone_object(c);if(o&&o.length>0){let l=e.Type.getSchema(n.type);if(l&&l.frameworkInstanceOf&&"TcHmi.Controls.System.TcHmiControl"===l.frameworkInstanceOf){if(!(_ instanceof e.Controls.System.baseTcHmiControl))return void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:r.__expression.toString()+", Missing control instance for parameter: '"+propertyName+"'.",domain:"TcHmi.System.Symbol"}});{let i=_.getId();new e.System.Symbol("%ctrl%"+i+"::"+o.join("::")+"%/ctrl%").writeEx(value,t,(function(t){t&&t.error!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,details:{code:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,message:e.Errors[e.Errors.E_SYMBOL_SUBSYMBOL_ERROR],reason:r.__expression.toString(),domain:"TcHmi.System.Symbol",errors:t.details?[t.details]:void 0}}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE})}))}return}{let l,c=[];if(t)for(let e=0,r=t.length;e<r;e++)c.push("::"+o.join("::")+t[e]);else c.push("::"+o.join("::"));let m,u=e.Errors.NONE;if(r.__readSubValue(_,o,(function(data){data.error===e.Errors.NONE?l=tchmi_clone_object(data.value):(u=data.error,m=data.details)})),u)return void e.Callback.callSafe(callback,r,{error:u,details:m});let g=e.ValueConverter.toSchemaType(d,schema);if(null===g&&null!==d){let t,value=d;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?r.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?r.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":r.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}return tchmi_equal(l,g)?void e.Callback.callSafe(callback,r,{error:e.Errors.NONE},{equal:!0}):void r.__writeSubValue(_,g,o,(function(data){if(data.error===e.Errors.NONE)if(i)s.value=_,e.EventProvider.raise("System.onDesignerUserControlParameterChanged<"+propertyName+">"),e.Callback.callSafe(callback,r,{error:e.Errors.NONE});else{let error=e.System.Services.controlManager.setControlPropertyByAttribute(control,n,_,c);error&&error.code!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:error.code,details:error}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE})}else e.Callback.callSafe(callback,r,{error:data.error,details:data.details})}))}}{let t=e.ValueConverter.toSchemaType(d,schema);if(null===t&&null!==d){let t,value=d;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?r.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?r.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":r.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,r,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}if(tchmi_equal(_,t))return void e.Callback.callSafe(callback,r,{error:e.Errors.NONE},{equal:!0});if(i)s.value=_,e.Callback.callSafe(callback,r,{error:e.Errors.NONE});else{let error=e.System.Services.controlManager.setControlPropertyByAttribute(control,n,t);error&&error.code!==e.Errors.NONE?e.Callback.callSafe(callback,r,{error:error.code,details:error}):e.Callback.callSafe(callback,r,{error:e.Errors.NONE})}return}}))}else i?e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: TCHMI_TARGET_DESIGNER_PARTIALPARAM::Parameter",domain:"TcHmi.System.Symbol"}}):e.Callback.callSafe(callback,r,{error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:r.__expression.toString()+" is not a valid PartialParameter. Expected: UserControlHost::Parameter",domain:"TcHmi.System.Symbol"}})}__writeSymbolTypeTemplateParam(value,r,callback){let o=this,name=this.__expression.getName(),path=this.__expression.getPath(),i=this.__expression.getPathTokens(),n=t.Services.templateParamSymbolManager.get(name);if(n.value instanceof e.SymbolExpression){let t=n.value,s=t.getTag(),l=t.getName(),c=t.getPath(),d="%"+s+"%"+l;null!==c&&(d+=c),i&&i.length>0&&(d+=path),d+="%/"+s+"%";let _=new e.System.Symbol(d);_.writeEx(value,r,(function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,o,{error:e.Errors.NONE}):e.Callback.callSafe(callback,o,{error:data.error,details:data.details}),_.destroy(),_=null}))}else this.resolveSchema((function(t){if(t&&t.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,details:{code:e.Errors.E_SYMBOL_RESOLVE_SCHEMA,message:e.Errors[e.Errors.E_SYMBOL_RESOLVE_SCHEMA],reason:o.__expression.toString(),domain:"TcHmi.System.Symbol",errors:t.details?[t.details]:void 0}});let schema=o.__schema,s=tchmi_clone_object(value),l=tchmi_clone_object(n.value),c=tchmi_clone_object(l);if(i&&i.length>0){let t,l=[];if(r)for(let e=0,t=r.length;e<t;e++)l.push(path+r[e]);else l.push(path);let d,_=e.Errors.NONE;if(o.__readSubValue(c,i,(function(data){data.error===e.Errors.NONE?t=tchmi_clone_object(data.value):(_=data.error,d=data.details)})),_)return void e.Callback.callSafe(callback,o,{error:_,details:d});let m=e.ValueConverter.toSchemaType(s,schema);if(null===m&&null!==s){let t,value=s;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?o.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?o.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":o.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}return tchmi_equal(t,m)?void e.Callback.callSafe(callback,o,{error:e.Errors.NONE},{equal:!0}):void o.__writeSubValue(c,m,i,(function(data){data.error===e.Errors.NONE?(n.value=c,e.System.Callback.callSafeCallbacks1Param(n.callbacks,o,{error:e.Errors.NONE,value:tchmi_clone_object(n.value),dirtyPaths:l}),e.Callback.callSafe(callback,o,{error:e.Errors.NONE})):e.Callback.callSafe(callback,o,{error:data.error,details:data.details})}))}{let t=e.ValueConverter.toSchemaType(s,schema);if(null===t&&null!==s){let t,value=s;return t="object"==typeof value&&__tchmi_is_instanced_object(value)?o.__expression.toString()+": Value of type: 'Instance of "+value.constructor+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":"object"==typeof value?o.__expression.toString()+": Value: '"+JSON.stringify(value)+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".":o.__expression.toString()+": Value: '"+value+"' of type: '"+typeof value+"' can't be converted to type schema"+(schema&&schema.id?": '"+schema.id+"'":"")+".",void e.Callback.callSafe(callback,o,{error:e.Errors.E_SYMBOL_VALUE_INVALID,details:{code:e.Errors.E_SYMBOL_VALUE_INVALID,message:e.Errors[e.Errors.E_SYMBOL_VALUE_INVALID],reason:t,domain:"TcHmi.System.Symbol"}})}return tchmi_equal(c,t)?void e.Callback.callSafe(callback,o,{error:e.Errors.NONE},{equal:!0}):(n.value=t,e.System.Callback.callSafeCallbacks1Param(n.callbacks,o,{error:e.Errors.NONE,value:tchmi_clone_object(n.value)}),void e.Callback.callSafe(callback,o,{error:e.Errors.NONE}))}}))}watch(callback){var r;let o="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(o=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+(null===(r=this.__expression)||void 0===r?void 0:r.toString())+", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch called.");let i,n,s,l=this,c=null,d=null,_=null,m=null,u=this.__expression.getType(),g=function(){switch(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Symbol, Expression="+l.__expression.toString()+", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch destroy called."),u){case e.SymbolType.Server:case e.SymbolType.Internal:case e.SymbolType.LocalizedText:i&&(i(),i=null);break;case e.SymbolType.Function:i&&(i(),i=null),n&&(n.destroy(),n=null);break;case e.SymbolType.Control:null!==d&&(d(),d=null),null!==_&&(_(),_=null),null!==c&&(c(),c=null);break;case e.SymbolType.PartialParam:null!==c&&(c(),c=null),null!==m&&(m(),m=null);break;case e.SymbolType.TemplateParam:let name=l.__expression.getName();t.Services.templateParamSymbolManager.get(name).value instanceof e.SymbolExpression&&(t.Services.templateParamSymbolManager.keepAlive(name)||t.Services.templateParamSymbolManager.remove(name)),i&&(i(),i=null),s&&(s.destroy(),s=null)}};if(u===e.SymbolType.Server)TCHMI_DESIGNER?this.read(data=>{data.error===e.Errors.NONE?e.Callback.callSafe(callback,l,{error:e.Errors.NONE,value:data.value,destroy:g}):e.Callback.callSafe(callback,l,{error:data.error,details:data.details})}):i=e.System.Services.serverManager.watch(this.__expression,(function(data){if(i||(i=data.destroy),data.error===e.Errors.NONE)if(data.processedStart&&data.processedEnd){let t={error:e.Errors.NONE,value:data.value,processedStart:data.processedStart,processedEnd:data.processedEnd,destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}else{let t={error:e.Errors.NONE,value:data.value,destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}else{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}));else if(u===e.SymbolType.Internal)i=e.System.Services.internalSymbolManager.watch(this.__expression.getName(),(function(data){if(i||(i=data.destroy),data.error===e.Errors.NONE){let t=l.__expression.getPathTokens();if(t&&t.length>0){let r=!1;if(data.dirtyPaths){let path=l.__expression.getPath();for(let e=0,t=data.dirtyPaths.length;e<t;e++){if(data.dirtyPaths[e]===path){r=!0;break}}}else r=!0;return void(r&&l.__readSubValue(data.value,t,(function(data){if(data.error===e.Errors.NONE){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}else{let t={error:data.error,details:data.details};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}})))}{let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}));else if(u===e.SymbolType.LocalizedText)i=e.System.Services.localizationManager.watch(this.__expression.getName(),(function(data){if(i||(i=data.destroy),data.error===e.Errors.NONE){if(data.error===e.Errors.NONE){let t=l.__expression.getPathTokens();if(t&&t.length>0){let t={error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:l.__expression.toString()+': Reading by path is not supported on symbols of type "LocalizedText".',domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}{let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}));else if(u===e.SymbolType.Function)n=new e.System.FunctionExpression(this.__expression.getContent(),!0),i=n.watch((function(data){if(i||(i=data.destroy),data.error===e.Errors.NONE){let t=l.__expression.getPathTokens();if(t&&t.length>0){let t={error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:l.__expression.toString()+': Reading by path is not supported on symbols of type "Function".',domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}{let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}));else{if(u===e.SymbolType.Control){let name=l.__expression.getName();if(!name){let t={error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:l.__expression.toString()+", Expression does not contain a valid name token.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t),g}let control=e.Controls.get(name),t=!1;control&&(t=!0);let r=()=>{let r=tchmi_clone_object(l.__expression.getPathTokens()),propertyName=null,i="";if(!control&&!t){let t={error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:l.__expression.toString()+": Can't find control instance with name: '"+name+"'.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}if(!control&&t){let t={error:e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE,details:{code:e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NO_LONGER_AVAILABLE],reason:l.__expression.toString()+": Control instance with name: '"+name+"' has become unavailable but was available before.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}if(r&&r.length>0&&(propertyName=r.shift(),r.length>0&&(i="::"+r.join("::"))),propertyName){let t=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName);if(!t){let t={error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:l.__expression.toString()+", Can't find attribute definition for property: '"+propertyName+"' of control: '"+name+"' of type: '"+control.getType()+"'.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}if(!t.propertyGetterName){let t={error:e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION],reason:l.__expression.toString()+", Can't find valid 'propertyGetterName' in attribute definition for property: '"+propertyName+"' of control: '"+name+"' of type: '"+control.getType()+"'. Please check Description.json.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}c=e.EventProvider.register(name+".onPropertyChanged<"+t.propertyName+">",(function(t,data){if(!data)return;let r,n=!1;if(data.dirtyPaths&&(r=data.dirtyPaths),i&&r&&r.length>0)for(let e=0,t=r.length;e<t;e++){let t=r[e];i===t&&(n=!0)}else n=!0;n&&l.read((function(data){if(data.error===e.Errors.NONE){if(r){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),dirtyPaths:r,destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}{let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}{let t={error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}))}))}this.read((function(data){if(data.error===e.Errors.NONE){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}{let t={error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}))};return d=e.EventProvider.register(name+".onInitialized",(e,data)=>{control=data,control&&(t=!0),r()}),_=e.EventProvider.register(name+".onDestroyed",(e,data)=>{control=null,r()}),r(),g}if(u===e.SymbolType.PartialParam){let name=this.__expression.getName(),t=tchmi_clone_object(this.__expression.getPathTokens()),r=!1;"TCHMI_TARGET_DESIGNER_PARTIALPARAM"===name&&(r=!0);let control,propertyName=null,i=null,n=null,s="";if(!t){let t={error:e.Errors.E_INVALID,details:{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol"}};return t.details.reason+=r?" is not a valid PartialParameter. Expected: TCHMI_TARGET_DESIGNER_PARTIALPARAM::Parameter":" is not a valid PartialParameter. Expected: UserControlHost::Parameter",TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t),g}if(propertyName=t.shift(),t.length>0&&(s="::"+t.join("::")),r){if(m=e.EventProvider.register("System.onDesignerUserControlParameterChanged<"+propertyName+">",(function(t,data){l.read((function(data){if(data.error===e.Errors.NONE){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}{let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}}))})),n=e.System.Services.Engineering.designerModeManager.userControlParameterManager.get(propertyName),!n)return e.Callback.callSafe(callback,l,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol"}}),g;if(i=n.descr,!i)return e.Callback.callSafe(callback,this,{error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:this.__expression.toString()+", Can't find control attribute with propertyName: '"+name+"'.",domain:"TcHmi.System.Symbol"}}),g}else{if(control=e.Controls.get(name),!control){let t={error:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_INSTANCE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_INSTANCE_NOT_FOUND],reason:l.__expression.toString()+", Can't find control instance with id: '"+name+"'.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t),g}if(i=e.System.Services.controlManager.getAttributeByPropertyName(control,propertyName),!i){let t={error:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_NOT_FOUND],reason:l.__expression.toString()+", Can't find attribute definition for property: '"+propertyName+"' of control: '"+name+"' of type: '"+control.getType()+"'.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t),g}if(!i.propertyGetterName){let t={error:e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION,details:{code:e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION,message:e.Errors[e.Errors.E_CONTROL_ATTRIBUTE_INVALID_CONFIGURATION],reason:l.__expression.toString()+", Can't find valid 'propertyGetterName' in attribute definition for property: '"+propertyName+"' of control: '"+name+"' of type: '"+control.getType()+"'. Please check Description.json.",domain:"TcHmi.System.Symbol"},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t),g}c=e.EventProvider.register(name+".onPropertyChanged<"+i.propertyName+">",(function(t,data){if(!data)return;let r,i=!1;if(data.dirtyPaths&&(r=data.dirtyPaths),s&&r&&r.length>0)for(let e=0,t=r.length;e<t;e++){let t=r[e];s===t&&(i=!0)}else i=!0;i&&l.read((function(data){if(data.error!==e.Errors.NONE){let t={error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),void e.Callback.callSafe(callback,l,t)}if(r){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),dirtyPaths:r,destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}else{let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}))}))}let d=!1;if(t&&t.length>0){let r=e.Type.getSchema(i.type);if(r&&r.frameworkInstanceOf&&"TcHmi.Controls.System.TcHmiControl"===r.frameworkInstanceOf){d=!0;let r=control[i.propertyGetterName].call(control);if(r instanceof e.Controls.System.baseTcHmiControl){let i=r.getId();new e.System.Symbol("%ctrl%"+i+"::"+t.join("::")+"%/ctrl%").watch((function(t){if(t.error!==e.Errors.NONE){let r={error:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,details:{code:e.Errors.E_SYMBOL_SUBSYMBOL_ERROR,message:e.Errors[e.Errors.E_SYMBOL_SUBSYMBOL_ERROR],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:t.details?[t.details]:void 0}};return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",r),void e.Callback.callSafe(callback,l,r)}let r={error:e.Errors.NONE,value:tchmi_clone_object(t.value)};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",r),e.Callback.callSafe(callback,l,r)}))}else{let t={error:e.Errors.E_SYMBOL_INVALID_PATH,details:{code:e.Errors.E_SYMBOL_INVALID_PATH,message:e.Errors[e.Errors.E_SYMBOL_INVALID_PATH],reason:l.__expression.toString()+", Missing control instance for parameter: '"+propertyName+"'.",domain:"TcHmi.System.Symbol"}};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}}d||this.read((function(data){if(data.error===e.Errors.NONE){let t={error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}else{let t={error:data.error,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+l.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}))}else if(u===e.SymbolType.TemplateParam){let name=this.__expression.getName(),path=this.__expression.getPath(),r=this.__expression.getPathTokens(),n=t.Services.templateParamSymbolManager.get(name);if(n.value instanceof e.SymbolExpression){n.callbacks.push(callback);let t=n.value,o=t.getTag(),c=t.getName(),d=t.getPath(),_="%"+o+"%"+c;null!==d&&(_+=d),r&&r.length>0&&(_+=path),_+="%/"+o+"%",s=new e.System.Symbol(_),i=s.watch((function(data){i||(i=data.destroy),data.error===e.Errors.NONE?e.Callback.callSafe(callback,l,{error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g}):e.Callback.callSafe(callback,l,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g})})),this.read((function(data){data.error===e.Errors.NONE?e.Callback.callSafe(callback,l,{error:e.Errors.NONE,value:tchmi_clone_object(data.value),destroy:g}):e.Callback.callSafe(callback,l,{error:data.error,details:{code:data.error,message:e.Errors[data.error],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol",errors:data.details?[data.details]:void 0},destroy:g})}))}else{let t={error:e.Errors.E_SYMBOL_INVALID_DATA_PROVIDER_ENTRY,details:{code:e.Errors.E_SYMBOL_INVALID_DATA_PROVIDER_ENTRY,message:e.Errors[e.Errors.E_SYMBOL_INVALID_DATA_PROVIDER_ENTRY],reason:l.__expression.toString(),domain:"TcHmi.System.Symbol"},destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}else{let t={error:e.Errors.E_NOT_SUPPORTED,details:{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:l.__expression.toString()+", SymbolType: '"+u+"' does not support watching.",domain:"TcHmi.System.Symbol"},destroy:g};TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Symbol, Expression=",l.__expression.toString(),", ObjectScopeDiagGUID="+this.__diagGUID+", LogicalScopeDiagGUID="+o+"] watch tick with:",t),e.Callback.callSafe(callback,l,t)}}return g}static isServerSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.Server}static isInternalSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.Internal}static isLocalizedTextSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.LocalizedText}static isPartialParamSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.PartialParam}static isTemplateParamSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.TemplateParam}static isFunctionSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.Function}static isControlSymbol(t){return!!t.getExpression()&&t.getExpression().getType()===e.SymbolType.Control}exists(callback){this.read((function(data){if(data.error!==e.Errors.NONE)return void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,result:!1});if(!o.isServerSymbol(this))return void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,result:!0});let t=data.response;if(t&&t.commands&&t.commands.length>0){return t.commands[0].error?void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,result:!1}):void e.Callback.callSafe(callback,this,{error:e.Errors.NONE,result:!0})}e.Callback.callSafe(callback,this,{error:e.Errors.NONE,result:!1})}))}}o.__SERVER_SYMBOL_SCHEMA_CACHE={},t.Symbol=o}(e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.SymbolExpressionParser=class{constructor(text){this.__text=null,this.__text=text}loadText(text){this.__text=text}__parseExpressionFromString(text,t,r){const o=t.length,i=text.length;for(let n=0;n<=i;n++){if("%"!==text[n])continue;let s="";if(n+o+2<=i&&(s=text.substr(n,o+2)),s==="%"+t+"%"){let l=0,c=0,d=text.substr(n+s.length,i-(n+s.length)),_=i-(n+s.length);for(let i=0;i<=_;i++){if("%"!==d[i])continue;let m="";i+o+2<=_&&(m=d.substr(i,o+2));let u="";if(i+o+3<=_&&(u=d.substr(i,o+3)),u==="%/"+t+"%"){if(c===l){let t=text.substr(n,s.length+u.length+i),o=new e.SymbolExpression(t);o.getType()!==e.SymbolType.Invalid&&r.push(o);break}c++}else m==="%"+t+"%"&&l++}}}return r}resolveExpressionsBySymbolType(type){let t=[],r=null;switch(type){case e.SymbolType.Internal:r="i";break;case e.SymbolType.Server:r="s";break;case e.SymbolType.LocalizedText:r="l";break;case e.SymbolType.PartialParam:r="pp";break;case e.SymbolType.TemplateParam:r="tp";break;case e.SymbolType.Control:r="ctrl";break;case e.SymbolType.Function:r="f";break;default:return t}return null===r||null===this.__text||""===this.__text||(t=this.__parseExpressionFromString(this.__text,r,t),t.sort((function(a,b){const e=a.toString().length,t=b.toString().length;return e>t?-1:e<t?1:0}))),t}resolveExpressions(){let e=[];if(null===this.__text||0===this.__text.length)return e;let t=["i","s","l","pp","tp","ctrl","f"];for(let r=0,o=t.length;r<o;r++)e=this.__parseExpressionFromString(this.__text,t[r],e);return e.sort((function(a,b){return a.toString().length>b.toString().length?-1:a.toString().length<b.toString().length?1:0})),e}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(e){e[e.None=0]="None",e[e.ScaleToFit=1]="ScaleToFit",e[e.ScaleToFitWidth=2]="ScaleToFitWidth",e[e.ScaleToFitHeight=3]="ScaleToFitHeight",e[e.ScaleToFill=4]="ScaleToFill"}(r=t.ScaleMode||(t.ScaleMode={}));t.ViewManager=class{constructor(){this.__scaleMode=r.None,this.__view=null,this.__animationFrameTimeId=0,this.__viewUrl=null,this.__onSystemSplashScreenHideEvent=null,this.__onViewResizedEventDestroyEvent=null,this.__onViewDestroyedEventDestroyEvent=null,this.__pending=!1,window.addEventListener("resize",this.__onWindowResized())}__onWindowResized(){return()=>{this.__scale()}}__onViewDestroyed(){let t=this;return function(r,o){t.__view===o&&(e.System.SharedResources.jqBody.children().detach(),null!==t.__onViewResizedEventDestroyEvent&&(t.__onViewResizedEventDestroyEvent(),t.__onViewResizedEventDestroyEvent=null),null!==t.__onViewDestroyedEventDestroyEvent&&(t.__onViewDestroyedEventDestroyEvent(),t.__onViewDestroyedEventDestroyEvent=null),t.__view=null,t.__viewUrl=null)}}__onViewResized(){return(e,t)=>{this.__scaleMode!==r.None&&this.__scale()}}__scale(){this.__animationFrameTimeId||window.requestAnimationFrame((function(){e.System.Services.viewManager.__doScaling()}))}__doScaling(){if(this.__animationFrameTimeId=0,!0===TCHMI_DESIGNER)return;if(!this.__view)return;const e=this.__view.getElement()[0];if(!e)return;const t=this.__view.getRenderedWidth(),o=this.__view.getRenderedHeight();if(o&&t)switch(this.__scaleMode){case r.ScaleToFit:{let r=document.body.offsetWidth/t,i=document.body.offsetHeight/o,n=r>i?i:r;e.style.transform=`scale(${n})`,e.style.transformOrigin="0 0"}break;case r.ScaleToFitWidth:{let r=document.body.offsetWidth/t;e.style.transform=`scale(${r})`,e.style.transformOrigin="0 0"}break;case r.ScaleToFitHeight:{let t=document.body.offsetHeight/o;e.style.transform=`scale(${t})`,e.style.transformOrigin="0 0"}break;case r.ScaleToFill:{let r=document.body.offsetWidth/t,i=document.body.offsetHeight/o;e.style.transform=`scale(${r},${i})`,e.style.transformOrigin="0 0"}break;case r.None:e.style.transform="",e.style.transformOrigin=""}}setScaleMode(t){let r=e.System.ScaleMode.None;switch(t){case"ScaleToFit":r=e.System.ScaleMode.ScaleToFit;break;case"ScaleToFitWidth":r=e.System.ScaleMode.ScaleToFitWidth;break;case"ScaleToFitHeight":r=e.System.ScaleMode.ScaleToFitHeight;break;case"ScaleToFill":r=e.System.ScaleMode.ScaleToFill}this.__scaleMode=r,this.__scale()}getView(){return this.__view}loadView(url,callback=null){if(!0===this.__pending)return void e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Loading "+url+" failed because we have already another load pending.",domain:"TcHmi.System.ViewManager"}});const t=tchmi_path(url);if(this.__viewUrl===t)return void e.Callback.callSafe(callback,this,{error:e.Errors.NONE});if(this.__pending=!0,void 0!==this.__view&&null!==this.__view&&(e.System.SharedResources.jqBody.children().detach(),this.__onSystemSplashScreenHideEvent&&(this.__onSystemSplashScreenHideEvent(),this.__onSystemSplashScreenHideEvent=null),null!==this.__onViewResizedEventDestroyEvent&&(this.__onViewResizedEventDestroyEvent(),this.__onViewResizedEventDestroyEvent=null),null!==this.__onViewDestroyedEventDestroyEvent&&(this.__onViewDestroyedEventDestroyEvent(),this.__onViewDestroyedEventDestroyEvent=null),this.__view.destroy(),this.__view=null,this.__viewUrl=null),!t)return this.__pending=!1,void e.Callback.callSafe(callback,this,{error:e.Errors.NONE});let r=this,o=function(url,t,o){let i=null;if(!1===TCHMI_DESIGNER&&!e.System.Services.splashScreen.isVisible()){let e=document.createElement("div");e.innerHTML='<div class="tchmi-view-loading-spinner-container"><div class="tchmi-view-loading-spinner"><div></div><div></div><div></div><div></div></div></div>',i=e.firstElementChild,i&&document.body.appendChild(i)}setTimeout(()=>{let n=document.createElement("div");n.innerHTML=t;const s=n.firstElementChild;let l=e.Controls.get(s.id);if(null==l&&(url===TCHMI_TARGET_PARTIAL&&s.setAttribute("data-tchmi-creator-partial-key",TCHMI_TARGET_PARTIAL),s.setAttribute("data-tchmi-partial-url",url),l=e.System.Services.controlManager.compile(s)),null==l){r.__pending=!1;let t="Compiling "+url+" failed.";return 0===n.childElementCount?t+=" No valid html elements found.":n.firstElementChild.hasAttribute("data-tchmi-type")||(t+=" First html element is no tchmi control (missing data-tchmi-type attribute)."),void e.Callback.callSafe(callback,r,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:t,domain:"TcHmi.System.ViewManager"}})}if(o&&l.__setKeepAlive(!0),r.__view=l,r.__viewUrl=url,r.__onViewResizedEventDestroyEvent=e.EventProvider.register(r.__view.getId()+".onResized",r.__onViewResized()),r.__onViewDestroyedEventDestroyEvent=e.EventProvider.register(r.__view.getId()+".onDestroyed",r.__onViewDestroyed()),e.System.Services.splashScreen.isVisible()||e.System.SharedResources.jqBody.children().detach(),!0===TCHMI_ENGINEERING&&!0===TCHMI_DESIGNER){let t=e.System.Services.Engineering.designerModeManager.rootControlManager.getViewPortSimulator();t.empty(),t[0].appendChild(r.__view.getElement()[0]),document.body.appendChild(t[0])}else!e.System.Services.splashScreen.isVisible()&&i&&i.remove(),e.System.Services.splashScreen.isVisible()&&(r.__view.getElement()[0].style.opacity="0",r.__onSystemSplashScreenHideEvent=e.EventProvider.register("System.onSplashScreenHide",e=>{r.__onSystemSplashScreenHideEvent&&(r.__onSystemSplashScreenHideEvent(),r.__onSystemSplashScreenHideEvent=null),r.__view&&(r.__view.getElement()[0].style.opacity="1")})),e.System.SharedResources.jqBody[0].prepend(r.__view.getElement()[0]);r.__pending=!1,e.Callback.callSafe(callback,r,{error:e.Errors.NONE})})},i=e.System.Data.Caches.partialMarkupCache.get(t),n=!1;if(!0===e.System.Data.isKeepAlivePartial.get(t)&&(n=!0),i)o(t,i.markup,n);else if(TCHMI_ENGINEERING)e.System.Services.Engineering.designerModeManager.partialContentManager.requestCurrentPartialContent(t,data=>{data.error===e.Errors.NONE?o(t,data.content,n):(r.__pending=!1,e.Callback.callSafe(callback,r,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Loading "+t+" failed.",domain:"TcHmi.System.ViewManager",errors:data.details?[data.details]:void 0}}))});else{let i=new XMLHttpRequest;i.open("GET",t+(TCHMI_ENGINEERING?"?preventcache="+Math.random():""));let s=function(r){200===i.status?(n&&e.System.Data.Caches.partialMarkupCache.set(t,{markup:i.responseText}),o(t,i.responseText,n)):l(r)},l=function(o){r.__pending=!1,e.Callback.callSafe(callback,r,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Loading "+t+" failed: "+i.statusText,domain:"TcHmi.System.ViewManager"}})};i.addEventListener("load",s),i.addEventListener("error",l),i.send()}}loadViewObject(t,callback=null){!0!==this.__pending?(this.__pending=!0,void 0!==this.__view&&null!==this.__view&&(e.System.SharedResources.jqBody.children().detach(),null!==this.__onViewResizedEventDestroyEvent&&(this.__onViewResizedEventDestroyEvent(),this.__onViewResizedEventDestroyEvent=null),null!==this.__onViewDestroyedEventDestroyEvent&&(this.__onViewDestroyedEventDestroyEvent(),this.__onViewDestroyedEventDestroyEvent=null),this.__view.destroy(),this.__view=null,this.__viewUrl=null),this.__view=t,this.__viewUrl=null,this.__onViewResizedEventDestroyEvent=e.EventProvider.register(this.__view.getId()+".onResized",this.__onViewResized()),this.__onViewDestroyedEventDestroyEvent=e.EventProvider.register(this.__view.getId()+".onDestroyed",this.__onViewDestroyed()),e.System.SharedResources.jqBody.children().detach(),!0===TCHMI_ENGINEERING&&!0===TCHMI_DESIGNER?e.System.SharedResources.jqBody[0].appendChild(e.System.Services.Engineering.designerModeManager.rootControlManager.getViewPortSimulator().empty()[0].appendChild(this.__view.getElement()[0])):e.System.SharedResources.jqBody[0].appendChild(this.__view.getElement()[0]),this.__pending=!1,e.Callback.callSafe(callback,this,{error:e.Errors.NONE})):"function"==typeof callback&&callback.call(this,{error:e.Errors.ERROR})}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.ThemeManager=class{constructor(){this.__activeThemes="Base",this.__registered_themedValueFiles_fromControl=new Map,this.__registered_styleCheets_fromControl=new Map,this.__control_themeFiles=new Map,this.__project_themeFiles=new Map,this.__resolveControlInheritance=()=>{if(!e.System.Services.controlManager)return;const t=(e,parent)=>{if(!e)return;const r=t=>{t.controlTypeValues||(t.controlTypeValues={}),t.controlTypeValues[e.controlType]||(t.controlTypeValues[e.controlType]={}),t.controlTypeValues[e.controlType].attributes||(t.controlTypeValues[e.controlType].attributes={}),t.controlTypeValues[e.controlType].themedResources||(t.controlTypeValues[e.controlType].themedResources={})};this.__project_themeFiles.forEach(t=>{if(r(t),parent){for(const r of Object.keys(t.controlTypeValues[parent.controlType].attributes))void 0===t.controlTypeValues[e.controlType].attributes[r]&&(t.controlTypeValues[e.controlType].attributes[r]=t.controlTypeValues[parent.controlType].attributes[r]);for(const r of Object.keys(t.controlTypeValues[parent.controlType].themedResources))void 0===t.controlTypeValues[e.controlType].themedResources[r]&&(t.controlTypeValues[e.controlType].themedResources[r]=t.controlTypeValues[parent.controlType].themedResources[r])}}),this.__control_themeFiles.forEach(t=>{t.forEach((e,controlName)=>{r(e)});let o=t.get(e.controlType);if(o&&parent&&t.has(parent.controlType)){let r=t.get(parent.controlType);for(const t of Object.keys(r.controlTypeValues[parent.controlType].attributes))void 0===o.controlTypeValues[e.controlType].attributes[t]&&(o.controlTypeValues[e.controlType].attributes[t]=r.controlTypeValues[parent.controlType].attributes[t]);for(const t of Object.keys(r.controlTypeValues[parent.controlType].themedResources))void 0===o.controlTypeValues[e.controlType].themedResources[t]&&(o.controlTypeValues[e.controlType].themedResources[t]=r.controlTypeValues[parent.controlType].themedResources[t])}});for(let r of e.children)t(r,e)};t(e.System.Services.controlManager.getInheritanceTree(),void 0)},this.__asyncLoadCount=0,this.retriggerUserControls=()=>{let t=[];e.System.Services.controlManager.getControlsCache().forEach((control,controlName)=>{"TcHmi.Controls.System.TcHmiUserControlHost"===control.getType()&&t.push(control)}),this.__triggerControlsWithImplicitValues(t)},this.__watchAttributeDefaults=new Map,this.__destroyOnPropertyChanged=new Map,this.__settingThemeValueInProgess=!1,this.__onControlDestroyed=(e,control)=>{this.__watchAttributeDefaults.delete(control);const t=this.__destroyOnPropertyChanged.get(control);t&&(t(),this.__destroyOnPropertyChanged.delete(control))},this.__onControlClassNamesChanged=(e,data)=>{let t=this.__project_themeFiles.get(this.__activeThemes);if(t){if(data.oldClassNames)for(let e of data.oldClassNames)if(t.controlClassValues&&t.controlClassValues[e])return void this.__triggerControlsWithImplicitValues([data.control]);for(let e of data.newClassName)if(t.controlClassValues&&t.controlClassValues[e])return void this.__triggerControlsWithImplicitValues([data.control])}},e.EventProvider.register("System.onControlDestroyed",this.__onControlDestroyed),e.EventProvider.register("System.onControlClassNamesChanged",this.__onControlClassNamesChanged),e.EventProvider.register("System.onUserControlConfigCreated",this.retriggerUserControls),e.EventProvider.register("System.onUserControlConfigChanged",this.retriggerUserControls),e.EventProvider.register("System.onUserControlConfigRemoved",this.retriggerUserControls),e.System.config.themes||(e.System.config.themes={}),e.System.config.activeTheme&&this.setTheme(e.System.config.activeTheme,!1);const t=document.fonts;t&&t.addEventListener&&t.addEventListener("loadingdone",t=>{TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] System has loaded another font file. Triggering a onThemeDataChanged."),e.EventProvider.raise("onThemeDataChanged")})}__clearProjectThemeUrl(e){if(e.endsWith(".theme"))this.__control_themeFiles.clear(),this.__project_themeFiles.clear();else if(e.endsWith(".css")){let t=document.head.querySelector('link[href="'+e+'"]');t&&(t.href="")}}getTheme(){return this.__activeThemes}setTheme(valueNew,t){return"string"!=typeof valueNew||""===valueNew?e.Errors.E_PARAMETER_INVALID:(tchmi_equal(this.__activeThemes,valueNew)||(this.__activeThemes=valueNew,t&&this.processActiveTheme()),e.Errors.NONE)}registerControlThemeFiles(t){let r=e.System.resolveQualifiedName(t.name,t.namespace),o=t.themes;if(o)for(let t in o)for(let i=0;i<o[t].resources.length;i++){const n=o[t].resources[i];if(n.name){if("ThemedValues"===n.type){let e=this.__registered_themedValueFiles_fromControl.get(t);e||(e=new Map,this.__registered_themedValueFiles_fromControl.set(t,e));let o=e.get(r);o||(o=[],e.set(r,o)),o.push(n)}else if("Stylesheet"===n.type){let e=this.__registered_styleCheets_fromControl.get(t);e||(e=new Map,this.__registered_styleCheets_fromControl.set(t,e));let o=e.get(r);o||(o=[],e.set(r,o)),o.push(n)}}else TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] No file path found for theme entry  ("+t+") and control ("+r+") in Description.json:"),TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn(n)}}processActiveTheme(callback,options){let t=!1,r=t=>{var r;this.__asyncLoadCount--,this.__asyncLoadCount<=0&&(this.__resolveControlInheritance(),this.__triggerControlsWithImplicitValues(null),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] System has loaded and parsed all async files. Triggering a control resize check and event onThemeDataChanged."),null===(r=e.System.Services.controlManager)||void 0===r||r.checkControlGeometry(),e.EventProvider.raise("onThemeDataChanged"),e.Callback.callSafe(callback,this,{error:e.Errors.NONE}))};if(e.Engineering.ErrorPane.remove("ThemeManager_multipleThemes"),e.System.config)for(let o in e.System.config.themes){if(this.__activeThemes!==o)continue;let i="";for(let n=0;n<e.System.config.themes[o].resources.length;n++){let s=e.System.config.themes[o].resources[n];if("Stylesheet"===s.type)continue;if("ThemedValues"!==s.type){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ThemeManager] Type value of entry invalid in tchmiconfig.json (has to be ThemedValues or Stylesheet).",s);continue}if(!s.name){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ThemeManager] Entry missing name property in tchmiconfig.json.",s);continue}if(i){e.Engineering.ErrorPane.add("ThemeManager_multipleThemes","Only one ThemedValues entry per theme ("+o+") allowed in tchmiconfig.json. Only "+i+" will be used.",e.Engineering.ErrorPane.MessageType.Error);break}i=s.name;let l=this.__project_themeFiles.get(o);null!==l&&(void 0===l?(this.__project_themeFiles.set(o,null),((t,o)=>{let i=new XMLHttpRequest;i.addEventListener("load",n=>{if(200!==i.status)this.__project_themeFiles.delete(t),TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] Loading "+o+" failed: "+i.statusText);else{const r=e.ValueConverter.toObject(i.responseText,null);if(null!==r){let i={};for(let t in r.controlTypeValues){let o=e.System.mapControlNamesFromPackageManifestApi0ToApi1.get(t);o&&(i[o]=r.controlTypeValues[t])}for(let e in i)r.controlTypeValues[e]=i[e];i=null,this.__project_themeFiles.set(t,r),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Fetched and parsed "+o)}else this.__project_themeFiles.delete(t),TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] Failed to parse "+o+". Details: "+i.responseText)}r()});const n=n=>{this.__project_themeFiles.delete(t),0===i.status||TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("Failed to load "+o),r()};i.addEventListener("error",n),i.addEventListener("abort",n),i.addEventListener("timeout",n),i.open("GET",tchmi_path(o)),i.send(),this.__asyncLoadCount++,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Fetching "+o+" async.")})(o,s.name)):t=!0)}}let o=[this.__activeThemes];"Base"!==this.__activeThemes&&o.push("Base"),this.__registered_themedValueFiles_fromControl.forEach((i,n)=>{-1!==o.indexOf(n)&&i.forEach((o,i)=>{let s=e.System.Data.Modules.controls.map.get(i);if(!s)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Missing package control module for type: '"+i+"'."));if(s&&s.error!==e.Errors.NONE)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Can't load package control module for type: '"+i+"'. Error: "+e.Log.buildMessage(s.errorDetails)));let l=!1;for(let s=0;s<o.length;s++){let c=o[s],d=this.__control_themeFiles.get(n);if(d||(d=new Map,this.__control_themeFiles.set(n,d)),l){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ThemeManager] Only one ThemedValues entry per theme ("+n+") and control ("+i+") allowed in Description.json.",this.__registered_themedValueFiles_fromControl.get(n).get(i));break}l=!0;let _=d.get(i);null!==_&&(void 0===_?(d.set(i,null),((t,o,i)=>{let n=new XMLHttpRequest;n.addEventListener("load",s=>{if(200!==n.status)this.__control_themeFiles.get(t).delete(o),TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] Loading "+i+" failed: "+n.statusText);else{const r=e.ValueConverter.toObject(n.responseText);if(null!==r){let n={};for(let t in r.controlTypeValues){let o=e.System.mapControlNamesFromPackageManifestApi0ToApi1.get(t);o&&(n[o]=r.controlTypeValues[t])}for(let e in n)r.controlTypeValues[e]=n[e];n=null,this.__control_themeFiles.get(t).set(o,r),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Fetched and parsed "+i)}else this.__control_themeFiles.get(t).delete(o),TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] Failed to parse "+i+". Details: "+n.responseText)}r()});const s=s=>{this.__control_themeFiles.get(t).delete(o),0===n.status||TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi.System.ThemeManager] Failed to load "+i),r()};n.addEventListener("error",s),n.addEventListener("abort",s),n.addEventListener("timeout",s);let l=e.System.Data.Modules.controls.map.get(o);l?l&&l.error!==e.Errors.NONE?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Can't load package control module for type: '"+o+"'. Error: "+e.Log.buildMessage(l.errorDetails)):l.package&&void 0!==l.package.basePath&&l.manifestData&&void 0!==l.manifestData.basePath&&i&&(n.open("GET",tchmi_path(l.package.basePath+"/"+l.manifestData.basePath+"/"+i)),n.send(),this.__asyncLoadCount++,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Fetching "+i+" async.")):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Missing package control module for type: '"+o+"'.")})(n,i,c.name)):t=!0)}})});let i={frameworkGlobal:[],packages:[],projectGlobal:[],projectTheme:[]};if(e.System.description&&e.System.description.dependencyFiles)for(let t of e.System.description.dependencyFiles)"Stylesheet"===t.type&&i.frameworkGlobal.push({url:e.System.config.basePath+"/"+t.name,theme:null});if(e.System.config.packages&&e.System.config.packages.length>0){let t=new Set,r=new Set,o=new Set,n=i=>{let n=e.System.Data.packages.get(i.name);if(n){let e=!0;for(let r=0;r<n.manifest.modules.length;r++){let o=n.manifest.modules[r];if("Package"===o.type&&!t.has(o.nugetId)){e=!1;break}}return e?(r.has(n)||(r.add(n),t.add(i.name)),void o.delete(n)):void o.add(n)}};e.System.config.packages.forEach(n);let s=e.System.config.packages.length*e.System.config.packages.length;for(;o.size;){if(s<0){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Recursion or unsatisfied dependency found in referenced Packages from Properties/tchmiconfig.json");break}o.forEach(n),s--}let l=t=>{let r=e.System.Data.packages.get(t.name);r&&r.manifest.modules.forEach(r=>{var o,n;switch(r.type){case"Package":break;case"Resource":(null===(o=r.path)||void 0===o?void 0:o.endsWith(".css"))&&i.packages.push({theme:null,url:tchmi_path(t.basePath+"/"+r.path)});break;case"Control":const s=tchmi_path(t.basePath+"/"+r.basePath+"/"+r.descriptionFile);let l=e.System.Data.Modules.controls.urlMap.get(s);if(!l||!l.descriptionExpanded){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] Internal Error: Did not found entry "+s+" in url cache.");break}if(l.descriptionExpanded.dependencyFiles&&l.package&&(null===(n=null==l?void 0:l.manifestData)||void 0===n?void 0:n.basePath))for(let e of l.descriptionExpanded.dependencyFiles)"Stylesheet"===e.type&&i.packages.push({theme:null,url:tchmi_path(l.package.basePath+"/"+l.manifestData.basePath+"/"+e.name)});let c=e.System.resolveQualifiedName(l.descriptionExpanded.name,l.descriptionExpanded.namespace);if(e.System.config.themes[this.__activeThemes]&&e.System.config.themes[this.__activeThemes].replacesThemeForControls){if(e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(c))break;const t=e.System.mapControlNamesFromPackageManifestApi1ToApi0.get(c);if(t&&e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(t))break}let d=[],_=this.__activeThemes,m=this.__registered_styleCheets_fromControl.get(this.__activeThemes),u=m?m.get(c):void 0;if(u)d=u;else{if(!this.__registered_styleCheets_fromControl.has("Base")||!this.__registered_styleCheets_fromControl.get("Base").has(c))return;d=this.__registered_styleCheets_fromControl.get("Base").get(c),_="Base"}for(let e of d)i.packages.push({theme:_,url:tchmi_path(l.package.basePath+"/"+l.manifestData.basePath+"/"+e.name)})}})};r.forEach(l)}if(e.System.config.dependencyFiles)for(let t=0;t<e.System.config.dependencyFiles.length;t++){let r=e.System.config.dependencyFiles[t];"Stylesheet"===r.type&&i.projectGlobal.push({theme:null,url:r.name})}for(let t in e.System.config.themes)if(this.__activeThemes===t)for(let r=0;r<e.System.config.themes[t].resources.length;r++){let o=e.System.config.themes[t].resources[r];"Stylesheet"===o.type&&(o.name?i.projectTheme.push({theme:t,url:o.name}):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ThemeManager] Entry missing name property in tchmiconfig.json.",o))}let n=(t,o)=>{var i;t.length||t.push({url:"",theme:null});for(let n=0;n<t.length;n++){let s=t[n],l=tchmi_path(s.url),c=document.head.querySelectorAll("link[data-tchmi-file-origin="+o+"]");const d=c[n],_=()=>{const e=document.createElement("link");return e.rel="stylesheet",e.type="text/css",e.href=l,l?(e.addEventListener("load",r),e.addEventListener("error",r),this.__asyncLoadCount++):e.dataset.tchmiReason="internal marker",e.dataset.tchmiFileOrigin=o,s.theme&&(e.dataset.tchmiFromTheme=s.theme),e};if(d){if(d.getAttribute("href")!==l||(null!==(i=d.dataset.tchmiFromTheme)&&void 0!==i?i:null)!==s.theme){const t=_();d.replaceWith(t),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Replaced CSS style node for "+s.url+".")}}else{const t=_();let r=c.length?c[c.length-1]:void 0;r?(r.after(t),t.after(document.createTextNode("\n"))):(document.head.appendChild(t),document.head.appendChild(document.createTextNode("\n"))),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] Added CSS style node for "+s.url+".")}}let n=document.head.querySelectorAll("link[data-tchmi-file-origin="+o+"]");for(let e=t.length;e<n.length;e++)n[e].parentElement.removeChild(n[e])};n(i.frameworkGlobal,"frameworkGlobal"),n(i.packages,"package"),n(i.projectGlobal,"projectGlobal"),n(i.projectTheme,"projectTheme"),this.__asyncLoadCount<=0&&(t&&this.__triggerControlsWithImplicitValues(null),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ThemeManager] System has loaded and parsed all sync files. Triggering a onThemeDataChanged."),e.EventProvider.raise("onThemeDataChanged"),e.Callback.callSafe(callback,this,{error:e.Errors.NONE}))}__triggerControlsWithImplicitValues(t){let r=(t,control)=>{t.forEach((value,propertyName,t)=>{this.__settingThemeValueInProgess=!0;let error=e.System.Services.controlManager.setControlProperty(control,propertyName,null);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ThemeManager] "+e.Log.buildMessage(error)),this.__settingThemeValueInProgess=!1})};if(null===t)this.__watchAttributeDefaults.forEach((e,control)=>{r(e,control)});else for(let e of t){var o=this.__watchAttributeDefaults.get(e);o&&r(o,e)}}getDefaultPropertyValue(control,propertyName){let r=null,o=this.__project_themeFiles.get(this.__activeThemes);const i=control.getClassNames();if(i&&i.length>0){for(let e of i)o&&o.controlClassValues&&o.controlClassValues[e]&&o.controlClassValues[e].attributes&&void 0!==o.controlClassValues[e].attributes[propertyName]&&null!==o.controlClassValues[e].attributes[propertyName]&&(r=o.controlClassValues[e].attributes[propertyName]);if(null!==r)return{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)}}const n=control.getType();if(o&&o.controlTypeValues&&o.controlTypeValues[n]&&void 0!==o.controlTypeValues[n].attributes[propertyName]&&null!==o.controlTypeValues[n].attributes[propertyName])return r=o.controlTypeValues[n].attributes[propertyName],{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)};const s=e.System.mapControlNamesFromPackageManifestApi1ToApi0.get(n);if(e.System.config.themes[this.__activeThemes]&&e.System.config.themes[this.__activeThemes].replacesThemeForControls&&e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(n));else if(s&&e.System.config.themes[this.__activeThemes]&&e.System.config.themes[this.__activeThemes].replacesThemeForControls&&e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(s));else{let t=[this.__activeThemes];"Base"!==this.__activeThemes&&t.push("Base");for(let o of t){let t=this.__control_themeFiles.get(o),i=t?t.get(n):void 0;if(i&&i.controlTypeValues&&i.controlTypeValues[n]&&i.controlTypeValues[n].attributes&&void 0!==i.controlTypeValues[n].attributes[propertyName]&&null!==i.controlTypeValues[n].attributes[propertyName])return r=i.controlTypeValues[n].attributes[propertyName],{error:e.Errors.NONE,origin:"control",originThemeName:o,value:tchmi_clone_object(r)}}}let l=e.System.Services.controlManager.getDescriptionAttributeByPropertyName(n,propertyName);if(l){if(void 0!==l.defaultValueInternal)return r=l.defaultValueInternal,{error:e.Errors.NONE,origin:"control",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)};{let schema=e.Type.getSchema(l.type);if(schema)return r=e.Type.Schema.resolveDefault(schema),{error:e.Errors.NONE,origin:"control",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)}}}if("TcHmi.Controls.System.TcHmiUserControlHost"===n){let o=control.getTargetUserControl();if(o){let i=tchmi_path(o.replace(".usercontrol",".usercontrol.json")),n=t.Services.controlManager.getUserControlConfigAttributeByPropertyName(i,propertyName);if(n&&void 0!==n.defaultValueInternal)return r=n.defaultValueInternal,{error:e.Errors.NONE,origin:"control",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)};if(n){let type=n.type;if(type){let schema=e.Type.getSchema(type);if(schema)return r=e.Type.Schema.resolveDefault(schema),{error:e.Errors.NONE,origin:"control",originThemeName:this.__activeThemes,value:tchmi_clone_object(r)}}}}}return{error:e.Errors.NONE,origin:"control",originThemeName:this.__activeThemes,value:null}}getThemeResource(control,resourceName){let t=null,r=this.__project_themeFiles.get(this.__activeThemes);const o=control.getClassNames();if(o&&o.length>0){for(let e of o)r&&r.controlClassValues&&r.controlClassValues[e]&&void 0!==r.controlClassValues[e].themedResources[resourceName]&&null!==r.controlClassValues[e].themedResources[resourceName]&&(t=r.controlClassValues[e].themedResources[resourceName]);if(null!==t)return{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:tchmi_clone_object(t)}}const i=control.getType();if(r&&r.controlTypeValues&&r.controlTypeValues[i]&&r.controlTypeValues[i].themedResources&&void 0!==r.controlTypeValues[i].themedResources[resourceName]&&null!==r.controlTypeValues[i].themedResources[resourceName])return t=r.controlTypeValues[i].themedResources[resourceName],{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:tchmi_clone_object(t)};if(e.System.config.themes[this.__activeThemes]&&e.System.config.themes[this.__activeThemes].replacesThemeForControls){if(e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(i))return{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:null};const t=e.System.mapControlNamesFromPackageManifestApi1ToApi0.get(i);if(t&&e.System.config.themes[this.__activeThemes].replacesThemeForControls.includes(t))return{error:e.Errors.NONE,origin:"project",originThemeName:this.__activeThemes,value:null}}let n=[this.__activeThemes];"Base"!==this.__activeThemes&&n.push("Base");for(let r of n){let o=this.__control_themeFiles.get(r),n=o?o.get(i):void 0;if(n&&n.controlTypeValues&&n.controlTypeValues[i]&&n.controlTypeValues[i].themedResources&&void 0!==n.controlTypeValues[i].themedResources[resourceName]&&null!==n.controlTypeValues[i].themedResources[resourceName])return t=n.controlTypeValues[i].themedResources[resourceName],{error:e.Errors.NONE,origin:"control",originThemeName:r,value:tchmi_clone_object(t)}}return{error:e.Errors.ERROR,origin:"control",originThemeName:this.__activeThemes,value:null}}watchAttributeDefaults(control,propertyName){let e=this.__watchAttributeDefaults.get(control);e||(e=new Map,this.__watchAttributeDefaults.set(control,e)),e.set(propertyName,!0)}startAttributeSetterWatcher(control){this.__watchAttributeDefaults.has(control)&&(this.__destroyOnPropertyChanged.has(control)||this.__destroyOnPropertyChanged.set(control,e.EventProvider.register(control.getId()+".onPropertyChanged",this.__handleOnPropertyChanged(control))))}unwatchAttributeDefaults(control,propertyName){let e=this.__watchAttributeDefaults.get(control);if(e&&e.delete(propertyName)&&0===e.size){this.__watchAttributeDefaults.delete(control);const e=this.__destroyOnPropertyChanged.get(control);e&&(e(),this.__destroyOnPropertyChanged.delete(control))}}__handleOnPropertyChanged(control){return(e,data)=>{if(this.__settingThemeValueInProgess)return;let r=t.Services.controlManager.getDescriptionAttributeByPropertyName(control.getType(),data.propertyName);r&&!r.readOnly&&this.unwatchAttributeDefaults(control,r.propertyName)}}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.TopMostLayer=class{constructor(){this.__optionsList=new Map,this.__detachEventDestroy=null,this.__abortClick=e=>{if(e.target===this.__masterDiv.lastElementChild&&this.__masterDiv.lastElementChild){let e=this.__masterDiv.lastElementChild.lastElementChild,t=this.__optionsList.get(e);t&&!1!==t.closeOnBackground&&this.remove(t.origin,$(e),!0)}},this.__checkDetachedControls=(e,control)=>{this.__optionsList.forEach((e,t)=>{e.origin===control&&this.remove(control,$(t),!0)})},this.__updateAllChildPosition=(t,r)=>{if(t&&Array.isArray(t)){let e=!1,r=new Map;for(let o=0,i=t.length;o<i;o++){let i=t[o],n=i.target;if(n instanceof HTMLElement)if("attributes"===i.type){if("style"!==i.attributeName){e=!0,r.clear();break}r.has(n)||r.set(n,i.oldValue)}else if("childList"===i.type){e=!0,r.clear();break}}if(!1===e&&r.forEach((function(t,r,o){t!==r.getAttribute("style")&&(e=!0),o.clear()})),!1===e)return}let o=[];const i=this.__masterDiv.children;for(let t=0;t<i.length;t++){if(!(i[t]instanceof HTMLElement))continue;let r=i[t],n=r.firstElementChild,s=this.__optionsList.get(n);if(s){let t=!0===s.centerVertical||!0===s.centerHorizontal;if(t||s.resizeCb){let i=!1;if(t){const e=r.firstElementChild.getBoundingClientRect();if(!0===s.centerVertical){const t=(document.documentElement.clientHeight-e.height)/2;n.style.top!==t+"px"&&(n.style.top=t+"px",i=!0)}if(!0===s.centerHorizontal){const t=(document.documentElement.clientWidth-e.width)/2;n.style.left!==t+"px"&&(n.style.left=t+"px",i=!0)}}!1!==t&&!0!==i||!s.resizeCb||o.push({callback:s.resizeCb,thisArg:s.origin,args:{error:e.Errors.NONE,element:$(n),parentPixelSize:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}})}}}for(let t=0;t<o.length;t++)e.Callback.callSafe(o[t].callback,o[t].thisArg,o[t].args)},this.__dimLastContainer=()=>{const e=this.__masterDiv.children;let t;for(let r=0;r<e.length;r++){if(!(e[r].firstElementChild instanceof HTMLElement))continue;let o=e[r];o.classList.remove("tchmi-topmostlayer-non-modal");let i=this.__optionsList.get(o.firstElementChild);i&&(!1!==i.dimBackground&&(t=o),o.classList.remove("tchmi-topmostlayer-background-dim"),!1===i.modal&&o.classList.add("tchmi-topmostlayer-non-modal"))}t&&t.classList.add("tchmi-topmostlayer-background-dim")},this.__masterDiv=document.createElement("div"),this.__masterDiv.id="tchmi-system-top-layer-master",this.__masterDiv.style.zIndex="5000",this.__masterDiv.style.position="absolute",this.__masterDiv.addEventListener("click",this.__abortClick,!1),this.__mutationObserver=new MutationObserver(this.__updateAllChildPosition)}add(t,element,options){if(!element)return!1;if(1!==element.length)return!1;let r=element[0];if(!(r instanceof HTMLElement))return!1;if(this.__optionsList.has(r))return!1;r.classList.add("tchmi-in-topmostlayer");let o=document.createElement("div");if(o.classList.add("tchmi-system-topmostlayer-container"),o.style.position="fixed",o.style.width="100%",o.style.height="100%",o.style.overscrollBehavior="contain",o.appendChild(r),this.__masterDiv.appendChild(o),options){let e=tchmi_clone_object(options);this.__optionsList.set(r,e),e.origin=t,e.styleBackup={},!0!==e.centerVertical&&!0!==e.centerHorizontal||(!0===e.centerHorizontal&&(e.styleBackup.left=r.style.left),!0===e.centerVertical&&(e.styleBackup.top=r.style.top),e.styleBackup.position=r.style.position,r.style.position="absolute",this.__mutationObserver.observe(r,{attributes:!0,attributeFilter:["style","class","id"],attributeOldValue:!0,childList:!0,subtree:!0}))}if(this.__dimLastContainer(),!this.__masterDiv.parentElement){const t={passive:!0,capture:!1};window.addEventListener("resize",this.__updateAllChildPosition,t),this.__detachEventDestroy=e.EventProvider.register("System.onControlDetached",this.__checkDetachedControls),document.body.appendChild(this.__masterDiv)}return this.__updateAllChildPosition(),this.__masterDiv.querySelectorAll("div[data-tchmi-type]").forEach(element=>{element.classList.add("tchmi-in-topmostlayer");let control=e.Controls.get(element.id);control&&!control.getParent()&&(control.__processIsEnabled(),control.__processAccessConfig())}),!0}remove(t,element,r){if(!element)return element;if(1!==element.length)return element;let o=element[0],i=this.__optionsList.get(o);if(!i)return element;o.classList.remove("tchmi-in-topmostlayer"),o.querySelectorAll("div[data-tchmi-type]").forEach(element=>{element.classList.remove("tchmi-in-topmostlayer")});const n=o.parentElement;if(this.__masterDiv.removeChild(n),n.removeChild(o),!this.__masterDiv.firstElementChild){document.body.removeChild(this.__masterDiv);const e={passive:!0,capture:!1};window.removeEventListener("resize",this.__updateAllChildPosition,e),this.__detachEventDestroy&&(this.__detachEventDestroy(),this.__detachEventDestroy=null),this.__mutationObserver.disconnect()}const s={error:e.Errors.NONE,element:element,canceled:r};return!0!==i.centerVertical&&!0!==i.centerHorizontal||(o.style.position=i.styleBackup.position,!0===i.centerHorizontal&&(o.style.left=i.styleBackup.left),!0===i.centerVertical&&(o.style.top=i.styleBackup.top)),this.__optionsList.delete(o),i.removeCb&&e.Callback.callSafe(i.removeCb,i.origin,s),this.__dimLastContainer(),element}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.SyncCmdToFramework=class{constructor(t){this.__cmd=t,this.__result=e.Errors.NONE,this.sendSynchronousConfirmation=!0}confirmRequest(t){new e.System.Engineering.SyncCmdToCreatorConfirmation({name:"Confirmation",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",confirmId:t,errorCode:this.__result,replyTo:null}).send()}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){if(!1===TCHMI_DESIGNER)return;if(tchmi_path(this.__cmd.targetPartial)!==TCHMI_TARGET_PARTIAL)return;let r=this.__cmd.controls;for(var o=0,i=r.length;o<i;o++){const t=e.Controls.get(r[o]);if(!t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkRemoveControls] Failed to remove control "${r[o]}": Not found in control cache.\n`);break}null!==t.getParent()&&t.getParent().getPcElement().children("#"+tchmi_css_escape_selector(t.getId())).remove(),e.Engineering.ErrorPane.remove(t.getId()+"requiredAttributeTouched"),t.__getKeepAlive()&&t.__setKeepAlive(!1),t.destroy()}new t.SyncCmdToCreatorSyncControls({name:"SyncControls",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,controls:[],replyTo:null}).send()}}t.SyncCmdToFrameworkRemoveControls=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToFramework{constructor(e){super(e),this.sendSynchronousConfirmation=!1}run(){}}e.SyncCmdToFrameworkConfirmation=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL&&e.System.Services.Engineering.designerModeManager.setControlLocked(this.__cmd.targetControl,this.__cmd.locked)}}t.SyncCmdToFrameworkControlLocked=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e),this.__controlsToSelect=[],this.__createsPending=0}createCallback(){return data=>{if(this.__createsPending--,this.__createsPending<=0&&!0===TCHMI_DESIGNER&&this.__controlsToSelect.length>0){e.System.Services.Engineering.designerModeManager.unselectEach(!0);for(let t=0,r=this.__controlsToSelect.length;t<r;t++){let r=this.__controlsToSelect[t];e.System.Services.Engineering.designerModeManager.select(r,!0)}!0===TCHMI_DESIGNER&&e.System.Services.Engineering.designerModeManager.resyncSelectedControls()}}}run(){if(!1===TCHMI_DESIGNER)return;if(tchmi_path(this.__cmd.targetPartial)!==TCHMI_TARGET_PARTIAL)return;let t=this.__cmd.controls;if(null!=t)for(let r=0,o=t.length;r<o;r++){let control=this.__cmd.controls[r];control.controlHtml?(this.__createsPending++,!0===TCHMI_DESIGNER&&!0===control.select&&this.__controlsToSelect.push(control.controlId),e.System.Services.Engineering.designerModeManager.createControl(this.__cmd.targetPartial,control.targetParentControl,control.domPosition,control.controlHtml,this.createCallback())):(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCreateControls] Failed to decode base64 encoded html content of "+control.controlId),this.__result=e.Errors.E_PARAMETER_INVALID),control=null}else this.__result=e.Errors.E_PARAMETER_INVALID}}t.SyncCmdToFrameworkCreateControls=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(r){class o extends r.SyncCmdToFramework{constructor(e){super(e)}run(){if(void 0===this.__cmd.targetPartial||null===this.__cmd.targetPartial)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCurrentPartialContent] Failed to synchronize partial. Command property targetPartial="+this.__cmd.targetPartial+"."),void(this.__result=e.Errors.E_PARAMETER_INVALID);let r=tchmi_path(this.__cmd.targetPartial);const o=e.ValueConverter.toObject(this.__cmd.piggyBack,null);if(!this.__cmd.content)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCurrentPartialContent] Failed to synchronize partial="+r+". Command property content="+this.__cmd.content+"."),void(this.__result=e.Errors.E_PARAMETER_INVALID);if(null!=o&&void 0!==o.requestId&&null!==o.requestId){let request=e.System.Services.Engineering.designerModeManager.partialContentManager.getRequest(o.requestId);if(request){let callback=request.callback;request.destroy&&request.destroy(),e.Callback.callSafe(callback,null,{error:e.Errors.NONE,targetPartial:r,content:this.__cmd.content})}}else{let o=document.createElement("div");o.innerHTML=this.__cmd.content;let i=o.firstElementChild;if(!i||void 0===i.id)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCurrentPartialContent] Failed to synchronize partial="+r+". Failed to read attribute=id."),void(this.__result=e.Errors.E_PARAMETER_INVALID);if(e.Controls.get(i.id))try{e.System.Services.Engineering.designerModeManager.syncControl(r,i.id,i.outerHTML)}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCurrentPartialContent] Failed to synchronize partial="+r+". Unexpected exception="+t+"."),void(this.__result=e.Errors.E_PARAMETER_INVALID)}let type=e.PartialType.Invalid;try{let o=[];r.indexOf(".view")>-1?(o=t.config.views,type=e.PartialType.View):r.indexOf(".content")>-1?(o=t.config.content,type=e.PartialType.Content):r.indexOf(".usercontrol")>-1&&(o=t.config.userControls,type=e.PartialType.UserControl);for(let t=0,n=o.length;t<n;t++)if(o[t].url===r){type!==e.PartialType.UserControl&&(type!==e.PartialType.View&&type!==e.PartialType.Content||!0!==o[t].preload)||e.System.Data.Caches.partialMarkupCache.set(r,{markup:this.__cmd.content,partialId:i.id});break}}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkCurrentPartialContent] Failed to synchronize partial="+r+". Unexpected exception="+t+".")}switch(type){case e.PartialType.View:e.EventProvider.raise("System.onViewChanged",{url:r,content:this.__cmd.content});break;case e.PartialType.Content:e.EventProvider.raise("System.onContentChanged",{url:r,content:this.__cmd.content});break;case e.PartialType.UserControl:e.EventProvider.raise("System.onUserControlChanged",{url:r,content:this.__cmd.content});break;case e.PartialType.Invalid:}!0===TCHMI_ENGINEERING&&!0===TCHMI_DESIGNER&&e.System.Services.Engineering.designerModeManager.highlightManager.processDomVisibility()}}}r.SyncCmdToFrameworkCurrentPartialContent=o}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){if(!0===TCHMI_DESIGNER||!0!==TCHMI_LIVEVIEW)return;tchmi_path(this.__cmd.targetPartial)===TCHMI_TARGET_PARTIAL&&!0===this.__cmd.locked&&e.Services.Engineering.designerModeManager.lock()}}t.SyncCmdToFrameworkCurrentPartialEditorLockState=r}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){if(!0!==TCHMI_DESIGNER)return;tchmi_path(this.__cmd.targetPartial)===TCHMI_TARGET_PARTIAL&&e.Services.Engineering.designerModeManager.highlightManager.setHighlightContainerVisibility(this.__cmd.state)}}t.SyncCmdToFrameworkCurrentPartialHighlightContainerState=r}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){!1!==TCHMI_DESIGNER&&e.System.Services.Engineering.designerModeManager.updateSettings(this.__cmd.settings)}}t.SyncCmdToFrameworkDesignerSettings=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL&&e.System.Services.Engineering.designerModeManager.highlightManager.setCreatorVisibilityAttribute(this.__cmd.targetControl,this.__cmd.visibility)}}t.SyncCmdToFrameworkDomVisibility=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){e.System.Services.Engineering.designerModeManager.resourceInjectionManager.injectPackageResources(this.__cmd.injectInfo,data=>{new t.SyncCmdToCreatorInjectedResources({name:"InjectedResources",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_DESIGNER?TCHMI_TARGET_PARTIAL:void 0,piggyBack:this.__cmd.piggyBack,replyTo:null}).send()})}}t.SyncCmdToFrameworkInjectResources=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e),this.sendSynchronousConfirmation=!1}run(){if(!1===TCHMI_DESIGNER)return;if(tchmi_path(this.__cmd.targetPartial)!==TCHMI_TARGET_PARTIAL)return;let t=this.__cmd.states;null!=t?(void 0!==t.leftCtrl&&null!==t.leftCtrl&&void 0!==t.leftCtrl.down&&!0===t.leftCtrl.down||void 0!==t.rightCtrl&&null!==t.rightCtrl&&void 0!==t.rightCtrl.down&&!0===t.rightCtrl.down?e.System.Services.Engineering.designerModeManager.interactionManager.setCtrlModifierKeyState(!0):e.System.Services.Engineering.designerModeManager.interactionManager.setCtrlModifierKeyState(!1),void 0!==t.leftShift&&null!==t.leftShift&&void 0!==t.leftShift.down&&!0===t.leftShift.down||void 0!==t.rightShift&&null!==t.rightShift&&void 0!==t.rightShift.down&&!0===t.rightShift.down?e.System.Services.Engineering.designerModeManager.interactionManager.setShiftModifierKeyState(!0):e.System.Services.Engineering.designerModeManager.interactionManager.setShiftModifierKeyState(!1)):this.__result=e.Errors.E_PARAMETER_INVALID}}t.SyncCmdToFrameworkKeyStates=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){4!==e.System.Services.accessManager.getCurrentUserConfig().state||this.__cmd.targetInstance&&this.__cmd.targetInstance!==TCHMI_DYNAMIC_INSTANCE_ID||e.Server.logout()}}t.SyncCmdToFrameworkLogoutClient=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){tchmi_path(this.__cmd.targetPartial)===tchmi_path(TCHMI_TARGET_PARTIAL)&&e.System.Services.Engineering.designerModeManager.lock()}}t.SyncCmdToFrameworkPartialEditorLocked=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToFramework{constructor(e){super(e)}run(){if(TCHMI_DESIGNER){if(tchmi_path(this.__cmd.targetPartial)!==tchmi_path(TCHMI_TARGET_PARTIAL))return;void 0!==window.location&&null!==window.location&&window.location.reload(!0)}}}e.SyncCmdToFrameworkPartialEditorUnlocked=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){if(!1===TCHMI_DESIGNER)return;const r=tchmi_path(this.__cmd.targetPartial);if(r!==TCHMI_TARGET_PARTIAL)return;if(void 0===this.__cmd.type||null===this.__cmd.type)return void(this.__result=e.Errors.E_PARAMETER_INVALID);const o=e.System.Services.Engineering.designerModeManager.hierarchyManager.getContainerFromPoint({left:this.__cmd.position.left+window.scrollX,top:this.__cmd.position.top+window.scrollY});if(!o)return void(this.__result=e.Errors.ERROR);let i={name:"DropControlPosition",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:r,controls:[{piggyBack:this.__cmd.piggyBack,targetParentControl:o.tco.getId(),type:this.__cmd.type,position:{centerX:o.mousePosXinTarget,centerY:o.mousePosYinTarget}}],replyTo:null};null===o.rowIndex||null===o.columnIndex||0===o.rowIndex&&0===o.columnIndex||(i.controls[0].attributes=[{name:"data-tchmi-grid-row-index",value:o.rowIndex},{name:"data-tchmi-grid-column-index",value:o.columnIndex}]),new t.SyncCmdToCreatorDropControlPosition(i).send()}}t.SyncCmdToFrameworkRequestDropControlPosition=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL&&e.System.Services.Engineering.designerModeManager.rootControlManager.scroll(this.__cmd.position)}}t.SyncCmdToFrameworkScrollPositionChanged=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);if(!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL){e.System.Services.Engineering.designerModeManager.unselectEach(!0);let t=this.__cmd.controls;for(let r=0,o=t.length;r<o;r++){let control=t[r];e.System.Services.Engineering.designerModeManager.select(control,!0)}e.System.Services.Engineering.designerModeManager.resyncSelectedControls()}}}t.SyncCmdToFrameworkSelectedControls=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL&&e.System.Services.serverManager.setServerAddress(this.__cmd.host,this.__cmd.port,this.__cmd.protocol)}}t.SyncCmdToFrameworkServerAddress=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){if(!1===TCHMI_DESIGNER)return;const t=tchmi_path(this.__cmd.targetPartial);if(t!==TCHMI_TARGET_PARTIAL)return;let r=!1;const o=this.__cmd.controls;for(let i=0,n=o.length;i<n;i++){const control=o[i];try{!0===e.System.Services.Engineering.designerModeManager.syncControl(t,control.targetControl,control.controlHtml)&&(r=!0)}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),this.__result=e.Errors.ERROR}}!0===r&&e.System.Services.Engineering.designerModeManager.highlightManager.processDomVisibility()}}t.SyncCmdToFrameworkSyncControls=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}__refreshBaseConfig(t,r){t.scaleMode!==r.scaleMode&&e.System.Services.viewManager.setScaleMode(t.scaleMode),!1===TCHMI_DESIGNER?t.startupView!==r.startupView&&e.System.Services.viewManager.loadView(t.startupView):t.creatorSettings&&t.creatorSettings.viewport&&(t.creatorSettings.viewport.defaultHeight!==r.creatorSettings.viewport.defaultHeight||t.creatorSettings.viewport.defaultWidth!==r.creatorSettings.viewport.defaultWidth)&&e.System.Services.Engineering.designerModeManager.rootControlManager.setCreatorViewPortPosition(e.System.Services.viewManager.getView()),t.activeTheme!==r.activeTheme?e.System.Services.themeManager.setTheme(t.activeTheme,!0):tchmi_equal(t.themes,r.themes)&&tchmi_equal(t.dependencyFiles.filter(value=>"Stylesheet"===value.type),r.dependencyFiles.filter(value=>"Stylesheet"===value.type))||e.System.Services.themeManager.processActiveTheme(),tchmi_equal(t.trigger,r.trigger)||(e.System.Services.triggerManager.unregister(r.trigger),e.System.Services.triggerManager.register(t.trigger)),TCHMI_ENGINEERING&&TCHMI_LIVEVIEW&&!tchmi_equal(t.tcHmiServer,r.tcHmiServer)&&e.System.Services.serverManager.refreshSubscriptions()}__loadViewPartial(t,callback){var r=null;if(!0===t.preload&&!0!==TCHMI_DESIGNER){let o=new XMLHttpRequest;o.open("GET",t.url+"?preventcache="+Math.random()),o.addEventListener("load",(function(i){200===o.status?r=o.responseText:TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+". Details:"+o.statusText),e.Callback.callSafe(callback,null,t,r)})),o.addEventListener("error",(function(i){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+". Details:"+o.statusText),e.Callback.callSafe(callback,null,t,r)})),o.send()}}__loadViewPartialCallback(t,r){if(null==r)return;let o,i=tchmi_path(t.url);if(void 0!==t.url&&null!==t.url&&!0===t.preload&&(o={markup:r},e.System.Data.Caches.partialMarkupCache.set(i,o)),!0===t.preload&&void 0!==t.url&&null!==t.url&&!0!==TCHMI_DESIGNER){let i=document.createElement("div");if(i.innerHTML=r,i.firstElementChild){const r=e.System.Services.controlManager.compile(i.firstElementChild);void 0!==r&&(o&&(o.partialId=r.getId()),r.__setKeepAlive(!0),r.getElement().attr("data-tchmi-partial-url",t.url))}}e.EventProvider.raise("System.onViewCreated",{url:i})}__refreshViewPartials(t,r){if(null==t||null==r)return;let o=[];for(let e=0,i=r.length;e<i;e++){let i=r[e],n=!1;for(let e=0,r=t.length;e<r;e++){if(t[e].url===i.url){n=!0;break}}!1===n&&o.push(i)}let i=[];for(let e=0,o=t.length;e<o;e++){var n=t[e],s=!1;for(let e=0,t=r.length;e<t;e++){let t=r[e];if(n.url===t.url){s=!0;break}}!1===s&&i.push(n)}for(let t=0,r=o.length;t<r;t++){let r=o[t];if(void 0===r.url||null===r.url)continue;let i=tchmi_path(r.url);e.System.Data.Caches.partialMarkupCache.delete(i),e.EventProvider.raise("System.onViewRemoved",{url:i})}for(let e=0,t=i.length;e<t;e++){let t=i[e];this.__loadViewPartial(t,this.__loadViewPartialCallback)}}__loadContentPartial(t,callback){if(!0===t.preload&&!0!==TCHMI_DESIGNER){let r=new XMLHttpRequest;r.open("GET",t.url+"?preventcache="+Math.random()),r.addEventListener("load",(function(o){200===r.status?t=e.ValueConverter.toObject(r.responseText):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+". Details:"+r.statusText),e.Callback.callSafe(callback,null,t,null)})),r.addEventListener("error",(function(o){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+". Details:"+r.statusText),e.Callback.callSafe(callback,null,t,null)})),r.send()}}__loadContentPartialCallback(t,r){let o,i=tchmi_path(t.url);if(null!=r&&void 0!==t.url&&null!==t.url&&!0===t.preload&&(o={markup:r},e.System.Data.Caches.partialMarkupCache.set(i,o)),!0===t.preload&&void 0!==t.url&&null!==t.url&&!0!==TCHMI_DESIGNER){let i=document.createElement("div");if(i.innerHTML=r,i.firstElementChild){const r=e.System.Services.controlManager.compile(i.firstElementChild);void 0!==r&&(o&&(o.partialId=r.getId()),r.getElement().attr("data-tchmi-partial-url",t.url))}}e.EventProvider.raise("System.onContentCreated",{url:i})}__refreshContentPartials(content,t){if(null==content||null==t)return;let r=[];for(let e=0,o=t.length;e<o;e++){let o=t[e],i=!1;for(let e=0,t=content.length;e<t;e++){if(content[e].url===o.url){i=!0;break}}!1===i&&r.push(o)}let o=[];for(let e=0,r=content.length;e<r;e++){var i=content[e],n=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(i.url===r.url){n=!0;break}}!1===n&&o.push(i)}for(let t=0,o=r.length;t<o;t++){let o=r[t];if(void 0===o.url||null===o.url)continue;let i=tchmi_path(o.url);e.System.Data.Caches.partialMarkupCache.delete(i),e.EventProvider.raise("System.onContentRemoved",{url:i})}for(let e=0,t=o.length;e<t;e++){let t=o[e];this.__loadViewPartial(t,this.__loadViewPartialCallback)}}__loadUserControlPartial(t,callback){var r=null,o=null,i=t.url.replace(".usercontrol",".usercontrol.json");let n=new XMLHttpRequest;n.open("GET",t.url+"?preventcache="+Math.random()),n.addEventListener("load",(function(s){if(200===n.status){r=n.responseText;let s=new XMLHttpRequest;s.open("GET",i+"?preventcache="+Math.random()),s.addEventListener("load",(function(n){200===s.status?o=e.ValueConverter.toObject(s.responseText):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+i+". Details:"+s.statusText),e.Callback.callSafe(callback,null,t,r,o)})),s.addEventListener("error",(function(n){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+i+". Details:"+s.statusText),e.Callback.callSafe(callback,null,t,r,o)})),s.send()}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+", status="+n.status),e.Callback.callSafe(callback,null,t,r,o)})),n.addEventListener("error",(function(i){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+t.url+", status="+n.status),e.Callback.callSafe(callback,null,t,r,o)})),n.send()}__loadUserControlPartialCallback(t,r,o){if(null==r)return;let i,n=tchmi_path(t.url),s=tchmi_path(t.url.replace(".usercontrol",".usercontrol.json"));void 0!==t.url&&null!==t.url&&(i={markup:r},e.System.Data.Caches.partialMarkupCache.set(n,i)),null!=o&&void 0!==t.url&&null!==t.url&&e.System.Data.Caches.partialCompositeConfigCache.set(s,o),e.EventProvider.raise("System.onUserControlCreated",{url:n}),e.EventProvider.raise("System.onUserControlConfigCreated",{url:s})}__refreshUserControlPartials(t,r){if(null==t||null==r)return;let o=[];for(let e=0,i=r.length;e<i;e++){let i=r[e],n=!1;for(let e=0,r=t.length;e<r;e++){t[e].url===i.url&&(n=!0)}!1===n&&o.push(i)}let i=[];for(let e=0,o=t.length;e<o;e++){let o=t[e],n=!1;for(let e=0,t=r.length;e<t;e++){let t=r[e];o.url===t.url&&(n=!0)}!1===n&&i.push(o)}for(let t=0,r=o.length;t<r;t++){let r=o[t];if(void 0===r.url||null===r.url)continue;let i=tchmi_path(r.url),n=tchmi_path(r.url.replace(".usercontrol",".usercontrol.json"));e.System.Data.Caches.partialMarkupCache.delete(i),e.System.Data.Caches.partialCompositeConfigCache.delete(n),e.EventProvider.raise("System.onUserControlRemoved",{url:i}),e.EventProvider.raise("System.onUserControlConfigRemoved",{url:n})}for(let e=0,t=i.length;e<t;e++){let t=i[e];this.__loadUserControlPartial(t,this.__loadUserControlPartialCallback)}}__refreshSymbols(t,r){let o=0,i=0,n=t.internal,s=r.internal,l=null,c=null,d=!1,_=[],m=!1,u=[],g=[];if(null!=s&&null!=n)for(c in s)if(s.hasOwnProperty(c)){for(l in d=!0,n)if(n.hasOwnProperty(l)){if(c===l){d=!1;break}l=null}!0===d&&_.push(c),d=!1,c=null}for(o=0,i=_.length;o<i;o++)e.System.Services.internalSymbolManager.remove(_[o]);if(null!=s&&null!=n)for(l in n)if(n.hasOwnProperty(l)){for(c in m=!0,s)if(s.hasOwnProperty(c)&&l===c){m=!1,tchmi_equal(n[l].value,s[c].value)&&n[l].persist===s[c].persist&&n[l].type===s[c].type&&n[l].readonly===s[c].readonly||g.push({key:l,item:n[l]});break}!0===m&&u.push({key:l,item:n[l]})}for(o=0,i=u.length;o<i;o++)e.System.Services.internalSymbolManager.add(u[o].key,u[o].item);for(o=0,i=g.length;o<i;o++)e.System.Services.internalSymbolManager.update(g[o].key,g[o].item)}__refreshPackages(t,r){let o=0,i=0,n=0,s=0,l=!1,c=[];if(null!=t&&null!=r){for(o=0,i=t.length;o<i;o++){for(l=!0,n=0,s=r.length;n<s;n++)if(t[o].name===r[n].name){l=!1;break}!0===l&&c.push(t[o])}e.System.Services.Engineering.designerModeManager.resourceInjectionManager.injectPackageResources(c)}}__refreshUserFunctions(t,r){let o=[];for(let e=0,s=t.length;e<s;e++){var i=t[e],n=!1;if(r)for(let e=0,t=r.length;e<t;e++){let t=r[e];if(tchmi_path(i.url)===tchmi_path(t.url)){n=!0;break}}else n=!1;!1===n&&o.push(i)}for(let t=0,r=o.length;t<r;t++){!function(t){let url=tchmi_path(t.url.replace(".js",".function.json")),r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(t){if(200===r.status){let t=e.ValueConverter.toObject(r.responseText),name=t.function.name,namespace=t.function.namespace,o=e.System.resolveQualifiedName(name,namespace),i=e.System.Data.Registrations.functions.map.get(name),n=function(){let name=i.name,r=e.System.resolveQualifiedName(i.name,i.namespace),o={error:e.Errors.NONE,reg:i,description:t};e.System.Data.Modules.functions.map.has(name)?e.System.Data.Modules.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.functions.map.set(name,o),r!==name&&(e.System.Data.Modules.functions.map.has(r)?e.System.Data.Modules.functions.map.set(r,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.functions.map.set(r,o))};i&&i.error!==e.Errors.E_NOT_UNIQUE||(i=e.System.Data.Registrations.functions.map.get(o),i?n():e.EventProvider.register("System.onFunctionRegistered",(function(e,data){e.destroy(),i=data,n()})))}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Details: "+r.statusText)})),r.addEventListener("error",(function(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Details: "+r.statusText)})),r.send()}(o[t])}}__refreshDependencyFiles(e,t){if(!e)return;let r=[];for(let n=0,s=e.length;n<s;n++){var o=e[n],i=!1;if(t)for(let e=0,r=t.length;e<r;e++){let r=t[e];if(tchmi_path(o.name)===tchmi_path(r.name)){i=!0;break}}else i=!1;!1===i&&r.push(o)}if(r.length>0){let e=document.createDocumentFragment();for(let t=0,o=r.length;t<o;t++){let o=r[t];"JavaScript"===o.type&&function(t){let r=document.createElement("script");r.src=tchmi_path(t.name),r.async=!1,r.onload=function(e){},r.onerror=function(e){},e.appendChild(r)}(o)}document.head.appendChild(e)}}__doReloadTcHmiConfig(url){let t=null,r=e.System.config,o=this,i=new XMLHttpRequest;i.open("GET","Properties/tchmiconfig.json?preventcache="+Math.random()),i.addEventListener("load",(function(n){if(200===i.status){if(t=e.ValueConverter.toObject(i.responseText),null===t)return;o.__doRefreshTcHmiConfig(t,r)}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Command will be ignored. Details: "+i.statusText)})),i.addEventListener("error",(function(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Command will be ignored. Details: "+i.statusText)})),i.send()}__doRefreshTcHmiConfig(t,r){e.System.config=t,e.System.config.basePath=r.basePath,e.System.config.tcHmiServer?e.System.config.tcHmiServer.websocketIntervalTime||(e.System.config.tcHmiServer.websocketIntervalTime=r.tcHmiServer.websocketIntervalTime):e.System.config.tcHmiServer=r.tcHmiServer,this.__refreshBaseConfig(t,r),this.__refreshViewPartials(t.views,r.views),this.__refreshContentPartials(t.content,r.content),this.__refreshUserControlPartials(t.userControls,r.userControls),this.__refreshSymbols(t.symbols,r.symbols),this.__refreshPackages(t.packages,r.packages),this.__refreshUserFunctions(t.userFunctions,r.userFunctions),this.__refreshDependencyFiles(t.dependencyFiles,r.dependencyFiles)}__doReloadUserControlConfig(url){let t=this,r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(o){if(200===r.status){let data=e.ValueConverter.toObject(r.responseText);t.__doRefreshUserControlConfig(url,data)}else e.EventProvider.raise("System.onUserControlConfigRemoved",{url:url})})),r.addEventListener("error",(function(t){e.EventProvider.raise("System.onUserControlConfigRemoved",{url:url})})),r.send()}__doRefreshUserControlConfig(url,data){e.System.Data.Caches.partialCompositeConfigCache.set(url,data),e.EventProvider.raise("System.onUserControlConfigChanged",{url:url})}__doReloadLocalizationFile(url){let t=this,r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(o){if(200===r.status){let data=e.ValueConverter.toObject(r.responseText);t.__doRefreshLocalizationFile(url,data)}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Details: "+r.statusText)})),r.addEventListener("error",(function(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.SyncCmdToFrameworkTcHmiConfigChanged] Error while loading "+url+". Details: "+r.statusText)})),r.send()}__doRefreshLocalizationFile(url,data){let locale=data.locale;if(null==locale)return;e.Locale.get()===locale&&e.System.Services.localizationManager.processLocalizationData(data)}__doRefreshThemeFile(url){e.System.Services.themeManager.__clearProjectThemeUrl(url),e.System.Services.themeManager.processActiveTheme()}run(){let e=this.__cmd;var t=tchmi_path(e.configPath);switch(e.type){case"TcHmiConfig":this.__doReloadTcHmiConfig(t);break;case"UserControlConfig":this.__doReloadUserControlConfig(t);break;case"Localization":this.__doReloadLocalizationFile(t);break;case"ThemeConfig":this.__doRefreshThemeFile(t)}}}t.SyncCmdToFrameworkTcHmiConfigChanged=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e),this.sendSynchronousConfirmation=!1}run(){e.System.Services.Engineering.designerModeManager.syncManager.beginTransaction(this.__cmd.transactionName)}}t.SyncCmdToFrameworkTransactionBegin=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e),this.sendSynchronousConfirmation=!1}run(){e.System.Services.Engineering.designerModeManager.syncManager.commitTransaction(this.__cmd.transactionName)}}t.SyncCmdToFrameworkTransactionCommit=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){class r extends t.SyncCmdToFramework{constructor(e){super(e)}run(){const t=tchmi_path(this.__cmd.targetPartial);!0===TCHMI_DESIGNER&&t===TCHMI_TARGET_PARTIAL&&e.System.Services.Engineering.designerModeManager.rootControlManager.setCreatorZoom(this.__cmd.factor)}}t.SyncCmdToFrameworkZoom=r}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.SyncCmdToCreator=class{constructor(e){this.__cmd=e}send(){e.System.Services.Engineering.designerModeComManager.sendCommand(this.__cmd)}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorConfirmation=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorControlDoubleClick=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorCopyMoveControls=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorHierarchyMoveControls=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorMessages=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorDropControlPosition=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorRegisterSyncView=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorRequestCurrentPartialContent=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorRequestRequiredViewPortSize=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorSyncControls=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorSelectedControls=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){class t extends e.SyncCmdToCreator{constructor(e){super(e)}}e.SyncCmdToCreatorInjectedResources=t}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){e.ErrorPane=class{constructor(){this.__messages={}}add(name,content,type){if(!1===TCHMI_ENGINEERING||!1===TCHMI_DESIGNER)return;this.remove(name);let t=tchmi_create_guid(),message={identifier:t,type:type,content:content},r={append:!0,identifier:t,targetPartial:TCHMI_TARGET_PARTIAL,targetInstance:TCHMI_DYNAMIC_INSTANCE_ID,type:type,content:content,line:null,position:null,unixTimestamp:Math.round(Date.now()/1e3)};this.__messages[name]=message,new e.SyncCmdToCreatorMessages({name:"Messages",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",messages:[r],replyTo:null}).send()}remove(name){if(!1===TCHMI_ENGINEERING||!1===TCHMI_DESIGNER)return;let message=this.__messages[name];if(!message)return;let t={remove:!0,identifier:message.identifier};new e.SyncCmdToCreatorMessages({name:"Messages",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",messages:[t],replyTo:null}).send(),delete this.__messages[name]}}}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(r){class o{constructor(){this.__websocket=void 0,this.__websocketWasClosedUnexpected=!1,this.__connectionWatcherInterval=0,this.__unloaded=!1,this.__onBeforeUnload=e=>{this.__unloaded=!0,this.__websocket&&(this.__websocket.close(),this.__websocket=void 0)},this.__connectionWatcherTick=()=>()=>{void 0===this.__websocket&&this.open()},e.EventProvider.register("System.onBeforeUnload",this.__onBeforeUnload)}__handleSyncCommandMessageResponse(o){if(!o.command)return;let i,n=!0;switch(o.command.name){case"Messages":break;case"InjectResources":i=new r.SyncCmdToFrameworkInjectResources(o.command);break;case"Confirmation":n=!1,i=new r.SyncCmdToFrameworkConfirmation(o.command);break;case"TransactionBegin":n=!1,i=new r.SyncCmdToFrameworkTransactionBegin(o.command);break;case"TransactionCommit":n=!1,i=new r.SyncCmdToFrameworkTransactionCommit(o.command);break;case"ScrollPositionChanged":n=!1,i=new r.SyncCmdToFrameworkScrollPositionChanged(o.command);break;case"RequestDropControlPosition":i=new r.SyncCmdToFrameworkRequestDropControlPosition(o.command);break;case"CreateControls":i=new r.SyncCmdToFrameworkCreateControls(o.command);break;case"SyncControls":i=new r.SyncCmdToFrameworkSyncControls(o.command);break;case"RemoveControls":i=new r.SyncCmdToFrameworkRemoveControls(o.command);break;case"SelectedControls":i=new r.SyncCmdToFrameworkSelectedControls(o.command);break;case"ServerAddress":n=!1,i=new r.SyncCmdToFrameworkServerAddress(o.command);break;case"DesignerSettings":i=new r.SyncCmdToFrameworkDesignerSettings(o.command);break;case"DomVisibility":i=new r.SyncCmdToFrameworkDomVisibility(o.command);break;case"ControlLocked":i=new r.SyncCmdToFrameworkControlLocked(o.command);break;case"KeyStates":n=!1,i=new r.SyncCmdToFrameworkKeyStates(o.command);break;case"CurrentPartialContent":i=new r.SyncCmdToFrameworkCurrentPartialContent(o.command);break;case"TcHmiConfigChanged":i=new r.SyncCmdToFrameworkTcHmiConfigChanged(o.command);break;case"Zoom":n=!1,i=new r.SyncCmdToFrameworkZoom(o.command);break;case"PartialEditorLocked":n=!1,i=new r.SyncCmdToFrameworkPartialEditorLocked(o.command);break;case"PartialEditorUnlocked":n=!1,i=new r.SyncCmdToFrameworkPartialEditorUnlocked(o.command);break;case"CurrentPartialEditorLockState":i=new r.SyncCmdToFrameworkCurrentPartialEditorLockState(o.command);break;case"CurrentPartialHighlightContainerState":i=new r.SyncCmdToFrameworkCurrentPartialHighlightContainerState(o.command);break;case"LogoutClient":i=new r.SyncCmdToFrameworkLogoutClient(o.command)}if(!n||!0!==t.Services.Engineering.designerModeManager.isLocked())if(void 0!==i){try{i.run()}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error('[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Unexpected exception handled while performing "'+o.command.name+'" command: \n'+t.toString())}i.sendSynchronousConfirmation&&i.confirmRequest(o.id)}else TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn('[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Command "'+o.command.name+'" not implemented.')}__websocketOnOpen(callback){return t=>{TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] WebSocket with url="+this.__websocket.url+" opened."),this.__websocket?this.__websocketWasClosedUnexpected?TCHMI_ENGINEERING&&!TCHMI_DESIGNER?(e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.System.Engineering.DesignerModeComManager"}}),e.System.Services.dialogManager.showDialog("__DesignerModeComManager",!1,e.DialogManager.DialogType.Overlay,{force:!0}),e.System.Services.dialogManager.updateText("__DesignerModeComManager","Websocket connection to engineering was restored from unexpected shutdown. Reloading automatically in 5 seconds...",e.DialogManager.DialogSeverity.Info),e.System.Services.dialogManager.showDialog("__DesignerModeComManager",!0,e.DialogManager.DialogType.Overlay),setTimeout(()=>{window.location.reload()},5e3)):window.location.reload():(new r.SyncCmdToCreatorRegisterSyncView({name:"RegisterSyncView",targetPartial:TCHMI_TARGET_PARTIAL,targetInstance:TCHMI_DYNAMIC_INSTANCE_ID,syncViewLevel:TCHMI_DESIGNER?"Master":"Slave",sessionId:e.System.Services.accessManager.getCurrentUserConfig().session,replyTo:null}).send(),e.Callback.callSafe(callback,null,{error:e.Errors.NONE})):e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.System.Engineering.DesignerModeComManager"}})}}__websocketOnClose(){return t=>{!0!==this.__unloaded&&(this.__websocketWasClosedUnexpected=!0,t.code&&!t.reason?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] WebSocket with url="+this.__websocket.url+" was closed with code="+t.code+"."):t.code&&t.reason?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] WebSocket with url="+this.__websocket.url+" was closed with code="+t.code+" and reason="+t.reason+"."):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] WebSocket with url="+this.__websocket.url+" was closed."),this.__websocket=void 0,this.__connectionWatcherInterval&&window.clearInterval(this.__connectionWatcherInterval),this.__unloaded||(this.__connectionWatcherInterval=window.setInterval(this.__connectionWatcherTick(),o.RECONNECT_INTERVAL)))}}__websocketOnMessage(){return t=>{if(!0===this.__unloaded)return;if(void 0===t)return;if(void 0===t.data)return;const r=e.ValueConverter.toObject(t.data,null);if(null!==r&&r.command){try{!0===TCHMI_CONSOLE_LOG_DESIGNER_MODE_COM_MESSAGES&&"KeyStates"!==r.command.name&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Response from TwinCAT HMI Creator.",{messageObj:r})}catch(e){}this.__handleSyncCommandMessageResponse(r)}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Failed to parse JSON message from TcHmiCreator!",{messageObj:r})}}open(callback){if(!0!==this.__unloaded){if(void 0===this.__websocket){if(void 0===TCHMI_ENGINEERING_WEBSOCKET)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Missing flag=TCHMI_ENGINEERING_WEBSOCKET."));try{this.__websocket=new WebSocket(TCHMI_ENGINEERING_WEBSOCKET+"/DesignerWebsocketname="+TCHMI_ENGINEERING_WEBSOCKET)}catch(t){let r="Opening connection to Engineering failed";throw t instanceof DOMException&&(r=r+": "+t.message),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] "+r),new Error(r)}this.__websocket.onopen=this.__websocketOnOpen(callback),this.__websocket.onclose=this.__websocketOnClose(),this.__websocket.onmessage=this.__websocketOnMessage()}}else e.Callback.callSafe(callback,null,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.System.Engineering.DesignerModeComManager",reason:"Website already unloaded."}})}sendCommand(t){let r={id:tchmi_create_guid(),timestamp:Date.now(),command:t};const message=JSON.stringify(r);void 0!==this.__websocket&&this.__websocket.readyState===WebSocket.OPEN&&(!0===TCHMI_CONSOLE_LOG_DESIGNER_MODE_COM_MESSAGES&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Request to TwinCAT HMI Creator.",{messageObj:r}),this.__websocket.send(message))}}o.RECONNECT_INTERVAL=5e3,r.DesignerModeComManager=o}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(r){r.DesignerModeManager=class{constructor(){this.__locked=!1,this.__partialRequested={},this.__settings={theme:{ChessboardLight:null,ChessboardDark:null},enableSnapping:!0,snapToControls:!0,snapToInnerContainerSides:!0,snapDistanceToControls:10,untransformedColor:null,selectionHighlightColor:null,unSelectedHighlightColor:null,selectedSecondaryColor:null,snapHighlightColor:null},this.metaDataManager=new r.DesignerModeControlMetaDataManager(this),this.partialContentManager=new r.DesignerModePartialContentManager(this),this.resourceInjectionManager=new r.DesignerModeResourceInjectionManager(this),!0===TCHMI_DESIGNER&&(this.hierarchyManager=new r.DesignerModeMasterHierarchyManager(this),this.rootControlManager=new r.DesignerModeMasterRootControlManager(this),this.highlightManager=new r.DesignerModeMasterControlHighlightManager(this),this.syncManager=new r.DesignerModeMasterSyncManager(this),this.interactionManager=new r.DesignerModeMasterInteractionManager(this),this.controlMoveManager=new r.DesignerModeMasterControlMoveManager(this),this.rectSelectManager=new r.DesignerModeMasterRectSelectManager(this),this.controlResizeManager=new r.DesignerModeMasterControlResizeManager(this),this.userControlParameterManager=new r.DesignerModeUserControlParameterManager(this),e.EventProvider.register("onThemeDataChanged",this.__onThemeDataChanged())),e.EventProvider.register("onControlAttached",this.__onControlAttached())}__onControlAttached(){var t=this;return function(r,o){let i=null;if(null!=o&&(i=o.getElement()[0].getAttribute("data-tchmi-partial-url"),!0===TCHMI_DESIGNER&&!0===t.hierarchyManager.isDesignerModeControl(o.getId()))){let r,n=!1;tchmi_path(i)===TCHMI_TARGET_PARTIAL&&(n=!0);let s=!0;r=o.getElement()[0].getAttribute("data-tchmi-creator-visibility"),r&&(r=e.ValueConverter.toType(r,"tchmi:framework#/definitions/Visibility")),"Collapsed"===r&&(s=!1);let l=!1;r=o.getElement()[0].getAttribute("data-tchmi-creator-locked"),r&&(l=e.ValueConverter.toType(r,"tchmi:general#/definitions/Boolean"));let c=!1;"Collapsed"===o.getVisibility()&&(c=!0);let d=t.metaDataManager.getControlMetaData(o.getId());if(null===d){let r=0;const i=e.StyleProvider.getSimpleElementStyle(o.getElement(),"z-index");void 0!==i["z-index"]&&(r=parseInt(i["z-index"],10),isNaN(r)&&(r=0)),d={id:o.getId(),parent:null,jControlPosition:t.highlightManager.createControlPosition(o,2e3+r),jHierarchyControlposition:t.highlightManager.createHierarchyControlPosition(o,2e3+r),jOriginalPosition:t.highlightManager.createOriginalPosition(o,1e3+r),jAnchorContainer:t.highlightManager.createAnchorContainer(o,3e3+r,l),jHierarchyAnchorContainer:t.highlightManager.createHierarchyAnchorContainer(o,3e3+r,l),isSelected:!1,isSelectedPrev:!1,isPartialRoot:n,controlCollapsed:c,isContainerControl:o.getIsContainerControl(),isGridControl:"TcHmi.Controls.System.TcHmiGrid"===o.getType(),domVisibility:s,locked:l,controlAttributeDimension:{},controlCssPixelDimension:{},relativeControlRotation:0,absoluteParentRotation:0},!0===n&&(d.jControlPosition[0].classList.add("tchmi-creator-root-partial"),d.jHierarchyControlposition[0].classList.add("tchmi-creator-root-partial"),d.jOriginalPosition[0].classList.add("tchmi-creator-root-partial"),d.jAnchorContainer[0].classList.add("tchmi-creator-root-partial"),d.jHierarchyAnchorContainer[0].classList.add("tchmi-creator-root-partial")),d.jAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",l),d.jHierarchyAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",l),d.jAnchorContainer[0].classList.toggle("tchmi-creator-control-height-inactive","Content"===o.getHeightMode()),d.jAnchorContainer[0].classList.toggle("tchmi-creator-control-width-inactive","Content"===o.getWidthMode()),t.highlightManager.processHighlightType(d),t.highlightManager.processDomVisibility(d),!0===d.isGridControl&&t.highlightManager.createGridHighlighter(o,d),t.metaDataManager.register(d)}else d.isPartialRoot=n,d.controlCollapsed=c,d.domVisibility=s;t.metaDataManager.refreshControlMetaData(d),t.controlMoveManager.registerControl(d),t.hierarchyManager.registerContainerControl(d),t.controlResizeManager.registerControl(d);let _=o;for(;null!=_;){if(!0===_.getIsContainerControl()){let i=o.getParent();if(i&&i.getId()===_.getId()){let o=t.metaDataManager.getControlMetaData(_.getId());if(null===o){let i,n=0;n=parseInt(_.getElement().css("zIndex"),10),isNaN(n)&&(n=0);let s=!0;i=_.getElement()[0].getAttribute("data-tchmi-creator-visibility"),i&&(i=e.ValueConverter.toType(r,"tchmi:framework#/definitions/Visibility")),"Collapsed"===i&&(s=!1);let l=!1;i=_.getElement()[0].getAttribute("data-tchmi-creator-locked"),i&&(l=e.ValueConverter.toType(r,"tchmi:general#/definitions/Boolean"));let c=!1;"Collapsed"===_.getVisibility()&&(c=!0),o={id:_.getId(),parent:null,jControlPosition:t.highlightManager.createControlPosition(_,2e3+n),jHierarchyControlposition:t.highlightManager.createHierarchyControlPosition(_,2e3+n),jOriginalPosition:t.highlightManager.createOriginalPosition(_,1e3+n),jAnchorContainer:t.highlightManager.createAnchorContainer(_,3e3+n,l),jHierarchyAnchorContainer:t.highlightManager.createHierarchyAnchorContainer(_,3e3+n,l),isSelected:!1,isSelectedPrev:!1,isPartialRoot:!1,controlCollapsed:c,isContainerControl:_.getIsContainerControl(),isGridControl:"TcHmi.Controls.System.TcHmiGrid"===_.getType(),domVisibility:s,locked:l,controlAttributeDimension:{},controlCssPixelDimension:{},relativeControlRotation:0,absoluteParentRotation:0},o.jAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",l),o.jHierarchyAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",l),t.metaDataManager.refreshControlMetaData(o),!0===o.isGridControl&&t.highlightManager.createGridHighlighter(_,o),t.metaDataManager.register(o)}d.parent=o}}_=_.getParent()}let m=o.getParent();if(null!==d.parent&&null!==m){const r=o.getElement().next();let i=null;if(0!==r.length&&(i=t.metaDataManager.getControlMetaData(r[0].id)),i)i.jOriginalPosition.before(d.jOriginalPosition),i.jControlPosition.before(d.jControlPosition),i.jControlPosition.before(d.jHierarchyControlposition),i.jAnchorContainer.before(d.jAnchorContainer),i.jAnchorContainer.before(d.jHierarchyAnchorContainer);else if(!1===d.parent.isGridControl)d.parent.jHierarchyControlposition.append(d.jOriginalPosition),d.parent.jHierarchyControlposition.append(d.jControlPosition),d.parent.jHierarchyControlposition.append(d.jHierarchyControlposition),d.parent.jHierarchyAnchorContainer.append(d.jAnchorContainer),d.parent.jHierarchyAnchorContainer.append(d.jHierarchyAnchorContainer);else{let t=o.getGridRowIndex();(!t||t>=m.__rowOptions.length)&&(t=0);let r=o.getGridColumnIndex();(!r||r>=m.__columnOptions.length)&&(r=0);const i=d.parent.jHierarchyControlposition.children("[data-tchmi-creator-grid-rowindex="+t+"][data-tchmi-creator-grid-cellindex="+r+"]");0===i.length&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Fatal internal error: Could not find target grid cell for "+o.getParent().getId()+" to attach highlight container."),i.append(d.jOriginalPosition),i.append(d.jControlPosition),i.append(d.jHierarchyControlposition),i.append(d.jAnchorContainer),i.append(d.jHierarchyAnchorContainer)}}else{const r=t.rootControlManager.getViewPortHighlightingSimulator();r.append(d.jOriginalPosition),r.append(d.jControlPosition),r.append(d.jHierarchyControlposition),r.append(d.jAnchorContainer),r.append(d.jHierarchyAnchorContainer),e.System.SharedResources.jqBody.append(r)}let u=t.highlightManager.requestAsyncHighlighterUpdateForControl(o);u.moved=!0,u.resized=!0,d.isPartialRoot&&t.rootControlManager.setRootControl(o,d)}}}__onThemeDataChanged(){let e=this;return function(t){e.metaDataManager.refreshControlMetaData()}}resyncSelectedControls(){if(this.metaDataManager.getSelectedControlsMetaDataHasChanged()){let e=this.metaDataManager.getSelectedControlsMetaData();const t={name:"SelectedControls",targetPartial:TCHMI_TARGET_PARTIAL,controls:[],replyTo:null};for(let id in e)t.controls.push(id);new r.SyncCmdToCreatorSelectedControls(t).send(),this.metaDataManager.resetSelectedControlsMetaDataHasChanged()}}resyncControls(){if(this.metaDataManager.getChangedControlsMetaDataHasChanged()){let t=this.metaDataManager.getChangedControlsMetaData();const o={name:"SyncControls",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,controls:[],replyTo:null};for(let id in t){const r=t[id],i=e.Controls.get(id);if(!i)continue;let n=i.getPcElement()[0].outerHTML,s=null,l=i.getParent();for(;null!==l&&null!==l.getParent();)l=l.getParent();if(s=null!==l?l:i,TCHMI_DESIGNER&&"TcHmi.Controls.System.TcHmiUserControl"===s.getType()){if(tchmi_path(s.getElement()[0].getAttribute("data-tchmi-partial-url"))===TCHMI_TARGET_PARTIAL){let t=new e.System.SymbolExpressionParser(n).resolveExpressionsBySymbolType(e.SymbolType.PartialParam);if(t)for(let e=0,r=t.length;e<r;e++){let r=t[e].toString(),o=r.replace(new RegExp("%pp%TCHMI_TARGET_DESIGNER_PARTIALPARAM::","g"),"%pp%");n=n.replace(new RegExp(tchmi_escape_regex(""+r),"g"),""+o)}}}o.controls.push({targetControl:r.id,descriptionPath:e.System.Services.controlManager.getDescriptionPath(i.getType()),controlHtml:n})}new r.SyncCmdToCreatorSyncControls(o).send(),this.metaDataManager.resetChangedControlsMetaData()}}syncControl(r,o,i){var n;let s=this;if(!o)return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Invalid target control."),!1;if(!i)return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Invalid or missing html."),!1;const l=e.Controls.get(o);if(!l)return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Control="+o+" not found in control cache."),!1;let c=document.createElement("div");c.innerHTML=i;let d=$(c.firstElementChild);if(0===d.length)return!1;if(1!==d.length&&(d=d.filter("div[data-tchmi-type]"),1!==d.length))return TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Only one control is allowed but got "+d.length),!1;if(!d[0].getAttribute("data-tchmi-type"))return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed for control="+o+". Missing attribute=data-tchmi-type."),!1;if(!d[0].id)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed for control="+o+". Missing attribute=id."),!1;let _=l.getPcElement().clone();if(0===_.length)return!1;if(d[0].outerHTML===_[0].outerHTML)return!1;let m=l.getAttrs(),u=t.resolveAttributesFromControlElement(d[0]);const g=this.metaDataManager.getControlMetaData(o);let E=u.value.id.value,h=l.getParent();if(o!==E&&h){let t=h.getPcElement().clone(),n=document.createElement("div");n.innerHTML=i;t.find("#"+tchmi_css_escape_selector(o)).replaceWith($(n.firstElementChild));return this.syncControl(r,t[0].id,t[0].outerHTML),g&&g.isSelected&&e.EventProvider.register(E+".onAttached",(function(e,data){s.select(E,!0),e.destroy()})),!0}e.Engineering.ErrorPane.remove(l.getId()+"requiredAttributeTouched");const S={"data-tchmi-creator-visibility":!0,"data-tchmi-creator-locked":!0,"data-tchmi-creator-viewport-width":!0,"data-tchmi-creator-viewport-height":!0,"data-tchmi-zindex":!0};let p=[],f=[];for(let t in u.value){const r=u.value[t],o=m[t];if(void 0===o||!tchmi_equal(r.value,o.value)){if(r.descr&&!0===r.descr.requiredOnCompile){e.Engineering.ErrorPane.add(l.getId()+"requiredAttributeTouched","Synchronization problem while changing attribute "+r.descr.name+" of control="+l.getId()+". It is not possible to change this attribute in runtime. Please save and reload this window.",e.Engineering.ErrorPane.MessageType.Error);continue}p.push(r)}S[r.name]&&delete S[r.name]}for(let t in m){let r=m[t];if(void 0===u.value[r.name]){if(r.descr&&!0===r.descr.requiredOnCompile){e.Engineering.ErrorPane.add(l.getId()+"requiredAttributeTouched","Synchronization problem while removing attribute "+r.descr.name+" of control="+l.getId()+". This attribute is not allowed to be deleted.",e.Engineering.ErrorPane.MessageType.Error);continue}f.push(r)}}for(let e in S){switch(e){case"data-tchmi-creator-visibility":null!==g&&(g.domVisibility=!0);break;case"data-tchmi-creator-locked":null!==g&&(g.locked=!1);break;case"data-tchmi-zindex":if(null!==g){const e=0;g.jOriginalPosition.css("z-index",1e3+e),g.jControlPosition.css("z-index",2e3+e),g.jHierarchyControlposition.css("z-index",2e3+e),g.jAnchorContainer.css("z-index",3e3+e),g.jHierarchyAnchorContainer.css("z-index",3e3+e)}}l.getElement()[0].removeAttribute(e),l.getPcElement()[0].removeAttribute(e)}if(null!=p)for(let t=0,r=p.length;t<r;t++){const r=p[t];switch(r.name.toLowerCase()){case"data-tchmi-creator-visibility":if(!0===TCHMI_DESIGNER&&null!==g)switch(e.ValueConverter.toType(r.value,"tchmi:framework#/definitions/Visibility")){case"Collapsed":g.domVisibility=!1;break;default:g.domVisibility=!0}l.getElement()[0].setAttribute(r.name,r.value),l.getAttrs()[r.name]=r;break;case"data-tchmi-creator-locked":!0===TCHMI_DESIGNER&&null!==g&&(g.locked=e.ValueConverter.toType(r.value,"tchmi:general#/definitions/Boolean")),l.getElement()[0].setAttribute(r.name,r.value),l.getAttrs()[r.name]=r;break;case"data-tchmi-creator-viewport-width":case"data-tchmi-creator-viewport-height":l.getElement()[0].setAttribute(r.name,r.value),l.getAttrs()[r.name]=r;break;case"data-tchmi-zindex":if(!0===TCHMI_DESIGNER&&null!==g){let e=parseInt(r.value,10);isNaN(e)&&(e=0),e>=0&&(g.jOriginalPosition.css("z-index",1e3+e),g.jControlPosition.css("z-index",2e3+e),g.jHierarchyControlposition.css("z-index",2e3+e),g.jAnchorContainer.css("z-index",3e3+e),g.jHierarchyAnchorContainer.css("z-index",3e3+e))}}}if("TcHmi.Controls.System.TcHmiHtmlHost"===l.getType()){let e=d[0].innerHTML;e&&l.setContent(e),e=""}for(let r=0,o=f.length;r<o;r++){let o=f[r];if(void 0!==o.descr&&null!==o.descr&&(o.valueType===t.ControlAttributeValueType.Simple&&l.getElement()[0].removeAttribute(o.name),delete l.getAttrs()[o.name],!0!==o.descr.readOnly))if(!0===e.Symbol.isSymbolExpression(o.value))try{e.System.Services.bindingManager.removeBinding(o.descr.propertyName,l,!0)}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Unexpected exception="+t+" while removing binding for attribute="+o.descr.propertyName+" of control="+l.getId()+".")}else{let error=e.System.Services.controlManager.setControlPropertyByAttribute(l,o.descr,null);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] "+e.Log.buildMessage(error))}}for(let r=0,o=p.length;r<o;r++){let o=p[r];if(void 0!==o.descr&&null!==o.descr&&(o.valueType===t.ControlAttributeValueType.Simple&&l.getElement()[0].setAttribute(o.name,o.value),l.getAttrs()[o.name]=o,!0!==o.descr.readOnly))if(!0===e.Symbol.isSymbolExpression(o.value)){let t=null,r=new e.SymbolExpression(o.value);r&&r.getType()===e.SymbolType.PartialParam&&(t=new e.SymbolExpression("%pp%TCHMI_TARGET_DESIGNER_PARTIALPARAM::"+r.getContent()+"%/pp%"));let i=!0,n=e.System.Services.bindingManager.getBinding(o.descr.propertyName,l);if(null!=n){let e=n.getSymbol();if(null!=e){let r=e.getExpression();if(null!=r)if(t){if(t.toString()===r.toString()){i=!1;break}}else if(o.value===r.toString()){i=!1;break}}}if(!0===i)try{e.System.Services.bindingManager.removeBinding(o.descr.propertyName,l,!1),t?e.System.Services.bindingManager.createBinding(t.toString(),o.descr.propertyName,l):e.System.Services.bindingManager.createBinding(o.value,o.descr.propertyName,l)}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Unexpected exception="+t+" while creating binding for attribute="+o.descr.propertyName+" of control="+l.getId()+".")}}else{try{e.System.Services.bindingManager.removeBinding(o.descr.propertyName,l,!1)}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Unexpected exception="+t+" while removing binding from attribute="+o.descr.propertyName+" of control="+l.getId()+".")}let error=e.System.Services.controlManager.setControlPropertyByAttribute(l,o.descr,o.value);error&&error.code!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] "+e.Log.buildMessage(error),error.exception?"\n":void 0,null!==(n=error.exception)&&void 0!==n?n:void 0)}}if(!0===l.getIsContainerControl()){let t=d.children(),i=_.children("div[data-tchmi-type]"),n=[];for(let r=0,o=i.length;r<o;r++){let o=i.eq(r),s=!0;for(let e=0,r=t.length;e<r;e++)if("DIV"===t[e].nodeName&&!1!==t[e].hasAttribute("data-tchmi-type")&&o[0].id===t[e].id){s=!1;break}if(!0===s){n.push(o[0].id);let t=e.Controls.get(o[0].id);if(t){t.__getKeepAlive()&&t.__setKeepAlive(!1),t.destroy()}}}for(let o=0,i=t.length;o<i;o++){if("DIV"!==t[o].nodeName||!1===t[o].hasAttribute("data-tchmi-type"))continue;let i=!1;for(let e=0,r=n.length;e<r;e++)if(t[o].id===n[e]){i=!0;break}if(!0!==i)try{this.syncControl(r,t[o].id,t[o].outerHTML)}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Unexpected exception="+r+" while syncing control="+t[o].id+".")}}let s=[],l=-1;for(let n=0,c=t.length;n<c;n++){if("DIV"!==t[n].nodeName||!1===t[n].hasAttribute("data-tchmi-type"))continue;l++;let c=!0;for(let e=0,r=i.length;e<r;e++)if(i[e].id===t[n].id){c=!1;break}if(!0===c){s.push(t[n].id);try{this.createControl(r,o,l,t[n].outerHTML,null)}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Synchronization failed. Unexpected exception="+r+" while creating control="+t[n].id+".")}}}}const y=l.getPcElement();if(l.__setPcElement(d.clone()),void 0!==l.getParent()&&null!==l.getParent()){let e=l.getParent();for(;null!==e;)e.getPcElement().find("#"+tchmi_css_escape_selector(y[0].id)).replaceWith(l.getPcElement().clone()),e=e.getParent()}if(!0===TCHMI_DESIGNER&&this.hierarchyManager.isDesignerModeControl(o)){const e=this.metaDataManager.refreshControlMetaData(o);if(null!=e){let t=this.highlightManager.requestAsyncHighlighterUpdateForControl(l);if(t.moved=!0,t.resized=!0,!0===e.isPartialRoot);else if(l.getParent()){let e=l.getParent();do{if(!e||"Content"!==e.getHeightMode()&&"Content"!==e.getWidthMode())e=null;else{const t=this.metaDataManager.getControlMetaData(e.getId());if(!t){e=null;break}if(t.isPartialRoot){this.rootControlManager.setCreatorViewPortPosition(e);break}e=e.getParent()}}while(null!==e)}}}return null!==g&&(g.jAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",g.locked),g.jHierarchyAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",g.locked),g.jAnchorContainer[0].classList.toggle("tchmi-creator-control-height-inactive","Content"===l.getHeightMode()),g.jAnchorContainer[0].classList.toggle("tchmi-creator-control-width-inactive","Content"===l.getWidthMode())),!0}createControl(t,r,o,i,callback=null){let n=this,s=document.createElement("div");s.innerHTML=i;let l=$(s.firstElementChild);if(0===l.length)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Invalid control html."));let c=l[0].getAttribute("data-tchmi-type");if(!c)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Invalid control html. Missing attribute=data-tchmi-type."));let d=l[0].id;if(!d)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Invalid control html. Missing attribute=id."));if(e.Controls.get(d))return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error('[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create instance of control. Id: "'+d+'" does already exist.'));let _=null;if(null!=r&&""!==r){if(_=e.Controls.get(r),!_)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Target parent control="+r+" not found in control cache."))}else{if("TcHmi.Controls.System.TcHmiView"!==c&&"TcHmi.Controls.System.TcHmiContent"!==c&&"TcHmi.Controls.System.TcHmiUserControl"!==c)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Only controls of type 'TcHmi.Controls.System.TcHmiView', 'TcHmi.Controls.System.TcHmiContent' or 'TcHmi.Controls.System.TcHmiUserControl' are valid as a root element."));l.attr("data-tchmi-partial-url",tchmi_path(TCHMI_TARGET_PARTIAL)).attr("data-tchmi-creator-partial-key",TCHMI_TARGET_PARTIAL)}var m=e.System.Services.controlManager.compile(l[0],_,{pos:o});if(void 0===m)return;if(null!==_){if(!0!==_.getIsContainerControl()||"function"!=typeof _.addChild)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Can't add child to a not 'TcHmiContainerControl' based control! Requested parent target control="+_.getId()+" has type="+_.getType()+"."));if(0===o)_.getPcElement().prepend(m.getPcElement().clone());else{const e=_.getPcElement().children();let t=-1;for(let r=0,i=0,n=e.length;i<n;i++)if("DIV"===e[i].nodeName&&!1!==e[i].hasAttribute("data-tchmi-type")){if(r++,o===r){t=i;break}if(o<r)break}-1===t?_.getPcElement().append(m.getPcElement().clone()):e.eq(t).after(m.getPcElement().clone())}}else{const t=m.getType();if("TcHmi.Controls.System.TcHmiView"!==t&&"TcHmi.Controls.System.TcHmiUserControl"!==t&&"TcHmi.Controls.System.TcHmiContent"!==t)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to create control. Can't load root element because it is of type="+t+" but only controls of type TcHmi.Controls.System.TcHmiView, TcHmi.Controls.System.TcHmiContent and TcHmi.Controls.System.TcHmiUserControl are allowed as root element."));e.System.Services.viewManager.loadViewObject(m)}let u=m.getId();e.Engineering.ErrorPane.remove(u+"requiredAttributeTouched"),e.EventProvider.register(u+".onAttached",(function(t,data){t.destroy(),"function"==typeof callback&&callback.call(n,{error:e.Errors.NONE})}))}select(t,r=!1){if(!0!==TCHMI_DESIGNER)return;const o=this.metaDataManager.getControlMetaData(t);if(null===o)return void(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeManager] Failed to select control="+t+"."));var i=e.Controls.get(o.id);if(!i)return;o.isSelectedPrev=o.isSelected,o.isSelected=!0,this.metaDataManager.selectControl(o),this.highlightManager.processHighlightType(o);let n=i.getParent();if(n&&"function"==typeof n.getChildren&&o.parent){let e=!1;for(let t of n.getChildren()){const r=this.metaDataManager.getControlMetaData(t.getId());if(r&&r.isSelected){e=!0;break}}o.parent.jControlPosition[0].classList.toggle("tchmi-creator-childcontrol-selected",e)}!0!==r&&this.resyncSelectedControls()}unselect(t,r=!1){if(!0!==TCHMI_DESIGNER)return;const o=this.metaDataManager.getControlMetaData(t);if(null===o)return;var i=e.Controls.get(o.id);if(!i)return;o.isSelected=!1,this.metaDataManager.unselectControl(o),o.isSelectedPrev=!1,this.highlightManager.processHighlightType(o);let n=i.getParent();if(n&&"function"==typeof n.getChildren&&o.parent){let e=!1;for(let t of n.getChildren()){const r=this.metaDataManager.getControlMetaData(t.getId());if(r&&r.isSelected){e=!0;break}}o.parent.jControlPosition[0].classList.toggle("tchmi-creator-childcontrol-selected",e)}!0!==r&&this.resyncSelectedControls()}selectEach(e){let t=this.unselectEach(!0);const r=this.metaDataManager.getControlMetaData();for(let id in r)!1===r[id].isPartialRoot&&(this.select(id,!0),t=!0);return!0!==e&&t&&this.resyncSelectedControls(),t}unselectEach(e){let t=!1;const r=this.metaDataManager.getControlMetaData();for(let id in r)!0===r[id].isSelected&&(this.unselect(id,!0),t=!0);return!0!==e&&t&&this.resyncSelectedControls(),t}setControlLocked(t,r){let o=this.metaDataManager.getControlMetaData(t);null!==o&&(o.locked=r,o.jAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",r),o.jHierarchyAnchorContainer[0].classList.toggle("tchmi-creator-control-locked",r));let i=e.Controls.get(t);i&&(r?(i.getElement()[0].setAttribute("data-tchmi-creator-locked","True"),i.getPcElement()[0].setAttribute("data-tchmi-creator-locked","True")):(i.getElement()[0].removeAttribute("data-tchmi-creator-locked"),i.getPcElement()[0].removeAttribute("data-tchmi-creator-locked")))}lock(){if(this.__locked=!0,!0===TCHMI_LIVEVIEW)e.System.Services.dialogManager.updateText("__TcHmiDesignerLock",'Your changes to the project require a client reload. <a onclick="window.location.reload()">Click here to reload now.</a>'),e.System.Services.dialogManager.showDialog("__TcHmiDesignerLock",!0,e.DialogManager.DialogType.Overlay);else if(!0===TCHMI_DESIGNER){e.System.Services.dialogManager.updateText("__TcHmiDesignerLock",""),e.System.Services.dialogManager.showDialog("__TcHmiDesignerLock",!0,e.DialogManager.DialogType.Overlay),this.unselectEach(!0);const r=t.Services.viewManager.getView();null!=r&&e.StyleProvider.setSimpleElementStyle(r.getElement(),"filter","blur(2px)")}e.System.SharedResources.jqBody.css({overflow:"hidden"})}unlock(){throw new Error("Not implemented!")}isLocked(){return this.__locked}getSettings(){return this.__settings}updateSettings(valueNew){tchmi_equal(this.__settings,valueNew)||(this.__settings=valueNew,this.highlightManager.updateEngineeringStyles().call(null),this.interactionManager.clearControlSnapPositionCache(),this.interactionManager.refreshControlSnapPositionCache())}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeControlMetaDataManager=class{constructor(t){this.__controlsMetaData={},this.__selectedControlsMetaData={},this.__selectedControlsMetaDataHasChanged=!1,this.__changedControlsMetaData={},this.__changedControlsMetaDataHasChanged=!1,this.__selectedControlIdsWithChildren=[],this.__designerModeManager=t,e.EventProvider.register("onControlDetached",this.__onControlDetached())}register(e){this.__controlsMetaData[e.id]=e}unregister(t){void 0!==this.__controlsMetaData[t]&&(!0===TCHMI_DESIGNER&&(this.__designerModeManager.highlightManager.handleControlRemoved(this.__controlsMetaData[t]),this.__designerModeManager.rootControlManager.setCreatorViewPortPosition(e.System.Services.viewManager.getView()),this.__designerModeManager.highlightManager.requestAsyncHighlighterUpdate()),delete this.__controlsMetaData[t]),void 0!==this.__selectedControlsMetaData[t]&&(delete this.__selectedControlsMetaData[t],this.__rebuildSelectIdCache())}__onControlDetached(){let e=this;return function(t,r){null!=r&&e.unregister(r.getId())}}getControlMetaData(id){return null==id?this.__controlsMetaData:void 0!==this.__controlsMetaData[id]?this.__controlsMetaData[id]:null}refreshControlMetaData(t){let r,id;if("string"==typeof t)r=this.getControlMetaData(t),id=t;else{if(!t){for(let id in this.__controlsMetaData)this.refreshControlMetaData(this.__controlsMetaData[id]);return null}r=t,id=r.id}if(null==r)return null;const o=e.Controls.get(id);if(!o)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeComManager] Failed to refresh Control Meta Data of control "${id}": Not found in control cache.\n`),null;const element=o.getElement();r.controlAttributeDimension=this.__getControlAttributeDimension(o),r.relativeControlRotation=this.__getRelativeRotation(element[0]),r.absoluteParentRotation=this.__getAbsoluteRotation(element.offsetParent()[0]),r.controlCssPixelDimension=this.__getControlCssPixelDimension(o);let i=this.__designerModeManager.highlightManager.requestAsyncHighlighterUpdateForControl(o);return i.moved=!0,i.resized=!0,r}getChangedControlsMetaData(){return this.__changedControlsMetaData}resetChangedControlsMetaData(){this.__changedControlsMetaDataHasChanged=!1,this.__changedControlsMetaData={}}getChangedControlsMetaDataHasChanged(){return this.__changedControlsMetaDataHasChanged}addChangedControlsMetaData(e){this.__changedControlsMetaData[e.id]||(this.__changedControlsMetaDataHasChanged=!0),this.__changedControlsMetaData[e.id]=e}getSelectedControlsMetaData(){return this.__selectedControlsMetaData}resetSelectedControlsMetaDataHasChanged(){this.__selectedControlsMetaDataHasChanged=!1}getSelectedControlsMetaDataHasChanged(){return this.__selectedControlsMetaDataHasChanged}selectControl(t){this.__selectedControlsMetaData[t.id]||(this.__selectedControlsMetaDataHasChanged=!0),this.__selectedControlsMetaData[t.id]=t;const r=e.Controls.get(t.id);if(!r)return;const o=e.System.resolveControlHierarchy(r,null),i=e=>{const t=e.ctrl;if(-1===this.__selectedControlIdsWithChildren.indexOf(t.getId())&&this.__selectedControlIdsWithChildren.push(t.getId()),!0===t.getIsContainerControl())for(let t=0,r=e.children_hierarchy.length;t<r;t++)i(e.children_hierarchy[t])};i(o),this.__rebuildSelectIdCache(t)}unselectControl(e){this.__selectedControlsMetaData[e.id]&&(this.__selectedControlsMetaDataHasChanged=!0),delete this.__selectedControlsMetaData[e.id],this.__rebuildSelectIdCache()}getSelectedControlIdsWithChildren(){return this.__selectedControlIdsWithChildren}__rebuildSelectIdCache(t){if(void 0===t){this.__selectedControlIdsWithChildren=[];for(let id in this.__selectedControlsMetaData){const e=this.__selectedControlsMetaData[id];!1===e.isPartialRoot&&this.__rebuildSelectIdCache(e)}return}if(!0===t.isPartialRoot)return;const r=e.Controls.get(t.id);if(!r)return;const o=e.System.resolveControlHierarchy(r,null),i=e=>{const t=e.ctrl;if(-1===this.__selectedControlIdsWithChildren.indexOf(t.getId())&&this.__selectedControlIdsWithChildren.push(t.getId()),!0===t.getIsContainerControl())for(let t=0,r=e.children_hierarchy.length;t<r;t++)i(e.children_hierarchy[t])};i(o)}__getControlAttributeDimension(e){return{topValue:e.getTop(),topUnit:e.getTopUnit(),leftValue:e.getLeft(),leftUnit:e.getLeftUnit(),widthValue:e.getWidth(),widthUnit:e.getWidthUnit(),minWidthValue:e.getMinWidth(),minWidthUnit:e.getMinWidthUnit(),maxWidthValue:e.getMaxWidth(),maxWidthUnit:e.getMaxWidthUnit(),widthMode:e.getWidthMode(),rightValue:e.getRight(),rightUnit:e.getRightUnit(),heightValue:e.getHeight(),heightUnit:e.getHeightUnit(),heightMode:e.getHeightMode(),minHeightValue:e.getMinHeight(),minHeightUnit:e.getMinHeightUnit(),maxHeightValue:e.getMaxHeight(),maxHeightUnit:e.getMaxHeightUnit(),bottomValue:e.getBottom(),bottomUnit:e.getBottomUnit()}}__getControlCssPixelDimension(e){let t={width:null,height:null,left:null,top:null,right:null,bottom:null},element=e.getElement();if(element){let e=element.css("width");e&&(t.width=parseFloat(e));let r=element.css("height");r&&(t.height=parseFloat(r));let o=element.css("left");o&&(t.left=parseFloat(o));let i=element.css("top");i&&(t.top=parseFloat(i));let n=element.css("right");n&&(t.right=parseFloat(n));let s=element.css("bottom");s&&(t.bottom=parseFloat(s))}return t}__getAbsoluteRotation(e){if(!e)return 0;let t=0;const r=e.parentElement;!r||r.nodeName&&"HTML"===r.tagName||(t=this.__getAbsoluteRotation(r));return t+this.__getRelativeRotation(e)}__getRelativeRotation(t){if(!t)return 0;const r=e.StyleProvider.getComputedElementStyle(t,"transform").transform;let o=0;if(r&&"none"!==r){const e=r.substring(r.indexOf("(")+1,r.lastIndexOf(")")).split(",");if(6===e.length){const a=parseFloat(e[0]),b=parseFloat(e[1]);o=Math.round(Math.atan2(b,a)*(180/Math.PI))}}return o}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterSyncManager=class{constructor(e){this.__transactionLock=[],this.__designerModeManager=e}beginTransaction(name){-1===this.__transactionLock.indexOf(name)&&this.__transactionLock.push(name)}commitTransaction(name){const e=this.__transactionLock.indexOf(name);-1!==e&&this.__transactionLock.splice(e,1),0===this.__transactionLock.length&&this.__sendPendingCommands()}__sendPendingCommands(){}transactionActive(){return 0===this.__transactionLock.length}updatePcElementAndSync(t){const r=[],o=["top","left","width","right","height","bottom"],i=this.__designerModeManager.metaDataManager.getSelectedControlsMetaData();for(let id in i){const t=i[id];if(null==t)continue;const n=e.Controls.get(t.id);if(!n)continue;r.push(n);const s=n.getPcElement().clone(),l=e.StyleProvider.getSimpleElementStyle(n.getElement(),o);for(let t of o)if(void 0!==l[t]){let r="data-tchmi-"+t,o=s.attr(r);if(e.Symbol.isSymbolExpression(o)){let t=new e.System.Symbol(o);if(t){if(t.getExpression().getType()===e.SymbolType.Server){t.destroy(),t=null;continue}t.read((function(data){data.error===e.Errors.NONE&&(o=data.value),t.destroy(),t=null}))}}"string"==typeof o&&(o=parseFloat(o));let i="data-tchmi-"+t+"-unit",n=s.attr(i),c=l[t].replace(/[-.0-9]/g,"");"px"!==c&&"%"!==c&&(c="px"),void 0===n?"px"!==c&&s.attr(i,c):n!==c&&s.attr(i,c);let d=parseFloat(l[t]);Math.round(o)===Math.round(d)||["height","width"].includes(t)&&["Content","Parent"].includes(s.attr("data-tchmi-"+t+"-mode"))||("px"===c?s.attr(r,d.toFixed(0)):"%"===c&&s.attr(r,d.toFixed(1)))}!0===t.domVisibility?s.removeAttr("data-tchmi-creator-visibility"):s.attr("data-tchmi-creator-visibility","False"),!1===t.locked?s.removeAttr("data-tchmi-creator-locked"):s.attr("data-tchmi-creator-locked","True"),0===this.__transactionLock.length&&this.__designerModeManager.syncControl(TCHMI_TARGET_PARTIAL,t.id,s[0].outerHTML)}e.EventProvider.raise(t,r),this.__designerModeManager.highlightManager.requestAsyncHighlighterUpdate()}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterHierarchyManager=class{constructor(t){this.__dragtargetContainerHighlighting={},this.__designerModeManager=t,e.System.SharedResources.jqBody.on("dragover.DesignerModeMasterHierarchyManager.body",event=>{event.preventDefault()}).on("dragenter.DesignerModeMasterHierarchyManager.body",this.__onDragEnter()).on("dragleave.DesignerModeMasterHierarchyManager.body",this.__onDragLeave())}isDesignerModeControl(id){let t=!1,r=function(e){if(e.ctrl.getId()!==id)for(let o=0,i=e.children_hierarchy.length;o<i;o++){let i=e.children_hierarchy[o];if(r(i),!0===t)return}else t=!0},o=void 0,i=document.querySelector(`div[data-tchmi-creator-partial-key="${TCHMI_TARGET_PARTIAL}"]`);if(i&&(o=e.Controls.get(i.id)),o){let i=!1,n=e.Controls.get(id);if(n){let element=n.getElement();if(element&&element.length>0){let e=element[0].getAttribute("data-tchmi-designer-ignore");null!=e&&(i=!0)}}if(i)t=!1;else{let t=e.System.resolveControlHierarchy(o,null);r(t)}}return t}registerContainerControl(e){e.jControlPosition.on("dragover.DesignerModeMasterHierarchyManager."+e.id,event=>{event.preventDefault()}),e.jControlPosition.on("dragenter.DesignerModeMasterHierarchyManager."+e.id,this.__onDragEnter()),e.jControlPosition.on("dragleave.DesignerModeMasterHierarchyManager."+e.id,this.__onDragLeave())}registerContainerElement(e){e.on("dragenter.DesignerModeMasterHierarchyManager",this.__onDragEnter()).on("dragleave.DesignerModeMasterHierarchyManager",this.__onDragLeave())}__onDragEnter(){return event=>{event.preventDefault(),this.addHighlightDropTarget({left:event.pageX,top:event.pageY},event.target)}}__onDragLeave(){return event=>{const e=(event.target.hasAttribute("data-tchmi-creator-target-control")?event.target.getAttribute("data-tchmi-creator-target-control"):"body")+"_r"+(event.target.hasAttribute("data-tchmi-creator-grid-rowindex")?event.target.getAttribute("data-tchmi-creator-grid-rowindex"):null)+"_c"+(event.target.hasAttribute("data-tchmi-creator-grid-cellindex")?event.target.getAttribute("data-tchmi-creator-grid-cellindex"):null);this.__dragtargetContainerHighlighting[e]&&(this.__dragtargetContainerHighlighting[e].classList.remove("tchmi-creator-possibledroptarget"),delete this.__dragtargetContainerHighlighting[e])}}addHighlightDropTarget(e,t){const r=this.getContainerFromPoint(e);if(this.removeHighlightDropTarget(),!r||!r.jHighlighter)return;const o=(t.hasAttribute("data-tchmi-creator-target-control")?t.getAttribute("data-tchmi-creator-target-control"):"body")+"_r"+r.rowIndex+"_c"+r.columnIndex;r.jHighlighter[0].classList.add("tchmi-creator-possibledroptarget"),this.__dragtargetContainerHighlighting[o]=r.jHighlighter[0]}removeHighlightDropTarget(){for(let e in this.__dragtargetContainerHighlighting)this.__dragtargetContainerHighlighting[e].classList.remove("tchmi-creator-possibledroptarget"),delete this.__dragtargetContainerHighlighting[e]}getContainerFromPoint(t){const r=e.System.Services.viewManager.getView();if(null===r)return null;const o=$(document.elementFromPoint(t.left-window.scrollX,t.top-window.scrollY));let i,n=void 0;if(0===o.length||o[0]===document.body){n=r;const e=this.__designerModeManager.metaDataManager.getControlMetaData(n.getId());e&&(i=e.jControlPosition)}else{const t=function(e){const o=e.ctrl,i=o.getType();if(("TcHmi.Controls.System.TcHmiView"===i||"TcHmi.Controls.System.TcHmiContent"===i||"TcHmi.Controls.System.TcHmiUserControl"===i)&&o.getId()!==r.getId())return[];let n=[];if(!0===o.getIsContainerControl()){n.push(o);for(let r=0,o=e.children_hierarchy.length;r<o;r++){const o=t(e.children_hierarchy[r]);n=n.concat(o)}}return n},s=e.System.resolveControlHierarchy(r,null),l=t(s);let c=o;do{const e=c.attr("data-tchmi-creator-target-control");if(void 0!==e){let t=!1;for(let r=0,o=l.length;r<o;r++){const o=l[r];if(o.getId()===e){n=o,i=c,t=!0;break}}if(!0===t)break}c=c.parent()}while(c.length>0);c=null,null==n&&(n=r)}let s=t.left,l=t.top,c=null,d=null;if("TcHmi.Controls.System.TcHmiGrid"===n.getType()){if(o[0].classList.contains("tchmi-creator-gridcell"))i=o;else{const e=o.parent();e.length&&e[0].classList.contains("tchmi-creator-hierarchy-gridcellposition")&&(i=e)}let e=parseInt(i.attr("data-tchmi-creator-grid-rowindex"),10),t=parseInt(i.attr("data-tchmi-creator-grid-cellindex"),10);if(!isNaN(t)&&!isNaN(e)){c=e,d=t;const r=i.position();s-=r.left,l-=r.top}}let _=n.getElement();if(_.length>0)do{const e=_.position();s-=e.left,l-=e.top,_=_.offsetParent(),s-=parseFloat(_.css("border-left-width")),l-=parseFloat(_.css("border-top-width"))}while(_.length>0&&!0!==_.is(e.System.SharedResources.jqBody)&&_[0]!==document.documentElement);const m=this.__designerModeManager.rootControlManager.getCreatorZoomFactor();return{tco:n,jHighlighter:i,mousePosXinTarget:Math.round(s/m),mousePosYinTarget:Math.round(l/m),rowIndex:c,columnIndex:d}}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterRootControlManager=class{constructor(t){this.__rootControlMetaElements=[],this.__scrollPosition={left:0,top:0},this.__creatorZoomFactor=1,this.__viewportCurrentWidth=0,this.__vpCurrentHeight=0,this.__scrollAnimationFrameId=0,this.__zoomAnimationFrameId=0,this.__designerModeManager=t,document.body.classList.add("tchmi-creator-chessboard"),e.System.SharedResources.jqBody.css({overflow:"hidden"});let r=document.createElement("div");r.innerHTML='<div class="tchmi-creator-view-port-simulator"></div>',this.__viewPortSimulator=$(r.firstElementChild),r.innerHTML='<div class="tchmi-creator-view-port-highlighting"></div>',this.__viewPortHighlightingSimulator=$(r.firstElementChild),window.setInterval(this.__onRequiredViewPortSizeWatchTick(),50)}getCreatorZoomFactor(){return this.__creatorZoomFactor}getViewPortSimulator(){return this.__viewPortSimulator}getViewPortHighlightingSimulator(){return this.__viewPortHighlightingSimulator}scroll(e){e.left===this.__scrollPosition.left&&e.top===this.__scrollPosition.top||(this.__scrollPosition.left=e.left,this.__scrollPosition.top=e.top,0!==this.__scrollAnimationFrameId&&window.cancelAnimationFrame(this.__scrollAnimationFrameId),this.__scrollAnimationFrameId=window.requestAnimationFrame(()=>{document.scrollingElement.scrollLeft=this.__scrollPosition.left,document.scrollingElement.scrollTop=this.__scrollPosition.top,this.__scrollAnimationFrameId=0}))}setCreatorZoom(e){void 0!==e&&this.__creatorZoomFactor!==e&&(this.__creatorZoomFactor=e,0!==this.__zoomAnimationFrameId&&window.cancelAnimationFrame(this.__zoomAnimationFrameId),this.__zoomAnimationFrameId=window.requestAnimationFrame(()=>{1!==this.__creatorZoomFactor?this.__viewPortSimulator.css("transform","scale("+this.__creatorZoomFactor+")"):this.__viewPortSimulator.css("transform",""),this.__designerModeManager.metaDataManager.refreshControlMetaData(),this.__zoomAnimationFrameId=0}))}setRootControl(e,t){this.setCreatorViewPortPosition(e),this.__rootControlMeta=t,this.__rootControlMetaElements[0]=this.__rootControlMeta.jControlPosition,this.__rootControlMetaElements[1]=this.__rootControlMeta.jAnchorContainer,this.__viewPortSimulator[0].setAttribute("data-tchmi-creator-target-control-type",e.getType())}__onRequiredViewPortSizeWatchTick(){return()=>{if(!this.__rootControlMeta)return;let e=50,r=50;for(let t=0,o=this.__rootControlMetaElements.length;t<o;t++){let o=this.__rootControlMetaElements[t];if(null!=o){let t=o[0].getBoundingClientRect(),i=t.width,n=t.height,s=o[0].offsetWidth,l=o[0].offsetHeight,c=o[0].scrollWidth-s,d=o[0].scrollHeight-l,_=i+(t.left+window.pageXOffset-document.documentElement.clientLeft)+c,m=n+(t.top+window.pageYOffset-document.documentElement.clientTop)+d;_>e&&(e=_),m>r&&(r=m)}}e=Math.floor(e)+35,r=Math.floor(r)+35,e===this.__viewportCurrentWidth&&r===this.__vpCurrentHeight||(new t.SyncCmdToCreatorRequestRequiredViewPortSize({name:"RequestRequiredViewPortSize",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,width:e,height:r,replyTo:null}).send(),this.__viewportCurrentWidth=e,this.__vpCurrentHeight=r,document.body.style.width=e+"px",document.body.style.height=r+"px")}}setCreatorViewPortPosition(t){if(!t)return;let r=1024,o=0,i=t.getElement()[0].getAttribute("data-tchmi-creator-viewport-width");i&&(o=e.ValueConverter.toType(i,"tchmi:framework#/definitions/PositiveNumber")),"number"==typeof o&&o>0?r=o:"number"==typeof e.System.config.creatorSettings.viewport.defaultWidth&&e.System.config.creatorSettings.viewport.defaultWidth>0&&(r=e.System.config.creatorSettings.viewport.defaultWidth);let n=!1,s=t.getWidth();const l=t.getWidthUnit(),c=t.getWidthMode();if("Parent"===c?s=null:"Content"===c&&(s=t.__getContentWidth()),("%"===l||null===s)&&(n=!0),!1===n){let e=t.getMinWidth(),o=t.getMinWidthUnit(),i=e;null!==e&&"%"===o&&(i=e*r/100),null!==i&&s<i&&(n=!0)}if(!1===n){let e=t.getMaxWidth(),o=t.getMaxWidthUnit(),i=e;null!==e&&"%"===o&&(i=e*r/100),null!==i&&s>i&&(n=!0)}!1===n&&(r=parseInt(t.getElement().css("left"),10)+s);let d=768,_=0;i=t.getElement()[0].getAttribute("data-tchmi-creator-viewport-height"),i&&(_=e.ValueConverter.toType(i,"tchmi:framework#/definitions/PositiveNumber")),"number"==typeof _&&_>0?d=_:"number"==typeof e.System.config.creatorSettings.viewport.defaultHeight&&e.System.config.creatorSettings.viewport.defaultHeight>0&&(d=e.System.config.creatorSettings.viewport.defaultHeight);let m=!1,u=t.getHeight();const g=t.getHeightUnit(),E=t.getHeightMode();if("Parent"===E?u=null:"Content"===E&&(u=t.__getContentHeight()),("%"===g||null===u)&&(m=!0),!1===m){let e=t.getMinHeight(),r=t.getMinHeightUnit(),o=e;null!==e&&"%"===r&&(o=e*d/100),null!==o&&u<o&&(m=!0)}if(!1===m){let e=t.getMaxHeight(),r=t.getMaxHeightUnit(),o=e;null!==e&&"%"===r&&(o=e*d/100),null!==o&&u>o&&(m=!0)}!1===m&&(d=parseInt(t.getElement().css("top"),10)+u),e.StyleProvider.setSimpleElementStyle(this.__viewPortSimulator,{width:r+"px",height:d+"px"}),e.StyleProvider.setSimpleElementStyle(this.__viewPortHighlightingSimulator,{width:r*this.__creatorZoomFactor+"px",height:d*this.__creatorZoomFactor+"px"})}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterControlHighlightManager=class{constructor(t){this.__highlightContainerVisibility=!0,this.__asyncWorkData={animationFrameId:0,ctrlList:new Map},this.__selectorGripsId=["TopLeft","TopCenter","TopRight","CenterRight","BottomRight","BottomCenter","BottomLeft","CenterLeft"],this.__selectorGrips=["nwse","ns","nesw","ew","nwse","ns","nesw","ew"],this.__designerModeManager=t,e.EventProvider.register("System.onControlsResized",this.__onControlsResized()),e.EventProvider.register("System.onControlsMoved",this.__onControlsMoved()),e.EventProvider.register("System.onControlVisibilityChanged",this.__onControlVisibilityChanged()),e.EventProvider.register("System.onControlGetRowCountChanged",this.__onGridRowOrColumnChanged()),e.EventProvider.register("System.onControlGetColumnCountChanged",this.__onGridRowOrColumnChanged()),e.EventProvider.register("System.onGridCellResized",this.__onGridCellResized()),e.EventProvider.register("System.onControlGridRowIndexChanged",this.__onGridRowOrColumnIndexChanged()),e.EventProvider.register("System.onControlGridColumnIndexChanged",this.__onGridRowOrColumnIndexChanged()),e.EventProvider.register("onThemeDataChanged",this.updateEngineeringStyles());let r=document.createElement("div");r.innerHTML='<div data-tchmi-creator-target-control="" \n                                class="tchmi-creator-controlposition tchmi-box" \n                                style="z-index:0;">\n                                <div data-tchmi-creator-target-control="" \n                                    class="tchmi-creator-controlname tchmi-box"\n                                    title=""></div>\n                        </div>';let o=r.firstElementChild;r.innerHTML='<div   data-tchmi-creator-target-control="" \n                                class="tchmi-creator-hierarchy-controlposition tchmi-box" \n                                style="z-index:0;">\n                        </div>';let i=r.firstElementChild;r.innerHTML='<div   data-tchmi-creator-target-control="" \n                                class="tchmi-creator-originalposition tchmi-box" \n                                style="z-index:0;">\n\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-top"></div>\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-left"></div>\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-width"></div>\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-right"></div>\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-height"></div>\n                                <div class="tchmi-creator-distance-line tchmi-box tchmi-creator-distance-bottom"></div>\n\n                                <div class="tchmi-creator-snapline tchmi-box tchmi-creator-snapline-top"></div>\n                                <div class="tchmi-creator-snapline tchmi-box tchmi-creator-snapline-left"></div>\n                                <div class="tchmi-creator-snapline tchmi-box tchmi-creator-snapline-right"></div>\n                                <div class="tchmi-creator-snapline tchmi-box tchmi-creator-snapline-bottom"></div>\n\n                        </div>';let n=r.firstElementChild;r.innerHTML='<div   data-tchmi-creator-target-control="" \n                                class="tchmi-creator-anchorcontainer tchmi-box" \n                                style="border-width: 1px;z-index:0;">\n\n                                <div data-tchmi-creator-anchor-name="TopLeft"      class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-top-left"></div>\n                                <div data-tchmi-creator-anchor-name="TopCenter"    class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-top-center"></div>\n                                <div data-tchmi-creator-anchor-name="TopRight"     class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-top-right"></div>\n                                <div data-tchmi-creator-anchor-name="CenterLeft"   class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-center-left"></div>\n                                <div data-tchmi-creator-anchor-name="CenterRight"  class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-center-right"></div>\n                                <div data-tchmi-creator-anchor-name="BottomLeft"   class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-bottom-left"></div>\n                                <div data-tchmi-creator-anchor-name="BottomCenter" class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-bottom-center"></div>\n                                <div data-tchmi-creator-anchor-name="BottomRight"  class="tchmi-creator-anchor-rect tchmi-box tchmi-creator-anchor-bottom-right"></div>\n                        </div>';let s=r.firstElementChild;r.innerHTML='<div   data-tchmi-creator-target-control="" \n                                class="tchmi-creator-hierarchy-anchorcontainer" \n                                style="z-index:0;">\n                        </div>';let l=r.firstElementChild;this.__cloneSource={controlPosition:o,hierarchyControlPosition:i,originalPosition:n,anchorContainer:s,hierarchyAnchorContainer:l}}handleControlRemoved(e){e.jOriginalPosition.remove(),e.jControlPosition.remove(),e.jHierarchyControlposition.remove(),e.jAnchorContainer.remove(),e.jHierarchyAnchorContainer.remove()}requestAsyncHighlighterUpdate(){0===this.__asyncWorkData.animationFrameId&&(this.__asyncWorkData.animationFrameId=window.requestAnimationFrame(()=>{const e=new Set;this.__asyncWorkData.ctrlList.forEach((value,t)=>{const r=this.__designerModeManager.metaDataManager.getControlMetaData(t.getId());if(null===r)return;e.add(t);const o=t.getParent();o&&r.parent&&!0===r.parent.isGridControl&&(e.has(o)||e.add(o)),value.rowColumnChanged&&this.createGridHighlighter(t,r),value.resized&&r.isPartialRoot&&this.__designerModeManager.rootControlManager.setCreatorViewPortPosition(t),this.updateGripCursors(r)}),this.setContainerPositions(e),this.__designerModeManager.interactionManager.clearControlSnapPositionCache(),this.__designerModeManager.interactionManager.refreshControlSnapPositionCache(),this.__asyncWorkData.ctrlList.clear(),this.__asyncWorkData.animationFrameId=0}))}__onControlsResized(){return(e,t)=>{if(!0!==this.__designerModeManager.controlResizeManager.getControlResizing())for(let e of t){this.requestAsyncHighlighterUpdateForControl(e).resized=!0}}}__onControlsMoved(){return(e,t)=>{if(!0!==this.__designerModeManager.controlMoveManager.getControlMoveActive())for(let e of t){this.requestAsyncHighlighterUpdateForControl(e).moved=!0}}}requestAsyncHighlighterUpdateForControl(e){this.requestAsyncHighlighterUpdate();let t=this.__asyncWorkData.ctrlList.get(e);return t||(t={resized:!1,moved:!1,rowColumnChanged:!1},this.__asyncWorkData.ctrlList.set(e,t)),t}__onControlVisibilityChanged(){return(e,t)=>{const r=this.__designerModeManager.metaDataManager.getControlMetaData(t.getId());if(null===r)return;"Collapsed"===t.getVisibility()?r.controlCollapsed=!0:r.controlCollapsed=!1;let o=this.requestAsyncHighlighterUpdateForControl(t);o.moved=!0,o.resized=!0}}__onGridRowOrColumnIndexChanged(){return(t,r)=>{let o=r.getParent();if(!o||"TcHmi.Controls.System.TcHmiGrid"!==o.getType())return;const i=this.__designerModeManager.metaDataManager.getControlMetaData(r.getId());if(null===i||null===i.parent)return;let n=r.getGridRowIndex();(!n||n>=r.getParent().__rowOptions.length)&&(n=0);let s=r.getGridColumnIndex();(!s||s>=r.getParent().__columnOptions.length)&&(s=0);const l=i.parent.jHierarchyControlposition.children("[data-tchmi-creator-grid-rowindex="+n+"][data-tchmi-creator-grid-cellindex="+s+"]");0===l.length&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeMasterHighlightManager] Fatal internal error: Could not find target grid cell for "+o.getId()+" to attach highlight container."),l.append(i.jOriginalPosition),l.append(i.jControlPosition),l.append(i.jHierarchyControlposition),l.append(i.jAnchorContainer),l.append(i.jHierarchyAnchorContainer)}}__onGridRowOrColumnChanged(){return(e,t)=>{if(this.requestAsyncHighlighterUpdateForControl(t).rowColumnChanged=!0,"function"==typeof t.getChildren){const e=t.getChildren();for(const t of e){this.requestAsyncHighlighterUpdateForControl(t).resized=!0}}}}__onGridCellResized(){return(e,t)=>{if(!0===this.__designerModeManager.controlResizeManager.getControlResizing())return;this.requestAsyncHighlighterUpdateForControl(t).resized=!0}}setHighlightContainerVisibility(valueNew){this.__highlightContainerVisibility=valueNew;const e=this.__designerModeManager.metaDataManager.getControlMetaData();for(let id in e){const t=e[id];this.processHighlightType(t)}this.processDomVisibility()}setCreatorVisibilityAttribute(e,bVisibility){var t=this.__designerModeManager.metaDataManager.getControlMetaData(e);null!==t&&(t.domVisibility=bVisibility,this.processDomVisibility(t))}processDomVisibility(t){if(!0!==TCHMI_DESIGNER)return;let r;r=t?{singleCtrl:t}:this.__designerModeManager.metaDataManager.getControlMetaData();for(let id in r){const t=r[id],o=e.Controls.get(t.id);o?(o.getElement()[0].classList.toggle("tchmi-creator-controlhidden",!1===t.domVisibility),!1===t.domVisibility?(t.jOriginalPosition[0].style.display="none",t.jControlPosition[0].style.display="none",t.jHierarchyControlposition[0].style.display="none",t.jAnchorContainer[0].style.display="none",t.jHierarchyAnchorContainer[0].style.display="none"):(t.jOriginalPosition[0].style.display="",t.jControlPosition[0].style.display="",t.jHierarchyControlposition[0].style.display="",t.jAnchorContainer[0].style.display="",t.jHierarchyAnchorContainer[0].style.display="")):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeMasterHighlightManager] Failed to handle control "${t.id}": Not found in control cache.\n`)}}__handleOuterDimension(t,r,o,i,n,s,l,c,d){const element=l.getElement(),_=c.jOriginalPosition.children(".tchmi-creator-distance-"+o),m=r[o],u=m*d;"top"!==o&&u>=30||"top"===o&&u>=50?e.StyleProvider.setSimpleElementStyle(_,{width:u+"px",display:"","background-color":"","border-color":"",opacity:"","font-size":""}):e.StyleProvider.setSimpleElementStyle(_,{width:u+"px",display:"","background-color":"","border-color":"",opacity:"","font-size":"0px"}),u>=10?_.removeClass("no-triangle"):_.addClass("no-triangle");let g=!0;if(null!=i){if("px"===n)t[o]=u+n,!0!==this.__designerModeManager.controlResizeManager.getControlResizing()&&!0!==this.__designerModeManager.controlMoveManager.getControlMoveActive()&&i?_.text(i.toFixed(0)+n):_.text(m.toFixed(0)+n);else if("%"===n){let e;"top"===o||"bottom"===o?e=parseFloat(element.parent().css("height")):"left"!==o&&"right"!==o||(e=parseFloat(element.parent().css("width")));let r=m/e*100;t[o]=r+n,!0!==this.__designerModeManager.controlResizeManager.getControlResizing()&&!0!==this.__designerModeManager.controlMoveManager.getControlMoveActive()&&i?_.text(i.toFixed(1)+n):_.text(r.toFixed(1)+n)}3!==++s||"right"!==o&&"bottom"!==o||(g=!1,e.StyleProvider.setSimpleElementStyle(_,{width:"45px",display:"",opacity:"0.5"}),"%"!==n&&u<=7&&_.text(i.toFixed(0)+n))}else g=!1,e.StyleProvider.setSimpleElementStyle(_,"display","none");return c.jOriginalPosition[0].classList.toggle("tchmi-creator-control-definedfrom"+o,g),s}__handleInnerDimension(t,r,o,i,n,s,l,c,d,_){const element=c.getElement(),m=d.jOriginalPosition.children(".tchmi-creator-distance-"+o),u=r[o];if(d.controlCollapsed)t[o]="0",e.StyleProvider.setSimpleElementStyle(m,{display:"none"}),l++;else{if(e.StyleProvider.setSimpleElementStyle(m,{width:u*_+"px",display:"",opacity:""}),"px"===n){let e=u*_;t[o]=e+n,!0!==this.__designerModeManager.controlResizeManager.getControlResizing()&&!0!==this.__designerModeManager.controlMoveManager.getControlMoveActive()&&i?m.text(i.toFixed(0)+n):m.text(u.toFixed(0)+n),"Parent"!==s&&null!=i&&l++}else if("%"===n){let e=u/parseFloat(element.parent().css(o))*100;t[o]=e+n,!0!==this.__designerModeManager.controlResizeManager.getControlResizing()&&!0!==this.__designerModeManager.controlMoveManager.getControlMoveActive()&&i?m.text(i.toFixed(1)+n):m.text(e.toFixed(1)+n),"Parent"!==s&&null!=i&&l++}"Parent"===s||"Content"===s?null!=i?e.StyleProvider.setSimpleElementStyle(m,{opacity:"0.5"}):e.StyleProvider.setSimpleElementStyle(m,{display:"none"}):"Value"===s&&(null!=i?e.StyleProvider.setSimpleElementStyle(m,{opacity:"1.0"}):e.StyleProvider.setSimpleElementStyle(m,{display:"none"}))}return l}setContainerPositions(t){if(!t||0===t.size)return;const r=this.__designerModeManager.rootControlManager.getCreatorZoomFactor(),o=new Map,i=new Map;t.forEach(n=>{if(!n.getIsAttached()||n.getIsDestroyed())return;const element=n.getElement();if(!element||0===element.length)return;const s=this.__designerModeManager.metaDataManager.getControlMetaData(n.getId());if(null==s)return;if(!1===s.domVisibility)return;let l={top:0,height:0,bottom:0,left:0,width:0,right:0,transform:"","transform-origin":"","border-width":"","border-style":""};if(s.controlCollapsed)s.jAnchorContainer.css({visibility:"collapse"}),s.jControlPosition.css({visibility:"collapse"}),s.jHierarchyAnchorContainer.css({visibility:"collapse"}),s.jHierarchyControlposition.css({visibility:"collapse"}),s.jOriginalPosition.css({visibility:"collapse"});else{let t=e.StyleProvider.getComputedElementStyle(element,Object.keys(l));l.top=parseFloat(t.top),l.height=parseFloat(t.height),l.bottom=parseFloat(t.bottom),l.left=parseFloat(t.left),l.width=parseFloat(t.width),l.right=parseFloat(t.right),l.transform=t.transform,l["transform-origin"]=t["transform-origin"],l["border-width"]=t["border-width"],l["border-style"]=t["border-style"],s.jAnchorContainer.css({visibility:""}),s.jControlPosition.css({visibility:""}),s.jHierarchyAnchorContainer.css({visibility:""}),s.jHierarchyControlposition.css({visibility:""}),s.jOriginalPosition.css({visibility:""})}if(o.set(n,l),!0===s.isGridControl){n.getChildren().forEach(e=>{t.has(e)||t.add(e)});const e=element[0].getBoundingClientRect();let o=s.jHierarchyControlposition.children(".tchmi-creator-hierarchy-gridcellposition");o=o.add(s.jControlPosition.children(".tchmi-creator-gridcell"));for(let t=0;t<o.length;t++){const n=o[t],l=parseInt(n.getAttribute("data-tchmi-creator-grid-rowindex"),10),c=element.children().children(".TcHmi_Controls_System_TcHmiGrid-grid").children().eq(l),d=parseInt(n.getAttribute("data-tchmi-creator-grid-cellindex"),10),_=c.children().eq(d);if(0===c.length||0===_.length)return;let m,u,g,E,h,S;n.classList.contains("tchmi-creator-gridcell")?(m=parseFloat(element.css("border-top-width")),u=parseFloat(element.css("border-left-width"))):(m=parseFloat(_.css("border-top-width")),u=parseFloat(_.css("border-left-width")));let p=_[0].getBoundingClientRect();0===s.absoluteParentRotation&&0===s.relativeControlRotation?(g=p.height,E=p.width,h=p.top-e.top,S=p.left-e.left):(g=_[0].offsetHeight,E=_[0].offsetWidth,h=_[0].offsetTop,S=_[0].offsetLeft);const f={height:g+"px",width:E+"px",top:m*r+h+"px",left:u*r+S+"px"};i.set(n,f)}}}),o.forEach((t,o)=>{const i={top:"",height:"",bottom:"",left:"",width:"",right:""},n=this.__designerModeManager.metaDataManager.getControlMetaData(o.getId());let s=0,l=o.getTop(),c=o.getTopUnit();s=this.__handleOuterDimension(i,t,"top",l,c,s,o,n,r),l=o.getHeight(),c=o.getHeightUnit();let d=o.getHeightMode();s=this.__handleInnerDimension(i,t,"height",l,c,d,s,o,n,r),l=o.getBottom(),c=o.getBottomUnit(),s=this.__handleOuterDimension(i,t,"bottom",l,c,s,o,n,r),s<2&&this.__handleOuterDimension(i,t,"top",0,"px",s,o,n,r),s=0,l=o.getLeft(),c=o.getLeftUnit(),s=this.__handleOuterDimension(i,t,"left",l,c,s,o,n,r),l=o.getWidth(),c=o.getWidthUnit(),d=o.getWidthMode(),s=this.__handleInnerDimension(i,t,"width",l,c,d,s,o,n,r),l=o.getRight(),c=o.getRightUnit(),s=this.__handleOuterDimension(i,t,"right",l,c,s,o,n,r),s<2&&this.__handleOuterDimension(i,t,"left",0,"px",s,o,n,r),s=0,e.StyleProvider.setSimpleElementStyle(n.jOriginalPosition,i);const _=t.transform;if(1!==r&&_.startsWith("matrix")){let e="",t=[],o=_.substring(_.lastIndexOf("(")+1,_.lastIndexOf(")")).split(",");6===o.length?(e="matrix",t=[4,5]):16===o.length&&(e="matrix3d",t=[12,13,14]);for(let e of t)o[e]=(parseInt(o[e],10)*r).toString();i.transform=e+"("+o.join(",")+")"}else i.transform="none"!==_?_:"";if(""!==i.transform){const e=t["transform-origin"];if(e){let t=e.split(" ");for(let e=0,o=t.length;e<o;e++)-1!==t[e].indexOf("px")&&(t[e]=parseInt(t[e],10)*r+"px");i["transform-origin"]=t.join(" ")}else i["transform-origin"]=""}else i["transform-origin"]="";e.StyleProvider.setSimpleElementStyle(n.jControlPosition,i),e.StyleProvider.setSimpleElementStyle(n.jHierarchyControlposition,i),e.StyleProvider.setSimpleElementStyle(n.jAnchorContainer,i),e.StyleProvider.setSimpleElementStyle(n.jHierarchyAnchorContainer,i);let m=t["border-width"];m||(m="0px");let u=t["border-style"];u||(u="none");let g=m.split("px"),E="";g.forEach((function(e,t){let o=parseFloat(e);isNaN(o)||(E+=o*r+"px ")}));let h={"border-width":E,"border-style":u,"border-color":"transparent"};if(e.StyleProvider.setSimpleElementStyle(n.jHierarchyControlposition,h),e.StyleProvider.setSimpleElementStyle(n.jHierarchyAnchorContainer,h),o.getParent()&&n.parent&&!0===n.parent.isGridControl&&0===n.jHierarchyControlposition.parent().length){let t=o.getGridRowIndex();(!t||t>=o.getParent().__rowOptions.length)&&(t=0);let r=o.getGridColumnIndex();(!r||r>=o.getParent().__columnOptions.length)&&(r=0);const i=n.parent.jHierarchyControlposition.children("[data-tchmi-creator-grid-rowindex="+t+"][data-tchmi-creator-grid-cellindex="+r+"]");0===i.length&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeMasterHighlightManager] Fatal internal error: Could not find target grid cell for "+o.getParent().getId()+" to attach highlight container."),n.jHierarchyControlposition.parent().is(i)||(i.append(n.jOriginalPosition),i.append(n.jControlPosition),i.append(n.jHierarchyControlposition),i.append(n.jAnchorContainer),i.append(n.jHierarchyAnchorContainer))}}),i.forEach((t,r)=>{e.StyleProvider.setSimpleElementStyle(r,t)})}updateGripCursors(e){let t,r=Math.round((e.relativeControlRotation+e.absoluteParentRotation)*(8/360));for(r<0&&(r+=8),t=0;t<8;t++){const o=(t+r)%8;e.jAnchorContainer.children(`[data-tchmi-creator-anchor-name="${this.__selectorGripsId[t]}"]`).css("cursor",this.__selectorGrips[o]+"-resize")}}processHighlightType(e){!0===e.isSelected?e.jControlPosition[0].classList.remove("tchmi-creator-active-highlight"):e.jControlPosition[0].classList.toggle("tchmi-creator-active-highlight",this.__highlightContainerVisibility),e.jControlPosition[0].classList.toggle("tchmi-creator-control-selected",e.isSelected),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-selected",e.isSelected),e.jAnchorContainer[0].classList.toggle("tchmi-creator-control-selected",e.isSelected),e.jOriginalPosition[0].classList.toggle("tchmi-creator-active-highlight",this.__highlightContainerVisibility)}updateEngineeringStyles(){return e=>{let t=document.querySelector('link[href*="StyleEngineering.css"]');const r=function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a/255+")"};if(t&&t.sheet){const settings=this.__designerModeManager.getSettings();let e=t.sheet.cssRules[0];if(":root"!==e.selectorText)throw new SyntaxError("StyleEngineering.css has invalid format: First selector has to be :root");let o=e.style;if(!(o.getPropertyValue("--tchmi-designer-control-untransformed-color")&&o.getPropertyValue("--tchmi-designer-control-unselected-color")&&o.getPropertyValue("--tchmi-designer-control-selected-color")&&o.getPropertyValue("--tchmi-designer-control-selected-secondary-color")&&o.getPropertyValue("--tchmi-designer-control-snap-color")))throw new SyntaxError("StyleEngineering.css has invalid format: CSS custom properties missing");settings.untransformedColor&&o.setProperty("--tchmi-designer-control-untransformed-color",r(settings.untransformedColor)),settings.unSelectedHighlightColor&&o.setProperty("--tchmi-designer-control-unselected-color",r(settings.unSelectedHighlightColor)),settings.selectionHighlightColor&&o.setProperty("--tchmi-designer-control-selected-color",r(settings.selectionHighlightColor)),settings.selectedSecondaryColor&&o.setProperty("--tchmi-designer-control-selected-secondary-color",r(settings.selectedSecondaryColor)),settings.snapHighlightColor&&o.setProperty("--tchmi-designer-control-snap-color",r(settings.snapHighlightColor)),void 0!==settings.snapDistanceToControls&&o.setProperty("--tchmi-designer-control-remote-snap-distance",settings.snapDistanceToControls+"px"),settings.theme&&settings.theme.ChessboardLight&&o.setProperty("--tchmi-designer-vs-theme-chessboard-light",r(settings.theme.ChessboardLight)),settings.theme&&settings.theme.ChessboardDark&&o.setProperty("--tchmi-designer-vs-theme-chessboard-dark",r(settings.theme.ChessboardDark))}}}createControlPosition(t,r){let o=t.getId(),i=t.getType(),n=e.System.Data.Modules.controls.map.get(i);n&&n.error===e.Errors.NONE&&n.descriptionExpanded&&(i=n.descriptionExpanded.displayName||"");let s=this.__cloneSource.controlPosition.cloneNode(!0);s.setAttribute("data-tchmi-creator-target-control",o),s.style.zIndex=r.toString();let l=s.firstElementChild;return l.title=o+": "+i,l.textContent=o,l.setAttribute("data-tchmi-creator-target-control",o),$(s)}createHierarchyControlPosition(e,t){let r=e.getId(),o=this.__cloneSource.hierarchyControlPosition.cloneNode(!0);return o.setAttribute("data-tchmi-creator-target-control",r),o.style.zIndex=t.toString(),$(o)}createOriginalPosition(e,t){let r=e.getId(),o=this.__cloneSource.originalPosition.cloneNode(!0);return o.setAttribute("data-tchmi-creator-target-control",r),o.style.zIndex=t.toString(),$(o)}createAnchorContainer(e,t,r){let o=e.getId(),i=this.__cloneSource.anchorContainer.cloneNode(!0);return i.setAttribute("data-tchmi-creator-target-control",o),i.style.zIndex=t.toString(),r&&i.classList.add("tchmi-creator-control-locked"),$(i)}createHierarchyAnchorContainer(e,t,r){let o=e.getId(),i=this.__cloneSource.hierarchyAnchorContainer.cloneNode(!0);return i.setAttribute("data-tchmi-creator-target-control",o),i.style.zIndex=t.toString(),r&&i.classList.add("tchmi-creator-control-locked"),$(i)}createGridHighlighter(t,r){if(!r)return;if(!t.__rowOptions)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeMasterHighlightManager] Grid control "+t.getId()+" has invalid Row Options."));if(!t.__columnOptions)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModeMasterHighlightManager] Grid control "+t.getId()+" has invalid Column Options."));const o=r.jHierarchyControlposition.children(".tchmi-creator-hierarchy-gridcellposition");o.children().detach(),o.remove(),r.jControlPosition.children(".tchmi-creator-gridcell").remove();let i=e.StyleProvider.getSimpleElementStyle(r.jControlPosition,"z-index"),n=$(),s=$(),l=document.createElement("div");for(let e=0;e<t.__rowOptions.length;e++)for(let r=0;r<t.__columnOptions.length;r++){l.innerHTML=`<div data-tchmi-creator-target-control="${t.getId()}" \n                                                class="tchmi-creator-hierarchy-gridcellposition tchmi-box" \n                                                style="z-index:${i["z-index"]}"\n                                                data-tchmi-creator-grid-rowindex="${e}" data-tchmi-creator-grid-cellindex="${r}">\n                                                </div>`;const o=$(l.firstElementChild);n=n.add(o),l.innerHTML=`<div data-tchmi-creator-target-control="${t.getId()}" \n                                                class="tchmi-creator-gridcell tchmi-box"\n                                                style="z-index:${i["z-index"]}"\n                                                data-tchmi-creator-grid-rowindex="${e}" data-tchmi-creator-grid-cellindex="${r}">\n                                                </div>`;const c=$(l.firstElementChild);this.__designerModeManager.hierarchyManager.registerContainerElement(c),s=s.add(c)}r.jHierarchyControlposition.append(n),r.jControlPosition.append(s)}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterRectSelectManager=class{constructor(t){this.__rectSelecting=!1,this.__lockRectSelect=!1,this.__documentRectSelectMouseMoveNs="mousemove.DesignerModeManager.DocumentRectSelectMouseMove",this.__documentRectSelectMouseUpNs="mouseup.DesignerModeManager.DocumentRectSelectMouseUp",this.__documentRectSelectMouseDownNs="mousedown.DesignerModeManager.DocumentRectSelectMouseDown",this.__designerModeManager=t,this.__selectionDragHighlighter=document.createElement("div"),this.__selectionDragHighlighter.classList.add("tchmi-creator-selection-drag-container"),e.System.SharedResources.jqDocument.on(this.__documentRectSelectMouseDownNs,this.__onDocumentRectSelectMouseDown())}getRectSelecting(){return this.__rectSelecting}lockRectSelect(){this.__lockRectSelect=!0}resetState(){this.__rectSelecting=!1,this.__lockRectSelect=!1,e.System.SharedResources.jqDocument.off(this.__documentRectSelectMouseMoveNs),e.System.SharedResources.jqDocument.off(this.__documentRectSelectMouseUpNs)}__onDocumentRectSelectMouseDown(){let t=this;return function(event){1===event.which&&(t.__designerModeManager.interactionManager.handleInteractionStart(event,null),t.__lockRectSelect=!1,e.System.SharedResources.jqDocument.on(t.__documentRectSelectMouseMoveNs,t.__onDocumentRectSelectMouseMove()),e.System.SharedResources.jqDocument.on(t.__documentRectSelectMouseUpNs,t.__onDocumentRectSelectMouseUp()))}}__onDocumentRectSelectMouseMove(){let t=this;return function(event){if(1!==event.which)return;if(!0===t.__designerModeManager.controlMoveManager.getControlMoveActive())return;if(!0===t.__designerModeManager.controlResizeManager.getControlResizing())return;if(!0===t.__lockRectSelect)return;const r=t.__designerModeManager.interactionManager.getStartMousePos();let o=event.pageX-r.left,i=event.pageY-r.top;if(Math.abs(o)<=5&&Math.abs(i)<=5)return;let n=0,s=0,l=0,c=0;t.__designerModeManager.controlMoveManager.setMouseMoving(!0),o>=0?(n=o,s=r.left):(n=-o,s=r.left+o),i>=0?(l=i,c=r.top):(l=-i,c=r.top+i),e.StyleProvider.setSimpleElementStyle(t.__selectionDragHighlighter,{width:n+"px",left:s+"px",height:l+"px",top:c+"px","pointer-events":"none"}),t.__selectionDragHighlighter.parentElement||document.body.appendChild(t.__selectionDragHighlighter),t.__rectSelecting=!0,t.__designerModeManager.controlMoveManager.lockControlMove(),t.__designerModeManager.controlResizeManager.lockControlResize()}}__onDocumentRectSelectMouseUp(){let e=this;return function(event){1!==event.which?(3===event.which&&e.__selectionDragHighlighter.remove(),e.__designerModeManager.controlMoveManager.setMouseMoving(!1)):!0===e.__lockRectSelect&&!1===e.__rectSelecting||(e.__processRectSelect(e.__selectionDragHighlighter.getBoundingClientRect(),event.ctrlKey,event.altKey),e.__selectionDragHighlighter.remove(),e.__designerModeManager.controlMoveManager.setMouseMoving(!1)),e.resetState()}}__processRectSelect(t,r,o){let i=!1,n=!0;const s=[],l=this.__designerModeManager.metaDataManager.getControlMetaData();for(let id in l){const c=l[id];if(!1===c.domVisibility)continue;let d=!1,_=c.parent;for(;null!==_;){if(!1===_.domVisibility){d=!0;break}_=_.parent}if(!0===d)continue;const m=e.Controls.get(c.id);if(!m)continue;if(!m.getElement())continue;const u=c.jControlPosition[0].getBoundingClientRect();if(!0===this.__hasClientRectIntersection(u,t,o)){if(!0===c.isPartialRoot)continue;if(!0===n&&!1===r){n=!1,this.__designerModeManager.unselectEach(!0)&&(i=!0)}let e=this.__designerModeManager.controlMoveManager.getActiveControl();if(e&&e.id===c.id&&e.isContainerControl&&r)continue;let t=!1,o=e;for(;o;){if(o.id===c.id){t=!0;break}o=o.parent}if(t)continue;s.push(c.id),i=!0}}s.forEach(e=>{this.__designerModeManager.select(e,!0)}),i&&this.__designerModeManager.resyncSelectedControls()}__hasClientRectIntersection(e,t,r){let o=e.left,i=e.right,n=e.top,s=e.bottom,l=t.left,c=t.right,d=t.top,_=t.bottom;return!1===r?!(o>c||i<l||n>_||s<d):o>l&&i<c&&n>d&&s<_}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterControlMoveManager=class{constructor(e){this.__copyMoveRectHighlightOffset={left:0,top:0},this.__highlightMouseDownNs="mousedown.DesignerModeManager.HighlightMouseDown",this.__highlightMouseUpNs="mouseup.DesignerModeManager.HighlightMouseUp",this.__highlightMouseMoveNs="mousemove.DesignerModeManager.HighlightMouseMove",this.__activeControl=null,this.__activeControlPrev=null,this.__mouseMoving=!1,this.__lockControlMove=!1,this.__controlMoveActive=!1,this.__designerModeManager=e,this.__copyMoveRectHighlighter=document.createElement("canvas"),this.__copyMoveRectHighlighter.classList.add("tchmi-creator-copymove-container"),this.__onHighlightMouseUpLastProc=new Date}registerControl(e){e.jControlPosition.on(this.__highlightMouseDownNs,this.__onHighlightMouseDown())}getActiveControl(){return this.__activeControl}getActiveControlPrev(){return this.__activeControlPrev}getControlMoveActive(){return this.__controlMoveActive}lockControlMove(){this.__lockControlMove=!0}setMouseMoving(valueNew){this.__mouseMoving=valueNew}resetState(){this.__lockControlMove=!1,this.__controlMoveActive=!1,e.System.SharedResources.jqDocument.off(this.__highlightMouseMoveNs),e.System.SharedResources.jqDocument.off(this.__highlightMouseUpNs),e.StyleProvider.setSimpleElementStyle(e.System.SharedResources.jqBody,"cursor",""),this.__designerModeManager.hierarchyManager.removeHighlightDropTarget(),this.__copyMoveRectHighlighter.remove(),null!==this.__activeControl&&(this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop-remote"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft-remote"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom-remote"),this.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright-remote"))}__onHighlightMouseDown(){let t=this;return function(event){if(1!==event.which)return;let r=$(event.target).attr("data-tchmi-creator-target-control");if(!r)return;const o=t.__designerModeManager.metaDataManager.getControlMetaData(r);null!==o&&(t.__activeControlPrev=t.__activeControl,t.__activeControl=o,t.__designerModeManager.interactionManager.handleInteractionStart(event,o),t.__designerModeManager.interactionManager.handleInteractionStartCopyMoveOffsetPosition(event),t.__designerModeManager.interactionManager.setAnchorName(void 0),t.__lockControlMove=!1,e.System.SharedResources.jqDocument.on(t.__highlightMouseMoveNs,t.__onHighlightMouseMove()),e.System.SharedResources.jqDocument.on(t.__highlightMouseUpNs,t.__onHighlightMouseUp()))}}__selectedControlsSameParent(t){let r=[];null===this.__activeControl.parent&&(r=null);const o=this.__designerModeManager.metaDataManager.getSelectedControlsMetaData();for(let id in o){const i=o[id];let n=!0===t?"none":"";null!==t&&(e.StyleProvider.setSimpleElementStyle(i.jControlPosition,"pointer-events",n),i.isGridControl&&e.StyleProvider.setSimpleElementStyle(i.jControlPosition[0].children,"pointer-events",n)),null!==i.parent?i.parent.id===this.__activeControl.parent.id?r&&r.push(i.id):r=null:r=null}return r}__onHighlightMouseMove(){let t=this;return function(event){if(null===t.__activeControl)return;if(!0===t.__designerModeManager.controlResizeManager.getControlResizing())return;if(!0===t.__activeControl.isPartialRoot)return;if(!0===t.__designerModeManager.rectSelectManager.getRectSelecting())return;if(!0===t.__lockControlMove)return;if(!0===event.ctrlKey&&!0===t.__activeControl.isContainerControl){let e=t.__activeControl;for(;e;)t.__designerModeManager.unselect(e.id,!0),e=e.parent;return}let r;if(1!==event.which)return void t.resetState();let o=t.__activeControl;do{if(!0===o.locked)return;o=o.parent}while(o);if(!1===t.__mouseMoving){if(!1===event.ctrlKey&&!1===t.__activeControl.isSelected){r=t.__designerModeManager.metaDataManager.getSelectedControlsMetaData();for(let id in r){let e=r[id];null!==e&&null!==t.__activeControl&&e.id!==t.__activeControl.id&&t.__designerModeManager.unselect(e.id,!0)}}t.__designerModeManager.select(t.__activeControl.id,!0)}const i=t.__designerModeManager.interactionManager.getStartMousePos(),n=t.__designerModeManager.interactionManager.getStartMousePosCopyMoveOffsetPosition();let s=event.pageX-i.left,l=event.pageY-i.top;if(0!==s||0!==l){if(t.__mouseMoving=!0,!0===event.shiftKey&&(Math.abs(s)>Math.abs(l)?l=0:s=0),t.__controlMoveActive=!0,t.__designerModeManager.rectSelectManager.lockRectSelect(),!1===event.ctrlKey){const o=t.__designerModeManager.rootControlManager.getCreatorZoomFactor();let i=t.__designerModeManager.interactionManager.handleSnapping(t.__activeControl,{left:s/o,top:l/o},{left:event.pageX,top:event.pageY},!event.altKey);t.__copyMoveRectHighlighter.parentElement&&(e.StyleProvider.setSimpleElementStyle(e.System.SharedResources.jqBody,"cursor",""),t.__copyMoveRectHighlighter.remove());const n=[];r=t.__designerModeManager.metaDataManager.getSelectedControlsMetaData();for(let id in r){const o=r[id];!0!==o.isPartialRoot&&(t.__processMove(o,i),n.push(e.Controls.get(o.id)))}t.__designerModeManager.hierarchyManager.removeHighlightDropTarget();if(null!==t.__selectedControlsSameParent(!0)){const r=t.__designerModeManager.hierarchyManager.getContainerFromPoint({left:event.pageX,top:event.pageY});if(r){let o=e.Controls.get(t.__activeControl.id);const i=t.__activeControl.parent?t.__activeControl.parent.id:"";!0!==event.altKey&&i!==r.tco.getId()?(t.__designerModeManager.hierarchyManager.addHighlightDropTarget({left:event.pageX,top:event.pageY},event.target),t.__activeControl.jControlPosition[0].classList.add("tchmi-creator-will-get-new-parent"),t.__activeControl.jOriginalPosition[0].classList.add("tchmi-creator-will-get-new-parent")):!0===event.altKey||!t.__activeControl.parent.isGridControl||r.columnIndex===o.getGridColumnIndex()&&r.rowIndex===o.getGridRowIndex()?(t.__activeControl.jControlPosition[0].classList.remove("tchmi-creator-will-get-new-parent"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-will-get-new-parent")):(t.__designerModeManager.hierarchyManager.addHighlightDropTarget({left:event.pageX,top:event.pageY},event.target),t.__activeControl.jControlPosition[0].classList.add("tchmi-creator-will-get-new-parent"),t.__activeControl.jOriginalPosition[0].classList.add("tchmi-creator-will-get-new-parent"))}}t.__designerModeManager.highlightManager.setContainerPositions(new Set(n)),t.__selectedControlsSameParent(!1)}else if(Math.abs(s)>=5&&Math.abs(l)>=5)if(t.__copyMoveRectHighlighter.parentElement){let e=i.top-n.top,r=i.left-n.left;t.__copyMoveRectHighlighter.style.top=t.__copyMoveRectHighlightOffset.top+l+window.scrollY+e+"px",t.__copyMoveRectHighlighter.style.left=t.__copyMoveRectHighlightOffset.left+s+window.scrollX+r+"px",t.__designerModeManager.hierarchyManager.addHighlightDropTarget({left:event.pageX,top:event.pageY},event.target)}else{t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright-remote");let o={top:Number.POSITIVE_INFINITY,left:Number.POSITIVE_INFINITY,rightside:Number.NEGATIVE_INFINITY,bottomside:Number.NEGATIVE_INFINITY},i=!0;null===t.__activeControl.parent&&(i=!1);let n=[];r=t.__designerModeManager.metaDataManager.getSelectedControlsMetaData();const c=[];for(let id in r){const s=r[id];if(t.__processMove(s,{left:0,top:0}),e.StyleProvider.setSimpleElementStyle(s.jControlPosition,"pointer-events","none"),!1===i)continue;if(null===s.parent){i=!1;continue}if(s.parent.id!==t.__activeControl.parent.id){i=!1;continue}let l=s.jControlPosition[0].getBoundingClientRect();o.top>l.top&&(o.top=l.top),o.left>l.left&&(o.left=l.left),o.bottomside<l.top+l.height&&(o.bottomside=l.top+l.height),o.rightside<l.left+l.width&&(o.rightside=l.left+l.width),n.push({top:l.top,left:l.left,height:l.height,width:l.width}),c.push(e.Controls.get(s.id))}if(t.__designerModeManager.highlightManager.setContainerPositions(new Set(c)),t.__designerModeManager.interactionManager.handleInteractionStartCopyMoveOffsetPosition(event),t.__designerModeManager.hierarchyManager.addHighlightDropTarget({left:event.pageX,top:event.pageY},event.target),!1===i)e.StyleProvider.setSimpleElementStyle(e.System.SharedResources.jqBody,"cursor","no-drop");else{e.StyleProvider.setSimpleElementStyle(e.System.SharedResources.jqBody,"cursor","copy"),t.__copyMoveRectHighlightOffset.top=o.top,t.__copyMoveRectHighlightOffset.left=o.left;let r=o.top+l+window.scrollY,i=o.left+s+window.scrollX,c=o.bottomside-o.top,d=o.rightside-o.left;t.__copyMoveRectHighlighter.width=d,t.__copyMoveRectHighlighter.height=c,t.__copyMoveRectHighlighter.style.cssText="top:"+r+"px;left:"+i+"px;height:"+c+"px;width:"+d+"px;";const _=t.__copyMoveRectHighlighter.getContext("2d");_.strokeStyle="gray";for(let e of n)_.strokeRect(e.left+window.scrollX+s-i,e.top+window.scrollY+l-r,e.width,e.height);document.body.appendChild(t.__copyMoveRectHighlighter)}for(let id in r){const t=r[id];e.StyleProvider.setSimpleElementStyle(t.jControlPosition,"pointer-events","")}}}else t.__designerModeManager.rectSelectManager.lockRectSelect()}}__processMove(t,r){let o=r.left,i=r.top,n=t,s=!1;do{if(!0===n.locked){s=!0;break}n=n.parent}while(n);if(!0===s)return;const l=e.Controls.get(t.id);if(!l)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`Failed to move control "${t.id}": Not found in control cache.\n`));var c=!1,d=l.getElement().parents("[data-tchmi-type]");const _=this.__designerModeManager.metaDataManager.getSelectedControlIdsWithChildren();for(var m=0,u=d.length;m<u;m++)if(-1!==_.indexOf(d[m].id)){c=!0;break}if(!0===c)return;let g,E=null,h={};if(null!==t.controlAttributeDimension.topValue&&("%"!==t.controlAttributeDimension.topUnit?(g=t.controlAttributeDimension.topValue+Math.sin(-t.absoluteParentRotation*Math.PI/180)*o+Math.cos(-t.absoluteParentRotation*Math.PI/180)*i,h.top=Math.round(g)+"px"):(null===E&&(E=l.getElement().parent().outerHeight()),g=t.controlAttributeDimension.topValue+100*(+Math.sin(-t.absoluteParentRotation*Math.PI/180)*o+Math.cos(-t.absoluteParentRotation*Math.PI/180)*i)/E,h.top=g+"%")),null!==t.controlAttributeDimension.bottomValue&&("%"!==t.controlAttributeDimension.bottomUnit?(g=t.controlAttributeDimension.bottomValue-Math.sin(-t.absoluteParentRotation*Math.PI/180)*o-Math.cos(-t.absoluteParentRotation*Math.PI/180)*i,h.bottom=Math.round(g)+"px"):(null===E&&(E=l.getElement().parent().outerHeight()),g=t.controlAttributeDimension.bottomValue+100*(-Math.sin(-t.absoluteParentRotation*Math.PI/180)*o-Math.cos(-t.absoluteParentRotation*Math.PI/180)*i)/E,h.bottom=g+"%")),null===t.controlAttributeDimension.topValue&&null===t.controlAttributeDimension.bottomValue&&(h.top=Math.round(Math.sin(-t.absoluteParentRotation*Math.PI/180)*o+Math.cos(-t.absoluteParentRotation*Math.PI/180)*i)+"px"),E=null,null!==t.controlAttributeDimension.leftValue&&("%"!==t.controlAttributeDimension.leftUnit?(g=t.controlAttributeDimension.leftValue+Math.cos(t.absoluteParentRotation*Math.PI/180)*o+Math.sin(t.absoluteParentRotation*Math.PI/180)*i,h.left=Math.round(g)+"px"):(null===E&&(E=l.getElement().parent().outerWidth()),g=t.controlAttributeDimension.leftValue+100*(+Math.cos(t.absoluteParentRotation*Math.PI/180)*o+Math.sin(t.absoluteParentRotation*Math.PI/180)*i)/E,h.left=g+"%")),null!==t.controlAttributeDimension.rightValue&&("%"!==t.controlAttributeDimension.rightUnit?(g=t.controlAttributeDimension.rightValue-Math.cos(t.absoluteParentRotation*Math.PI/180)*o-Math.sin(t.absoluteParentRotation*Math.PI/180)*i,h.right=Math.round(g)+"px"):(null===E&&(E=l.getElement().parent().outerWidth()),g=t.controlAttributeDimension.rightValue+100*(-Math.cos(t.absoluteParentRotation*Math.PI/180)*o-Math.sin(t.absoluteParentRotation*Math.PI/180)*i)/E,h.right=g+"%")),null===t.controlAttributeDimension.leftValue&&null===t.controlAttributeDimension.rightValue&&(h.left=Math.round(Math.cos(t.absoluteParentRotation*Math.PI/180)*o+Math.sin(t.absoluteParentRotation*Math.PI/180)*i)+"px"),e.StyleProvider.setSimpleElementStyle(l.getElement(),h),this.__designerModeManager.metaDataManager.addChangedControlsMetaData(t),l.getParent()&&t.parent&&!0===t.parent.isGridControl){const e=new Set;e.add(l.getParent()),this.__designerModeManager.highlightManager.setContainerPositions(e)}}__onHighlightMouseUp(){let r=this;return function(event){let o={};if(1!==event.which){if(3===event.which&&!0===r.__controlMoveActive){o=r.__designerModeManager.metaDataManager.getSelectedControlsMetaData();for(let id in o){const e=o[id];!0!==e.isPartialRoot&&r.__processMove(e,{left:0,top:0})}}return void r.resetState()}if(!0===r.__lockControlMove&&!0===r.__designerModeManager.rectSelectManager.getRectSelecting())return void r.resetState();null===r.__activeControl&&(r.__mouseMoving=!1,r.resetState());const i=r.__activeControl,n=r.__activeControlPrev;!1===r.__mouseMoving&&(!1===event.ctrlKey&&!1===i.isSelected&&r.__designerModeManager.unselectEach(!0),r.__designerModeManager.select(i.id,!0),r.__designerModeManager.rectSelectManager.lockRectSelect());const s=r.__designerModeManager.interactionManager.getStartMousePos(),l=event.pageX-s.left,c=event.pageY-s.top;let d=0;if(null!=n&&i.id===n.id&&Math.abs(l)<5&&Math.abs(c)<5){const e=r.__onHighlightMouseUpLastProc.getTime();Date.now()-e<=500&&(d=3)}r.__onHighlightMouseUpLastProc=new Date;let _=e.Controls.get(r.__activeControl.id);if(3===d&&event.ctrlKey&&_){let t=e.System.Data.Modules.controls.map.get(_.getType());t&&t.error===e.Errors.NONE&&t.descriptionExpanded&&!t.descriptionExpanded.defaultDesignerEvent&&(d=0)}if(3===d)_&&new t.SyncCmdToCreatorControlDoubleClick({name:"ControlDoubleClick",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,targetControl:{id:i.id,type:_.getType()},replyTo:null}).send();else{let o;!0===event.ctrlKey&&!1===r.__mouseMoving&&!0===i.isSelectedPrev&&i.isSelected&&r.__designerModeManager.unselect(i.id,!0),!0===event.ctrlKey&&(Math.abs(l)>5||Math.abs(c)>5)?d=2:!0!==event.altKey&&(Math.abs(l)>5||Math.abs(c)>5)&&(d=1),null===i.parent&&(d=0);let n,s=null;if(0!==d&&(s=r.__selectedControlsSameParent(!0),n=r.__designerModeManager.hierarchyManager.getContainerFromPoint({left:event.pageX,top:event.pageY}),r.__selectedControlsSameParent(!1),null===s&&(d=0)),s){if(2===d?o={name:"CopyMoveControls",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,deltaPosition:{left:null,top:null},controls:s,targetParentControl:n.tco.getId(),replyTo:null}:1===d&&(o={name:"HierarchyMoveControls",frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",targetPartial:TCHMI_TARGET_PARTIAL,deltaPosition:{left:null,top:null},controls:s,targetParentControl:n.tco.getId(),replyTo:null}),0!==d){null===n.rowIndex&&(n.rowIndex=0),null===n.columnIndex&&(n.columnIndex=0);let e=_.getGridRowIndex(),t=_.getGridColumnIndex();1===d&&n.rowIndex===e&&n.columnIndex===t&&n.tco===_.getParent()?d=0:o.attributes=[{name:"data-tchmi-grid-row-index",value:n.rowIndex},{name:"data-tchmi-grid-column-index",value:n.columnIndex}]}if(0!==d&&null!==i.parent&&null!==i.controlAttributeDimension.topValue&&"px"===i.controlAttributeDimension.topUnit&&null!==i.controlAttributeDimension.heightValue&&"px"===i.controlAttributeDimension.heightUnit&&"Value"===i.controlAttributeDimension.heightMode&&0===i.absoluteParentRotation){let e=i.jOriginalPosition.parent()[0].getBoundingClientRect(),t=n.jHighlighter[0].getBoundingClientRect();o.deltaPosition.top=c+(e.top-t.top)}if(0!==d&&null!==i.parent&&null!==i.controlAttributeDimension.leftValue&&"px"===i.controlAttributeDimension.leftUnit&&null!==i.controlAttributeDimension.widthValue&&"px"===i.controlAttributeDimension.widthUnit&&"Value"===i.controlAttributeDimension.widthMode&&0===i.absoluteParentRotation){let e=i.jOriginalPosition.parent()[0].getBoundingClientRect(),t=n.jHighlighter[0].getBoundingClientRect();o.deltaPosition.left=l+(e.left-t.left)}}if(2===d&&o&&"CopyMoveControls"===o.name)new t.SyncCmdToCreatorCopyMoveControls(o).send(),r.__designerModeManager.metaDataManager.resetChangedControlsMetaData();else if(1===d&&o&&"HierarchyMoveControls"===o.name)new t.SyncCmdToCreatorHierarchyMoveControls(o).send(),r.__designerModeManager.metaDataManager.resetChangedControlsMetaData();else if(0===d){const t=[],o=e.System.resolveControlHierarchy(_,null),i=function(e){for(var r=0,o=e.children_hierarchy.length;r<o;r++){var n=e.children_hierarchy[r];t.push(n.ctrl),i(n)}};i(o),r.__designerModeManager.highlightManager.setContainerPositions(new Set(t)),r.__designerModeManager.syncManager.updatePcElementAndSync("System.onControlPositionParameterChanged"),r.__designerModeManager.resyncSelectedControls(),r.__designerModeManager.resyncControls()}}r.__mouseMoving=!1,r.resetState()}}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeMasterControlResizeManager=class{constructor(e){this.__anchorMouseMoveNs="mousemove.DesignerModeManager.AnchorMouseMove",this.__anchorMouseUpNs="mouseup.DesignerModeManager.AnchorMouseUp",this.__anchorMouseDownNs="mousedown.DesignerModeManager.AnchorMouseDown",this.__lockControlResize=!1,this.__controlResizing=!1,this.__activeControl=null,this.__designerModeManager=e}registerControl(e){e.jAnchorContainer.children(".tchmi-creator-anchor-rect").on(this.__anchorMouseDownNs,this.__onAnchorMouseDown())}getControlResizing(){return this.__controlResizing}lockControlResize(){this.__lockControlResize=!0}__onAnchorMouseDown(){let t=this;return function(event){if(1!==event.which)return;let r=$(event.target).parent().attr("data-tchmi-creator-target-control");if(!r)return;if(t.__activeControl=t.__designerModeManager.metaDataManager.getControlMetaData(r),null===t.__activeControl)return;const o=$(event.target).attr("data-tchmi-creator-anchor-name");t.__designerModeManager.interactionManager.setAnchorName(o),o&&(t.__designerModeManager.interactionManager.handleInteractionStart(event,t.__activeControl),t.__lockControlResize=!1,e.System.SharedResources.jqDocument.on(t.__anchorMouseMoveNs,t.__onAnchorMouseMove()),e.System.SharedResources.jqDocument.on(t.__anchorMouseUpNs,t.__onAnchorMouseUp()))}}__onAnchorMouseMove(){let t=this;return function(event){if(null===t.__activeControl)return;if(!0===t.__designerModeManager.rectSelectManager.getRectSelecting())return;if(!0===t.__lockControlResize)return;const r=t.__designerModeManager.interactionManager.getAnchorName();if(!r)return;if(1!==event.which)return e.System.SharedResources.jqDocument.off(t.__anchorMouseMoveNs),e.System.SharedResources.jqDocument.off(t.__anchorMouseUpNs),t.__controlResizing=!1,void t.__designerModeManager.rectSelectManager.resetState();let o=t.__activeControl;do{if(!0===o.locked)return;o=o.parent}while(o);t.__controlResizing=!0,t.__designerModeManager.rectSelectManager.lockRectSelect();const i=t.__designerModeManager.interactionManager.getStartMousePos(),n=t.__designerModeManager.interactionManager.getPositionInsideControl(),s=event.pageX-i.left;let l=event.pageY-i.top;!0===event.shiftKey&&0!==n.width&&("TopLeft"===r||"BottomRight"===r?l=s*(n.height/n.width):"TopRight"!==r&&"BottomLeft"!==r||(l=-s*(n.height/n.width)));const c=t.__designerModeManager.rootControlManager.getCreatorZoomFactor(),d=t.__designerModeManager.metaDataManager.getSelectedControlsMetaData(),_=t.__designerModeManager.interactionManager.handleSnapping(t.__activeControl,{left:s/c,top:l/c},{left:event.pageX,top:event.pageY},!event.altKey);for(var id in d){const o=d[id];t.__processResize(o,_,r),o.isPartialRoot&&t.__designerModeManager.rootControlManager.setCreatorViewPortPosition(e.Controls.get(o.id))}}}__processResize(t,r,o){let i=t,n=!1;do{if(!0===i.locked){n=!0;break}i=i.parent}while(i);if(!0===n)return;const s=e.Controls.get(t.id);if(!s)return;let l=Math.sin(-t.absoluteParentRotation*Math.PI/180)*r.left+Math.cos(-t.absoluteParentRotation*Math.PI/180)*r.top,c=Math.cos(t.absoluteParentRotation*Math.PI/180)*r.left+Math.sin(t.absoluteParentRotation*Math.PI/180)*r.top;const d=this.__getResizedRect(t,o,c,l);let _={};if(null!==d.heightValue&&"Parent"!==d.heightMode&&(_.height=d.heightValue+d.heightUnit),null!==d.widthValue&&"Parent"!==d.widthMode&&(_.width=d.widthValue+d.widthUnit),null!==d.leftValue&&(_.left=d.leftValue+d.leftUnit),null!==d.topValue&&(_.top=d.topValue+d.topUnit),null!==d.rightValue&&(_.right=d.rightValue+d.rightUnit),null!==d.bottomValue&&(_.bottom=d.bottomValue+d.bottomUnit),null===d.leftValue&&null===d.rightValue&&(_.left="0"),null===d.topValue&&null===d.bottomValue&&(_.top="0"),e.StyleProvider.setSimpleElementStyle(s.getElement(),_),this.__designerModeManager.metaDataManager.addChangedControlsMetaData(t),s.getParent()&&t.parent&&!0===t.parent.isGridControl){const e=new Set;e.add(s.getParent()),this.__designerModeManager.highlightManager.setContainerPositions(e)}const m=[];if(m.push(e.Controls.get(t.id)),null!==this.__activeControl&&void 0!==e.Controls.get(this.__activeControl.id)){const t=function(e){for(var r=0,o=e.children_hierarchy.length;r<o;r++){const o=e.children_hierarchy[r];m.push(o.ctrl),t(o)}},r=e.System.resolveControlHierarchy(e.Controls.get(this.__activeControl.id),null);t(r),this.__designerModeManager.highlightManager.setContainerPositions(new Set(m))}this.__designerModeManager.metaDataManager.addChangedControlsMetaData(t)}__getResizedRectRotationOffset(e,t,r,o,i,n,s){if(0===i)return{left:0,top:0};null==n&&(n=Math.sin(i)),null==s&&(s=Math.cos(i));let l=-e/2,c=t/2,d=-(e+r)/2,_=(t+o)/2;return{left:_*n+d*s-d-(c*n+l*s-l),top:_*s-d*n-_-(c*s-l*n-c)}}__getResizedRect(e,t,r,o){const i=e.controlAttributeDimension,n=e.relativeControlRotation;let s,l,c;if(e.isPartialRoot){const e=this.__designerModeManager.rootControlManager.getViewPortSimulator();s=e.outerHeight(),l=e.outerWidth(),c=this.__designerModeManager.interactionManager.getPositionInsideControl()}else s=e.jControlPosition.parent().outerHeight(),l=e.jControlPosition.parent().outerWidth(),c={top:0,left:0,width:0,right:0,height:0,bottom:0};this.__designerModeManager.rootControlManager.getCreatorZoomFactor();let d=tchmi_clone_object(i);const _=n*Math.PI/180,m=Math.sin(_),u=Math.cos(_);let offset,g=-m*r+u*o,E=u*r+m*o;switch(t){case"TopLeft":if(offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u),null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue-E>=d.maxWidthValue&&(E=d.widthValue-d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue-E>=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E>=d.maxWidthValue&&(E=e-d.maxWidthValue)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue-E<=d.minWidthValue&&(E=d.widthValue-d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue-E<=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E<=d.minWidthValue&&(E=e-d.minWidthValue)}"%"!==d.widthUnit?d.widthValue-E<=0&&(E=d.widthValue):d.widthValue-100*E/l<=0&&(E=d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=-(offset.left-E):(t+=100*-(offset.left-E)/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=offset.left:(r+=100*offset.left/l,r=l*(r/100)),t+r>=l&&(E=e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}if(null!==d.heightValue){if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue-g>=d.maxHeightValue&&(g=d.heightValue-d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue-g>=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g>=d.maxHeightValue&&(g=e-d.maxHeightValue)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue-g<=d.minHeightValue&&(g=d.heightValue-d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue-g<=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g<=d.minHeightValue&&(g=e-d.minHeightValue)}"%"!==d.heightUnit?d.heightValue-g<=0&&(g=d.heightValue):100*-g/s<=0&&(g=d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=-(-offset.top-g):(t+=100*-(-offset.top-g)/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-offset.top:(r+=100*-offset.top/s,r=s*(r/100)),t+r>=s&&(g=e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=-E:d.widthValue+=100*-E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width-E:d.widthValue=e.controlCssPixelDimension.width/l*100-100*E/l),null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=-g:d.heightValue+=100*-g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height-g:d.heightValue=e.controlCssPixelDimension.height/s*100-100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-(offset.left-E):d.leftValue+=100*-(offset.left-E)/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=-(-offset.top-g):d.topValue+=100*-(-offset.top-g)/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=offset.left:d.rightValue+=100*offset.left/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-offset.top:d.bottomValue+=100*-offset.top/s);break;case"TopCenter":if(offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u),null!==d.heightValue){if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue-g>=d.maxHeightValue&&(g=d.heightValue-d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue-g>=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g>=d.maxHeightValue&&(g=e-d.maxHeightValue)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue-g<=d.minHeightValue&&(g=d.heightValue-d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue-g<=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g<=d.minHeightValue&&(g=e-d.minHeightValue)}"%"!==d.heightUnit?d.heightValue-g<=0&&(g=d.heightValue):100*-g/s<=0&&(g=d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u)}else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=-offset.top+u*g:(t+=100*(-offset.top+u*g)/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-offset.top:(r+=100*-offset.top/s,r=s*(r/100)),t+r>=s&&(g=e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u))}null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=-g:d.heightValue+=100*-g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height-g:d.heightValue=e.controlCssPixelDimension.height/s*100-100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-(-offset.left+m*g):d.leftValue+=100*-(-offset.left+m*g)/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=-offset.top+u*g:d.topValue+=100*(-offset.top+u*g)/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=offset.left:d.rightValue+=100*offset.left/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-offset.top:d.bottomValue+=100*-offset.top/s);break;case"TopRight":if(offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u),null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue+E>=d.maxWidthValue&&(E=d.maxWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue+E>=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E>=d.maxWidthValue&&(E=d.maxWidthValue-e)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue+E<=d.minWidthValue&&(E=d.minWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue+E<=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E<=d.minWidthValue&&(E=d.minWidthValue-e)}"%"!==d.widthUnit?d.widthValue+E<=0&&(E=-d.widthValue):d.widthValue+100*E/l<=0&&(E=-d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=-offset.left:(t+=100*-offset.left/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=-(-offset.left+E):(r+=100*-(-offset.left+E)/l,r=l*(r/100)),t+r>=l&&(E=-e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}if(null!==d.heightValue){if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue-g>=d.maxHeightValue&&(g=d.heightValue-d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue-g>=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g>=d.maxHeightValue&&(g=e-d.maxHeightValue)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue-g<=d.minHeightValue&&(g=d.heightValue-d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue-g<=e&&(g=d.heightValue-e)}else{let e=d.heightValue/100*s;e-g<=d.minHeightValue&&(g=e-d.minHeightValue)}"%"!==d.heightUnit?d.heightValue-g<=0&&(g=d.heightValue):100*-g/s<=0&&(g=d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=-(-offset.top-g):(t+=100*-(-offset.top-g)/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-offset.top:(r+=100*-offset.top/s,r=s*(r/100)),t+r>=s&&(g=e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=E:d.widthValue+=100*E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width+E:d.widthValue=e.controlCssPixelDimension.width/l*100+100*E/l),null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=-g:d.heightValue+=100*-g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height+g:d.heightValue=e.controlCssPixelDimension.height/s*100+100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-offset.left:d.leftValue+=100*-offset.left/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=-(-offset.top-g):d.topValue+=100*-(-offset.top-g)/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=-(-offset.left+E):d.rightValue+=100*-(-offset.left+E)/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-offset.top:d.bottomValue+=100*-offset.top/s);break;case"CenterLeft":if(offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u),null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue-E>=d.maxWidthValue&&(E=d.widthValue-d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue-E>=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E>=d.maxWidthValue&&(E=e-d.maxWidthValue)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue-E<=d.minWidthValue&&(E=d.widthValue-d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue-E<=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E<=d.minWidthValue&&(E=e-d.minWidthValue)}"%"!==d.widthUnit?d.widthValue-E<=0&&(E=d.widthValue):d.widthValue-100*E/l<=0&&(E=d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=offset.left+u*E:(t+=100*(offset.left+u*E)/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=offset.left:(r+=100*offset.left/l,r=l*(r/100)),t+r>=l&&(E=e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=-E:d.widthValue+=100*-E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width-E:d.widthValue=e.controlCssPixelDimension.width/l*100-100*E/l),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=offset.left+u*E:d.leftValue+=100*(offset.left+u*E)/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=offset.top:d.topValue+=100*offset.top/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=offset.left:d.rightValue+=100*offset.left/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-offset.top:d.bottomValue+=100*-offset.top/s);break;case"CenterRight":if(!0===e.isPartialRoot&&(null!==d.widthValue&&"%"===d.widthUnit&&(d.widthUnit="px",d.widthValue=d.widthValue/100*c.width),null!==d.rightValue&&"%"===d.rightUnit&&(d.rightUnit="px",d.rightValue=d.rightValue/100*l)),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u),null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue+E>=d.maxWidthValue&&(E=d.maxWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue+E>=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E>=d.maxWidthValue&&(E=d.maxWidthValue-e)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue+E<=d.minWidthValue&&(E=d.minWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue+E<=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E<=d.minWidthValue&&(E=d.minWidthValue-e)}"%"!==d.widthUnit?d.widthValue+E<=0&&(E=-d.widthValue):d.widthValue+100*E/l<=0&&(E=-d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=-offset.left:(t+=100*-offset.left/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=-(-offset.left+E):(r+=100*-(-offset.left+E)/l,r=l*(r/100)),t+r>=l&&(E=-e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,0,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=E:d.widthValue+=100*E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width+E:d.widthValue=e.controlCssPixelDimension.width/l*100+100*E/l),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-offset.left:d.leftValue+=100*-offset.left/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=offset.top:d.topValue+=100*offset.top/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=-(-offset.left+E):d.rightValue+=100*-(-offset.left+E)/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-offset.top:d.bottomValue+=100*-offset.top/s);break;case"BottomLeft":if(offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u),null!==d.heightValue){if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue+g>=d.maxHeightValue&&(g=d.maxHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue+g>=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g>=d.maxHeightValue&&(g=d.maxHeightValue-e)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue+g<=d.minHeightValue&&(g=d.minHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue+g<=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g<=d.minHeightValue&&(g=d.minHeightValue-e)}"%"!==d.heightUnit?d.heightValue+g<=0&&(g=-d.heightValue):d.heightValue+100*g/s<=0&&(g=-d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=offset.top:(t+=100*offset.top/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-(offset.top+g):(r+=100*-(offset.top+g)/s,r=s*(r/100)),t+r>=s&&(g=-e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}if(null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue-E>=d.maxWidthValue&&(E=d.widthValue-d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue-E>=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E>=d.maxWidthValue&&(E=e-d.maxWidthValue)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue-E<=d.minWidthValue&&(E=d.widthValue-d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue-E<=e&&(E=d.widthValue-e)}else{let e=d.widthValue/100*l;e-E<=d.minWidthValue&&(E=e-d.minWidthValue)}"%"!==d.widthUnit?d.widthValue-E<=0&&(E=d.widthValue):d.widthValue-100*E/l<=0&&(E=d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=-offset.left+E:(t+=100*(-offset.left+E)/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=offset.left:(r+=100*offset.left/l,r=l*(r/100)),t+r>=l&&(E=e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=-E:d.widthValue+=100*-E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width-E:d.widthValue=e.controlCssPixelDimension.width/l*100-100*E/l),null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=g:d.heightValue+=100*g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height+g:d.heightValue=e.controlCssPixelDimension.height/s*100+100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-offset.left+E:d.leftValue+=100*(-offset.left+E)/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=offset.top:d.topValue+=100*offset.top/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=offset.left:d.rightValue+=100*offset.left/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-(offset.top+g):d.bottomValue+=100*-(offset.top+g)/s);break;case"BottomCenter":if(!0===e.isPartialRoot&&(null!==d.heightValue&&"%"===d.heightUnit&&(d.heightUnit="px",d.heightValue=d.heightValue/100*c.height),null!==d.bottomValue&&"px"===d.bottomUnit&&(d.bottomUnit="px",d.bottomValue=d.bottomValue/100*s)),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u),null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue+g>=d.maxHeightValue&&(g=d.maxHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue+g>=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g>=d.maxHeightValue&&(g=d.maxHeightValue-e)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue+g<=d.minHeightValue&&(g=d.minHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue+g<=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g<=d.minHeightValue&&(g=d.minHeightValue-e)}if(null!==d.heightValue)"%"!==d.heightUnit?d.heightValue+g<=0&&(g=-d.heightValue):d.heightValue+100*g/s<=0&&(g=-d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u);else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=offset.top:(t+=100*offset.top/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-(g+offset.top):(r+=100*-(g+offset.top)/s,r=s*(r/100)),t+r>=s&&(g=-e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,0,g,_,m,u))}null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=g:d.heightValue+=100*g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height+g:d.heightValue=e.controlCssPixelDimension.height/s*100+100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-offset.left:d.leftValue+=100*-offset.left/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=offset.top:d.topValue+=100*offset.top/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=offset.left:d.rightValue+=100*offset.left/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-(g+offset.top):d.bottomValue+=100*-(g+offset.top)/s);break;case"BottomRight":if(!0===e.isPartialRoot&&(null!==d.heightValue&&"%"===d.heightUnit&&(d.heightUnit="px",d.heightValue=d.heightValue/100*c.height),null!==d.widthValue&&"%"===d.widthUnit&&(d.widthUnit="px",d.widthValue=d.widthValue/100*c.width),null!==d.bottomValue&&"%"===d.bottomUnit&&(d.bottomUnit="px",d.bottomValue=d.bottomValue/100*s),null!==d.rightValue&&"%"===d.rightUnit&&(d.rightUnit="px",d.rightValue=d.rightValue/100*l)),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u),null!==d.heightValue){if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue>d.maxHeightValue&&(d.heightValue=d.maxHeightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue>e&&(d.heightValue=e)}else{d.heightValue/100*s>d.maxHeightValue&&(d.heightValue=d.maxHeightValue/s*100)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue<d.minHeightValue&&(d.heightValue=d.minHeightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue<e&&(d.heightValue=e)}else{d.heightValue/100*s<d.minHeightValue&&(d.heightValue=d.minHeightValue/s*100)}if(null!==d.maxHeightValue)if(d.heightUnit===d.maxHeightUnit)d.heightValue+g>=d.maxHeightValue&&(g=d.maxHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.maxHeightValue/100*s;d.heightValue+g>=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g>=d.maxHeightValue&&(g=d.maxHeightValue-e)}if(null!==d.minHeightValue)if(d.heightUnit===d.minHeightUnit)d.heightValue+g<=d.minHeightValue&&(g=d.minHeightValue-d.heightValue);else if("%"!==d.heightUnit){let e=d.minHeightValue/100*s;d.heightValue+g<=e&&(g=e-d.heightValue)}else{let e=d.heightValue/100*s;e+g<=d.minHeightValue&&(g=d.minHeightValue-e)}"%"!==d.heightUnit?d.heightValue+g<=0&&(g=-d.heightValue):d.heightValue+100*g/s<=0&&(g=-d.heightValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.heightValue&&null!==d.topValue&&null!==d.bottomValue){let t=d.topValue;"%"!==d.topUnit?t+=offset.top:(t+=100*offset.top/s,t=s*(t/100));let r=d.bottomValue;"%"!==d.bottomUnit?r+=-(offset.top+g):(r+=100*-(offset.top+g)/s,r=s*(r/100)),t+r>=s&&(g=-e.controlCssPixelDimension.height,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}if(null!==d.widthValue){if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue>d.maxWidthValue&&(d.widthValue=d.maxWidthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue>e&&(d.widthValue=e)}else{d.widthValue/100*l>d.maxWidthValue&&(d.widthValue=d.maxWidthValue/l*100)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue<d.minWidthValue&&(d.widthValue=d.minWidthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue<e&&(d.widthValue=e)}else{d.widthValue/100*l<d.minWidthValue&&(d.widthValue=d.minWidthValue/l*100)}if(null!==d.maxWidthValue)if(d.widthUnit===d.maxWidthUnit)d.widthValue+E>=d.maxWidthValue&&(E=d.maxWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.maxWidthValue/100*l;d.widthValue+E>=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E>=d.maxWidthValue&&(E=d.maxWidthValue-e)}if(null!==d.minWidthValue)if(d.widthUnit===d.minWidthUnit)d.widthValue+E<=d.minWidthValue&&(E=d.minWidthValue-d.widthValue);else if("%"!==d.widthUnit){let e=d.minWidthValue/100*l;d.widthValue+E<=e&&(E=e-d.widthValue)}else{let e=d.widthValue/100*l;e+E<=d.minWidthValue&&(E=d.minWidthValue-e)}"%"!==d.widthUnit?d.widthValue+E<=0&&(E=-d.widthValue):d.widthValue+100*E/l<=0&&(E=-d.widthValue),offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u)}else if(null===d.widthValue&&null!==d.leftValue&&null!==d.rightValue){let t=d.leftValue;"%"!==d.leftUnit?t+=-offset.left:(t+=100*-offset.left/l,t=l*(t/100));let r=d.rightValue;"%"!==d.rightUnit?r+=-(-offset.left+E):(r+=100*-(-offset.left+E)/l,r=l*(r/100)),t+r>=l&&(E=-e.controlCssPixelDimension.width,offset=this.__getResizedRectRotationOffset(d.widthValue,d.heightValue,E,g,_,m,u))}null!==d.widthValue?"%"!==d.widthUnit?d.widthValue+=E:d.widthValue+=100*E/l:(null===d.leftValue&&null!==d.rightValue||null!==d.leftValue&&null===d.rightValue)&&("%"!==d.widthUnit?d.widthValue=e.controlCssPixelDimension.width+E:d.widthValue=e.controlCssPixelDimension.width/l*100+100*E/l),null!==d.heightValue?"%"!==d.heightUnit?d.heightValue+=g:d.heightValue+=100*g/s:(null===d.topValue&&null!==d.bottomValue||null!==d.topValue&&null===d.bottomValue)&&("%"!==d.heightUnit?d.heightValue=e.controlCssPixelDimension.height+g:d.heightValue=e.controlCssPixelDimension.height/s*100+100*g/s),null!==d.leftValue&&("%"!==d.leftUnit?d.leftValue+=-offset.left:d.leftValue+=100*-offset.left/l),null!==d.topValue&&("%"!==d.topUnit?d.topValue+=offset.top:d.topValue+=100*offset.top/s),null!==d.rightValue&&("%"!==d.rightUnit?d.rightValue+=-(-offset.left+E):d.rightValue+=100*-(-offset.left+E)/l),null!==d.bottomValue&&("%"!==d.bottomUnit?d.bottomValue+=-(offset.top+g):d.bottomValue+=100*-(offset.top+g)/s)}return d}__onAnchorMouseUp(){let t=this;return function(event){1===event.which&&(e.System.SharedResources.jqDocument.off(t.__anchorMouseMoveNs),e.System.SharedResources.jqDocument.off(t.__anchorMouseUpNs),null!==t.__activeControl&&(t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snaptop-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapleft-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapbottom-remote"),t.__activeControl.jOriginalPosition[0].classList.remove("tchmi-creator-control-snapright-remote"),!0!==t.__lockControlResize&&(t.__controlResizing=!1,t.__designerModeManager.rectSelectManager.lockRectSelect(),t.__designerModeManager.syncManager.updatePcElementAndSync("System.onControlSizeParameterChanged"),t.__designerModeManager.resyncControls())))}}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){e.DesignerModeMasterInteractionManager=class{constructor(e){this.__verPositionCache={},this.__horPositionCache={},this.__anchorName=void 0,this.__onDocumentelementClick=event=>{event.target!==document.documentElement&&event.target!==document.body||this.__designerModeManager.unselectEach(!1)},this.__designerModeManager=e,document.documentElement.addEventListener("click",this.__onDocumentelementClick),this.__modifierKeyPressed={ctrl:!1,shift:!1},this.__startMousePosition={left:0,top:0},this.__startMousePositionCopyMoveOffsetPosition={left:0,top:0},this.__positionInsideControl={top:0,left:0,right:0,bottom:0,height:0,width:0}}getAnchorName(){return this.__anchorName}setAnchorName(e){this.__anchorName=e}getStartMousePos(){return this.__startMousePosition}getStartMousePosCopyMoveOffsetPosition(){return this.__startMousePositionCopyMoveOffsetPosition}getPositionInsideControl(){return this.__positionInsideControl}setCtrlModifierKeyState(e){this.__modifierKeyPressed.ctrl=e}setShiftModifierKeyState(e){this.__modifierKeyPressed.shift=e}clearControlSnapPositionCache(){this.__horPositionCache={},this.__verPositionCache={}}handleInteractionStart(event,e){if(this.__startMousePosition.left=event.pageX,this.__startMousePosition.top=event.pageY,this.__startMousePositionCopyMoveOffsetPosition.left=0,this.__startMousePositionCopyMoveOffsetPosition.top=0,e&&e.jOriginalPosition){const t=e.jOriginalPosition[0].getBoundingClientRect();this.__positionInsideControl.top=event.pageY-t.top-window.scrollY,this.__positionInsideControl.left=event.pageX-t.left-window.scrollX,this.__positionInsideControl.right=t.right+window.scrollX-event.pageX,this.__positionInsideControl.bottom=t.bottom+window.scrollY-event.pageY,this.__positionInsideControl.height=t.height,this.__positionInsideControl.width=t.width}}handleInteractionStartCopyMoveOffsetPosition(event){this.__startMousePositionCopyMoveOffsetPosition.left=event.pageX,this.__startMousePositionCopyMoveOffsetPosition.top=event.pageY}refreshControlSnapPositionCache(e){if(this.__designerModeManager.getSettings().enableSnapping)if(e){if(0===e.absoluteParentRotation&&(this.__addPositionCacheEntry(e.jOriginalPosition[0],e.id,e.isContainerControl),!0===e.isGridControl)){let t=e.jControlPosition.children(".tchmi-creator-gridcell");for(let r=0,o=t.length;r<o;r++)this.__addPositionCacheEntry(t[r],e.id,!0)}}else{const e=this.__designerModeManager.metaDataManager.getControlMetaData();for(let id in e)this.refreshControlSnapPositionCache(e[id])}}__addSnapPosition(e,t,r){e[r]?e[r].push(t):e[r]=[t]}__addPositionCacheEntry(e,name,t){let r=this.__designerModeManager.getSettings(),o=r.snapDistanceToControls,i=r.snapDistanceToControls;const n=e.getBoundingClientRect(),s=Math.round(n.left+window.scrollX),l=Math.round(n.top+window.scrollY),c=Math.round(n.right+window.scrollX),d=Math.round(n.bottom+window.scrollY);r.snapToControls&&(this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!1},l),this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!0},l-o)),t&&r.snapToInnerContainerSides&&this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!0},l+i),r.snapToControls&&(this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!1},d),this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!0},d+o)),t&&r.snapToInnerContainerSides&&this.__addSnapPosition(this.__verPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!0},d-i),r.snapToControls&&(this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!1},s),this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!0},s-o)),t&&r.snapToInnerContainerSides&&this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!0},s+i),r.snapToControls&&(this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!1},c),this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!1,remoteMatch:!0},c+o)),t&&r.snapToInnerContainerSides&&this.__addSnapPosition(this.__horPositionCache,{name:name,controlTopOrLeft:!0,remoteMatch:!0},c-i)}handleSnapping(e,t,r,o){let i=0,n=0;const s=this.__designerModeManager.rootControlManager.getCreatorZoomFactor();let l=!1,c=!1,d=!1,_=!1,m=!1,u=!1,g=!1,E=!1;if(o&&0===e.absoluteParentRotation){const e=this.__designerModeManager.metaDataManager.getSelectedControlIdsWithChildren();let t,o,s=!0,h=!0,S=!0,p=!0;switch(this.__anchorName){case"TopLeft":h=!1,p=!1;break;case"TopCenter":h=!1,S=!1,p=!1;break;case"TopRight":h=!1,S=!1;break;case"CenterRight":s=!1,h=!1,S=!1;break;case"CenterLeft":s=!1,h=!1,p=!1;break;case"BottomLeft":s=!1,p=!1;break;case"BottomCenter":s=!1,S=!1,p=!1;break;case"BottomRight":s=!1,S=!1}if(!0===s||!0===h)for(t in this.__verPositionCache){let i=this.__verPositionCache[t];if(o=parseInt(t,10),!isNaN(o))if(!0===s&&o-5<r.top-this.__positionInsideControl.top&&r.top-this.__positionInsideControl.top<o+5){for(let t of i)if(-1===e.indexOf(t.name)&&(!0!==t.remoteMatch||!0!==t.controlTopOrLeft)){!1===l&&!1===c?(n=o-(r.top-this.__positionInsideControl.top),l=!0,m=t.remoteMatch):o-n==r.top-this.__positionInsideControl.top&&(l=!0,m=t.remoteMatch);break}}else if(!0===h&&o-5<r.top-this.__positionInsideControl.top+this.__positionInsideControl.height&&r.top-this.__positionInsideControl.top+this.__positionInsideControl.height<o+5)for(let t of i)if(-1===e.indexOf(t.name)&&(!0!==t.remoteMatch||!1!==t.controlTopOrLeft)){!1===l&&!1===c?(n=o-(r.top-this.__positionInsideControl.top+this.__positionInsideControl.height),c=!0,u=t.remoteMatch):o-n===r.top-this.__positionInsideControl.top+this.__positionInsideControl.height&&(c=!0,u=t.remoteMatch);break}if(!0===l&&!0===c)break}if(!0===S||!0===p)for(t in this.__horPositionCache){let n=this.__horPositionCache[t];if(o=parseInt(t,10),!isNaN(o))if(!0===S&&o-5<r.left-this.__positionInsideControl.left&&r.left-this.__positionInsideControl.left<o+5){for(let t of n)if(-1===e.indexOf(t.name)&&(!0!==t.remoteMatch||!0!==t.controlTopOrLeft)){!1===d&&!1===_?(i=o-(r.left-this.__positionInsideControl.left),d=!0,g=t.remoteMatch):o-i==r.left-this.__positionInsideControl.left&&(d=!0,g=t.remoteMatch);break}}else if(!0===p&&o-5<r.left-this.__positionInsideControl.left+this.__positionInsideControl.width&&r.left-this.__positionInsideControl.left+this.__positionInsideControl.width<o+5)for(let t of n)if(-1===e.indexOf(t.name)&&(!0!==t.remoteMatch||!1!==t.controlTopOrLeft)){!1===d&&!1===_?(i=o-(r.left-this.__positionInsideControl.left+this.__positionInsideControl.width),_=!0,E=t.remoteMatch):o-i===r.left-this.__positionInsideControl.left+this.__positionInsideControl.width&&(_=!0,E=t.remoteMatch);break}if(!0===d&&_)break}}return e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snaptop",l),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapbottom",c),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapleft",d),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapright",_),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snaptop-remote",m),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapbottom-remote",u),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapleft-remote",g),e.jOriginalPosition[0].classList.toggle("tchmi-creator-control-snapright-remote",E),{left:t.left+i/s,top:t.top+n/s}}}}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModeResourceInjectionManager=class{constructor(e){this.__designerModeManager=e}injectPackageResources(t,callback){let r,o,i=this,n=0,s=new Map,l={map:new Map,urlByName:new Map,array:[]},c={map:new Map,array:[]},d=new Map,_=new Map,m=function(){n>0||(n=0,r&&(r(),r=null),o&&(o(),o=null),e.System.Services.typeManager.doForceSchemaDefinitions(data=>{e.System.Services.controlManager.resolveDescriptionInheritation(),e.System.Services.themeManager.processActiveTheme(),e.Callback.callSafe(callback,i,{error:e.Errors.NONE})}))},u=function(){n>0||(n=0,l.array.forEach((function(t,r){!function(t){if(!t.description.template)return;let url=tchmi_path(t.package.basePath+"/"+t.manifestData.basePath+"/"+t.description.template),r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(t){n--,200===r.status?(e.System.Data.Caches.templateMarkupCache.set(url,this.responseText),m()):m()})),r.addEventListener("error",(function(e){n--,m()})),n++,r.send()}(t)})),m())},g=function(){if(n>0)return;n=0;let t=[],i=[];s.forEach((e,name)=>{i.push(e)}),i.sort((a,b)=>{if(a&&a.manifest&&a.manifest.modules)for(let e=0,t=a.manifest.modules.length;e<t;e++){let t=a.manifest.modules[e];if((!t||"Package"===t.type)&&t.nugetId===b.name)return-1}if(b&&b.manifest&&b.manifest.modules)for(let e=0,t=b.manifest.modules.length;e<t;e++){let t=b.manifest.modules[e];if((!t||"Package"===t.type)&&t.nugetId===a.name)return 1}return 0});for(let r=0,o=i.length;r<o;r++){let o=i[r];if(!o)continue;let n=o.manifest;if(!n)continue;let s=n.modules;if(s)for(let r=0,i=s.length;r<i;r++){let i=s[r];if("Control"===i.type){let r=tchmi_path(o.basePath+"/"+i.basePath+"/"+i.descriptionFile),n=d.get(r);if(!n)continue;let s={error:e.Errors.NONE,manifestData:i,package:o,description:n,descriptionExpanded:tchmi_clone_object(n)};s.descriptionExpanded.inheritationResolved=!1;let name=n.name;if(l.array.push(s),1===s.package.manifest.apiVersion){let t=e.System.resolveQualifiedName(n.name,n.namespace);l.map.has(name)?(l.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}),l.urlByName.delete(name)):(l.map.set(name,s),l.urlByName.set(name,r)),l.map.has(t)?(l.map.set(t,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}),l.urlByName.delete(t)):(l.map.set(t,s),l.urlByName.set(t,r))}else l.map.has(name)?(l.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}),l.urlByName.delete(name)):(l.map.set(name,s),l.urlByName.set(name,r));e.System.Services.themeManager.registerControlThemeFiles(n);for(let e=0,r=n.dependencyFiles.length;e<r;e++){let r=n.dependencyFiles[e];if(r&&(r.type&&"JAVASCRIPT"===r.type.toUpperCase())){let e=tchmi_path(o.basePath+"/"+i.basePath+"/"+r.name);if(t.indexOf(e)>-1)continue;t.push(e)}}}else if("Function"===i.type){let r=tchmi_path(o.basePath+"/"+i.basePath+"/"+i.descriptionFile),n=_.get(r);if(!n)continue;let s={error:e.Errors.NONE,manifestData:i,package:o,description:n};c.array.push(s),c.map.set(n.function.name,s);let name=n.function.name;if(1===s.package.manifest.apiVersion){let t=e.System.resolveQualifiedName(n.function.name,"Namespace");c.map.has(name)?c.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):c.map.set(name,s),c.map.has(t)?c.map.set(t,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):c.map.set(t,s)}else c.map.has(name)?c.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):c.map.set(name,s);for(let e=0,r=n.dependencyFiles.length;e<r;e++){let r=n.dependencyFiles[e];if(r&&(r.type&&"JAVASCRIPT"===r.type.toUpperCase())){let e=tchmi_path(o.basePath+"/"+i.basePath+"/"+r.name);if(t.indexOf(e)>-1)continue;t.push(e)}}}else if("Resource"===i.type&&".js"===i.path.substr(i.path.length-3,3).toLowerCase()){let e=tchmi_path(o.basePath+"/"+i.path);if(t.indexOf(e)>-1)continue;t.push(e)}}}let m=document.createDocumentFragment();r=e.EventProvider.register("System.onControlRegistered",(function(t,data){let name=data.name,r=e.System.resolveQualifiedName(data.name,data.namespace),o=l.map.get(name);if(1===o.package.manifest.apiVersion){let t=l.map.get(r);if(e.System.Data.Modules.controls.array.push(o),o&&o.error===e.Errors.NONE)if(o.reg=data,e.System.Data.Modules.controls.map.has(name)){e.System.Data.Modules.controls.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}});let url=l.urlByName.get(name);url&&e.System.Data.Modules.controls.urlMap.delete(url)}else{e.System.Data.Modules.controls.map.set(name,o);let url=l.urlByName.get(name);url&&e.System.Data.Modules.controls.urlMap.set(url,o)}else e.System.Data.Modules.controls.map.set(name,{error:o.error});if(t&&t.error===e.Errors.NONE)if(t.reg=data,e.System.Data.Modules.controls.map.has(r)){e.System.Data.Modules.controls.map.set(r,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}});let url=l.urlByName.get(r);url&&e.System.Data.Modules.controls.urlMap.delete(url)}else{e.System.Data.Modules.controls.map.set(r,t);let url=l.urlByName.get(r);url&&e.System.Data.Modules.controls.urlMap.set(url,t)}else e.System.Data.Modules.controls.map.set(name,{error:t.error})}else if(o&&o.error===e.Errors.NONE){if(o.reg=data,o.reg.directory&&o.reg.template){let e=tchmi_path(o.reg.template),t=tchmi_path(o.reg.directory);if(e.indexOf(t)>=-1){let r=tchmi_path(e.replace(t,""));o.description.template=r,o.descriptionExpanded.template=r}}e.System.Data.Modules.controls.map.has(name)?e.System.Data.Modules.controls.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.controls.map.set(name,o)}else e.System.Data.Modules.controls.map.set(name,{error:o.error})})),o=e.EventProvider.register("System.onFunctionRegistered",(function(t,data){let name=data.name,r=e.System.resolveQualifiedName(data.name,data.namespace),o=c.map.get(name);if(e.System.Data.Modules.functions.array.push(o),1===o.package.manifest.apiVersion){let t=c.map.get(r);o&&o.error===e.Errors.NONE?(o.reg=data,e.System.Data.Modules.functions.map.has(name)?e.System.Data.Modules.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.functions.map.set(name,o)):e.System.Data.Modules.functions.map.set(name,{error:o.error}),t&&t.error===e.Errors.NONE?e.System.Data.Modules.functions.map.has(r)?e.System.Data.Modules.functions.map.set(r,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.functions.map.set(r,t):e.System.Data.Modules.functions.map.set(name,{error:t.error})}else o&&o.error===e.Errors.NONE?(o.reg=data,e.System.Data.Modules.functions.map.has(name)?e.System.Data.Modules.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE]}}):e.System.Data.Modules.functions.map.set(name,o)):e.System.Data.Modules.functions.map.set(name,{error:o.error})}));for(let e=0,r=t.length;e<r;e++){!function(e){n++;let t=document.createElement("script");t.src=e,t.async=!1,t.onload=function(e){n--,u()},t.onerror=function(e){n--,u()},m.appendChild(t)}(t[e])}document.head.appendChild(m),u()},E=function(){n>0||(n=0,s.forEach((e,name)=>{let t=e.manifest;if(t){let r=t.modules;if(r)for(let t=0,o=r.length;t<o;t++){let o=r[t];o&&("Control"===o.type?function(e,t){let url=tchmi_path(e.basePath+"/"+t.basePath+"/"+t.descriptionFile),r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(e){if(n--,200===r.status){try{d.set(url,JSON.parse(this.responseText))}catch(e){}g()}else g()})),r.addEventListener("error",(function(e){n--,g()})),n++,r.send()}(e,o):"Function"===o.type&&function(e,t){let url=tchmi_path(e.basePath+"/"+t.basePath+"/"+t.descriptionFile),r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(e){if(n--,200===r.status){try{_.set(url,JSON.parse(this.responseText))}catch(e){}g()}else g()})),r.addEventListener("error",(function(e){n--,g()})),n++,r.send()}(e,o))}}}),g())};for(let r=0,o=t.length;r<o;r++){let o=t[r];e.System.Data.packages.has(o.name)||function(t){let url=tchmi_path(t.basePath+"/Manifest.json"),r=new XMLHttpRequest;r.open("GET",url+"?preventcache="+Math.random()),r.addEventListener("load",(function(o){if(n--,200!==r.status)return void E();let i;try{i=JSON.parse(this.responseText)}catch(e){}if(!i)return void E();let l={name:t.name,basePath:t.basePath,manifest:i};s.set(l.name,l),e.System.Data.packages.set(l.name,l),E()})),r.addEventListener("error",(function(e){n--,E()})),n++,r.send()}(o),E()}}injectProjectResources(){}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){let r;!function(t){t.DesignerModePartialContentManager=class{constructor(e){this.__requests=new Map,this.__requestIdCount=0,this.__designerModeManager=e}requestCurrentPartialContent(r,callback){let requestId=0,o=0;do{if(requestId=0,o++,o>=1e6){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModePartialContentManager] Reached maxium of parallel requests."),requestId=null;break}this.__requestIdCount++,this.__requestIdCount>=1e6&&(this.__requestIdCount=1),requestId=this.__requestIdCount}while(this.__requests.has(requestId));if(null===requestId)return()=>{};let i=null;try{i=JSON.stringify({requestId:requestId,requestInstance:TCHMI_DYNAMIC_INSTANCE_ID})}catch(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.Engineering.DesignerModePartialContentManager] Unexpected exception="+t+".")}let n={callback:callback,timeoutTimer:setTimeout(()=>{this.__requests.delete(requestId),e.Callback.callSafe(callback,null,{error:e.Errors.E_TIMEOUT,details:{code:e.Errors.E_TIMEOUT,message:e.Errors[e.Errors.E_TIMEOUT],domain:"TcHmi.System.Engineering.DesignerModePartialContentManager"}})},6e4)},s=()=>{this.__requests.delete(requestId),n&&(clearTimeout(n.timeoutTimer),n.timeoutTimer=null,n.callback=null,n=null)};return n.destroy=s,this.__requests.set(requestId,n),new t.SyncCmdToCreatorRequestCurrentPartialContent({name:"RequestCurrentPartialContent",targetPartial:r,piggyBack:i,replyTo:TCHMI_DYNAMIC_INSTANCE_ID}).send(),s}getRequest(requestId){let request=this.__requests.get(requestId);return request&&this.__requests.delete(requestId),request}}}(r=t.Engineering||(t.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(e){let t;!function(e){e.DesignerModeUserControlParameterManager=class{constructor(e){this.__params=new Map,this.__designerModeManager=e,this.__params=new Map}add(name,e){this.__params.set(name,e)}remove(name){this.__params.delete(name)}get(name){if(name){let e=this.__params.get(name);if(e)return e}return null}}}(t=e.Engineering||(e.Engineering={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.LocalizationManager=class{constructor(){this.__entries={},this.__locale=void 0,this.__localeFileRequested="",this.__callbackMap=new Map}getLocale(){return this.__locale}loadLocale(locale,callback){locale||e.Callback.callSafe(callback,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Missing locale.",domain:"TcHmi.System.LocalizationManager"}}),e.System.Services.serverManager.request({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"SetLocale",writeValue:locale}]},e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{if(callback){let e=this.__callbackMap.get(locale);e||(e=[],this.__callbackMap.set(locale,e)),e.push(callback)}}}))}processLocalizationData(data,t=!1){if(void 0===data.locale||null===data.locale)return e.Errors.E_PARAMETER_INVALID;const r=data.localizedText;if(null==r)return e.Errors.E_PARAMETER_INVALID;let o=[];for(let e in r){let t=this.__entries[e];t?tchmi_equal(t.text,r[e])||(t.text=r[e],o.push(t)):(t={text:r[e],callbacks:[]},this.__entries[e]=t)}for(let t=0,r=o.length;t<r;t++){let r=o[t],i=[];for(let e=0,t=r.callbacks.length;e<t;e++)i[e]=r.callbacks[e];for(let t of i)-1!==r.callbacks.indexOf(t)&&e.Callback.callSafe(t.callback,this,{error:e.Errors.NONE,value:r.text,destroy:t.destroy})}return document.documentElement.lang=data.locale,this.__locale=data.locale,t||e.EventProvider.raise("onLocaleChanged",data.locale),e.Errors.NONE}__loadLocale(t,callback=null){let r=this.__callbackMap.get(t);r||(r=[]),r.push(callback),r.push(()=>{this.__callbackMap.delete(t)});const o=e.System.config.languages;if(!o||0===Object.keys(o).length)return void e.System.Callback.callSafeCallbacks1Param(r,null,{error:e.Errors.NONE});const i=function(e){if(!e)return;let t=o[e];if(!t){const t=e.toLowerCase().split("-");for(let e of Object.keys(o))if(e.toLowerCase().split("-")[0]===t[0])return tchmi_path(o[e])}return tchmi_path(t)};let n=i(t);if(!n){let e;e=navigator.languages?navigator.languages:navigator.browserLanguage?[navigator.browserLanguage]:[];for(let t=0;t<e.length&&(n=i(e[t]),!n);t++);}if(!n)return this.__locale=void 0,void e.System.Callback.callSafeCallbacks1Param(r,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Can't find localization file for locale '"+t+"'.",domain:"TcHmi.System.LocalizationManager"}});if(this.__localeFileRequested===n)return void e.System.Callback.callSafeCallbacks1Param(r,null,{error:e.Errors.NONE});this.__localeFileRequested=n;let s=new XMLHttpRequest;s.open("GET",n+(TCHMI_ENGINEERING?"?preventcache="+Math.random():""));let error=t=>{e.System.Callback.callSafeCallbacks1Param(r,null,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Failed to load: '"+n+"'. Details: '"+s.statusText+"'.",domain:"TcHmi.System.LocalizationManager"}})};s.addEventListener("load",o=>{if(200!==s.status)return void error(o);let data=e.ValueConverter.toObject(s.responseText);const i=this.processLocalizationData(data);i===e.Errors.NONE?e.System.Callback.callSafeCallbacks1Param(r,null,{error:e.Errors.NONE}):e.System.Callback.callSafeCallbacks1Param(r,null,{error:i,details:{code:i,message:e.Errors[i],reason:"Parsing localization file for locale: '"+t+"' failed.",domain:"TcHmi.System.LocalizationManager"}})}),s.addEventListener("error",error),s.send()}get(name){return this.__entries[name]}watch(name,callback){let t=this.__entries[name];if(!t){let t;return t=this.__locale?"Localization key: '"+name+"' does not exist for locale: '"+this.__locale+"'.":"Localization key: '"+name+"' does not exist because no locale is defined.",e.Callback.callSafe(callback,this,{error:e.Errors.E_SYMBOL_UNKNOWN,details:{code:e.Errors.E_SYMBOL_UNKNOWN,message:e.Errors[e.Errors.E_SYMBOL_UNKNOWN],reason:t,domain:"TcHmi.System.LocalizationManager"}}),function(){}}let r=function(){let e=t.callbacks.indexOf(o);-1!==e&&(t.callbacks.splice(e,1),o.callback=null)},o={callback:callback,destroy:r};return t.callbacks.push(o),e.Callback.callSafe(callback,this,{error:e.Errors.NONE,value:t.text,destroy:r}),r}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){class r{constructor(){this.__isInitialized=!1,this.__unloaded=!1,this.__lastConnectState=0,this.__cyclicReconnect=!1,this.__watchSymbolCache=new Map,this.__requestCache=new Map,this.__requestQueue=[],this.__requestPending=null,this.__requestIdCount=0,this.__conWatcherIntervalId=0,this.__firstAccessReject=null,this.__firstAccessRejectTimeoutId=0,this.__symbolWatcherIntervalId=0,this.__symbolWatcherStartTime=new Date,this.__checkLicenseSubscriptionId=null,this.__serverStateWatcherIntervalId=0,this.__publishInProgress=!1,this.__publishInProgressOld=!1,this.resolveHandleServerState=callback=>{let url=this.__serverProtocol+"//"+this.__serverHost+":"+this.__serverPort+"/Config/ServerState",t=new XMLHttpRequest;t.open("GET",url),t.addEventListener("load",r=>{if(200!==t.status)return void e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR]}});let o;try{o=JSON.parse(t.responseText)}catch(t){return void e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR]}})}o?(this.__publishInProgress=o.publishInProgress,!0===this.__publishInProgress&&!1===this.__publishInProgressOld?(e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Publish in progress...<br />Application will be reloaded if publish has finished.",e.DialogManager.DialogSeverity.Info)):!1===this.__publishInProgress&&!0===this.__publishInProgressOld&&window.location.reload(),this.__publishInProgressOld=this.__publishInProgress,e.Callback.callSafe(callback,this,{error:e.Errors.NONE})):e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR]}})}),t.addEventListener("error",t=>{e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR]}})}),t.send()},this.__onBeforeUnload=t=>{"__TcHmiServerManager"===e.System.Services.dialogManager.getDialogOwner()&&e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!1),this.__unloaded=!0,this.__cyclicReconnect=!1,this.__lastConnectState=4,this.close()},e.EventProvider.register("System.onBeforeUnload",this.__onBeforeUnload);let t=window.location.port;t||(t="https:"===window.location.protocol?"443":"80"),this.setServerAddress(window.location.hostname,t,window.location.protocol)}watchServerState(){this.__serverStateWatcherIntervalId||(this.__serverStateWatcherIntervalId=setInterval(this.resolveHandleServerState,TCHMI_SERVER_STATE_WATCH_INTERVAL))}unwatchServerState(){this.__serverStateWatcherIntervalId&&(clearInterval(this.__serverStateWatcherIntervalId),this.__serverStateWatcherIntervalId=0)}onWsOpen(callback){let t=this;return function(r){if(!t.__websocket)return void e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.System.ServerManager"}});TCHMI_ENGINEERING&&e.Engineering.ErrorPane.remove("E_SERVER_CONNECTION_LOST"),!1===TCHMI_UNITTEST_MODE&&t.watchServerState(),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ServerManager] WebSocket with url="+t.__websocket.url+" opened.");let o=6e4;e.System.config.tcHmiServer&&e.System.config.tcHmiServer.websocketSystemTimeout&&(o=e.System.config.tcHmiServer.websocketSystemTimeout);let i=!0;t.__checkLicenseSubscriptionId=e.Server.subscribeEx([{commandOptions:["SendErrorMessage"],symbol:"Diagnostics::LICENSE"}],1e3,{timeout:o},data=>{let r=1,o={code:e.Errors.NONE};if(data&&data.response&&(data.error===e.Errors.NONE||data.error===e.Errors.E_SERVER_RESPONSE_ERROR)){let error=data.response.error;if(void 0!==error)error.code===e.Server.Error.HMI_E_MISSING_LICENSE_HANDSHAKE||error.code===e.Server.Error.HMI_E_LICENSE_VERIFY||error.code===e.Server.Error.HMI_E_LICENSE_TARGET?(r=6,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_MISSING,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager",'Error: TwinCAT HMI Server license is missing.<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error)):(r=1,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_CHECK_FAILED,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.<br />"+e.DialogManager.buildMessage(error),e.DialogManager.DialogSeverity.Error));else{let commands=data.response.commands;if(null==commands||void 0===commands[0]||null===commands[0])r=1,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.<br />Response is invalid. Missing command array or command array entry.",e.DialogManager.DialogSeverity.Error);else if(void 0!==commands[0].error){let i=commands[0].error;if(i.code===e.Server.Error.HMI_E_MISSING_LICENSE_HANDSHAKE||i.code===e.Server.Error.HMI_E_LICENSE_VERIFY||i.code===e.Server.Error.HMI_E_LICENSE_TARGET)r=6,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_MISSING,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),TCHMI_DESIGNER?e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: TwinCAT HMI Server license is missing.<br/>\nPlease try to close and reopen the designer window.",e.DialogManager.DialogSeverity.Error):e.System.Services.dialogManager.updateText("__TcHmiServerManager",'Error: TwinCAT HMI Server license is missing.<br/>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error);else if(i.code===e.Server.Error.HMI_E_INSUFFICIENT_ACCESS)if(TCHMI_DESIGNER)r=5,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_NO_ACCESS,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.<br />Insufficient access. Please try to close and reopen the designer window.",e.DialogManager.DialogSeverity.Error);else{let i=!1;if(0===t.__lastConnectState&&window.localStorage)try{let e=window.localStorage.getItem("TCHMI_SERVER_RECONNECT_COUNT"),t=0;void 0!==e&&(t=parseInt(e,10)),t++,window.localStorage.setItem("TCHMI_SERVER_RECONNECT_COUNT",t.toString()),t<2&&(i=!0)}catch(e){}if(i)window.location.reload();else{if(window.localStorage)try{window.localStorage.setItem("TCHMI_SERVER_RECONNECT_COUNT","0")}catch(e){}r=5,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_NO_ACCESS,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager",'Error: Failed to check TwinCAT HMI Server license.<br />Insufficient access.<br/>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error)}}else r=2,o.code=e.Errors.E_SERVER_COMMAND_ERROR,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.<br />"+e.DialogManager.buildMessage(i),e.DialogManager.DialogSeverity.Error)}else{let t=commands[0].readValue;if(null==t)r=1,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license. Response is invalid. Missing readValue in command object.",e.DialogManager.DialogSeverity.Error);else switch(t.STATE){case"Engineering":case"Demo":case"OK":r=3,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!1,e.DialogManager.DialogType.Overlay);break;case"Unregistered":case"Pending":case"Error":r=6,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: TwinCAT HMI Server license is missing. License state: '"+t.STATE+"'.",e.DialogManager.DialogSeverity.Error);break;default:r=6,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: TwinCAT HMI Server license is missing. Unknown license state: '"+t.STATE+"'.",e.DialogManager.DialogSeverity.Error)}}}}else if(r=1,o.code=e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_CHECK_FAILED,e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),data.error!==e.Errors.NONE){let t=data.details;t||(t={code:data.error,message:e.Errors[data.error]}),e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.<br />"+e.DialogManager.buildMessage(t),e.DialogManager.DialogSeverity.Error)}else e.System.Services.dialogManager.updateText("__TcHmiServerManager","Error: Failed to check TwinCAT HMI Server license.",e.DialogManager.DialogSeverity.Error);let n={error:o.code,url:t.__websocket?t.__websocket.url:void 0,details:o};if(n.details.message=e.Errors[n.details.code],n.details.domain="TcHmi.System.ServerManager",i&&"function"==typeof callback&&"__TcHmiServerManager"===e.System.Services.dialogManager.getDialogOwner()&&e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!1),3===r){if(t.__isInitialized=!0,t.__cyclicReconnect=!0,window.localStorage)try{window.localStorage.setItem("TCHMI_SERVER_RECONNECT_COUNT","0")}catch(e){}i&&(0!==t.__conWatcherIntervalId&&(window.clearInterval(t.__conWatcherIntervalId),t.__conWatcherIntervalId=0),t.refreshSubscriptions((function(data){e.EventProvider.raise("onWebSocketOpened"),e.Callback.callSafe(callback,null,n),t.__lastConnectState=r,0===t.__symbolWatcherIntervalId&&(t.__symbolWatcherStartTime=new Date,t.__symbolWatcherIntervalId=window.setInterval(t.symbolWatcherTick(),100)),i=!1})))}else if(6===r){if(TCHMI_ENGINEERING){const o=new Date;let s=!1;null===t.__firstAccessReject&&(s=!0),t.__lastConnectState!==r&&(t.__firstAccessReject=o),s&&0===t.__firstAccessRejectTimeoutId?(t.__firstAccessReject=null,t.__firstAccessRejectTimeoutId=setTimeout(()=>{6===t.__lastConnectState&&(i&&(e.Callback.callSafe(callback,null,n),i=!1),t.__firstAccessRejectTimeoutId=0)},5e3)):o.getTime()-t.__firstAccessReject.getTime()>5e3&&(t.__firstAccessReject=null,0!==t.__firstAccessRejectTimeoutId&&(clearTimeout(t.__firstAccessRejectTimeoutId),t.__firstAccessRejectTimeoutId=0),i&&(e.Callback.callSafe(callback,null,n),i=!1),i=!1)}else i&&(e.Callback.callSafe(callback,null,n),i=!1),i=!1;t.__lastConnectState=r}else t.__lastConnectState=r,i&&(e.Callback.callSafe(callback,null,n),i=!1)})}}onWsClose(callback){let t=this;return function(o){let i=!1;t.releaseRequest(t.__checkLicenseSubscriptionId),t.unwatchServerState(),!0===t.__unloaded||(o.code&&1e3!==o.code&&!o.reason?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] WebSocket with url="+this.url+" was closed with code="+o.code+"."):o.code&&1e3!==o.code&&o.reason?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] WebSocket with url="+this.url+" was closed with code="+o.code+" and reason="+o.reason+"."):TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ServerManager] WebSocket with url="+this.url+" was closed.")),3===t.__lastConnectState&&(t.__lastConnectState=0,!1===t.__unloaded&&(i=!0,e.Engineering.ErrorPane.add("E_SERVER_CONNECTION_LOST","Connection to server lost. Reopening connection...",e.Engineering.ErrorPane.MessageType.Error))),t.__watchSymbolCache.forEach((function(r,o){let i=r.callbacks;for(let r=0,o=i.length;r<o;r++){let callback=i[r];e.Callback.callSafe(callback.callback,t,{error:e.Errors.E_WEBSOCKET_CLOSED,details:{code:e.Errors.E_WEBSOCKET_CLOSED,message:e.Errors[e.Errors.E_WEBSOCKET_CLOSED],reason:"The underlying websocket was closed.",domain:"TcHmi.System.ServerManager"}}),callback.dirty=!0}r.reqId=null}));let n=[];t.__requestCache.forEach((function(r,id){let o=r.callbacks;clearTimeout(r.timeoutTimer);for(let r=0,i=o.length;r<i;r++){let callback=o[r];e.Callback.callSafe(callback,t,{error:e.Errors.E_WEBSOCKET_CLOSED,details:{code:e.Errors.E_WEBSOCKET_CLOSED,message:e.Errors[e.Errors.E_WEBSOCKET_CLOSED],reason:"The underlying websocket was closed.",domain:"TcHmi.System.ServerManager"}})}(200!==r.type||200===r.type&&!0===r.managed)&&n.push(r)})),n.forEach((function(e,r,o){t.unregisterRequest(e.id)})),e.EventProvider.raise("onWebSocketClosed"),t.__isInitialized=!1,e.Callback.callSafe(callback,null,{error:e.Errors.E_WEBSOCKET_NOT_READY,url:this.url}),t.__websocket=void 0,t.__unloaded||t.resolveHandleServerState(data=>{i&&!t.__publishInProgress&&(e.System.Services.dialogManager.updateText("__TcHmiServerManager","Connection to server lost. Reopening connection...",e.DialogManager.DialogSeverity.Error),e.System.Services.dialogManager.showDialog("__TcHmiServerManager",!0,e.DialogManager.DialogType.Overlay),!0===t.__cyclicReconnect&&0===t.__conWatcherIntervalId&&(t.__conWatcherIntervalId=window.setInterval(t.conWatcherTick(),r.RECONNECT_INTERVAL))),data.error===e.Errors.NONE&&t.watchServerState()})}}onWsMessage(){let t=this;return function(r){let o=e.ValueConverter.toObject(r.data,null);if(!0===TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.ServerManager] Response from TwinCAT HMI Server:",{response:o}),null==o)return;if(void 0===o.id||null===o.id)return;let request=t.getRequest(o.id);request&&(0!==request.timeoutTimer&&(clearTimeout(request.timeoutTimer),request.timeoutTimer=0),e.Callback.callSafe(request.responseCallback,t,{error:e.Errors.NONE,response:o}))}}conWatcherTick(){return()=>{!0===this.__cyclicReconnect&&void 0===this.__websocket&&this.open()}}open(callback){if(!this.__websocket){const t=this.__websocketProtocol+"//"+this.__serverHost+":"+this.__serverPort;try{this.__websocket=new WebSocket(t)}catch(t){return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] Opening connection to Hmi Webserver failed!"))}this.__websocket.onopen=this.onWsOpen(callback),this.__websocket.onclose=this.onWsClose(callback),this.__websocket.onmessage=this.onWsMessage()}}__close(){this.__websocket&&(this.__websocket.close(1e3),this.__websocket=void 0)}close(){this.__websocket&&(0!==this.__conWatcherIntervalId&&(window.clearInterval(this.__conWatcherIntervalId),this.__conWatcherIntervalId=0),this.__close())}requestQueueHasPendingRequest(){return!!this.__requestPending}requestQueueDone(request){request&&this.__requestPending&&this.__requestPending.id===request.id&&(this.__requestPending.pending=!1,this.__requestPending.queued=!1,this.__requestPending=null,this.requestQueueNext())}requestQueueAdd(request){this.__requestQueue.push(request),request.queued=!0,!1===this.requestQueueHasPendingRequest()&&this.requestQueueNext()}requestQueueRemove(request){let e=-1;for(let t=0,r=this.__requestQueue.length;t<r;t++){if(this.__requestQueue[t].id===request.id){e=t;break}}e>=0&&this.__requestQueue.splice(e,1),this.requestQueueDone(request)}requestQueueNext(){let request=this.__requestQueue.shift();request&&(request.pending=!0,this.__requestPending=request,this.__websocket.send(JSON.stringify(request.message)))}getFreeRequestId(){let t=0,r=0;do{if(t=0,r++,r>=1e6){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] Reached maxium of parallel requests."),t=null;break}this.__requestIdCount++,this.__requestIdCount>=1e6&&(this.__requestIdCount=1),t=this.__requestIdCount}while(this.__requestCache.has(t));return t}setServerAddress(e,t,r){e&&(this.__serverHost=e),t&&(this.__serverPort=t.toString()),r&&(this.__serverProtocol=r,"http:"===r?this.__websocketProtocol="ws:":"https:"===r&&(this.__websocketProtocol="wss:"))}getRequest(id){return this.__requestCache.get(id)}registerRequest(id,type,message){if(this.__requestCache.has(id))return null;let e={id:id,type:type,message:message,deletionPending:!1,timeoutCallback:null,timeoutTimer:0,timeout:null,interval:null,callbacks:[],responseCallback:null,queued:!1,pending:!1,managed:!1};return this.__requestCache.set(id,e),e}unregisterRequest(id){let request=this.__requestCache.get(id);request&&(0!==request.timeoutTimer&&(clearTimeout(request.timeoutTimer),request.timeoutTimer=0),this.requestQueueRemove(request),this.__requestCache.delete(id))}registerRequestCallback(e,callback){let request=this.__requestCache.get(e);request&&request.callbacks.push(callback)}unregisterRequestCallback(e,callback){let request=this.__requestCache.get(e);if(request){let e=request.callbacks.indexOf(callback);e>-1&&request.callbacks.splice(e,1)}}registerEventCallback(t,callback){let r=this,request=this.registerRequest(t,300);return request.responseCallback=function(data){e.System.Callback.callSafeCallbacks1Param(request.callbacks,r,{error:e.Errors.NONE,response:data.response})},this.registerRequestCallback(t,callback),t}symbolWatcherTick(){let e=this;return function(){let t=new Date;if(!0===e.__isInitialized&&void 0!==e.__websocket&&null!==e.__websocket&&e.__websocket.readyState===WebSocket.OPEN&&t.getTime()-e.__symbolWatcherStartTime.getTime()>250){1===e.refreshSymbolWatcher()&&0!==e.__symbolWatcherIntervalId&&(window.clearInterval(e.__symbolWatcherIntervalId),e.__symbolWatcherIntervalId=0)}}}refreshSymbolWatcher(){let t=this,error=!1,r=[],o=new Map,i=this.__watchSymbolCache;if(i.forEach((function(e,t){null!==e.reqId&&r.lastIndexOf(e.reqId)<0&&(r.push(e.reqId),e.reqId=null),0===e.refs?i.delete(t):o.get(t)||o.set(t,e)})),r.length>0){let o={requestType:"ReadWrite",commands:[]};for(let t=0,i=r.length;t<i;t++){let i=r[t];o.commands.push({commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Unsubscribe",writeValue:i}),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ServerManager] Unsubscribing request with id="+i+".")}this.request(o,(function(data){let r=data.response;if(void 0===r)return;r.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] Server responds with error. "+e.Log.buildMessage(r.error));let commands=r.commands;if(null!=commands)for(let r=0,o=commands.length;r<o;r++){let o=commands[r];null!=o&&(void 0!==o.error&&null!==o.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.ServerManager] Server responds with error for unsubscribe id="+o.writeValue+". ",e.Log.buildMessage(o.error)),void 0!==o.writeValue&&null!==o.writeValue&&t.releaseRequest(o.writeValue))}}))}let n=new Map;if(o.forEach((function(r,o){let i="";null===r.interval?i+="GLOBAL":i+=r.interval,i+="_",null===r.timeout?i+="GLOBAL":i+=r.timeout;let s=n.get(i),l=t.getFreeRequestId();if(l){s?r.reqId=s.message.id:(r.reqId=l,s={interval:r.interval,timeout:r.timeout,watchEntries:[],message:{requestType:"Subscription",id:l,commands:[]}},null!==r.interval&&(s.message.intervalTime=r.interval)),s.watchEntries.push(r);let t=s.message.commands,o=!0;for(let e=0,i=t.length;e<i;e++){let i=t[e];if(i.symbol===r.name&&tchmi_equal(i.commandOptions,r.options)){o=!1;break}}o&&(t.push({commandOptions:r.options,symbol:r.name}),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.ServerManager] Subscribing symbol "+r.name+" in request id="+l+".")),n.set(i,s)}else error=!0})),error)return 0;return n.forEach((function(message,r){!function(r){for(let e=0,t=r.watchEntries.length;e<t;e++){let t=r.watchEntries[e];for(let e=0,r=t.callbacks.length;e<r;e++){let r=t.callbacks[e];!1===r.dirty&&(r.refreshLock=!0)}}t.getRequest(t.request(r.message,(function(data){var o;if(data.error===e.Errors.NONE){let i=data.response;if(i.error){let t=[];null===(o=r.message.commands)||void 0===o||o.forEach(value=>{value.symbol&&t.push(value.symbol)}),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.ServerManager] Server responds "+(t.length?"(for symbol: "+t.join(",")+") ":"")+"with error: "+e.Log.buildMessage(i.error))}for(let o=0,n=i.commands.length;o<n;o++){let n=i.commands[o];if(!n)continue;let s=n.symbol;null===r.interval?s+="_GLOBAL":s+="_"+r.interval,null===r.timeout?s+="_GLOBAL":s+="_"+r.timeout,n.commandOptions&&n.commandOptions.indexOf("Poll")>-1?s+="_POLL":s+="_GLOBAL";let l=t.__watchSymbolCache.get(s);if(!l)continue;if(void 0!==n.error){e.System.ServerManager.__callSymbolWatchEntryCallbacks(l.callbacks,t,{error:e.Errors.E_SERVER_COMMAND_ERROR,details:{code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],domain:"TcHmi.System.ServerManager",reason:n.symbol,errors:[n.error]}});continue}if(void 0===n.readValue)continue;let c=!tchmi_equal(l.value,n.readValue);l.value=n.readValue,n.processedStart&&(l.processedStart=n.processedStart),n.processedEnd&&(l.processedEnd=n.processedEnd);let d=[];for(let e=0,t=l.callbacks.length;e<t;e++){let t=l.callbacks[e];d.push(t)}for(let r of d)-1!==l.callbacks.indexOf(r)&&(!1===r.refreshLock||!0===c?(r.refreshLock=!1,r.dirty=!1,e.Callback.callSafe(r.callback,t,{error:e.Errors.NONE,value:tchmi_clone_object(l.value),processedStart:l.processedStart,processedEnd:l.processedEnd,destroy:r.destroy})):r.refreshLock=!1)}}else for(let o=0,i=r.watchEntries.length;o<i;o++)e.System.ServerManager.__callSymbolWatchEntryCallbacks(r.watchEntries[o].callbacks,t,{error:data.error})}))).managed=!0}(message)})),error?0:1}watch(expression,callback){if(null==expression)return e.Callback.callSafe(callback,this,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"No expression given.",domain:"TcHmi.System.ServerManager"}}),function(){};if(expression.getType()!==e.SymbolType.Server)return e.Callback.callSafe(callback,this,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"No valid expression given. Needs server symbol expression",domain:"TcHmi.System.ServerManager"}}),function(){};if(null==callback||"function"!=typeof callback)return function(){};let options=expression.getOptions(),interval=options.Interval?options.Interval:null,t=options.Timeout?options.Timeout:null,r=this,name=expression.getName(),o=[];o.push("SendErrorMessage");let i=name;i+=null===interval?"_GLOBAL":"_"+interval,i+=null===t?"_GLOBAL":"_"+t,options.SubscriptionMode&&"Poll"===options.SubscriptionMode||"Poll"===e.System.config.tcHmiServer.websocketSubscriptionMode?(i+="_POLL",o.push("Poll")):i+="_GLOBAL";let n=this.__watchSymbolCache.get(i),s=function(){let e=!1;if(n){n.refs--;let t=-1;for(let e=0,r=n.callbacks.length;e<r;e++)if(n.callbacks[e].callback===callback){t=e;break}t>-1&&n.callbacks.splice(t,1),0===n.refs&&(e=!0)}e&&0===r.__symbolWatcherIntervalId&&(r.__symbolWatcherStartTime=new Date,r.__symbolWatcherIntervalId=window.setInterval(r.symbolWatcherTick(),100))};return n?(n.callbacks.push({callback:callback,dirty:!0,refreshLock:!1,destroy:s}),n.refs++):(n={reqId:null,name:name,interval:interval,timeout:t,refs:1,value:null,options:o,callbacks:[{callback:callback,dirty:!0,refreshLock:!1,destroy:s}]},this.__watchSymbolCache.set(i,n)),0===this.__symbolWatcherIntervalId&&(this.__symbolWatcherStartTime=new Date,this.__symbolWatcherIntervalId=window.setInterval(this.symbolWatcherTick(),100)),s}request(e,callback){return this.requestEx(e,null,callback)}requestEx(t,options,callback){let r=this;if(!(t=tchmi_clone_object(t)))return e.Callback.callSafe(callback,this,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"No request given",domain:"TcHmi.System.ServerManager"}}),null;if((void 0===t.id||null===t.id)&&(t.id=this.getFreeRequestId(),null===t.id))return e.Callback.callSafe(callback,this,{error:e.Errors.ERROR,details:{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"No request id could be generated",domain:"TcHmi.System.ServerManager"}}),null;if(this.__websocket&&this.__websocket.readyState!==WebSocket.CLOSING&&this.__websocket.readyState!==WebSocket.CLOSED&&this.__websocket.readyState!==WebSocket.CONNECTING){let request,o,i=!1,type=0;switch(t.requestType){case"ReadWrite":type=100,i=!options||!0!==options.parallel;break;case"Subscription":type=200,i=!options||!0!==options.parallel;break;case"Event":type=300,i=!1}if(request=options&&!0===options.refresh?this.getRequest(t.id):this.registerRequest(t.id,type,t),null===request)return e.Callback.callSafe(callback,this,{error:e.Errors.E_PARAMETER_INVALID,details:{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"A request with the same id: '"+t.id+"' is already in progress.",domain:"TcHmi.System.ServerManager"}}),null;"function"==typeof callback&&this.registerRequestCallback(t.id,callback),!0===TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.ServerManager] Request to TwinCAT HMI Server:",{requestObj:t}),"Subscription"===t.requestType&&(void 0===t.intervalTime||null===t.intervalTime?(t.intervalTime=e.System.config.tcHmiServer.websocketIntervalTime,(isNaN(t.intervalTime)||"number"!=typeof t.intervalTime)&&(t.intervalTime=500)):request.interval=t.intervalTime),options&&void 0!==options.timeout&&null!==options.timeout&&(request.timeout=options.timeout),request.timeoutCallback=function(){e.Callback.callSafe(callback,r,{error:e.Errors.E_TIMEOUT,details:{code:e.Errors.E_TIMEOUT,message:e.Errors[e.Errors.E_TIMEOUT],domain:"TcHmi.System.ServerManager",reason:'Request with id: "'+request.id+'" does not respond within expected time.'}}),request.queued&&r.requestQueueDone(request),r.releaseRequest(request.id)},request.responseCallback=function(data){e.System.Callback.callSafeCallbacks1Param(request.callbacks,r,{error:e.Errors.NONE,response:data.response}),request.queued&&r.requestQueueDone(request),200!==request.type&&r.releaseRequest(request.id)},o=null!==request.timeout?request.timeout:e.System.config.tcHmiServer&&e.System.config.tcHmiServer.websocketTimeout?e.System.config.tcHmiServer.websocketTimeout:6e4,request.timeoutTimer=setTimeout((function(){e.Callback.callSafe(request.timeoutCallback,r)}),o),i?this.requestQueueAdd(request):this.__websocket.send(JSON.stringify(request.message))}else e.Callback.callSafe(callback,this,{error:e.Errors.E_WEBSOCKET_NOT_READY,details:{code:e.Errors.E_WEBSOCKET_NOT_READY,message:e.Errors[e.Errors.E_WEBSOCKET_NOT_READY],domain:"TcHmi.System.ServerManager"}});return t.id}releaseRequest(id){this.unregisterRequest(id)}getWebsocketReadyState(){return void 0!==this.__websocket&&null!==this.__websocket?this.__websocket.readyState:null}login(username,password,persistent=!0,reload=!0,options,callback){const message={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Login",writeValue:{userName:username,password:password,persistent:persistent}}]};return e.System.Services.accessManager.unsubscribe(data=>{e.System.Services.accessManager.enableReload(reload),t.Services.serverManager.requestEx(message,options,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("Login successful with username: "+data.response.commands[0].writeValue.userName),document.cookie="sessionId="+data.response.sessionId+"; path=/",reload&&window.location.reload(!0),e.System.Services.accessManager.subscribe(data=>{e.Callback.callSafe(callback,this,{error:e.Errors.NONE})})}}))}),!0}logout(reload=!0,options,callback){return e.System.Services.accessManager.unsubscribe(data=>{e.System.Services.accessManager.enableReload(reload);t.Services.serverManager.requestEx({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Logout"}]},options,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{e.System.Services.accessManager.subscribe(data=>{e.Callback.callSafe(callback,this,{error:e.Errors.NONE})})}}))}),!0}forceLogout(username,options,callback){const message={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"ForceLogout",writeValue:username}]};return t.Services.serverManager.requestEx(message,options,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}})),!0}refreshSubscription(request,callback){this.request({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"Unsubscribe",writeValue:request.id}]},data=>{null===request.interval&&delete request.message.intervalTime,null===request.timeout&&request.timeoutTimer&&(clearTimeout(request.timeoutTimer),request.timeoutTimer=null),this.requestEx(request.message,{refresh:!0},data=>{e.Callback.callSafe(callback,this,{error:e.Errors.NONE})})})}refreshSubscriptions(callback){let t=0,r=()=>{0===t&&e.Callback.callSafe(callback,this,{error:e.Errors.NONE})};this.__requestCache.forEach((request,id)=>{200===request.type&&(t++,this.refreshSubscription(request,data=>{t--,r()}))}),r()}static __callSymbolWatchEntryCallbacks(t,thisArg,data){let r=[];for(let e=0,o=t.length;e<o;e++)r.push(t[e]);for(let o of r){if(-1===t.indexOf(o))continue;let r=e.Callback.callSafe(o.callback,thisArg,data);if(void 0!==r)return r}}}r.RECONNECT_INTERVAL=5e3,t.ServerManager=r}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){class r{constructor(){this.__subscriptions=new e.List}confirmAlarm(alarm,callback){let t={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"ConfirmAlarm",writeValue:alarm}]};e.System.Services.serverManager.request(t,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,this,{error:e.Errors.NONE})}}))}listEvents(filter,callback){const t={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"ListEvents",filter:filter}]};e.System.Services.serverManager.request(t,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{setTimeout(()=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,events:data.results[0].value})})}}))}subscribe(filter,callback){const t=e.System.Services.serverManager.getFreeRequestId(),r={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"SubscribeEvents",writeValue:t,filter:filter}]};let o={responseId:t,callback:callback};return this.__subscriptions.push(o),e.System.Services.serverManager.request(r,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{e.System.Services.serverManager.registerEventCallback(t,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{setTimeout(()=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE,event:data.results[0].value})})}}))}})),t}unsubscribe(id,callback){const t=this.__subscriptions.firstOrDefault(e=>e.responseId===id);if(null!==t){const r={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"UnsubscribeEvents",writeValue:t.responseId}]};e.System.Services.serverManager.releaseRequest(t.responseId),this.__subscriptions.remove(t),e.System.Services.serverManager.request(r,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,this,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,this,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))}}updateSubscription(id,filter,callback){const t=this.__subscriptions.firstOrDefault(e=>e.responseId===id);if(null!==t){let r={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:"UpdateEventsSubscription",writeValue:t.responseId,filter:filter}]};e.System.Services.serverManager.request(r,e.Server.__handleServerResponse({error:data=>{if(data.error!==e.Errors.NONE)e.Callback.callSafe(callback,null,{error:data.error,details:data.details});else{let t=data.results[0];e.Callback.callSafe(callback,null,{error:t.error,details:t.details})}},success:data=>{e.Callback.callSafe(callback,null,{error:e.Errors.NONE})}}))}}}t.ServerEventManager=r,function(e){let t;!function(e){e[e.Raise=0]="Raise",e[e.Change=1]="Change",e[e.Dispose=2]="Dispose"}(t=e.ServerAlarmChangeType||(e.ServerAlarmChangeType={}))}(r=t.ServerEventManager||(t.ServerEventManager={}))}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){let t;!function(t){t.TriggerManager=class{constructor(){this.__triggerMap=new Map}__resolveValue(r,o){if(o)switch(o.objectType){case"StaticValue":let value=o.value;r.success(value);break;case"Symbol":let i=new t.Symbol(o.symbolExpression);i.read((function(data){data.error===e.Errors.NONE?r.success(data.value):r.error(data.error,data.details),i.destroy(),i=null}));break;case"FunctionExpression":if(e.IFunction.isFunctionExpression(o)){let i=new t.FunctionExpression(o.functionExpression);try{let e=!1;i.execute({success:function(t){e||(e=!0,r.success(t))},error:function(error,t){e||(e=!0,r.error(error,t))}})}catch(t){r.error(e.Errors.E_TRIGGER_FUNCTION_EXPRESSION_EXCEPTION,{code:e.Errors.E_TRIGGER_FUNCTION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_TRIGGER_FUNCTION_EXPRESSION_EXCEPTION],reason:t,domain:"TcHmi.System.TriggerManager"})}}else r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],domain:"TcHmi.System.TriggerManager"});break;default:r.error(e.Errors.E_NOT_SUPPORTED,{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],domain:"TcHmi.System.TriggerManager"})}else r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"An object of type: 'IFunction.Value' must not be null or undefined.",domain:"TcHmi.System.TriggerManager"})}__resolveValueAsArray(e,t){let r=[];if(!t)return void e.success(r);let o=t.length,i=0,n=this,s=function(){let value=t[i],l=!1;n.__resolveValue({success:function(t){l||(l=!0,r.push(t),i===o-1?e.success(r):(i++,s()))},error:function(error,t){l||(l=!0,e.error(error,t))},trigger:e.trigger,event:e.event},value)};s()}__resolveConditionExpressionsResult(t,r){let o=this,i=!1,n=[],s=2*r.length,l=function(r,l){let c=!1;o.__resolveValue({success:function(o){c||(c=!0,i||(r.result[l]=o,s--,0===s&&function(){let r="";r+="(";for(let e=0,t=n.length;e<t;e++)null!==n[e].expression.logic&&"OR"!==n[e].expression.logic||(r+="("),"=="===n[e].expression.compareOperator||"==="===n[e].expression.compareOperator?(r+="tchmi_equal(",r+="results["+e+"].result.compare1",r+=",",r+="results["+e+"].result.compare2",r+=",false)"):"!="===n[e].expression.compareOperator||"!=="===n[e].expression.compareOperator?(r+="!tchmi_equal(",r+="results["+e+"].result.compare1",r+=",",r+="results["+e+"].result.compare2",r+=",false)"):(r+="(",r+="results["+e+"].result.compare1",r+=n[e].expression.compareOperator,r+="results["+e+"].result.compare2",r+=")"),void 0!==n[e+1]?"AND"===n[e+1].expression.logic?r+=" && ":"OR"===n[e+1].expression.logic&&(r+=") || "):r+=")";r+=")",r+="\n//# sourceURL=TcHmi_System_TriggerManager_ConditionExpressionsResult_Eval";var o=!1;try{o=gIsolatedEval_TcHmi_System_TriggerManager_ConditionExpressionsResult(r,n)}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),t.error(e.Errors.E_EXCEPTION,{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r,domain:"TcHmi.System.TriggerManager"})}t.success(o)}()))},error:function(error,e){c||(c=!0,i=!0,t.error(error,e))},trigger:t.trigger,event:t.event},r.expression[l])};for(let e=0,t=r.length;e<t&&!i;e++){let t={expression:r[e],result:{compare1:void 0,compare2:void 0}};n[e]=t,l(t,"compare1"),l(t,"compare2")}}__taControlApiFunction(t,r,o){TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __taControlApiFunction called with:",{ctx:t,action:r});let i=r;const control=i.control,fn=i.fn;if(null==control)throw new Error("Property: 'control' is missing in object of type: 'TcHmi.Trigger.ControlApiFunction'.");if(null==fn)throw new Error("Property: 'fn' is missing in object of type: 'TcHmi.Trigger.ControlApiFunction'.");let n=null;if(!0===e.Symbol.isSymbolExpression(i.control)){var s=new e.SymbolExpression(i.control);n=e.Controls.get(s.getName())}else n=e.Controls.get(i.control);if(null==n)throw new Error("Can't find instance of control width id: '"+control+"'.");let l=n[fn];if("function"!=typeof l)throw new Error("Can't find function with name: '"+fn+"' in instance of control with id: '"+control+"'.");let c=!1;this.__resolveValueAsArray({success:function(r){if(c)return;c=!0;let o,i=!0;try{o=l.call(n,...r)}catch(r){i=!1,TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),t.error(e.Errors.E_EXCEPTION,{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r,domain:"TcHmi.System.TriggerManager"})}i&&t.success(o)},error:function(error,e){c||(c=!0,t.error(error,e))},trigger:t.trigger,event:t.event},i.fnParams)}__taWriteToSymbol(t,r,o){TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __taWriteToSymbol called with:",{ctx:t,action:r});let i=!1;this.__resolveValue({success:function(o){if(i)return;i=!0;let n=new e.System.Symbol(r.symbolExpression);n.write(o,(function(data){data.error===e.Errors.NONE?t.success():t.error(data.error,data.details),n.destroy(),n=null}))},error:function(error,e){i||(i=!0,t.error(error,e))},trigger:t.trigger,event:t.event},r.value)}__taFunction(t,r,o){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __taFunction called with:",{ctx:t,action:r}),null==r)return;let i={objectType:"Function",active:r.active,fn:r.fn,fnParams:r.fnParams};new e.Function(i).executeEx(null,(function(data){data.error===e.Errors.NONE?t.success(data.result):t.error(data.error,data.details)}))}__taActionTemplate(r,o,i){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+i+"] __taActionTemplate called with:",{ctx:r,action:o}),null!=o){let i=o.templateName;if(null==i||""===i||"string"!=typeof i)return void r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Pproperty: 'templateName' in object of type 'TcHmi.Trigger.ActionTemplate' is invalid. Value must be a valid string with a length of at least one character.",domain:"TcHmi.System.TriggerManager"});if(void 0===t.config||null===t.config)return void r.error(e.Errors.E_INVALID,{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:"TcHmi.System.config is not a valid object of type: 'IConfig'.",domain:"TcHmi.System.TriggerManager"});let n=t.config.actionTemplates;if(null==n||void 0===n.length)return void r.error(e.Errors.E_INVALID,{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:"Pproperty: 'actionTemplates' in configuration contains no valid action templates. Please check tchmiconfig.json.",domain:"TcHmi.System.TriggerManager"});let s=null;for(let e=0,t=n.length;e<t&&(s=n[e],s.name!==i);e++)s=null;if(null===s)return void r.error(e.Errors.E_INVALID,{code:e.Errors.E_INVALID,message:e.Errors[e.Errors.E_INVALID],reason:"Can't find action template with name: '"+i+"' in configuration. Please check tchmiconfig.json.",domain:"TcHmi.System.TriggerManager"});const l=tchmi_create_guid();let c=!1,d=s.parameters;const _=function(){if(d&&d.length)for(let t=0,r=d.length;t<r;t++){let r=d[t];if(!r.name)continue;let name=l+"."+r.name;e.System.Services.templateParamSymbolManager.keepAlive(name)||e.System.Services.templateParamSymbolManager.remove(name)}};let m=o.fnParams;for(let t=0,i=d.length;t<i;t++){let i=d[t];if(!i.name)continue;let name=l+"."+i.name,n=m[t];if(e.IFunction.isSymbol(n))e.System.Services.templateParamSymbolManager.add(name,i.type,new e.SymbolExpression(n.symbolExpression));else{if(!e.IFunction.isStaticValue(n)){if(n){r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Unknown objectType: '"+n.objectType+"' in parameter in property: 'fnParam' in object of type 'TcHmi.Trigger.ActionTemplate' with templateName: '"+o.templateName+"'. Supported objectTypes are 'Symbol' and 'StaticValue'. Processing will be aborted.",domain:"TcHmi.System.TriggerManager"}),c=!0;break}r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Missing property: 'fnParam' in object of type 'TcHmi.Trigger.ActionTemplate' with templateName: '"+o.templateName+"'. Processing will be aborted.",domain:"TcHmi.System.TriggerManager"}),c=!0;break}e.System.Services.templateParamSymbolManager.add(name,i.type,n.value)}}if(c)r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.System.TriggerManager"}),_();else{let t=JSON.stringify(s.actions);for(let e=0,r=d.length;e<r;e++){let r=d[e];if(!r.name)continue;r.name;t=t.replace(new RegExp(tchmi_escape_regex("%tp%"+r.name),"g"),"%tp%"+l+"."+r.name)}let o=e.ValueConverter.toObject(t,null);if(null===o)r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Failed to parse json.",domain:"TcHmi.System.TriggerManager"});else try{let e=!1;this.__processActionList({success:function(t){e||(e=!0,r.success(),_())},error:function(error,t){e||(e=!0,r.error(error,t),_())},trigger:r.trigger,event:r.event},o)}catch(t){r.error(e.Errors.E_EXCEPTION,{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:t,domain:"TcHmi.System.TriggerManager"})}}}}__taFunctionExpression(r,o,i){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+i+"] __taFunctionExpression called with action:",{ctx:r,action:o}),!e.Trigger.isFunctionExpression(o))return;let n=new t.FunctionExpression(o.functionExpression),s=!1;n.execute({success:function(e){s||(s=!0,r.success(e))},error:function(error,e){s||(s=!0,r.error(error,e))}})}__taJavaScript(t,r,o){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __taJavaScript called with:",{ctx:t,action:r}),!e.Trigger.isJavaScript(r))return;let i="",n=r.sourceLines;if(Array.isArray(n)){try{for(var s=0,l=n.length;s<l;s++)i+=n[s]+"\n";i+="\n//# sourceURL=TcHmi_System_TriggerManager___taJavaScript_Eval"}catch(r){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),void t.error(e.Errors.E_EXCEPTION,{code:e.Errors.E_EXCEPTION,message:e.Errors[e.Errors.E_EXCEPTION],reason:r,domain:"TcHmi.System.TriggerManager"})}try{let e=!1;gIsolatedEval_TcHmi_System_TriggerManager_JavaScriptAction({success:function(){e||(e=!0,"Asynchronous"===r.waitMode&&t.success())},error:function(error,o){e||(e=!0,"Asynchronous"===r.waitMode&&t.error(error,o))}},i),"Asynchronous"!==r.waitMode&&t.success()}catch(o){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(o),"Asynchronous"!==r.waitMode&&t.error(e.Errors.E_TRIGGER_JAVASCRIPT_EVAL_EXCEPTION,{code:e.Errors.E_TRIGGER_JAVASCRIPT_EVAL_EXCEPTION,message:e.Errors[e.Errors.E_TRIGGER_JAVASCRIPT_EVAL_EXCEPTION],reason:o,domain:"TcHmi.System.TriggerManager"})}}else t.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Invalid property: 'sourceLines' in obect of type 'TcHmi.Trigger.JavaScript'. Expected an array of strings.",domain:"TcHmi.System.TriggerManager"})}__taCondition(t,r,o){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __taCondition called with:",{ctx:t,condition:r}),!r)return void t.error(e.Errors.E_TRIGGER_CONDITION_INVALID,{code:e.Errors.E_TRIGGER_CONDITION_INVALID,message:e.Errors[e.Errors.E_TRIGGER_CONDITION_INVALID],reason:"Object of type 'TcHmi.Trigger.Condition' must not be null or undefined.",domain:"TcHmi.System.TriggerManager"});let i=r.parts;if(!i)return void t.error(e.Errors.E_TRIGGER_CONDITION_INVALID,{code:e.Errors.E_TRIGGER_CONDITION_INVALID,message:e.Errors[e.Errors.E_TRIGGER_CONDITION_INVALID],reason:"Object of type 'TcHmi.Trigger.Condition' requires at least a property with name \"part\" which is an array with one object which contains a property named 'if' with a value of type 'TcHmi.Trigger.Expression'.",domain:"TcHmi.System.TriggerManager"});if(0===i.length)return void t.success();let n=this,s=!1,l=0,c=function(t){let r,o,d=i[l];if(d){if(l++,void 0!==d.if)r=d.if,o=d.then,s=!0;else if(void 0!==d.elseif){if(r=d.elseif,o=d.then,!s)return void t.error(e.Errors.E_TRIGGER_CONDITION_INVALID,{code:e.Errors.E_TRIGGER_CONDITION_INVALID,message:e.Errors[e.Errors.E_TRIGGER_CONDITION_INVALID],reason:"Part 'elseif' must not be defined before part 'if'.",domain:"TcHmi.System.TriggerManager"})}else if(void 0!==d.else&&(o=d.else,!s))return void t.error(e.Errors.E_TRIGGER_CONDITION_INVALID,{code:e.Errors.E_TRIGGER_CONDITION_INVALID,message:e.Errors[e.Errors.E_TRIGGER_CONDITION_INVALID],reason:"Part 'else' must not be defined before part 'if'.",domain:"TcHmi.System.TriggerManager"});try{let i=!1;r&&o?n.__resolveConditionExpressionsResult({success:function(e){i||(i=!0,!0===e?n.__processActionList({success:function(e){t.success()},error:function(error,e){t.success()},trigger:t.trigger,event:t.event},o):c({success:function(e){t.success()},error:function(error,e){t.error(error,e)},trigger:t.trigger,event:t.event}))},error:function(error,e){i||(i=!0,t.error(error,e))},trigger:t.trigger,event:t.event},r):!r&&o?n.__processActionList({success:function(e){t.success()},error:function(error,e){t.success()},trigger:t.trigger,event:t.event},o):t.error(e.Errors.E_TRIGGER_CONDITION_INVALID,{code:e.Errors.E_TRIGGER_CONDITION_INVALID,message:e.Errors[e.Errors.E_TRIGGER_CONDITION_INVALID],reason:"Condition definition is invalid because it contains no expressions and no following actions.",domain:"TcHmi.System.TriggerManager"})}catch(r){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(r),t.error(e.Errors.E_TRIGGER_RESOLVE_CONDITION_EXPRESSION_EXCEPTION,{code:e.Errors.E_TRIGGER_RESOLVE_CONDITION_EXPRESSION_EXCEPTION,message:e.Errors[e.Errors.E_TRIGGER_RESOLVE_CONDITION_EXPRESSION_EXCEPTION],reason:r,domain:"TcHmi.System.TriggerManager"})}}else t.success()};c({success:function(e){t.success()},error:function(error,e){t.error(error,e)},trigger:t.trigger,event:t.event})}__taSwitchCase(r,o,i){if(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+i+"] __taSwitchCase called with:",{ctx:r,switchCase:o}),null==o)return void r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Object of type 'TcHmi.Trigger.SwitchCase' must not be null or undefined.",domain:"TcHmi.System.TriggerManager"});let n=o.compare;if(null==n)return void r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Object of type 'TcHmi.Trigger.SwitchCase' requires a property: 'compare' which must not be null or undefined.",domain:"TcHmi.System.TriggerManager"});let s=o.cases;if(null==s)return void r.error(e.Errors.E_PARAMETER_INVALID,{code:e.Errors.E_PARAMETER_INVALID,message:e.Errors[e.Errors.E_PARAMETER_INVALID],reason:"Object of type 'TcHmi.Trigger.SwitchCase' requires a property: 'cases' which must not be null or undefined.",domain:"TcHmi.System.TriggerManager"});let l=null;void 0!==o.caseDefault&&null!==o.caseDefault&&(l=o.caseDefault);let c=this,d=void 0,_=!1;this.__resolveValue({success:function(o){_||(_=!0,d=o,function(){let o=0,i=0,n=null;for(o=0,i=s.length;o<i;o++){const i=s[o];if(null==i){r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Property: 'cases' in object of type: 'TcHmi.Trigger.SwitchCase' must not contain entries which are null or undefined.",domain:"TcHmi.System.TriggerManager"});break}const l=i.caseValue;if(null==l){r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],domain:"TcHmi.System.TriggerManager"});break}let c;switch(l.objectType){case"StaticValue":c=l.value;break;case"Symbol":let o=new t.Symbol(l.symbolExpression);if(null!=o){if(!t.Symbol.isInternalSymbol(o)){r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:"Symbol of type: '"+e.SymbolType[o.getExpression().getType()]+"' is not supported in switch case. Please use objects of type: 'StaticValue' or symbols of type: 'InternalSymbol' only.",domain:"TcHmi.System.TriggerManager"}),o.destroy();break}o.read((function(data){c=data.value,o.destroy()}))}break;default:r.error(e.Errors.ERROR,{code:e.Errors.ERROR,message:e.Errors[e.Errors.ERROR],reason:'Object type: "'+l.objectType+"\" is not supported in switch case. Please use objects of type: 'StaticValue' or symbols of type: 'InternalSymbol' only.",domain:"TcHmi.System.TriggerManager"});continue}if(!0===tchmi_equal(c,d,!1)&&(n=i),null!==n)break}null!==n?c.__processActionList({success:function(){},error:function(){},trigger:r.trigger,event:r.event},n.actions):null!==l&&c.__processActionList({success:function(){},error:function(){},trigger:r.trigger,event:r.event},l.actions)}(),r.success(e.Errors.NONE))},error:function(error,e){_||(_=!0,r.error(error,e))},trigger:r.trigger,event:r.event},n)}__processAction(t,r,o){let i=this;if(!1===r.active)return void t.success();let n=!1,s={success:function(e){if(n)return;n=!0;let s=!1;i.__processActionList({success:function(e){s||(s=!0,t.success(e))},error:function(error,e){s||(s=!0,t.error(error,e))},trigger:t.trigger,event:t.event},r.success,o)},error:function(error,s){if(n)return;n=!0,s?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.TriggerManager, Event="+t.event.name+", ObjectType="+r.objectType+"] "+e.Log.buildMessage(s)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi.System.TriggerManager, Event="+t.event.name+", ObjectType="+r.objectType+"] "+e.Log.buildMessage({code:error,message:e.Errors[error]}));let l=!1;i.__processActionList({success:function(e){l||(l=!0,t.success(e))},error:function(error,e){l||(l=!0,t.error(error))},trigger:t.trigger,event:t.event},r.error,o)},trigger:t.trigger,event:t.event};try{switch(r.objectType){case"Condition":this.__taCondition(s,r,o);break;case"SwitchCase":this.__taSwitchCase(s,r,o);break;case"ControlApiFunction":this.__taControlApiFunction(s,r,o);break;case"WriteToSymbol":this.__taWriteToSymbol(s,r,o);break;case"Function":this.__taFunction(s,r,o);break;case"JavaScript":this.__taJavaScript(s,r,o);break;case"ActionTemplate":this.__taActionTemplate(s,r,o);break;case"FunctionExpression":this.__taFunctionExpression(s,r,o);break;case"Comment":t.success();break;default:t.error(e.Errors.E_NOT_SUPPORTED,{code:e.Errors.E_NOT_SUPPORTED,message:e.Errors[e.Errors.E_NOT_SUPPORTED],reason:"Object type: '"+r.objectType+"' is not supported.",domain:"TcHmi.System.TriggerManager"})}}catch(o){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.errorEx("[Source=Framework, Module=TcHmi.System.TriggerManager, Event=",t.event.name,", ObjectType=",r.objectType,"] Throwed",o),t.error(e.Errors.E_TRIGGER_ACTION_EXCEPTION,{code:e.Errors.E_TRIGGER_ACTION_EXCEPTION,message:e.Errors[e.Errors.E_TRIGGER_ACTION_EXCEPTION],reason:o,domain:"TcHmi.System.TriggerManager"})}}__processActionList(e,t,r){if(!t)return void e.success();let o=t.length;if(0===o)return void e.success();let i=0,n=this,s=function(){let l=t[i],c=function(){i===o-1?e.success():(i++,s())},d=!1;n.__processAction({success:function(){d||(d=!0,void 0!==l.asyncWait&&!0!==l.asyncWait||c())},error:function(error,e){d||(d=!0,void 0!==l.asyncWait&&!0!==l.asyncWait||c())},trigger:e.trigger,event:e.event},l,r),void 0!==l.asyncWait&&!1===l.asyncWait&&c()};s()}__onTriggerEvent(t){var r=this;return function(event,data){let o="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(o=tchmi_create_guid()),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debugEx("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __onTriggerEvent called with:",{event:event,data:data}),!0===t.preventDefault&&data&&"function"==typeof data.preventDefault&&(TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi.System.TriggerManager, LogicalScopeDiagGUID="+o+"] __onTriggerEvent calling data.preventDefault() because 'trigger.preventDefault===true'."),data.preventDefault()),r.__processActionList({success:function(){},error:function(error,e){},trigger:t,event:event},t.actions,o)}}register(t){if((!0!==TCHMI_ENGINEERING||!0!==TCHMI_DESIGNER)&&null!=t)for(var r=0,o=t.length;r<o;r++){var i=t[r];if(void 0===i.event||null===i.event||"string"!=typeof i.event)continue;if(void 0===i.actions||null===i.actions||"object"!=typeof i.actions||!1===Array.isArray(i.actions))continue;let o=e.EventProvider.register(i.event,this.__onTriggerEvent(i),i.preventDefault?{passive:!1,capture:!1}:void 0),n=this.__triggerMap.get(i.event);void 0===n?(n=[{trigger:i,destroyTriggerEvent:o}],this.__triggerMap.set(i.event,n)):n.push({trigger:i,destroyTriggerEvent:o})}}unregister(e){if((!0!==TCHMI_ENGINEERING||!0!==TCHMI_DESIGNER)&&null!=e)for(let t=0,r=e.length;t<r;t++){let r=e[t];if(void 0===r.event||null===r.event||"string"!=typeof r.event)continue;if(void 0===r.actions||null===r.actions||"object"!=typeof r.actions||!1===Array.isArray(r.actions))continue;let o=this.__triggerMap.get(r.event);if(void 0!==o){for(let e=0,t=o.length;e<t;e++){let i=o[e];if(tchmi_equal(r,i.trigger)){i.destroyTriggerEvent(),o.splice(e,1),e--,t--;break}i=null}0===o.length&&this.__triggerMap.delete(r.event)}}}}}(t=e.System||(e.System={}))}(TcHmi||(TcHmi={})),function(e){!function(t){TCHMI_DYNAMIC_INSTANCE_ID=tchmi_create_guid();let r=document.head.querySelector('meta[name="tchmi-buildtime"]');r&&(e.System.buildtime=r.content);class o{static printDebugOutput(){TCHMI_CONSOLE_LOG_LEVEL>=4&&(e.Log.debugEx("[Source=Framework, Module=TcHmi] Loading TwinCAT HMI Application"),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.location.href:",window.location.href),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.appName:",window.navigator.appName),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.appCodeName:",window.navigator.appCodeName),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.appVersion:",window.navigator.appVersion),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.platform:",window.navigator.platform),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.userAgent:",window.navigator.userAgent),e.Log.debugEx("[Source=Framework, Module=TcHmi] window.navigator.cookieEnabled:",window.navigator.cookieEnabled),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_DYNAMIC_INSTANCE_ID:",TCHMI_DYNAMIC_INSTANCE_ID),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_DEBUG_TIME_LOAD_LIBRARY:",TCHMI_DEBUG_TIME_LOAD_LIBRARY),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_ENGINEERING:",TCHMI_ENGINEERING),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_DESIGNER:",TCHMI_DESIGNER),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_LIVEVIEW:",TCHMI_LIVEVIEW),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_RUNTIME:",TCHMI_RUNTIME),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_TARGET_PARTIAL:",TCHMI_TARGET_PARTIAL),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONFIG_OVERRIDE: ",TCHMI_CONFIG_OVERRIDE),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_ENGINEERING_WEBSOCKET:",TCHMI_ENGINEERING_WEBSOCKET),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONSOLE_LOG_LEVEL:",TCHMI_CONSOLE_LOG_LEVEL),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONSOLE_LOG_PERSISTENT:",TCHMI_CONSOLE_LOG_PERSISTENT),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES:",TCHMI_CONSOLE_LOG_PERSISTENT_MAX_ENTRIES),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES:",TCHMI_CONSOLE_LOG_TCHMISERVER_MESSAGES),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES:",TCHMI_CONSOLE_LOG_ENGINEERING_COM_MESSAGES),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_UNITTEST_MODE:",TCHMI_UNITTEST_MODE),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_BENCHMARK_MODE:",TCHMI_BENCHMARK_MODE),e.Log.debugEx("[Source=Framework, Module=TcHmi] TCHMI_EVENT_OPTION_OBJECT_SUPPORTED:",TCHMI_EVENT_OPTION_OBJECT_SUPPORTED),e.System.buildtime&&e.Log.debugEx("[Source=Framework, Module=TcHmi] TcHmi.System.buildtime:",e.System.buildtime),performance&&"object"==typeof performance&&"function"==typeof performance.now&&e.Log.debugEx("[Source=Framework, Module=TcHmi] Time elapsed: "+performance.now().toFixed(3).toString()+"ms"))}static prepare(){if(e.System.SharedResources.jqWindow=$(window),e.System.SharedResources.jqDocument=$(document),window.addEventListener("beforeunload",e.System.__beforeunload),window.addEventListener("unload",e.System.__unload),e.System.Services.dialogManager)throw TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Duplicate Framework code running! Please fix JS inclusion. Aborting."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Duplicate Framework code running! Please fix JS inclusion. Aborting.",e.DialogManager.DialogSeverity.Error),new Error("Duplicate Framework code running");if(e.System.Services.dialogManager=new e.System.DialogManager,e.System.Services.splashScreen=new e.System.SplashScreen,document.body)e.System.SharedResources.jqBody=$(document.body),e.System.SharedResources.jqBody.empty();else{let t=function(){document.body?(document.removeEventListener("readystatechange",t),e.System.SharedResources.jqBody=$(document.body),e.System.SharedResources.jqBody.empty(),1e4===e.System.Init.__initStep&&e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay)):window.setTimeout(t,10)};document.addEventListener("readystatechange",t)}}static run(r){e.System.Init.__initStep=r;let o,i=0,n=[],s=[],l=[],c=[],d=[],_=[],m=[],u=TCHMI_ENGINEERING?"?preventcache="+TCHMI_DYNAMIC_INSTANCE_ID:"";const g={PackageLoaded:2e9,BaseConfigLoaded:2e9,BaseDescriptionLoaded:2e9,OpenEngineeringConnection:2e9,OpenServerConnection:2e9,ControlsDescriptionLoaded:2e9,ControlsDescriptionResolved:2e9,TypeDefinitionsResolved:2e9,ServerSymbolSchemaCacheResolved:2e9,ControlsTemplatesLoaded:2e9,PackagesFunctionDescriptionLoaded:2e9,UserFunctionDescriptionLoaded:2e9,UserControlsLoaded:2e9,ContentLoaded:2e9,ViewLoaded:2e9,ContentCompiled:2e9,ViewCompiled:2e9};let E=new Map([[0,{id:0,text:"System Configuration",toDo:1,done:0}],[0,{id:0,text:"System Configuration",toDo:1,done:0}],[1,{id:1,text:"Preparing System",toDo:1,done:0}],[2,{id:2,text:"Loading Packages",toDo:0,done:0}],[3,{id:3,text:"Connectivity",toDo:1,done:0}],[4,{id:4,text:"Type Definitions",toDo:1,done:0}],[5,{id:5,text:"Preparing Controls",toDo:1,done:0}],[6,{id:6,text:"Preparing Functions",toDo:1,done:0}],[7,{id:7,text:"Loading UserControls",toDo:0,done:0}],[8,{id:8,text:"Loading Content",toDo:0,done:0}],[9,{id:9,text:"Loading Views",toDo:0,done:0}],[10,{id:10,text:"Compiling Content",toDo:0,done:0}],[11,{id:11,text:"Compiling Views",toDo:0,done:0}],[12,{id:12,text:"Finalize",toDo:1,done:0}]]),h=()=>{if(!TCHMI_DESIGNER){let t=E.get(i);if(!t)return;e.System.Services.splashScreen.updateVersionInfo("Version: "+e.version.full),e.System.Services.splashScreen.updateStageInfo("Stage "+(t.id+1)+" / "+E.size+": "+t.text),0===t.done&&0===t.toDo?e.System.Services.splashScreen.updateStageProgress(100):0===t.done&&t.toDo>0?e.System.Services.splashScreen.updateStageProgress(0):e.System.Services.splashScreen.updateStageProgress(t.done/t.toDo*100)}};!function r(){switch(e.System.Init.__initStep){case 1:break;case 2:{let t=[],o=["WebSocket","Map","WeakMap","MutationObserver","indexedDB","Set","Promise"];for(let e of o)e in window||t.push(e);let i=["find","includes"];for(let e of i)e in Array.prototype||t.push("Array.prototype."+e);Array.from||t.push("Array.from");let n=["startsWith","endsWith","includes"];for(let e of n)e in String.prototype||t.push("String.prototype."+e);if(document.head.classList){var S=document.createElement("div");S.classList.add("a","b"),"a b"!==S.className&&t.push("Element.classList.add with multiple arguments"),S.className="a",S.classList.toggle("a",!0),"a"!==S.className&&t.push("Element.classList.toggle with force")}else t.push("Element.classList");if(t.length>0)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Browser does not support required features: "+t.join(", ")+"."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Browser does not support required features: <ul><li>"+t.join("</li>\n<li>")+"</li></ul>",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();e.System.Init.__initStep=3}case 3:{e.System.Init.__initStep=1,e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.BASE_CONFIGURATION"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.BASE_CONFIGURATION"),g.BaseConfigLoaded=1;const t="Properties/tchmiconfig.json";let o=new XMLHttpRequest;o.open("GET",t+u);let i=function(t){if(200===o.status){if(1e4!==e.System.Init.__initStep){if(e.System.config=e.ValueConverter.toObject(o.responseText),TCHMI_UNITTEST_MODE)e.System.config||(e.System.config={basePath:""});else{if(!e.System.config)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Configuration: 'Properties/tchmiconfig.json' is not valid."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Configuration: 'Properties/tchmiconfig.json' is not valid.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();{let t=0;for(let r in e.System.config)"__COMMENT"!==r.substr(0,9)&&t++;if(0===t)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Configuration: 'Properties/tchmiconfig.json' is not valid. Content was not generated from 'tchmiconfig.tpl.json'."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Configuration: 'Properties/tchmiconfig.json' is not valid. Content was not generated from 'tchmiconfig.tpl.json'.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r()}}if(e.System.config.creatorSettings?e.System.config.creatorSettings.viewport||(e.System.config.creatorSettings.viewport={defaultHeight:0,defaultWidth:0}):e.System.config.creatorSettings={viewport:{defaultHeight:0,defaultWidth:0}},e.System.config.userFunctions||(e.System.config.userFunctions=[]),e.System.config.userFunctions){n=e.System.config.userFunctions;for(let e=0;e<n.length;e++)n[e].url=tchmi_path(n[e].url)}if(e.System.config.userControls||(e.System.config.userControls=[]),e.System.config.userControls){s=e.System.config.userControls,E.get(7).toDo+=2*s.length;for(let e=0;e<s.length;e++)s[e].url=tchmi_path(s[e].url)}if(e.System.config.content||(e.System.config.content=[]),e.System.config.content){c=e.System.config.content,g.ContentCompiled=c.length;for(let t=0;t<c.length;t++)c[t].url=tchmi_path(c[t].url),!0===c[t].preload&&(E.get(8).toDo++,E.get(10).toDo++,c[t].keepAlive=!0),void 0===c[t].keepAlive&&(c[t].keepAlive=!1),!0!==c[t].keepAlive||TCHMI_DESIGNER?e.System.Data.isKeepAlivePartial.set(c[t].url,!1):e.System.Data.isKeepAlivePartial.set(c[t].url,!0)}if(e.System.config.views||(e.System.config.views=[]),e.System.config.views){l=e.System.config.views,g.ViewCompiled=l.length;for(let t=0;t<l.length;t++)l[t].url=tchmi_path(l[t].url),!0===l[t].preload&&(E.get(9).toDo++,E.get(11).toDo++,l[t].keepAlive=!0),void 0===l[t].keepAlive&&(l[t].keepAlive=!1),!0===l[t].keepAlive?e.System.Data.isKeepAlivePartial.set(l[t].url,!0):e.System.Data.isKeepAlivePartial.set(l[t].url,!1)}if(e.System.config.packages&&e.System.config.packages.length>0&&(g.PackageLoaded=e.System.config.packages.length,E.get(2).toDo=e.System.config.packages.length),e.System.config.tcHmiServer||(e.System.config.tcHmiServer={}),e.System.config.tcHmiServer.websocketIntervalTime||(e.System.config.tcHmiServer.websocketIntervalTime=500),e.System.config.tcHmiServer.websocketTimeout||(e.System.config.tcHmiServer.websocketTimeout=6e4),e.System.config.tcHmiServer.websocketSystemTimeout||(e.System.config.tcHmiServer.websocketSystemTimeout=6e4),TCHMI_DESIGNER){const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=tchmi_path(e.System.config.basePath+"/StyleEngineering.css"),document.head.appendChild(t)}if(!0===TCHMI_ENGINEERING){const t=TCHMI_CONFIG_OVERRIDE;null!==t&&(void 0!==t.basePath&&(e.System.config.basePath=t.basePath),t.tcHmiServer&&t.tcHmiServer.websocketIntervalTime&&(e.System.config.tcHmiServer.websocketIntervalTime=t.tcHmiServer.websocketIntervalTime))}TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] Loading Properties/tchmiconfig.json finished."),g.BaseConfigLoaded--,0===g.BaseConfigLoaded&&(e.System.Init.__initStep=4,TCHMI_DESIGNER?r():setTimeout(()=>{r()}))}}else d(t)},d=function(t){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading Properties/tchmiconfig.json failed! Detail: "+o.statusText),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading base config Properties/tchmiconfig.json failed! "+o.statusText,e.DialogManager.DialogSeverity.Error),1e4!==e.System.Init.__initStep&&(e.System.Init.__initStep=1e4,TCHMI_DESIGNER?r():setTimeout(()=>{r()}))};o.addEventListener("load",i),o.addEventListener("error",d),o.send()}break;case 4:{e.System.Init.__initStep=1,e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.BASE_DESCRIPTION"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.BASE_DESCRIPTION"),g.BaseDescriptionLoaded=1;const t=tchmi_path(e.System.config.basePath+"/Description.json");let o=new XMLHttpRequest;o.open("GET",t+u);let i=function(i){if(200===o.status){if(1e4!==e.System.Init.__initStep){if(e.System.description=e.ValueConverter.toObject(o.responseText),!e.System.description||!e.System.description.version)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+t+" failed! File not a valid FrameworkDescription JSON: "+o.responseText),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading Framework "+t+" failed! File not a valid FrameworkDescription JSON.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();e.version=e.System.description.version,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] TcHmi.version.full: "+e.version.full),g.BaseDescriptionLoaded--,0===g.BaseDescriptionLoaded&&(e.System.Init.__initStep=5,TCHMI_DESIGNER?r():setTimeout(()=>{r()}))}}else n(i)},n=function(i){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+t+" failed! Detail: "+o.statusText),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading Framework "+t+" failed! "+o.statusText,e.DialogManager.DialogSeverity.Error),1e4!==e.System.Init.__initStep&&(e.System.Init.__initStep=1e4,r())};o.addEventListener("load",i),o.addEventListener("error",n),o.send()}break;case 5:if(!document.body)return void setTimeout(()=>{e.System.Init.__initStep=5,r()},25);if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.THEME_MANAGER_EARLY"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.THEME_MANAGER_EARLY"),e.System.Init.__initStep=1,e.System.Services.themeManager)throw TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Duplicate Framework code running! Please fix JS inclusion. Aborting."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Duplicate Framework code running! Please fix JS inclusion. Aborting.",e.DialogManager.DialogSeverity.Error),new Error("Duplicate Framework code running");e.System.Services.themeManager=new t.ThemeManager,e.System.Services.themeManager.processActiveTheme(()=>{if(E.get(i).done++,TCHMI_DESIGNER)return e.System.Init.__initStep=6,void r();window.requestAnimationFrame(()=>{e.System.Services.splashScreen.show(),h(),setTimeout(()=>{e.System.Init.__initStep=6,i=1,h(),setTimeout(()=>{r()})})})});break;case 6:{let i=null;e.System.buildtime&&(i=window.localStorage.getItem("TcHmi.Init.cachedBuildtime"));const n=["controlTemplate","contentMarkup","userControlMarkup","userControlConfig","userFunctionConfig"];o=window.indexedDB.open("TcHmi.Init"),o.onerror=event=>{event.target.error.name,e.System.Init.__initStep=7,r()},o.onupgradeneeded=event=>{try{n.forEach(name=>{if(o.result.objectStoreNames.contains(name))try{o.result.deleteObjectStore(name)}catch(e){}o.result.createObjectStore(name)}),i=e.System.buildtime,window.localStorage.setItem("TcHmi.Init.cachedBuildtime",i)}catch(e){}},o.onsuccess=event=>{if(!TCHMI_DESIGNER&&e.System.buildtime){let r=!1;if(o.result.objectStoreNames.length!==n.length?r=!0:n.forEach(name=>{!r&&o.result.objectStoreNames.contains(name)||(r=!0)}),i!==e.System.buildtime||r||e.System.config.disableLoadingOptimization)try{r?(window.localStorage.removeItem("TcHmi.Init.cachedBuildtime"),window.indexedDB.deleteDatabase("TcHmi.Init")):(n.forEach(name=>{o.result.transaction(name,"readwrite").objectStore(name).clear()}),i=e.System.buildtime,window.localStorage.setItem("TcHmi.Init.cachedBuildtime",i))}catch(e){}else{let r=o.result.transaction(n,"readonly");r.objectStore("controlTemplate").openCursor().onsuccess=event=>{let t=event.target.result;t&&(e.System.Data.Caches.templateMarkupCache.set(t.key,t.value),t.continue())},r.objectStore("userControlMarkup").openCursor().onsuccess=event=>{let e=event.target.result;e&&(t.Data.Caches.partialMarkupCache.set(e.key,{markup:e.value}),e.continue())},r.objectStore("userControlConfig").openCursor().onsuccess=event=>{let t=event.target.result;t&&(e.System.Data.Caches.partialCompositeConfigCache.set(t.key,t.value),t.continue())},r.objectStore("contentMarkup").openCursor().onsuccess=event=>{let e=event.target.result;e&&(t.Data.Caches.partialMarkupCache.set(e.key,{markup:e.value}),e.continue())},r.objectStore("userFunctionConfig").openCursor().onsuccess=event=>{let t=event.target.result;if(t){let r=e.System.Data.Registrations.functions.map.get(t.value.name);if(!(r&&r.error!==e.Errors.E_NOT_UNIQUE||(r=e.System.Data.Registrations.functions.map.get(t.value.qname),r&&r.error===e.Errors.NONE)))return void t.continue();let o={error:e.Errors.NONE,reg:r,description:t.value.descr};e.System.Data.Modules.functions.map.set(t.value.name,o),t.value.name!==t.value.qname&&e.System.Data.Modules.functions.map.set(t.value.qname,o),m.push(t.key),t.continue()}}}}},e.System.Init.__initStep=7}case 7:if(e.System.Init.__initStep=1,e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.SYSTEM_PREPARATION"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.SYSTEM_PREPARATION"),"3.5.1"!==$().jquery)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Mismatching jQuery version. Please avoid overriding built in jQuery version."),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Mismatching jQuery version. Please avoid overriding.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();if(!document.body)return void setTimeout(()=>{e.System.Init.__initStep=7,r()},25);try{e.System.Services.internalSymbolManager=new t.InternalSymbolManager,e.System.Services.templateParamSymbolManager=new t.TemplateParamSymbolManager,e.System.Services.bindingManager=new t.BindingManager,e.System.Services.localizationManager=new t.LocalizationManager,e.System.Services.serverManager=new t.ServerManager,e.System.Services.triggerManager=new t.TriggerManager,e.System.Services.accessManager=new t.AccessManager,e.System.Services.topMostLayer=new t.TopMostLayer,e.System.Services.serverEventManager=new t.ServerEventManager,e.System.Services.controlManager=new t.ControlManager,e.System.Services.styleManager=new t.StyleManager,e.System.Services.typeManager=new t.Type.TypeManager,e.System.Services.animationProvider=new t.AnimationProvider,e.System.Services.viewManager=new t.ViewManager,!0===TCHMI_ENGINEERING&&(e.System.Services.Engineering.designerModeManager=new t.Engineering.DesignerModeManager,e.System.Services.Engineering.designerModeComManager=new t.Engineering.DesignerModeComManager,e.System.Services.Engineering.errorPane=new t.Engineering.ErrorPane)}catch(t){return e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: Initializing a service failed: "+t.message,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r()}if(!0===TCHMI_DESIGNER){const t=TCHMI_CONFIG_OVERRIDE;null!==t&&void 0!==t.tcHmiServer&&t.tcHmiServer.websocketOverwrite&&e.System.Services.serverManager.setServerAddress(t.tcHmiServer.websocketOverwrite.host,t.tcHmiServer.websocketOverwrite.port)}if(e.System.config.symbols&&e.System.config.symbols.internal)for(let t in e.System.config.symbols.internal)e.System.Services.internalSymbolManager.add(t,e.System.config.symbols.internal[t]);e.EventProvider.raise("System.onInitializedServices"),TCHMI_DESIGNER?(e.System.Init.__initStep=8,i=2,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=8,i=2,h(),setTimeout(()=>{r()})}));break;case 8:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.PACKAGES_MANIFEST_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.PACKAGES_MANIFEST_LOAD"),e.System.Init.__initStep=1,e.System.config.packages&&e.System.config.packages.length>0){const t=function(t){const o=tchmi_path(t.basePath+"/Manifest.json");let n=new XMLHttpRequest;n.open("GET",o+u);let s=function(s){1e4!==e.System.Init.__initStep&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load package: '"+t.name+"' from 'Properties/tchmiconfig.json'. Missing 'Manifest.json'. Expected path: '"+o+"'. Details: "+n.statusText),g.PackageLoaded--,E.get(i).done++,h(),g.PackageLoaded<=0&&(e.System.Init.__initStep=9,i=3,TCHMI_DESIGNER?r():(h(),setTimeout(()=>{r()}))))};n.addEventListener("load",(function(l){if(200!==n.status)return void s(l);if(1e4===e.System.Init.__initStep)return;let c=e.ValueConverter.toObject(n.responseText);if(c&&c.modules){let r={name:t.name,basePath:t.basePath,manifest:c};if(e.System.Data.packages.has(r.name))TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Found duplicate entry in Properties/tchmiconfig.json#package "+r.name+" Skipping entry.");else if(e.System.Data.packages.set(r.name,r),c.modules.length>0)for(let e=0,t=c.modules.length;e<t;e++){let t=c.modules[e];t&&"Control"===t.type?d.push({package:r,module:t}):t&&"Function"===t.type&&_.push({package:r,module:t})}TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] Loading "+o+" finished!")}else TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load package: '"+t.name+"' from 'Properties/tchmiconfig.json'. Response returns no valid 'Manifest.json' content. Details: "+n.responseText);g.PackageLoaded--,E.get(i).done++,h(),g.PackageLoaded<=0&&(c=null,e.System.Init.__initStep=9,i=3,TCHMI_DESIGNER?r():(h(),setTimeout(()=>{r()})))})),n.addEventListener("error",s),n.send()};for(let r=0,o=e.System.config.packages.length;r<o;r++){t(e.System.config.packages[r])}}else TCHMI_DESIGNER?(e.System.Init.__initStep=9,i=3,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=9,i=3,h(),setTimeout(()=>{r()})}));break;case 9:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.OPEN_ENGINEERING_CONNECTION"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.OPEN_ENGINEERING_CONNECTION"),!TCHMI_ENGINEERING)return e.System.Init.__initStep=10,i=3,void r();e.System.Init.__initStep=1,g.OpenEngineeringConnection=1,e.System.Services.Engineering.designerModeComManager.open(t=>{0!==g.OpenEngineeringConnection&&1e4!==e.System.Init.__initStep&&(t.error===e.Errors.NONE?(g.OpenEngineeringConnection=0,e.System.Init.__initStep=10,i=3,r()):(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Communication to TwinCAT HMI Creator failed: "+e.Log.buildMessage(t.details)),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),TCHMI_DESIGNER?e.System.Services.dialogManager.updateText("__TcHmiMain","Error: Communication to TwinCAT HMI Creator failed: "+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+"<br/>\n<br/>\nPlease try to close and reopen the designer window.",e.DialogManager.DialogSeverity.Error):e.System.Services.dialogManager.updateText("__TcHmiMain","Error: Communication to TwinCAT HMI Creator failed: "+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error),g.OpenEngineeringConnection=0,e.System.Init.__initStep=1e4,r()))});break;case 10:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.OPEN_SERVER_CONNECTION"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.OPEN_SERVER_CONNECTION"),e.System.Init.__initStep=1,g.OpenServerConnection=1,e.System.Services.serverManager.open(t=>{if(0!==g.OpenServerConnection&&1e4!==e.System.Init.__initStep)if(E.get(i).done++,h(),t.error===e.Errors.NONE)g.OpenServerConnection=0,e.System.Init.__initStep=11,i=4,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})});else{if(t.error===e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_CHECK_FAILED)TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to check TwinCAT HMI Server license: "+e.Log.buildMessage(t.details)),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: Communication to TwinCAT HMI Server failed:<br>\n"+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error);else if(t.error===e.Errors.E_SERVER_COMMAND_ERROR)TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] TwinCAT HMI Server license symbol invalid: "+e.Log.buildMessage(t.details)),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: Communication to TwinCAT HMI Server failed (System-Symbols mapped?):<br>\n"+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error);else if(t.error===e.Errors.E_WEBSOCKET_OPEN_SERVER_LICENSE_MISSING)TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] TwinCAT HMI Server license is missing: "+e.Log.buildMessage(t.details)),TCHMI_DESIGNER?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: TwinCAT HMI Server license is missing. Please reopen window.",e.DialogManager.DialogSeverity.Error)):(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: TwinCAT HMI Server license is missing:<br>\n"+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error));else if(t.error===e.Errors.E_WEBSOCKET_OPEN_SERVER_NO_ACCESS)e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Error: TwinCAT HMI Server denied access because of missing rights. This session was logged out or the server is misconfigured. Autoreload in 5 seconds.<br>\n"+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<input type="submit" value="Reload now" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error),window.setTimeout((function(){window.location.reload()}),5e3);else if(!0===TCHMI_DESIGNER)TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Opening connection to engineering server failed: "+e.Log.buildMessage(t.details)),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Opening connection to engineering server failed.<br>Please start the server from the context menu in the project tree.<br>\n"+e.DialogManager.__buildFirstDeepestErrorMessage(t.details)+'<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',e.DialogManager.DialogSeverity.Error);else{const r=t.url&&-1===t.url.indexOf(window.location.host);let o="Opening";"https:"===window.location.protocol&&(o+=" secure"),o+=" Websocket connection failed.",o+=" Perhaps";const i=[];"https:"===window.location.protocol&&i.push(" the HTTPS server certificate is not trusted for websocket (missing trust always)"),t.url&&!0===r&&i.push(" the server "+t.url+" is no working websocket server"),i.push(" we have a proxy problem"),o+=i.join(" or"),o+='. The browser console could have some more information.<br>\n<input type="submit" value="Retry" style="padding:10px;" onclick="window.location.reload()">',TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Opening connection to engineering server failed: "+e.Log.buildMessage(t.details)),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain",o,e.DialogManager.DialogSeverity.Error)}e.System.Init.__initStep=1e4,r()}});break;case 11:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.TYPEDEFINITIONS"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.TYPEDEFINITIONS"),e.System.Init.__initStep=1,g.TypeDefinitionsResolved=1,t.Services.typeManager.doWatchSchemaDefinitions((function(data){if(data.error===e.Errors.NONE)g.TypeDefinitionsResolved=0,TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] Resolving type definitions finished."),e.System.Init.__initStep=12;else{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Resolving type definitions failed: "+e.Log.buildMessage(data.details));let message="Resolving type definitions failed: "+e.Log.__buildFirstDeepestErrorMessage(data.details);e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain",message,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4}r()}));break;case 12:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.SERVER_SYMBOL_SCHEMA_CACHE"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.SERVER_SYMBOL_SCHEMA_CACHE"),e.System.Init.__initStep=1,g.ServerSymbolSchemaCacheResolved=1,t.Symbol.resolveServerSymbolSchemaCache((function(data){if(E.get(i).done++,h(),data.error===e.Errors.NONE)g.ServerSymbolSchemaCacheResolved=0,TCHMI_DESIGNER?(e.System.Init.__initStep=13,i=5,r()):setTimeout(()=>{e.System.Init.__initStep=13,i=5,h(),setTimeout(()=>{r()})});else{TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Resolving server symbol schema cache failed: "+e.Log.buildMessage(data.details));let message="Resolving server symbol schema cache failed: "+e.Log.__buildFirstDeepestErrorMessage(data.details);e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain",message,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()}}));break;case 13:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_DESCRIPTION_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_DESCRIPTION_LOAD"),e.System.Init.__initStep=1,d&&d.length>0){g.ControlsDescriptionLoaded=d.length;const o=function(o){o.module.basePath||(o.module.basePath="");const i=tchmi_path(o.package.basePath+"/"+o.module.basePath+"/"+o.module.descriptionFile);let n=new XMLHttpRequest;n.open("GET",i+u);let s=function(t){1e4!==e.System.Init.__initStep&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load control description: '"+i+"'. Related control type will not be available. Details: Status: "+n.status+", StatusText: "+n.statusText+"."),g.ControlsDescriptionLoaded--,g.ControlsDescriptionLoaded<=0&&(e.System.Init.__initStep=14,TCHMI_DESIGNER?r():setTimeout(()=>{r()})))};n.addEventListener("load",(function(l){if(200!==n.status)return void s(l);if(1e4===e.System.Init.__initStep)return;let c=e.ValueConverter.toObject(n.responseText);if(c&&1===o.package.manifest.apiVersion){let name=c.name;c.apiVersion||TCHMI_CONSOLE_LOG_LEVEL>=2&&e.Log.warn("[Source=Framework, Module=TcHmi] Package: '"+o.package.name+"': API Version mismatch. This may lead to consequential errors. Please contact the developer of the package. Control module: '"+name+"' has apiVersion: '0' but package has apiVersion: '1'. Do not mix TwinCAT HMI 1.10 and TwinCAT 1.12 and greater API modules in one package. If the package is designed to provide TwinCAT HMI 1.10 API controls the apiVersion of the Manifest.json has to be set to '0' if it's designed to provide TwinCAT HMI 1.12 api logic remove the TwinCAT HMI 1.10 API control or set the apiVersion in Description.json to '1' if the control is designed based on TwinCAT HMI 1.12 API.");let r,namespace=c.namespace;namespace&&(r=e.System.resolveQualifiedName(name,namespace));let n=e.System.Data.Registrations.controls.map.get(name);if(n&&n.error!==e.Errors.E_NOT_UNIQUE||!r||(n=e.System.Data.Registrations.controls.map.get(r)),n){let s={error:e.Errors.NONE,manifestData:o.module,package:o.package,reg:n,description:c,descriptionExpanded:tchmi_clone_object(c)};if(s.descriptionExpanded.inheritationResolved=!1,e.System.Data.Modules.controls.array.push(s),e.System.Data.Modules.controls.map.has(name)?(e.System.Data.Modules.controls.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:'Ambiguous module definitions for the name: "'+name+'". Please try fully qualified name.'}}),e.System.Data.Modules.controls.urlMap.delete(i)):(e.System.Data.Modules.controls.map.set(name,s),e.System.Data.Modules.controls.urlMap.set(i,s)),r&&(e.System.Data.Modules.controls.map.has(r)?(e.System.Data.Modules.controls.map.set(r,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:"Multiple module definitions with the name "+r+" found."}}),e.System.Data.Modules.controls.urlMap.delete(i)):(e.System.Data.Modules.controls.map.set(r,s),e.System.Data.Modules.controls.urlMap.set(i,s))),r&&e.System.mapControlNamesFromPackageManifestApi1ToApi0.has(r)){let t=e.System.mapControlNamesFromPackageManifestApi1ToApi0.get(r);e.System.Data.Modules.controls.map.has(t)?e.System.Data.Modules.controls.map.set(t,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:"Multiple module definitions with the name "+t+" found."}}):e.System.Data.Modules.controls.map.set(t,s)}t.Services.themeManager.registerControlThemeFiles(c)}else n?n.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Registration of control type '"+r+"' is not valid and will therefore not be available. Details: "+e.Log.buildMessage(n.errorDetails)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Control type '"+r+"' is not registered and will therefore not be available.\nPossible reason/s:\n- Related source file contains a call to 'TcHmi.Controls.registerEx' or 'TcHmi.Controls.register' (deprecated) with name and/or namespace not matching the definition in control description file: '"+i+"'.\n- Related source file contains no call to 'TcHmi.Controls.registerEx' or 'TcHmi.Controls.register' (deprecated).\n- Related source file is not included in html document.\n- Related source file is not included in required order in html document.\n")}else if(c){let name=c.name,r=e.System.Data.Registrations.controls.map.get(name);if(r){if(r.directory&&r.template){let e=tchmi_path(r.template),t=tchmi_path(r.directory);e.indexOf(t)>=-1&&(c.template=e.replace(t,""))}let n={error:e.Errors.NONE,manifestData:o.module,package:o.package,reg:r,description:c,descriptionExpanded:tchmi_clone_object(c)};n.descriptionExpanded.inheritationResolved=!1,e.System.Data.Modules.controls.array.push(n),e.System.Data.Modules.controls.map.has(name)?(e.System.Data.Modules.controls.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:'Ambiguous module definitions for the name: "'+name+'". Please try fully qualified name.'}}),e.System.Data.Modules.controls.urlMap.delete(i)):(e.System.Data.Modules.controls.map.set(name,n),e.System.Data.Modules.controls.urlMap.set(i,n)),t.Services.themeManager.registerControlThemeFiles(c)}else r?r.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Registration of control type '"+name+"' is not valid and will therefore not be available. Details: "+e.Log.buildMessage(r.errorDetails)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Control type '"+name+"' is not registered and will therefore not be available.\nPossible reason/s:\n- Related source file contains a call to 'TcHmi.Controls.registerEx' or 'TcHmi.Controls.register' (deprecated) with name and/or namespace not matching the definition in control description file: '"+i+"'.\n- Related source file contains no call to 'TcHmi.Controls.registerEx' or 'TcHmi.Controls.register' (deprecated).\n- Related source file is not included in html document.\n- Related source file is not included in required order in html document.\n")}else if(!c)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+i+" failed! File is not a valid Control Description JSON: "+n.responseText),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Failed to load valid Description.json of "+o.package.name+". Response is no valid Manifest JSON.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}));g.ControlsDescriptionLoaded--,g.ControlsDescriptionLoaded<=0&&(c=null,e.System.Init.__initStep=14,TCHMI_DESIGNER?r():setTimeout(()=>{r()}))})),n.addEventListener("error",s),n.send()};for(let e=0,t=d.length;e<t;e++){o(d[e])}break}e.System.Init.__initStep=15,TCHMI_DESIGNER?r():setTimeout(()=>{r()});break;case 14:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_DESCRIPTION_RESOLVE"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_DESCRIPTION_RESOLVE"),e.System.Init.__initStep=1,g.ControlsDescriptionResolved=1;try{e.System.Services.controlManager.resolveDescriptionInheritation()}catch(t){return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(t),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Resolving control description inheritation failed!",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r()}g.ControlsDescriptionResolved=0,e.System.Init.__initStep=15,TCHMI_DESIGNER?r():setTimeout(()=>{r()});break;case 15:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.THEME_MANAGER_FINAL"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.THEME_MANAGER_FINAL"),e.System.Init.__initStep=1,e.System.Services.themeManager.processActiveTheme(),e.System.Init.__initStep=16,TCHMI_DESIGNER?r():setTimeout(()=>{r()});break;case 16:{e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_TEMPLATES_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.CONTROLS_TEMPLATES_LOAD"),e.System.Init.__initStep=1;let n=[];if(e.System.Data.Modules.controls.array.forEach((e,t)=>{e.descriptionExpanded&&e.descriptionExpanded.inheritedTemplate&&!n.includes(e.descriptionExpanded.inheritedTemplate)&&n.push(e.descriptionExpanded.inheritedTemplate)}),g.ControlsTemplatesLoaded=n.length,n&&n.length>0){const s=function(url){let n=new XMLHttpRequest;n.open("GET",url+u);let s=function(t){1e4!==e.System.Init.__initStep&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed! Detail: "+n.statusText),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed! "+n.statusText,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r())};n.addEventListener("load",(function(l){200===n.status?1e4!==e.System.Init.__initStep&&(t.Data.Caches.templateMarkupCache.set(url,n.responseText),!TCHMI_DESIGNER&&"done"===o.readyState&&o.result&&o.result.objectStoreNames&&o.result.objectStoreNames.contains("controlTemplate")&&o.result.transaction("controlTemplate","readwrite").objectStore("controlTemplate").put(n.responseText,url),g.ControlsTemplatesLoaded--,g.ControlsTemplatesLoaded<=0&&(E.get(i).done++,h(),TCHMI_DESIGNER?(e.System.Init.__initStep=17,i=6,r()):setTimeout(()=>{e.System.Init.__initStep=17,i=6,h(),setTimeout(()=>{r()})}))):s(l)})),n.addEventListener("error",s),n.send()};for(let t=0,r=n.length;t<r;t++){const r=n[t];e.System.Data.Caches.templateMarkupCache.has(r)?g.ControlsTemplatesLoaded--:s(r)}}g.ControlsTemplatesLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=17,i=6,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=17,i=6,h(),setTimeout(()=>{r()})})))}break;case 17:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.PACKAGES_FUNCTION_DESCRIPTION_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.PACKAGES_FUNCTION_DESCRIPTION_LOAD"),e.System.Init.__initStep=1,_&&_.length>0){g.PackagesFunctionDescriptionLoaded=_.length,e.Log.performanceLog("[Source=Framework, Module=TcHmi] Loading and processing "+g.PackagesFunctionDescriptionLoaded+" package function description files");const t=function(t){if(t.module.basePath||(t.module.basePath=""),!t.module.descriptionFile)return g.PackagesFunctionDescriptionLoaded--,g.PackagesFunctionDescriptionLoaded<=0?(e.System.Init.__initStep=18,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}))):void 0;const o=tchmi_path(t.package.basePath+"/"+t.module.basePath+"/"+t.module.descriptionFile);let i=new XMLHttpRequest;i.open("GET",o+u);let n=function(t){if(1e4!==e.System.Init.__initStep)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load function description: '"+o+"'. Related functions will not be available. Details: Status: "+i.status+", StatusText: "+i.statusText+"."),g.PackagesFunctionDescriptionLoaded--,g.PackagesFunctionDescriptionLoaded<=0?(e.System.Init.__initStep=18,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}))):void 0};i.addEventListener("load",(function(s){if(200!==i.status)return void n(s);if(1e4===e.System.Init.__initStep)return;let l=e.ValueConverter.toObject(i.responseText);if(!l||!l.function)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load function description: '"+o+"'. Related functions will not be available. Response is no valid function JSON: \n"+i.responseText),g.PackagesFunctionDescriptionLoaded--,g.PackagesFunctionDescriptionLoaded<=0?(e.System.Init.__initStep=18,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}))):void 0;let name=l.function.name,namespace=l.function.namespace,c=e.System.resolveQualifiedName(name,namespace),d=e.System.Data.Registrations.functions.map.get(name);if(d&&d.error!==e.Errors.E_NOT_UNIQUE||(d=e.System.Data.Registrations.functions.map.get(c)),d&&d.error===e.Errors.NONE){let r={error:e.Errors.NONE,manifestData:t.module,package:t.package,reg:d,description:l};e.System.Data.Modules.functions.map.has(name)?e.System.Data.Modules.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:'Ambiguous module definitions for the name: "'+name+'". Please try fully qualified name.'}}):e.System.Data.Modules.functions.map.set(name,r),c!==name&&(e.System.Data.Modules.functions.map.has(c)?e.System.Data.Modules.functions.map.set(c,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:"Multiple module definitions with the name "+c+" found."}}):e.System.Data.Modules.functions.map.set(c,r)),e.System.Functions.checkDescription(l)}else d?d.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Registration of function '"+c+"' is not valid and function will therefore not be available. Details: "+e.Log.buildMessage(d.errorDetails)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Function '"+c+"' is not registered and will therefore not be available.\nPossible reason/s:\n- Source file: '"+o.replace(".function.json",".js")+"' contains a call to 'TcHmi.Functions.registerFunctionEx', 'TcHmi.Functions.registerFunction' (deprecated) or 'TcHmi.Functions.registerFrameworkFunction' (deprecated) with name and/or namespace not matching the definition in function description file: '"+o+"'.\n- Source file: '"+o.replace(".function.json",".js")+"' contains no call to 'TcHmi.Functions.registerFunctionEx', 'TcHmi.Functions.registerFunction' (deprecated) or 'TcHmi.Functions.registerFrameworkFunction' (deprecated).\n- Source file: '"+o.replace(".function.json",".js")+"' is not included in html document.\n");return g.PackagesFunctionDescriptionLoaded--,g.PackagesFunctionDescriptionLoaded<=0?(e.System.Init.__initStep=18,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}))):void 0})),i.addEventListener("error",n),i.send()};for(let e=0,r=_.length;e<r;e++)t(_[e]);break}e.System.Init.__initStep=18,TCHMI_DESIGNER?r():setTimeout(()=>{r()});break;case 18:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.USER_FUNCTION_DESCRIPTION_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.USER_FUNCTION_DESCRIPTION_LOAD"),e.System.Init.__initStep=1,g.UserFunctionDescriptionLoaded=n.length,n&&n.length>0){const t=function(url){const t=tchmi_path(url);let n=new XMLHttpRequest;n.open("GET",url+u);let s=function(o){TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load function description: '"+t+"'. Related functions will not be available. Details: Status: "+n.status+", StatusText: "+n.statusText+"."),g.UserFunctionDescriptionLoaded--,g.UserFunctionDescriptionLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=19,i=7,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=19,i=7,h(),setTimeout(()=>{r()})})))};n.addEventListener("load",(function(l){if(200!==n.status)return void s(l);let c=e.ValueConverter.toObject(n.responseText);if(!c||!c.function)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load function description: '"+t+"'. Related functions will not be available. Response is no valid function JSON: \n"+n.responseText),g.UserFunctionDescriptionLoaded--,g.UserFunctionDescriptionLoaded<=0?(e.System.Init.__initStep=19,void(TCHMI_DESIGNER?r():setTimeout(()=>{r()}))):void 0;let name=c.function.name,namespace=c.function.namespace,d=e.System.resolveQualifiedName(name,namespace),_=e.System.Data.Registrations.functions.map.get(name);if(_&&_.error!==e.Errors.E_NOT_UNIQUE||(_=e.System.Data.Registrations.functions.map.get(d)),_&&_.error===e.Errors.NONE){let t={error:e.Errors.NONE,reg:_,description:c};e.System.Data.Modules.functions.map.has(name)?e.System.Data.Modules.functions.map.set(name,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:'Ambiguous module definitions for the name: "'+name+'". Please try fully qualified name.'}}):(e.System.Data.Modules.functions.map.set(name,t),!TCHMI_DESIGNER&&"done"===o.readyState&&o.result&&o.result.objectStoreNames&&o.result.objectStoreNames.contains("userFunctionConfig")&&o.result.transaction("userFunctionConfig","readwrite").objectStore("userFunctionConfig").put({descr:c,name:name,qname:d},url)),d!==name&&(e.System.Data.Modules.functions.map.has(d)?e.System.Data.Modules.functions.map.set(d,{error:e.Errors.E_NOT_UNIQUE,errorDetails:{code:e.Errors.E_NOT_UNIQUE,message:e.Errors[e.Errors.E_NOT_UNIQUE],domain:"TcHmi",reason:"Multiple module definitions with the name "+d+" found."}}):e.System.Data.Modules.functions.map.set(d,t)),e.System.Functions.checkDescription(c)}else _?_.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Registration of function '"+d+"' is not valid and function will therefore not be available. Details: "+e.Log.buildMessage(_.errorDetails)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Function '"+d+"' is not registered and will therefore not be available.\nPossible reason/s:\n- Source file: '"+t.replace(".function.json",".js")+"' contains a call to 'TcHmi.Functions.registerFunctionEx', 'TcHmi.Functions.registerFunction' (deprecated) or 'TcHmi.Functions.registerFrameworkFunction' (deprecated) with name and/or namespace not matching the definition in function description file: '"+url+"'.\n- Source file: '"+t.replace(".function.json",".js")+"' contains no call to 'TcHmi.Functions.registerFunctionEx', 'TcHmi.Functions.registerFunction' (deprecated) or 'TcHmi.Functions.registerFrameworkFunction' (deprecated).\n- Source file: '"+t.replace(".function.json",".js")+"' is not included in html document.\n");g.UserFunctionDescriptionLoaded--,g.UserFunctionDescriptionLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=19,i=7,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=19,i=7,h(),setTimeout(()=>{r()})})))})),n.addEventListener("error",s),n.send()};for(const e of n){let url=e.url.replace(".js",".function.json");m.includes(url)?g.UserFunctionDescriptionLoaded--:t(url)}}g.UserFunctionDescriptionLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=19,i=7,r()):(E.get(i).done++,h(),setTimeout(()=>{e.System.Init.__initStep=19,i=7,h(),setTimeout(()=>{r()})})));break;case 19:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.USERCONTROL_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.USERCONTROL_LOAD"),e.System.Init.__initStep=1,s&&s.length>0){g.UserControlsLoaded=2*s.length;const n=function(url){if(TCHMI_ENGINEERING)e.System.Services.Engineering.designerModeManager.partialContentManager.requestCurrentPartialContent(url,data=>{if(data.error===e.Errors.NONE){if(1e4===e.System.Init.__initStep)return;t.Data.Caches.partialMarkupCache.set(url,{markup:data.content}),E.get(i).done++,g.UserControlsLoaded--,h(),g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),TCHMI_DESIGNER?(e.System.Init.__initStep=20,i=8,r()):setTimeout(()=>{e.System.Init.__initStep=20,i=8,h(),setTimeout(()=>{r()})}))}else{if(1e4===e.System.Init.__initStep)return;TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+e.Log.buildMessage(data.details)),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()):(E.get(i).done++,g.UserControlsLoaded--,g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),TCHMI_DESIGNER?(e.System.Init.__initStep=20,i=8,r()):setTimeout(()=>{e.System.Init.__initStep=20,i=8,h(),setTimeout(()=>{r()})})))}});else{let n=new XMLHttpRequest;n.open("GET",url+u);let s=function(s){200===n.status?1e4!==e.System.Init.__initStep&&(t.Data.Caches.partialMarkupCache.set(url,{markup:n.responseText}),!TCHMI_DESIGNER&&"done"===o.readyState&&o.result&&o.result.objectStoreNames&&o.result.objectStoreNames.contains("userControlMarkup")&&o.result.transaction("userControlMarkup","readwrite").objectStore("userControlMarkup").put(n.responseText,url),E.get(i).done++,g.UserControlsLoaded--,h(),g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),TCHMI_DESIGNER?(e.System.Init.__initStep=20,i=8,r()):setTimeout(()=>{e.System.Init.__initStep=20,i=8,h(),setTimeout(()=>{r()})}))):l(s)},l=function(t){1e4!==e.System.Init.__initStep&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+n.statusText),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed. Probably a syntax error in HTML or a wrong entry in Properties/tchmiconfig.json. "+n.statusText,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()):(g.UserControlsLoaded--,E.get(i).done++,h(),g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),TCHMI_DESIGNER?(e.System.Init.__initStep=20,i=8,r()):setTimeout(()=>{e.System.Init.__initStep=20,i=8,h(),setTimeout(()=>{r()})}))))};n.addEventListener("load",s),n.addEventListener("error",l),n.send()}},l=function(url){let t=new XMLHttpRequest;t.open("GET",url+u);let n=function(t){g.UserControlsLoaded--,g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),e.System.Init.__initStep=20,i=8,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))};t.addEventListener("load",(function(s){if(200!==t.status)return void n(s);let l=e.ValueConverter.toObject(t.responseText);l?(e.System.Data.Caches.partialCompositeConfigCache.set(url,l),!TCHMI_DESIGNER&&"done"===o.readyState&&o.result&&o.result.objectStoreNames&&o.result.objectStoreNames.contains("userControlConfig")&&o.result.transaction("userControlConfig","readwrite").objectStore("userControlConfig").put(l,url)):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Failed to load user control config: '"+url+"'. Response is no valid user control JSON: \n"+t.responseText),g.UserControlsLoaded--,E.get(i).done++,h(),g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),e.System.Init.__initStep=20,i=8,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))})),t.addEventListener("error",n),t.send()};for(const t of s){e.System.Data.Caches.partialMarkupCache.has(t.url)?(g.UserControlsLoaded--,E.get(i).done++):n(t.url);let r=t.url.replace(".usercontrol",".usercontrol.json");e.System.Data.Caches.partialCompositeConfigCache.has(r)?(g.UserControlsLoaded--,E.get(i).done++):l(r)}g.UserControlsLoaded<=0&&(e.System.Services.controlManager.resolveUcAttributes(),e.System.Services.themeManager.retriggerUserControls(),e.System.Init.__initStep=20,i=8,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))}else TCHMI_DESIGNER?(e.System.Init.__initStep=20,i=8,r()):(h(),setTimeout(()=>{e.System.Init.__initStep=20,i=8,h(),setTimeout(()=>{r()})}));break;case 20:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.CONTENT_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.CONTENT_LOAD"),e.System.Init.__initStep=1,g.ContentLoaded=c.length,c&&c.length>0){const n=function(url){if(TCHMI_ENGINEERING)e.System.Services.Engineering.designerModeManager.partialContentManager.requestCurrentPartialContent(url,data=>{if(data.error===e.Errors.NONE){if(1e4===e.System.Init.__initStep)return;t.Data.Caches.partialMarkupCache.set(url,{markup:data.content}),E.get(i).done++,g.ContentLoaded--,h(),g.ContentLoaded<=0&&(e.System.Init.__initStep=21,i=9,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))}else{if(1e4===e.System.Init.__initStep)return;TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+e.Log.buildMessage(data.details)),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()):(g.ContentLoaded--,g.ContentLoaded<=0&&(e.System.Init.__initStep=21,i=9,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})})))}});else{let n=new XMLHttpRequest;n.open("GET",url+u);let s=function(s){200===n.status?1e4!==e.System.Init.__initStep&&(t.Data.Caches.partialMarkupCache.set(url,{markup:n.responseText}),!TCHMI_DESIGNER&&"done"===o.readyState&&o.result&&o.result.objectStoreNames&&o.result.objectStoreNames.contains("contentMarkup")&&o.result.transaction("contentMarkup","readwrite").objectStore("contentMarkup").put(n.responseText,url),E.get(i).done++,g.ContentLoaded--,h(),g.ContentLoaded<=0&&(e.System.Init.__initStep=21,i=9,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))):l(s)},l=function(t){1e4!==e.System.Init.__initStep&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+n.statusText),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed. Probably a syntax error in HTML or a wrong entry in Properties/tchmiconfig.json. "+n.statusText,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()):(g.ContentLoaded--,g.ContentLoaded<=0&&(e.System.Init.__initStep=21,i=9,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))))};n.addEventListener("load",s),n.addEventListener("error",l),n.send()}};for(const e of c)!0!==e.preload||!0===TCHMI_DESIGNER||!0===TCHMI_ENGINEERING&&e.url===TCHMI_TARGET_PARTIAL?(TCHMI_DESIGNER||!0!==e.preload||!0!==e.preload||!0!==TCHMI_ENGINEERING||e.url!==TCHMI_TARGET_PARTIAL||(E.get(i).done++,h()),g.ContentLoaded--):t.Data.Caches.partialMarkupCache.has(e.url)?(E.get(i).done++,g.ContentLoaded--):n(e.url)}g.ContentLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=21,i=9,r()):(h(),setTimeout(()=>{e.System.Init.__initStep=21,i=9,h(),setTimeout(()=>{r()})})));break;case 21:if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.VIEW_LOAD"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.VIEW_LOAD"),e.System.Init.__initStep=1,g.ViewLoaded=l.length,l&&l.length>0){const o=function(url){if(TCHMI_ENGINEERING)e.System.Services.Engineering.designerModeManager.partialContentManager.requestCurrentPartialContent(url,data=>{if(data.error===e.Errors.NONE){if(1e4===e.System.Init.__initStep)return;t.Data.Caches.partialMarkupCache.set(url,{markup:data.content}),E.get(i).done++,g.ViewLoaded--,h(),g.ViewLoaded<=0&&(e.System.Init.__initStep=22,i=10,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))}else{if(1e4===e.System.Init.__initStep)return;TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+e.Log.buildMessage(data.details)),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,r()):(g.ViewLoaded--,g.ViewLoaded<=0&&(e.System.Init.__initStep=22,i=10,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})})))}});else{let o=new XMLHttpRequest;o.open("GET",url+u);let n=function(n){200===o.status?1e4!==e.System.Init.__initStep&&(t.Data.Caches.partialMarkupCache.set(url,{markup:o.responseText}),E.get(i).done++,g.ViewLoaded--,h(),g.ViewLoaded<=0&&(e.System.Init.__initStep=22,i=10,TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))):s(n)},s=function(t){if(1e4!==e.System.Init.__initStep)return TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Framework, Module=TcHmi] Loading "+url+" failed. Errordetail: "+o.statusText),url===TCHMI_TARGET_PARTIAL?(e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Loading "+url+" failed. Probably a syntax error in HTML or a wrong entry in Properties/tchmiconfig.json. "+o.statusText,e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r()):(g.ViewLoaded--,g.ViewLoaded<=0?(e.System.Init.__initStep=22,i=10,void(TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))):void 0)};o.addEventListener("load",n),o.addEventListener("error",s),o.send()}};for(const e of l)!0!==e.preload||!0===TCHMI_DESIGNER||!0===TCHMI_ENGINEERING&&e.url===TCHMI_TARGET_PARTIAL?(TCHMI_DESIGNER||!0!==TCHMI_ENGINEERING||!0!==e.preload||e.url!==TCHMI_TARGET_PARTIAL||(E.get(i).done++,h()),g.ViewLoaded--):o(e.url)}g.ViewLoaded<=0&&(TCHMI_DESIGNER?(e.System.Init.__initStep=22,i=10,r()):(h(),setTimeout(()=>{e.System.Init.__initStep=22,i=10,h(),setTimeout(()=>{r()})})));break;case 22:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.CONTENT_COMPILE"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.CONTENT_COMPILE"),e.System.Init.__initStep=1;for(let o of c)!0!==o.preload||!0===TCHMI_DESIGNER||!0===TCHMI_ENGINEERING&&o.url===TCHMI_TARGET_PARTIAL?(TCHMI_DESIGNER||!0!==o.preload||!0!==TCHMI_ENGINEERING||o.url!==TCHMI_TARGET_PARTIAL||(E.get(i).done++,h()),g.ContentCompiled--):function(o){setTimeout(()=>{const n=o.url;let s=t.Data.Caches.partialMarkupCache.get(n);if(s){let t=document.createElement("div");t.innerHTML=s.markup;let r=t.firstElementChild;if(r){s.partialId=r.id,r.setAttribute("data-tchmi-partial-url",n);let t=e.System.Services.controlManager.compile(r);void 0!==t&&t.__setKeepAlive(!0)}}if(g.ContentCompiled--,E.get(i).done++,h(),g.ContentCompiled<=0)return e.System.Init.__initStep=23,i=11,void(TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))})}(o);if(g.ContentCompiled<=0)return void(TCHMI_DESIGNER?(e.System.Init.__initStep=23,i=11,r()):(h(),setTimeout(()=>{e.System.Init.__initStep=23,i=11,h(),setTimeout(()=>{r()})})));break;case 23:e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.VIEW_COMPILE"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.VIEW_COMPILE"),e.System.Init.__initStep=1;for(let o of l)!0!==o.preload||!0===TCHMI_DESIGNER||!0===TCHMI_ENGINEERING&&o.url===TCHMI_TARGET_PARTIAL?(TCHMI_DESIGNER||!0!==o.preload||!0!==TCHMI_ENGINEERING||!0!==o.preload||o.url!==TCHMI_TARGET_PARTIAL||(E.get(i).done++,h()),g.ViewCompiled--):function(o){setTimeout(()=>{const n=o.url;let s=t.Data.Caches.partialMarkupCache.get(n);if(s){let t=document.createElement("div");t.innerHTML=s.markup;let r=t.firstElementChild;if(r){r.setAttribute("data-tchmi-partial-url",n),s.partialId=r.id;let t=e.System.Services.controlManager.compile(r);void 0!==t&&t.__setKeepAlive(!0),s=null}}if(g.ViewCompiled--,E.get(i).done++,h(),g.ViewCompiled<=0)return e.System.Init.__initStep=1e3,i=12,void(TCHMI_DESIGNER?r():setTimeout(()=>{h(),setTimeout(()=>{r()})}))})}(o);if(g.ViewCompiled<=0)return void(TCHMI_DESIGNER?(e.System.Init.__initStep=1e3,i=12,r()):(h(),setTimeout(()=>{e.System.Init.__initStep=1e3,i=12,h(),setTimeout(()=>{r()})})));break;case 1e3:{let t;if(e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.FINAL"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.FINAL"),e.System.Init.__initStep=1,e.System.Services.triggerManager&&e.System.config&&e.System.config.trigger&&e.System.Services.triggerManager.register(e.System.config.trigger),!0===TCHMI_ENGINEERING)t=tchmi_path(TCHMI_TARGET_PARTIAL);else{const o=e.System.config.startupView;if(null==o)return e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","No startup view defined!",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();let i=!1;for(const e of l)if(tchmi_path(e.url)===tchmi_path(o)){i=!0;break}if(null==o||!0!==i)return e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Can't find a valid view definition matching the defined startup view.",e.DialogManager.DialogSeverity.Error),e.System.Init.__initStep=1e4,void r();t=o}e.System.Services.viewManager.setScaleMode(e.System.config.scaleMode),e.System.Services.viewManager.loadView(t,(function(data){if(E.get(i).done++,h(),data.error!==e.Errors.NONE)return e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),e.System.Services.dialogManager.updateText("__TcHmiMain","Failed to load "+t+".",e.DialogManager.DialogSeverity.Error),TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("Failed to load "+t+": "+e.Log.buildMessage(data.details)),e.System.Init.__initStep=1e4,void r();e.System.isInitialized=!0,e.EventProvider.raise("onInitialized"),e.Log.performanceLog("[Source=Framework, Module=TcHmi] End"),TCHMI_CONSOLE_LOG_LEVEL>=4&&"object"==typeof performance&&"function"==typeof performance.now&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] Time elapsed: "+performance.now().toFixed(3).toString()+"ms"),setTimeout(()=>{e.System.Services.splashScreen.hide()})}))}break;case 1e4:if(e.System.Services.splashScreen.hide(),e.Log.performanceLog("[Source=Framework, Module=TcHmi] INIT_STATE.ERROR"),TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] INIT_STATE.ERROR"),"loading"===document.readyState){let t=function(){document.removeEventListener("readystatechange",t),e.System.Services.dialogManager.showDialog("__TcHmiMain",!0,e.DialogManager.DialogType.Overlay),r()};document.addEventListener("readystatechange",t);break}e.Log.performanceLog("[Source=Framework, Module=TcHmi] End"),TCHMI_CONSOLE_LOG_LEVEL>=4&&"object"==typeof performance&&"function"==typeof performance.now&&TCHMI_CONSOLE_LOG_LEVEL>=4&&e.Log.debug("[Source=Framework, Module=TcHmi] Time elapsed: "+performance.now().toFixed(3).toString()+"ms");break;default:e.System.Init.__initStep=1}}()}}o.__initStep=0,t.Init=o,!1===TCHMI_UNITTEST_MODE&&(e.System.Init.printDebugOutput(),e.System.Init.prepare(),e.System.Init.run(2))}(e.System||(e.System={}))}(TcHmi||(TcHmi={}));