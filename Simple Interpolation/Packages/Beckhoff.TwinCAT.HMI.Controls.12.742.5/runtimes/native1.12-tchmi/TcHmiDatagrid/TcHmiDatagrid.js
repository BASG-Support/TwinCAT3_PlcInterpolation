var TcHmi;!function(e){let t;!function(t){let i;!function(t){class i extends e.Controls.System.TcHmiControl{constructor(t,r,o){super(t,r,o),this.__destroyDataSymbolWatch=null,this.__pagingInfo={usePaging:!1,subscriptionId:null,buffer:30,theoraticalOffset:0,actualOffset:0,filterMap:[],timing:{isScrolling:!1,timeoutID:null,lastRequestTime:0,lastUpdateTime:0,minTimeout:100,responseLatencies:[],updateTimings:[],firstResponsePending:!1}},this.__dataSymbolTransform=null,this.__internalSorting=[],this.__filterInstance=null,this.__internalSrcColumn=[],this.__lockState=null,this.__columnWidths=[{width:0,widthUnit:"px",pixelWidth:0,minWidth:6,minWidthUnit:"px",resizable:!0}],this.__draggingInfo={isDragging:!1,columnIndex:null,startingPoint:null,offset:null},this.__lastRemovedSorting=null,this.__filterSortMap=null,this.__dataLength=0,this.__sortTouches=[],this.__srcDataHasChanged=!1,this.__selectedCell=null,this.__scrollInfo={scrollTop:0,scrollLeft:0,firstIndex:0,oldFirstIndex:0,rowCount:0,oldRowCount:0,buffer:10},this.__resizedEventDestroyEvent=null,this.__movedEventDestroyEvent=null,this.__comboboxDropdowns={},this.__selectedCombobox=null,this.__resizeElementMinWidth=8,this.__contentWidth=null,this.__contentHeight=null,this.__storageValidation={sorting:{function:"getSorting",expectedResult:void 0},columnWidths:{function:"getSrcColumn",expectedResult:void 0}},this.__onMousedown=t=>{if(!0!==e.Access.checkAccess(this,"operate"))return;if(!this.getIsEnabled())return;if(0!==t.button)return;let i=t.target;for(;i&&i instanceof Element&&!i.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template")&&!i.classList.contains("tchmi-datagrid-combobox-template");)i=i.parentElement;if(!(i instanceof HTMLDivElement))return;let r=i.parentElement;r instanceof HTMLTableCellElement&&this.__openCombobox(r)},this.__onItemClick=t=>{if(!this.__selectedCombobox)return;if(!(t.target instanceof HTMLElement)||!t.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown-element")&&!t.target.classList.contains("tchmi-datagrid-combobox-template-dropdown-element"))return;if(!0!==e.Access.checkAccess(this,"operate"))return;if(!this.getIsEnabled())return;let i=this.__selectedCombobox.cell.parentElement;if(!(i instanceof HTMLTableRowElement))return;let r=parseInt(t.target.dataset.index||"",10),o=this.__selectedCombobox.column;if(!isNaN(r)&&o){let e=o.dataDefinitions?o.dataDefinitions[r]:void 0,t=this.__selectedCombobox.cell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select")[0];if(e&&t){t.textContent=e.text||"";let r=this.__modifySrcData(e.value,this.__selectedCombobox.row,this.__internalSrcColumn.indexOf(o),i);if(r)if(r.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let e=0,t=this.__internalSrcColumn.length;e<t;e++){let t=this.__internalSrcColumn[e];if(t!==o&&t.name===o.name){let o=i.children[e+1];o instanceof HTMLTableCellElement&&this.__fillCell(o,t,r.convertedValue)}}}}this.__closeCombobox()},this.__resizeDropdownBoxCb=()=>{if(!this.__selectedCombobox)return;const t=document.documentElement.getBoundingClientRect(),i=this.__selectedCombobox.combobox.getBoundingClientRect(),r=this.__selectedCombobox.dropdown.getBoundingClientRect();let o={top:i.top+i.height+"px",left:i.left+"px",right:null,"min-width":i.width+"px"};t.height-i.bottom<r.height&&i.top>=r.height?(o.top=i.top-r.height+"px",this.__selectedCombobox.dropdown.classList.add("above-control")):this.__selectedCombobox.dropdown.classList.remove("above-control"),t.width-i.left<r.width&&i.right>=r.width&&(o.left=null,o.right=t.width-i.right+"px"),e.StyleProvider.setSimpleElementStyle(this.__selectedCombobox.dropdown,o)},this.__onColumnMouseDown=t=>{if(0!==t.button)return;if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;if(!(t.target instanceof HTMLElement)||!t.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")&&!t.target.classList.contains("tchmi-datagrid-template-resize-element"))return;let i=t.target;for(;i&&!(i instanceof HTMLTableCellElement);)i=i.parentElement;if(!i)return;let r=i.getBoundingClientRect();this.__draggingInfo.isDragging=!0,this.__draggingInfo.columnIndex=i.cellIndex,this.__draggingInfo.startingPoint=r.left,this.__draggingInfo.offset=r.width-(t.clientX-r.left)},this.__onColumnMouseMove=t=>{if(!this.__draggingInfo.isDragging||null===this.__draggingInfo.startingPoint||null===this.__draggingInfo.offset||null===this.__draggingInfo.columnIndex)return;if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;let i=t.clientX-this.__draggingInfo.startingPoint+this.__draggingInfo.offset;if("%"===this.__columnWidths[this.__draggingInfo.columnIndex].widthUnit){let e=this.__element[0].clientWidth;0!==this.__draggingInfo.columnIndex&&this.__showRowNumbers&&(e-=this.__columnWidths[0].pixelWidth),i=i/e*100}this.__resizeColumn(this.__draggingInfo.columnIndex,i),this.__setStoredValue("columnWidths",this.__columnWidths.map(e=>e.width))},this.__onColumnMouseUp=()=>{this.__draggingInfo.isDragging=!1,this.__draggingInfo.columnIndex=null,this.__draggingInfo.startingPoint=null,this.__draggingInfo.offset=null,this.__lockState&&this.__internalSrcColumn[this.__lockState.column]&&"CheckBox"===this.__internalSrcColumn[this.__lockState.column].control&&this.__unlock()},this.__onColumnMouseDblClick=t=>{if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;if(!(t.target instanceof HTMLElement)||!t.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")&&!t.target.classList.contains("tchmi-datagrid-template-resize-element"))return;let i=$(t.target).closest("th"),r=i[0].cellIndex;if(!this.__columnWidths[r].resizable)return;let o=this.__elementDataTableBody.find(`td:nth-child(${r+1})`);i.css({"min-width":"0","max-width":"none"}),o.css({"min-width":"0","max-width":"none",display:"table-cell"});let s="",l="",n=r>0&&"ComboBox"===this.__internalSrcColumn[r-1].control;n&&(o.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select").css({position:"static"}),s=o.css("padding-left"),l=o.css("padding-right"),o.css({"padding-left":"0","padding-right":"0"}));let a=r>0&&"TextBox"===this.__internalSrcColumn[r-1].control;if(a){let e=o.find("input");e.css({width:"0",position:"static"}),e.each((e,t)=>{t.style.width=t.scrollWidth+"px"}),s=o.css("padding-left"),l=o.css("padding-right"),o.css({"padding-left":"0","padding-right":"0"})}let _=i[0].offsetWidth,h=o[0].offsetWidth;n&&(h+=o[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button")[0].clientWidth,o.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select").css({position:""}),o.css({"padding-left":s,"padding-right":l})),a&&(o.find("input").css({width:"",position:""}),o.css({"padding-left":s,"padding-right":l})),i.css({"min-width":"","max-width":""}),o.css({"min-width":"","max-width":"",display:""});let d=_>h?_:h;if("%"===this.__columnWidths[r].widthUnit){let e=this.__element[0].clientWidth;0!==this.__draggingInfo.columnIndex&&this.__showRowNumbers&&(e-=this.__columnWidths[0].pixelWidth),d=d/e*100}this.__resizeColumn(r,d,!0),this.__setStoredValue("columnWidths",this.__columnWidths.map(e=>e.width))},this.__onSortClick=t=>{if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;let i=t.target;for(;i instanceof HTMLElement&&!i.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element")&&!i.classList.contains("tchmi-datagrid-template-sort-element")&&!i.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")&&!i.classList.contains("tchmi-datagrid-template-row-numbers");){if(i.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element"))return;i=i.parentElement}i instanceof HTMLElement&&this.__modifySorting(i,t.shiftKey)},this.__onSortTouchStart=t=>{if(this.getIsEnabled()&&e.Access.checkAccess(this,"operate"))for(let e=0,i=t.changedTouches.length;e<i;e++){let i=t.changedTouches[e],r=i.target;for(;r instanceof HTMLElement&&!r.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element")&&!r.classList.contains("tchmi-datagrid-template-sort-element")&&!r.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")&&!r.classList.contains("tchmi-datagrid-template-row-numbers");)r=r.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")?null:r.parentElement;if(!(r instanceof HTMLElement))continue;let o={touchId:i.identifier,timeoutId:null,sortElement:r,clientX:i.clientX,clientY:i.clientY};this.__sortTouches.push(o),o.timeoutId=window.setTimeout(()=>{o.timeoutId=null,this.__modifySorting(o.sortElement,!0)},300)}},this.__onSortTouchMove=e=>{for(let t=0,i=e.changedTouches.length;t<i;t++){let i=e.changedTouches[t],r=-1;for(let e=0,t=this.__sortTouches.length;e<t;e++)if(this.__sortTouches[e].touchId===i.identifier){r=e;break}if(-1===r)continue;let o=this.__sortTouches[r];Math.pow(i.clientX-o.clientX,2)+Math.pow(i.clientY-o.clientY,2)>100&&(null!==o.timeoutId&&window.clearTimeout(o.timeoutId),this.__sortTouches.splice(r,1))}},this.__onSortTouchEnd=e=>{e.cancelable&&e.preventDefault();for(let t=0,r=e.changedTouches.length;t<r;t++){let r=e.changedTouches[t],o=-1;for(let e=0,t=this.__sortTouches.length;e<t;e++)if(this.__sortTouches[e].touchId===r.identifier){o=e;break}if(-1===o)continue;let s=this.__sortTouches[o];if(null!==s.timeoutId)if(window.clearTimeout(s.timeoutId),0===this.__internalSorting.length)this.__modifySorting(s.sortElement,!1);else{let e=s.sortElement;for(;e&&!(e instanceof HTMLTableCellElement);)e=e.parentElement;if(e)if(e.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||e.classList.contains("tchmi-datagrid-template-row-numbers"))this.__modifySorting(s.sortElement,!1);else{let t=void 0;if(i.isSimpleColumn(this.__internalSrcColumn[0])||(t=e.dataset.name),this.__lastRemovedSorting&&this.__lastRemovedSorting.name===t)this.__modifySorting(s.sortElement,!0);else{let e=!1;for(let i=0,r=this.__internalSorting.length;i<r;i++)if(this.__internalSorting[i].name===t){e=!0;break}this.__modifySorting(s.sortElement,e)}}}this.__sortTouches.splice(o,1)}},this.__onSortTouchCancel=e=>{e.cancelable&&e.preventDefault();for(let t=0,i=e.changedTouches.length;t<i;t++){let i=e.changedTouches[t],r=-1;for(let e=0,t=this.__sortTouches.length;e<t;e++)if(this.__sortTouches[e].touchId===i.identifier){r=e;break}if(-1===r)continue;let o=this.__sortTouches[r];null!==o.timeoutId&&window.clearTimeout(o.timeoutId),this.__sortTouches.splice(r,1)}},this.__onScroll=e=>{let t=e.currentTarget.scrollLeft,i=e.currentTarget.scrollTop;if(this.__scrollInfo.scrollLeft!==t&&(this.__scrollInfo.scrollLeft=t,this.__elementHeaderScroll.scrollLeft(t)),this.__scrollInfo.scrollTop!==i){this.__scrollInfo.scrollTop=i;let e=this.__rowHeight?Math.floor(i/this.__rowHeight):0;Math.abs(this.__scrollInfo.firstIndex-e)>this.__scrollInfo.buffer/2&&(this.__scrollInfo.firstIndex=e,this.__pagingInfo.usePaging&&this.__updatePaging(),this.__updateTable(2),this.__updateSentinels())}this.__pagingInfo.usePaging&&(this.__pagingInfo.timing.isScrolling=!0,null!==this.__pagingInfo.timing.timeoutID&&window.clearTimeout(this.__pagingInfo.timing.timeoutID),this.__pagingInfo.timing.timeoutID=window.setTimeout(()=>{this.__pagingInfo.timing.isScrolling=!1,this.__pagingInfo.timing.timeoutID=null,this.__updatePaging()},200))},this.__onFocusElement=t=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;let r=t.target;for(;r instanceof Node&&!(r instanceof HTMLTableCellElement);)r=r.parentElement;if(!(r instanceof HTMLTableCellElement))return;let o=r.parentElement;if(!(o instanceof HTMLTableRowElement))return;let s=parseInt(r.dataset.row||"",10),l=parseInt(r.dataset.column||"-1",10);if(isNaN(s))return;let n=s;if(s=this.__srcDataIndexToOriginalIndex(s),-1!==s){if(this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),r.classList.add("focused"),o.classList.add("focused"),null===this.__selectedCell||this.__selectedCell.rowIndex!==s||this.__selectedCell.columnIndex!==l){let t=[];if(this.__selectedCell&&this.__selectedCell.rowIndex===s||t.push("SelectedRowIndex"),this.__selectedCell&&this.__selectedCell.columnIndex===l||t.push("SelectedColumnIndex"),this.__selectedCell&&null!==this.__selectedCell.rowIndex){let e=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);-1!==e&&tchmi_equal(this.__srcData[e],this.__srcData[n])||t.push("selectedRowValue")}else t.push("selectedRowValue");if(l>=0){let e=this.__internalSrcColumn[l];if(!i.isSimpleColumn(e)&&this.__selectedCell&&this.__selectedCell.rowIndex&&this.__selectedCell.columnIndex>=0){let i=this.__internalSrcColumn[this.__selectedCell.columnIndex],r=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===r)t.push("selectedCellValue");else{let o=this.__readObjectProperty(this.__srcData[r],i.name),s=this.__readObjectProperty(this.__srcData[n],e.name);tchmi_equal(o,s)||t.push("selectedCellValue")}}else t.push("selectedCellValue")}else t.push("selectedCellValue");this.__selectedCell={rowIndex:s,columnIndex:l},t.length>0&&(e.EventProvider.raise(this.__id+".onSelectedItemChanged"),t.forEach(t=>e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:t})))}t.target instanceof HTMLInputElement&&"text"===t.target.type&&!t.target.disabled&&this.__lock(s,l,o)}},this.__onFocusElementOut=t=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;if(!(t.target instanceof HTMLInputElement)||"text"!==t.target.type)return;if(!this.__lockState)return;if(!this.__lockState.editStarted)return void this.__unlock();let i=t.target;for(;i&&!(i instanceof HTMLTableCellElement);)i=i.parentElement;let r=i;for(;r&&!(r instanceof HTMLTableRowElement);)r=r.parentElement;if(!r)return;if(this.__unlock(),!i||i.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||i.classList.contains("tchmi-datagrid-template-row-numbers"))return;let o=parseInt(i.dataset.row||"",10),s=parseInt(i.dataset.column||"",10);if(isNaN(o)||isNaN(s))return;if("TextBox"!==this.__internalSrcColumn[s].control||o>=this.__dataLength)return;let l=this.__modifySrcData(t.target.value,o,s,r);if(l)if(l.needSorting)this.__filterAndSort(),this.__updateTable(0);else{t.target.value=this.__executeFormatFunction(this.__internalSrcColumn[s].format,l.convertedValue);for(let e=0,t=this.__internalSrcColumn.length;e<t;e++){let t=this.__internalSrcColumn[e];if(e!==s&&t.name===this.__internalSrcColumn[s].name){let i=r.children[e+1];i instanceof HTMLTableCellElement&&this.__fillCell(i,t,l.convertedValue)}}}},this.__onEmptyAreaClick=t=>{if(t.target===t.currentTarget&&this.__srcData&&this.getIsEnabled()&&e.Access.checkAccess(this,"operate")&&null!==this.__selectedCell){let t=["SelectedColumnIndex"];null!==this.__selectedCell.rowIndex&&t.push("SelectedRowIndex","selectedRowValue","selectedCellValue"),this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),this.__selectedCell=null,e.EventProvider.raise(this.__id+".onSelectedItemChanged"),t.forEach(t=>e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:t}))}},this.__onKeydown=t=>{if(this.__srcData&&this.getIsEnabled()&&e.Access.checkAccess(this,"operate")&&t.target instanceof HTMLInputElement&&"text"===t.target.type&&this.__lockState)if(this.__lockState.editStarted=!0,"Enter"===t.key)t.target.blur();else if("Escape"===t.key&&this.__selectedCell&&null!==this.__selectedCell.rowIndex){let e=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===e)return;let r=this.__srcData[e],o=this.__internalSrcColumn[this.__selectedCell.columnIndex];i.isSimpleColumn(o)||(r=this.__readObjectProperty(r,o.name)),t.target.value=this.__executeFormatFunction(o.format,r),this.__lockState.editStarted=!1,t.target.blur()}},this.__onCheckboxMouseDown=t=>{if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;if(!(t.target instanceof HTMLLabelElement&&t.target.previousElementSibling instanceof HTMLInputElement&&"checkbox"===t.target.previousElementSibling.type))return;let i=t.target;for(;i&&!(i instanceof HTMLTableCellElement);)i=i.parentElement;if(!i)return;let r=i.parentElement;if(!(r instanceof HTMLTableRowElement))return;let o=parseInt(i.dataset.row||"",10),s=parseInt(i.dataset.column||"",10);isNaN(o)||isNaN(s)||(o=this.__srcDataIndexToOriginalIndex(o),-1!==o&&this.__lock(o,s,r))},this.__onValueChange=t=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!e.Access.checkAccess(this,"operate"))return;if(!(t.target instanceof HTMLInputElement)||"checkbox"!==t.target.type)return;let i=t.target;for(;i&&!(i instanceof HTMLTableRowElement);)i=i.parentElement;if(!i)return;this.__lockState&&"ComboBox"===this.__internalSrcColumn[this.__lockState.column].control&&this.__unlock();let r=t.target;for(;r&&!(r instanceof HTMLTableCellElement);)r=r.parentElement;if(!r)return;let o=parseInt(r.dataset.row||"",10),s=parseInt(r.dataset.column||"",10);if(isNaN(o)||isNaN(s))return;if("CheckBox"!==this.__internalSrcColumn[s].control)return;let l=this.__modifySrcData(t.target.checked,o,s,i);if(l)if(l.needSorting)this.__filterAndSort(),this.__updateTable(0);else{t.target.value=this.__executeFormatFunction(this.__internalSrcColumn[s].format,l.convertedValue);for(let e=0,t=this.__internalSrcColumn.length;e<t;e++){let t=this.__internalSrcColumn[e];if(e!==s&&t.name===this.__internalSrcColumn[s].name){let r=i.children[e+1];r instanceof HTMLTableCellElement&&this.__fillCell(r,t,l.convertedValue)}}}},this.__onResolverForSrcColumnWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("srcColumn"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__srcColumn)||(this.__srcColumn=t.value,Array.isArray(t.value)?this.__internalSrcColumn=t.value:this.__internalSrcColumn=[t.value],e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcColumn"}),this.__processSrcColumn()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=SrcColumn] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForSrcDataWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("srcData"),t.error===e.Errors.NONE?(this.__srcDataHasChanged&&(this.__srcDataHasChanged=!1,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"srcDataHasChanged"})),tchmi_equal(t.value,this.__srcData)||(null!==t.value?this.__srcData=t.value:this.__srcData=[],this.__filterSortMap=null,this.__dataSymbol||e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcData"}),this.__processSrcData())):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=SrcData] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onDataSymbolPage=t=>{var i,r,o,s,l,n,a;if(this.__pagingInfo.timing.firstResponsePending&&(this.__pagingInfo.timing.firstResponsePending=!1,this.__pagingInfo.timing.responseLatencies.push(Date.now()-this.__pagingInfo.timing.lastRequestTime),this.__pagingInfo.timing.responseLatencies.length>3&&this.__pagingInfo.timing.responseLatencies.shift()),t.error!==e.Errors.NONE)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(i=this.__dataSymbol)||void 0===i?void 0:i.getExpression().toString()}%/s%] `+e.Log.buildMessage(t.details)));if(!t.response)return void e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(r=this.__dataSymbol)||void 0===r?void 0:r.getExpression().toString()}%/s%] `+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}));if(t.response.error)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(o=this.__dataSymbol)||void 0===o?void 0:o.getExpression().toString()}%/s%] `+e.Log.buildMessage(t.response.error)));if(!t.response.commands||0===t.response.commands.length)return void e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(s=this.__dataSymbol)||void 0===s?void 0:s.getExpression().toString()}%/s%] `+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+t.response.id+"'.",domain:this.__type}));if(t.response.commands[0].error)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(l=this.__dataSymbol)||void 0===l?void 0:l.getExpression().toString()}%/s%] `+e.Log.buildMessage(t.response.commands[0].error)));let _=t.response.commands[0],h=new Array(_.maxEntries);for(let e=0,t=_.readValue.length;e<t;e++){let t=_.readValue[e];this.__dataSymbolTransform&&(t=this.__dataSymbolTransform(t)),h[e+(null!==(n=_.offset)&&void 0!==n?n:0)]=t}this.__pagingInfo.actualOffset=null!==(a=_.offset)&&void 0!==a?a:0,this.__pagingInfo.filterMap=_.filterMap,this.__setSrcData(h)},this.__onDataSymbolWatch=t=>{var i,r;t.error===e.Errors.NONE?this.__setSrcData(null!==(r=t.value)&&void 0!==r?r:null):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(i=this.__dataSymbol)||void 0===i?void 0:i.getExpression().toString()}] `+e.Log.buildMessage(t.details))},this.__onResolverForSortingWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("sorting"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__sorting)||(this.__sorting=t.value,this.__internalSorting=tchmi_clone_object(t.value)||[],e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Sorting"}),this.__processSorting()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=Sorting] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForFilterWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("filter"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__filter)||(this.__filter=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Filter"}),this.__processFilter()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=Filter] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForHeaderCellPaddingWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerCellPadding"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__headerCellPadding)||(this.__headerCellPadding=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderCellPadding"}),this.__processHeaderCellPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderCellPadding] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForTableBorderColorWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("tableBorderColor"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__tableBorderColor)||(this.__tableBorderColor=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderColor"}),this.__processTableBorderColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=TableBorderColor] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForTableBorderStyleWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("tableBorderStyle"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__tableBorderStyle)||(this.__tableBorderStyle=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderStyle"}),this.__processTableBorderStyle()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=TableBorderStyle] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForRowNumbersCellPaddingWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersCellPadding"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__rowNumbersCellPadding)||(this.__rowNumbersCellPadding=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersCellPadding"}),this.__processRowNumbersCellPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersCellPadding] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForCellContentPaddingWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("cellContentPadding"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__cellContentPadding)||(this.__cellContentPadding=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CellContentPadding"}),this.__processCellContentPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=CellContentPadding] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForHeaderBackgroundColorWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerBackgroundColor"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__headerBackgroundColor)||(this.__headerBackgroundColor=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderBackgroundColor"}),this.__processHeaderBackgroundColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderBackgroundColor] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForHeaderTextColorWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerTextColor"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__headerTextColor)||(this.__headerTextColor=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderTextColor"}),this.__processHeaderTextColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderTextColor] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForRowNumbersTextColorWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersTextColor"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__rowNumbersTextColor)||(this.__rowNumbersTextColor=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersTextColor"}),this.__processRowNumbersTextColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersTextColor] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))},this.__onResolverForRowNumbersBackgroundColorWatchCallback=t=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersBackgroundColor"),t.error===e.Errors.NONE?tchmi_equal(t.value,this.__rowNumbersBackgroundColor)||(this.__rowNumbersBackgroundColor=t.value,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersBackgroundColor"}),this.__processRowNumbersBackgroundColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersBackgroundColor] Resolving symbols from object failed with error: "+e.Log.buildMessage(t.details))}}__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template"),0===this.__elementTemplateRoot.length&&(this.__elementTemplateRoot=this.__element.find(".tchmi-datagrid-template")),this.__elementOuter=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-outer"),0===this.__elementOuter.length&&(this.__elementOuter=this.__elementTemplateRoot.find(".tchmi-datagrid-template-outer")),this.__elementHeaderScroll=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border"),0===this.__elementHeaderScroll.length&&(this.__elementHeaderScroll=this.__elementTemplateRoot.find(".tchmi-datagrid-template-header-border")),this.__elementHeaderTable=this.__elementHeaderScroll.find("table"),this.__elementDataScroll=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-data-scroll"),0===this.__elementDataScroll.length&&(this.__elementDataScroll=this.__elementTemplateRoot.find(".tchmi-datagrid-template-data-scroll")),this.__elementDataTableBody=this.__elementDataScroll.find("table tbody"),0===this.__elementTemplateRoot.length||0===this.__elementOuter.length||0===this.__elementHeaderScroll.length||0===this.__elementHeaderTable.length||0===this.__elementDataScroll.length||0===this.__elementDataTableBody.length)throw new Error("Invalid Template.html");super.__previnit()}__init(){super.__init(),this.__initStorage(),document.addEventListener("mouseup",this.__onColumnMouseUp),document.addEventListener("mousemove",this.__onColumnMouseMove),document.addEventListener("click",this.__onItemClick),this.__elementHeaderTable[0].addEventListener("mousedown",this.__onColumnMouseDown),this.__elementHeaderTable[0].addEventListener("dblclick",this.__onColumnMouseDblClick),this.__elementHeaderTable[0].addEventListener("click",this.__onSortClick),this.__elementHeaderTable[0].addEventListener("touchstart",this.__onSortTouchStart),this.__elementHeaderTable[0].addEventListener("touchmove",this.__onSortTouchMove),this.__elementHeaderTable[0].addEventListener("touchend",this.__onSortTouchEnd),this.__elementHeaderTable[0].addEventListener("touchcancel",this.__onSortTouchCancel),this.__elementDataScroll[0].addEventListener("scroll",this.__onScroll),this.__elementDataScroll[0].addEventListener("click",this.__onEmptyAreaClick),this.__elementDataTableBody[0].addEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementDataTableBody[0].addEventListener("change",this.__onValueChange),this.__elementDataTableBody[0].addEventListener("focusin",this.__onFocusElement),this.__elementDataTableBody[0].addEventListener("focusout",this.__onFocusElementOut),this.__elementDataTableBody[0].addEventListener("keydown",this.__onKeydown),this.__elementDataTableBody[0].addEventListener("mousedown",this.__onMousedown)}__attach(){super.__attach(),this.__resizedEventDestroyEvent=e.EventProvider.register(this.__id+".onResized",this.__onResized());let t=this.__getStoredValue("columnWidths");if(t)for(let e=0,i=Math.min(t.length,this.__columnWidths.length);e<i;e++)this.__columnWidths[e].width=t[e];this.__recalcAllColumnWidths();let i=this.__getStoredValue("sorting");i&&(this.__internalSorting=i,this.__processSorting()),i&&this.__pagingInfo.usePaging||this.__processDataSymbol(),this.__updateTable(1)}__detach(){super.__detach(),this.__selectedCombobox=null,null!==this.__resizedEventDestroyEvent&&(this.__resizedEventDestroyEvent(),this.__resizedEventDestroyEvent=null),this.__processDataSymbol(!0)}destroy(){this.__keepAlive||(document.removeEventListener("mouseup",this.__onColumnMouseUp),document.removeEventListener("mousemove",this.__onColumnMouseMove),document.removeEventListener("click",this.__onItemClick),this.__elementHeaderTable[0].removeEventListener("mousedown",this.__onColumnMouseDown),this.__elementHeaderTable[0].removeEventListener("dblclick",this.__onColumnMouseDblClick),this.__elementHeaderTable[0].removeEventListener("click",this.__onSortClick),this.__elementHeaderTable[0].removeEventListener("touchstart",this.__onSortTouchStart),this.__elementHeaderTable[0].removeEventListener("touchmove",this.__onSortTouchMove),this.__elementHeaderTable[0].removeEventListener("touchend",this.__onSortTouchEnd),this.__elementHeaderTable[0].removeEventListener("touchcancel",this.__onSortTouchCancel),this.__elementDataScroll[0].removeEventListener("scroll",this.__onScroll),this.__elementDataScroll[0].removeEventListener("click",this.__onEmptyAreaClick),this.__elementDataTableBody[0].removeEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementDataTableBody[0].removeEventListener("change",this.__onValueChange),this.__elementDataTableBody[0].removeEventListener("focusin",this.__onFocusElement),this.__elementDataTableBody[0].removeEventListener("focusout",this.__onFocusElementOut),this.__elementDataTableBody[0].removeEventListener("keydown",this.__onKeydown),this.__elementDataTableBody[0].removeEventListener("mousedown",this.__onMousedown),super.destroy())}__recalcRowCount(){if(!this.getRenderedHeight())return;let e=0;this.__rowHeight&&(e=Math.ceil(this.__elementDataScroll[0].clientHeight/this.__rowHeight)),this.__scrollInfo.rowCount!==e&&(this.__scrollInfo.rowCount=e,this.__pagingInfo.usePaging&&this.__updatePaging(!0),this.__updateTable(2),this.__updateSentinels())}__onResized(){return(e,t)=>{this.__recalcRowCount(),this.__recalcAllColumnWidths(),this.__selectedCombobox&&this.__resizeDropdownBoxCb()}}__recalcAllColumnWidths(t=!1){if(!this.__isAttached)return;let i=this.__element[0].clientWidth;function r(e){return i*(.01*e)}let o=0;if(i>0)for(let s=0,l=this.__columnWidths.length;s<l;s++){let l=this.__columnWidths[s],n=l.minWidth;i<=0?n=0:"%"===l.widthUnit&&"px"===l.minWidthUnit?n=n/i*100:"px"===l.widthUnit&&"%"===l.minWidthUnit&&(n=r(n));let a=l.width<n?n:l.width,_="%"===l.widthUnit?r(a):a,h=Math.floor(_);if(o+=_-h,o>=1&&(h++,o--),0===s&&this.__showRowNumbers&&(i-=h),l.pixelWidth!==h||t){l.pixelWidth=h;const t={"min-width":l.pixelWidth+"px","max-width":l.pixelWidth+"px"};e.StyleProvider.setSimpleElementStyle(this.__elementHeaderScroll[0].querySelectorAll(`th:nth-child(${s+1})`),t),e.StyleProvider.setSimpleElementStyle(this.__elementDataScroll[0].querySelectorAll(`td:nth-child(${s+1})`),t)}}let s=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=checkbox] + label");for(let e=0,t=s.length;e<t;e++){let t=s[e].parentElement.cellIndex;if(t>=this.__columnWidths.length)continue;let i=Math.min(this.__rowHeight||0,this.__columnWidths[t].pixelWidth)-(this.__tableBorderWidth||0);s[e].style.width=i+"px",s[e].style.height=i+"px"}"Content"===this.getWidthMode()&&this.__processWidth()}__buildHeader(){let t=this.__elementHeaderTable.find("tr");t.find("th[data-column]").remove();let r=document.createDocumentFragment();for(let t=0,o=this.__internalSrcColumn.length;t<o;t++){let o="",s=this.__internalSrcColumn[t];i.isSimpleColumn(s)||(o=s.name);let l=document.createElement("th");l.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header","tchmi-datagrid-template-header","tchmi-box"),l.dataset.column=t.toString(10),l.dataset.name=o,this.__internalSrcColumn[t].resize&&l.classList.add("resizable");let n=this.__columnWidths[t+1].pixelWidth;e.StyleProvider.setSimpleElementStyle(l,{"min-width":n+"px","max-width":n+"px"}),e.StyleProvider.processContentPadding(l,this.__headerCellPadding),e.StyleProvider.processBorderWidth(l,{right:this.__tableBorderWidth}),e.StyleProvider.processBorderStyle(l,this.__tableBorderStyle),e.StyleProvider.processBorderColor(l,this.__tableBorderColor),e.StyleProvider.processBackgroundColor(l,this.__headerBackgroundColor),e.StyleProvider.processTextColor(l,this.__headerTextColor),e.StyleProvider.processFontFamily(l,this.__headerFontFamily),e.StyleProvider.processFontSize(l,this.__headerFontSize,this.__headerFontSizeUnit),e.StyleProvider.processFontStyle(l,this.__headerFontStyle),e.StyleProvider.processFontWeight(l,this.__headerFontWeight);let a=document.createElement("div");a.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-wrapper","tchmi-datagrid-template-header-wrapper");let _=document.createElement("div");_.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element","tchmi-datagrid-template-sort-element"),s.sortable&&_.classList.add("sortable");let h=document.createElement("div");h.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element-child","tchmi-datagrid-template-sort-element-child"),h.textContent=tchmi_decode_control_characters(this.__internalSrcColumn[t].label);for(let e=0,t=this.__internalSorting.length;e<t;e++)if(this.__internalSorting[e].name===o){switch(this.__internalSorting[e].order){case"Ascending":h.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc","tchmi-datagrid-template-header-sort-asc");break;case"Descending":h.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc","Ttchmi-datagrid-template-header-sort-desc")}break}let d=document.createElement("div");d.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element","tchmi-datagrid-template-resize-element"),this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth&&e.StyleProvider.setSimpleElementStyle(d,{width:this.__tableBorderWidth+"px",right:-this.__tableBorderWidth+"px"}),_.appendChild(h),a.appendChild(_),a.appendChild(d),l.appendChild(a),r.appendChild(l)}t[0].appendChild(r)}__updateTable(e){if(!this.__srcData||!this.__rowNumbersHorizontalAlignment||!this.__rowNumbersVerticalAlignment||void 0===this.__rowHeight||void 0===this.__showRowNumbers)return;let t=!this.__pagingInfo.usePaging&&this.__filterSortMap,i=this.__scrollInfo.firstIndex-this.__scrollInfo.buffer;i=i>0?i:0;let r=this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer;r=r<=this.__dataLength?r:this.__dataLength;let o=this.__elementDataTableBody[0];switch(e){case 0:let e=!1;if(this.__lockState){let o=this.__originalIndexToSrcDataIndex(this.__lockState.row),s=t?this.__filterSortMap.indexOf(o):o;if(-1===s)this.__lockState.rowElement.classList.add("hidden"),e=!0;else if(s<i)this.__lockState.rowElement.classList.add("hidden"),e=!0,this.__createRow(o,s,this.__lockState.rowElement,this.__lockState.column);else if(s>=r)this.__lockState.rowElement.classList.add("hidden"),e=!0,this.__createRow(o,s,this.__lockState.rowElement,this.__lockState.column);else{let e=s-i-this.__lockState.rowElement.rowIndex;if(0!==e){let t=this.__lockState.rowElement,i=[];if(e>0){for(let r=0;r<e&&t.nextElementSibling;r++)t=t.nextElementSibling,i.push(t);this.__lockState.rowElement.before(...i)}else{for(let r=0;r<-e&&t.previousElementSibling;r++)t=t.previousElementSibling,i.push(t);this.__lockState.rowElement.after(...i)}}this.__lockState.rowElement.classList.remove("hidden")}}let s=null,l=0;for(let e=i;e<r;e++&l++){let i=t?this.__filterSortMap[e]:e,r=o.children[l];r&&r.classList.contains("hidden")&&(r=o.children[++l]),r?this.__createRow(i,e,r,this.__lockState&&this.__originalIndexToSrcDataIndex(this.__lockState.row)===i?this.__lockState.column:void 0):(s||(s=document.createDocumentFragment()),s.appendChild(this.__createRow(i,e)))}for(s&&o.appendChild(s);o.childElementCount>(e?l+1:l);){let e=o.lastElementChild;if(this.__lockState&&e===this.__lockState.rowElement){if(!e.classList.contains("hidden")){e.classList.add("hidden");continue}e=e.previousElementSibling}if(!e)break;o.removeChild(e)}break;case 1:this.__lockState&&this.__unlock();let n=document.createDocumentFragment();for(let e=i;e<r;e++){let i=t?this.__filterSortMap[e]:e;n.appendChild(this.__createRow(i,e))}for(;o.lastChild;)o.removeChild(o.lastChild);o.appendChild(n);break;case 2:let a=this.__scrollInfo.oldFirstIndex-this.__scrollInfo.buffer;a=a>0?a:0;let _=this.__scrollInfo.oldFirstIndex+this.__scrollInfo.oldRowCount+this.__scrollInfo.buffer;_=_<=this.__dataLength?_:this.__dataLength;let h=[],d=0;for(let e=a;e<i;e++){let e=o.children[d];if(!e)break;if(this.__lockState&&e===this.__lockState.rowElement){if(d=1,!e.classList.contains("hidden")){e.classList.add("hidden");continue}if(e=e.nextElementSibling,!e)break}h.push(o.removeChild(e))}d=0;for(let e=_-1;e>=r;e--){let e=o.children[o.childElementCount-(d+1)];if(!e)break;if(this.__lockState&&e===this.__lockState.rowElement){if(d=1,!e.classList.contains("hidden")){e.classList.add("hidden");continue}if(e=e.previousElementSibling,!e)break}h.push(o.removeChild(e))}let c=document.createDocumentFragment(),m=Math.max(_,i);for(let e=m;e<r;e++){let i=t?this.__filterSortMap[e]:e;c.appendChild(this.__createRow(i,e,h.pop()))}let u=document.createDocumentFragment(),g=Math.min(a-1,r-1);for(let e=g;e>=i;e--){let i=t?this.__filterSortMap[e]:e;u.insertBefore(this.__createRow(i,e,h.pop()),u.firstChild)}if(this.__lockState){let e=t?this.__filterSortMap.indexOf(this.__originalIndexToSrcDataIndex(this.__lockState.row)):this.__originalIndexToSrcDataIndex(this.__lockState.row);if(e<i)this.__elementDataTableBody.children().first().after(u),this.__elementDataTableBody.append(c);else if(e>=r)this.__elementDataTableBody.prepend(u),this.__elementDataTableBody.children().last().before(c);else{let t=e-(g-(u.childNodes.length-1));t>=0&&t<u.childNodes.length?(this.__elementDataTableBody.children().first().removeClass("hidden").after(Array.prototype.slice.call(u.childNodes,t+1)),this.__elementDataTableBody.prepend(Array.prototype.slice.call(u.childNodes,0,t))):this.__elementDataTableBody.prepend(u);let i=e-m;i>=0&&i<c.childNodes.length?(this.__elementDataTableBody.children().last().removeClass("hidden").before(Array.prototype.slice.call(c.childNodes,0,i)),this.__elementDataTableBody.append(Array.prototype.slice.call(c.childNodes,1))):this.__elementDataTableBody.append(c)}}else this.__elementDataTableBody.prepend(u),this.__elementDataTableBody.append(c)}this.__scrollInfo.oldFirstIndex=this.__scrollInfo.firstIndex,this.__scrollInfo.oldRowCount=this.__scrollInfo.rowCount}__openCombobox(t){if(!this.__srcData)return;let r=parseInt(t.dataset.column||"",10),o=this.__internalSrcColumn[r],s=parseInt(t.dataset.row||"",10);if(!o||!o.editable||isNaN(r)||isNaN(s))return;let l=t.parentElement;if(!(l instanceof HTMLTableRowElement))return;let n=t.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template")[0],a=this.__comboboxDropdowns[JSON.stringify(o.dataDefinitions)];if(!n||!a)return;let _=s;if(s=this.__srcDataIndexToOriginalIndex(s),-1===s)return;this.__lock(s,r,l);let h=this.__srcData[_];i.isSimpleColumn(o)||(h=this.__readObjectProperty(h,o.name));for(let e=0,t=a.children.length;e<t;e++){let t=a.children[e];tchmi_equal(t.dataset.value,h,!1)?t.classList.add("selected"):t.classList.remove("selected")}n.classList.add("active");let d={removeCb:e=>{document.removeEventListener("scroll",this.__resizeDropdownBoxCb,{capture:!0}),null!==this.__movedEventDestroyEvent&&(this.__movedEventDestroyEvent(),this.__movedEventDestroyEvent=null),n.classList.remove("active"),this.__selectedCombobox=null,this.__unlock()}};a.classList.remove("drop-down-style-mobile"),d.dimBackground=!1,d.resizeCb=this.__resizeDropdownBoxCb,document.addEventListener("scroll",this.__resizeDropdownBoxCb,{capture:!0,passive:!0}),this.__movedEventDestroyEvent=e.EventProvider.register(this.__id+".onMoved",this.__resizeDropdownBoxCb),this.__selectedCombobox={cell:t,column:o,row:_,combobox:n,dropdown:a},e.TopMostLayer.add(this,$(a),d)}__closeCombobox(){this.__selectedCombobox&&e.TopMostLayer.remove(this,$(this.__comboboxDropdowns[JSON.stringify(this.__selectedCombobox.column.dataDefinitions)]))}__createRow(t,r,o,s){if(!this.__srcData)throw new Error("Unable to create row without srcData");let l=-1;if(o&&(l=parseInt(o.dataset.row||"",10),l===t&&this.__oldSrcData&&tchmi_equal(this.__oldSrcData[l],this.__srcData[t])))return o;let n=o||document.createElement("tr");n.setAttribute("data-row",t.toString(10)),this.__setRowClasses(n,t);for(let a=-1,_=this.__internalSrcColumn.length;a<_;a++){if(a===s)continue;let _,h;if(-1!==a){let e=this.__internalSrcColumn[a];if(i.isSimpleColumn(e)){if(_=this.__srcData[t],l===t&&this.__oldSrcData&&tchmi_equal(this.__oldSrcData[l],_))continue}else if(_=this.__readObjectProperty(this.__srcData[t],e.name),l===t&&this.__oldSrcData&&tchmi_equal(this.__readObjectProperty(this.__oldSrcData[l],e.name),_))continue}if(o?h=n.getElementsByTagName("td")[a+1]:(h=document.createElement("td"),n.appendChild(h)),h.setAttribute("data-row",t.toString()),!o){let t=this.__columnWidths[a+1].pixelWidth,r={"min-width":t+"px","max-width":t+"px",height:this.__rowHeight+"px"};if(-1===a)h.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers tchmi-datagrid-template-row-numbers tchmi-box"),r.display=this.__showRowNumbers?"":"none",r["text-align"]=this.__rowNumbersHorizontalAlignment?this.__rowNumbersHorizontalAlignment.toLowerCase():"","Center"===this.__rowNumbersVerticalAlignment?r["vertical-align"]="middle":this.__rowNumbersVerticalAlignment&&(r["vertical-align"]=this.__rowNumbersVerticalAlignment.toLowerCase()),e.StyleProvider.processContentPadding(h,this.__rowNumbersCellPadding),e.StyleProvider.processTextColor(h,this.__rowNumbersTextColor),e.StyleProvider.processBackgroundColor(h,this.__rowNumbersBackgroundColor),e.StyleProvider.processFontFamily(h,this.__rowNumbersFontFamily),e.StyleProvider.processFontSize(h,this.__rowNumbersFontSize,this.__rowNumbersFontSizeUnit),e.StyleProvider.processFontStyle(h,this.__rowNumbersFontStyle),e.StyleProvider.processFontWeight(h,this.__rowNumbersFontWeight);else{h.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell tchmi-datagrid-template-cell tchmi-box"),h.setAttribute("data-column",a.toString());let t=this.__internalSrcColumn[a];switch(i.isSimpleColumn(t)||h.setAttribute("data-column-name",t.name),t.horizontalAlignment){case"Left":r["justify-content"]="flex-start";break;case"Center":r["justify-content"]="center";break;case"Right":r["justify-content"]="flex-end";break;default:r["justify-content"]=""}switch(t.verticalAlignment){case"Top":r["align-items"]="flex-start";break;case"Center":r["align-items"]="center";break;case"Bottom":r["align-items"]="flex-end";break;default:r["align-items"]=""}e.StyleProvider.processTextColor(h,t.textColor),e.StyleProvider.processBackgroundColor(h,t.cellBackground),e.StyleProvider.processFontFamily(h,this.__gridFontFamily),e.StyleProvider.processFontSize(h,this.__gridFontSize,this.__gridFontSizeUnit),e.StyleProvider.processFontStyle(h,this.__gridFontStyle),e.StyleProvider.processFontWeight(h,this.__gridFontWeight)}h.setAttribute("tabindex","0"),h.setAttribute("data-tchmi-focusable",""),e.StyleProvider.setSimpleElementStyle(h,r),e.StyleProvider.processBorderWidth(h,{right:this.__tableBorderWidth,rightUnit:"px",bottom:this.__tableBorderWidth,bottomUnit:"px",top:0,left:0}),e.StyleProvider.processBorderStyle(h,this.__tableBorderStyle),e.StyleProvider.processBorderColor(h,this.__tableBorderColor)}if(this.__selectedCell&&this.__selectedCell.columnIndex===a?h.classList.add("focused"):h.classList.remove("focused"),-1!==a){let t=this.__internalSrcColumn[a];this.__fillCell(h,t,_),o||h.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control")||h.classList.contains("tchmi-datagrid-template-cell-unpadded-control")||e.StyleProvider.processContentPadding(h,this.__cellContentPadding)}else h.firstChild?h.firstChild.nodeValue=(r+1).toString():h.textContent=(r+1).toString()}return n}__fillCell(t,i,r){switch(i.control){case"CheckBox":let o=t.getElementsByTagName("input")[0];if(!o){o=document.createElement("input"),o.setAttribute("type","checkbox");const r="checkbox-"+tchmi_create_guid();o.setAttribute("id",r),o.disabled=!i.editable;let s=document.createElement("label");s.setAttribute("for",r);let l=Math.min(this.__rowHeight||0,this.__columnWidths[t.cellIndex].pixelWidth)-(this.__tableBorderWidth||0);e.StyleProvider.setSimpleElementStyle(s,{height:l+"px",width:l+"px"}),t.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control"),t.appendChild(o),t.appendChild(s)}o.checked=e.ValueConverter.toBoolean(r,!1);break;case"TextBox":let input=t.getElementsByTagName("input")[0];input||(input=document.createElement("input"),input.setAttribute("type","text"),null!==i.cellBackground&&void 0!==i.cellBackground&&e.StyleProvider.processBackgroundColor(input,i.cellBackground),null!==i.textColor&&void 0!==i.textColor&&e.StyleProvider.processTextColor(input,i.textColor),i.horizontalAlignment&&(input.style.textAlign=i.horizontalAlignment.toLowerCase()),e.StyleProvider.processContentPadding(input,this.__cellContentPadding),input.disabled=!i.editable,t.appendChild(input),t.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control"));let s=this.__executeFormatFunction(i.format,r);input.value=(null!=s?s:"").toString().replace(/(?:\r\n|\\r|\\n)/g," ");break;case"TextBlock":let l=this.__executeFormatFunction(i.format,r);t.firstChild?t.firstChild.nodeValue=tchmi_decode_control_characters(l):t.textContent=tchmi_decode_control_characters(l);break;case"Image":let n=t.getElementsByTagName("img")[0];n||(n=document.createElement("img"),t.appendChild(n));let a=null;i.dataDefinitions&&(a=i.dataDefinitions.filter(e=>tchmi_equal(e.value,r))[0]),n.setAttribute("src",a&&a.source||""),n.setAttribute("alt",a&&a.text||""),n.style.width=a&&void 0!==a.width&&null!==a.width?a.width+"px":"",n.style.height=a&&void 0!==a.height&&null!==a.height?a.height+"px":"";break;case"ComboBox":let _=t.getElementsByTagName("div")[0],h=t.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select")[0];if(!_||!h){switch(_=document.createElement("div"),_.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template tchmi-datagrid-combobox-template tchmi-box"),_.setAttribute("tabindex","-1"),h=document.createElement("div"),h.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select tchmi-datagrid-combobox-template-select tchmi-box"),e.StyleProvider.processContentPadding(h,this.__cellContentPadding),i.horizontalAlignment){case"Left":h.style.justifyContent="flex-start";break;case"Center":h.style.justifyContent="center";break;case"Right":h.style.justifyContent="flex-end"}switch(i.verticalAlignment){case"Top":h.style.alignItems="flex-start";break;case"Center":h.style.alignItems="center";break;case"Bottom":h.style.alignItems="flex-end"}let r=$('<svg class="TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button tchmi-box" version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30px" height="100%" viewBox="0 0 30 30" enable-background="new 0 0 30 30" xml:space="preserve"><polyline class="TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button-arrow" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" points= "22.865,12.5 15,20.366 7.135,12.5" /></svg>')[0];_.appendChild(h),_.appendChild(r),t.appendChild(_),t.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")}let d=null;i.dataDefinitions&&(d=i.dataDefinitions.filter(e=>tchmi_equal(e.value,r))[0]),h.textContent=d&&d.text||"";break;default:void 0!==r?t.innerHTML=r:t.textContent=""}}__resizeColumn(e,t,i=!1){(this.__columnWidths[e].resizable||i)&&(t!==this.__columnWidths[e].width||i)&&(this.__columnWidths[e].width=t,this.__recalcAllColumnWidths(i))}__modifySorting(t,r){let o=t;for(;o&&!(o instanceof HTMLTableCellElement);)o=o.parentElement;if(o){if(o.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||o.classList.contains("tchmi-datagrid-template-row-numbers")){if(r)return;this.__internalSorting=tchmi_clone_object(this.__sorting)||[],this.__lastRemovedSorting=null}else{if(!t.classList.contains("sortable"))return;let e=void 0;i.isSimpleColumn(this.__internalSrcColumn[0])||(e=o.dataset.name);let s=null;for(let t=0,i=this.__internalSorting.length;t<i;t++)if(this.__internalSorting[t].name===e){s=this.__internalSorting[t];break}if(s)switch(s.order){case"Ascending":s.order="Descending",r||(this.__internalSorting=[s]),this.__lastRemovedSorting=null;break;case"Descending":if(r){let e=this.__internalSorting.indexOf(s);this.__internalSorting.splice(e,1),this.__lastRemovedSorting={name:s.name,position:e}}else this.__internalSorting=[],this.__lastRemovedSorting=null}else r?this.__lastRemovedSorting&&this.__lastRemovedSorting.name===e?this.__internalSorting.splice(this.__lastRemovedSorting.position,0,{name:e,order:"Ascending"}):this.__internalSorting.push({name:e,order:"Ascending"}):this.__internalSorting=[{name:e,order:"Ascending"}],this.__lastRemovedSorting=null}e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Sorting"}),this.__processSorting(),o.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")?this.__removeStoredValue("sorting"):this.__setStoredValue("sorting",this.__internalSorting)}}__filterAndSort(){if(!this.__srcData||this.__pagingInfo.usePaging||0===this.__internalSorting.length&&!this.__filterInstance){this.__filterSortMap=null;let e=this.__srcData?this.__srcData.length:0;return void(e!==this.__dataLength&&(this.__dataLength=e,this.__updateSentinels(),"Content"===this.getHeightMode()&&this.__processHeight()))}let t="object"!=typeof this.__srcData[0];this.__filterSortMap=this.__srcData.map((e,t)=>t),this.__filterInstance&&(this.__filterSortMap=this.__filterSortMap.filter(e=>this.__filterInstance.test(this.__srcData[e],e))),this.__internalSorting.length>0&&(this.__filterSortMap=this.__filterSortMap.sort((i,r)=>{let o=0;for(let s=0,l=this.__internalSorting.length;s<l&&0===o;s++){let l=this.__srcData[i],n=this.__srcData[r];!t&&this.__internalSorting[s].name&&(l=this.__readObjectProperty(this.__srcData[i],this.__internalSorting[s].name),n=this.__readObjectProperty(this.__srcData[r],this.__internalSorting[s].name)),l=null!=l?l.valueOf():l,n=null!=n?n.valueOf():n;let a=null,_=(e,t)=>e===t?0:e?1:-1,h=(e,t)=>e-t,d=(t,i)=>(a||(a=new Intl.Collator(e.Locale.get(),{usage:"sort",sensitivity:"accent",numeric:!0})),a.compare(t,i)),c="Descending"===this.__internalSorting[s].order?-1:1;switch(typeof l){case"boolean":switch(typeof n){case"boolean":o=_(l,n);break;case"number":o=h(l?1:0,n);break;case"string":o=d(l.toString(),n);break;default:o=-1*c}break;case"number":switch(typeof n){case"boolean":o=h(l,n?1:0);break;case"number":o=h(l,n);break;case"string":o=d(l.toString(10),n);break;default:o=-1*c}break;case"string":switch(typeof n){case"boolean":o=d(l,n.toString());break;case"number":o=d(l,n.toString(10));break;case"string":o=d(l,n);break;default:o=-1*c}break;default:switch(typeof n){case"boolean":case"number":case"string":o=c;break;default:o=!l&&n?-1:l&&!n?1:l||n||l===n?0:void 0===l?-1:1}}o*=c}return o})),this.__dataLength!==this.__filterSortMap.length&&(this.__dataLength=this.__filterSortMap.length,this.__updateSentinels(),"Content"===this.getHeightMode()&&this.__processHeight())}__updateSentinels(){if(!this.__srcData)return;let t=0,i=0;void 0!==this.__rowHeight&&(t=(this.__scrollInfo.firstIndex-this.__scrollInfo.buffer)*this.__rowHeight,i=(this.__dataLength-(this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer))*this.__rowHeight),t=t>0?t:0,i=i>0?i:0,e.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-scroll-sentinel-top"),"height",t+"px"),e.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-scroll-sentinel-bottom"),"height",i+"px")}__modifySrcData(valueNew,t,r,o){if(!this.__srcData)return null;let s=this.__internalSrcColumn[r],l=this.__srcData[t];i.isSimpleColumn(s)||(l=this.__readObjectProperty(l,s.name));let n=valueNew;if(null!=l)switch(typeof l){case"string":n=e.ValueConverter.toString(valueNew);break;case"number":n=e.ValueConverter.toNumber(valueNew);break;case"boolean":n=e.ValueConverter.toBoolean(valueNew);break;case"object":n=e.ValueConverter.toObject(valueNew)}null===n&&(n=valueNew);let a=!1;if(!tchmi_equal(l,n)){if(i.isSimpleColumn(s)?this.__srcData[t]=n:this.__writeObjectProperty(this.__srcData[t],s.name,n),this.__dataSymbol)if(this.__pagingInfo.usePaging){let r=this.__srcDataIndexToOriginalIndex(t);if(-1===r)return null;let o=n,l=this.__dataSymbol.getExpression().getName()+`[${r}]`;i.isSimpleColumn(s)||(l+="::"+s.name),e.Server.writeSymbol(l,o,t=>{t.error!==e.Errors.NONE?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${l}%/s%] `+e.Log.buildMessage(t.details)):t.response?t.response.error?TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${l}%/s%] `+e.Log.buildMessage(t.response.error)):t.response.commands&&0!==t.response.commands.length?t.response.commands[0].error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${l}%/s%] `+e.Log.buildMessage(t.response.commands[0].error)):e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${l}%/s%] `+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+t.response.id+"'.",domain:this.__type})):e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${l}%/s%] `+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}))})}else this.__dataSymbol.write(this.__srcData,t=>{t.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${this.__dataSymbol.getExpression().toString()}] `+e.Log.buildMessage(t.details))});this.__setRowClasses(o,t),e.EventProvider.raise(this.__id+".onDataChanged",{index:t,property:i.isSimpleColumn(s)?null:s.name,value:n}),e.EventProvider.raise(this.__id+".onSelectedItemChanged"),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__dataSymbol||e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcData"}),this.__srcDataHasChanged||(this.__srcDataHasChanged=!0,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"srcDataHasChanged"}));for(let e=0,t=this.__internalSorting.length;e<t;e++){if(!this.__internalSorting[e].name&&i.isSimpleColumn(s)){a=!0;break}if(this.__internalSorting[e].name===s.name){a=!0;break}}}return{convertedValue:n,needSorting:a}}__readObjectProperty(obj,path){if(void 0===obj)return;let t=e.System.resolveSymbolPathToTokenArray(path),i=obj;for(let e=0,r=t.length;e<r;e++){let r=t[e],o=!1;if(r.match(/\[.*\]/)&&(r=r.slice(1,-1),o=!0),Array.isArray(i)&&o){let e=parseInt(r,10);i=i[isNaN(e)?r:e]}else{if("object"!=typeof i)return null;i=i[r]}}return i}__writeObjectProperty(obj,path,valueNew){let t=e.System.resolveSymbolPathToTokenArray(path),i=obj;for(let e=0,r=t.length;e<r;e++){let o=t[e],s=!1;if(o.match(/\[.*\]/)&&(o=o.slice(1,-1),s=!0),Array.isArray(i)&&s){let t=parseInt(o,10);e+1===r?i[isNaN(t)?o:t]=valueNew:i=i[isNaN(t)?o:t]}else{if("object"!=typeof i)return;e+1===r?i[o]=valueNew:i=i[o]}}}__initStorage(){let e=window.localStorage.getItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id);if(e)try{this.__storage=JSON.parse(e),"object"!=typeof this.__storage&&(this.__storage={})}catch(e){this.__storage={}}else this.__storage={};for(let e in this.__storageValidation)this.__storageValidation[e].expectedResult=this[this.__storageValidation[e].function].apply(this);for(let e in this.__storage)tchmi_equal(this.__storageValidation[e].expectedResult,this.__storage[e].validation.expectedResult)||this.__removeStoredValue(e)}__getStoredValue(t){this.__storage||this.__initStorage();let i=e.Server.getCurrentUser(),r=this.__storage[t];if(r)return i?r.users?r.users[i]:void 0:r.anonymousUser}__setStoredValue(t,i){this.__storage||this.__initStorage();let r=e.Server.getCurrentUser();this.__storage[t]||(this.__storage[t]={validation:{function:this.__storageValidation[t].function,expectedResult:void 0}});let o=this.__storage[t];o.validation.expectedResult=this.__storageValidation[t].expectedResult,r?(o.users||(o.users={}),o.users[r]=i):o.anonymousUser=i;try{window.localStorage.setItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id,JSON.stringify(this.__storage))}catch(e){}}__removeStoredValue(t){this.__storage||this.__initStorage();let i=this.__storage[t];if(i){let r=e.Server.getCurrentUser();r?i.users?(delete i.users[r],0===Object.keys(i.users).length&&(void 0===i.anonymousUser?delete this.__storage[t]:delete i.users)):void 0===i.anonymousUser&&delete this.__storage[t]:i.users?delete i.anonymousUser:delete this.__storage[t]}if(Object.keys(this.__storage).length>0)try{window.localStorage.setItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id,JSON.stringify(this.__storage))}catch(e){}else window.localStorage.removeItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id)}setSrcColumn(valueNew){if(this.__lockState)return;let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("SrcColumn"));let i=this.__objectResolvers.get("srcColumn");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("srcColumn",{resolver:r,watchCallback:this.__onResolverForSrcColumnWatchCallback,watchDestroyer:r.watch(this.__onResolverForSrcColumnWatchCallback)})}getSrcColumn(){return this.__srcColumn}__processSrcColumn(){var e;this.__srcData&&this.__srcData.length>0&&"object"!=typeof this.__srcData[0]&&0===this.__internalSrcColumn.length&&(this.__internalSrcColumn=[{label:"",control:"TextBlock",width:70,widthUnit:"px",resize:!0,minWidth:70,minWidthUnit:"px",editable:!0,horizontalAlignment:"Center",verticalAlignment:"Center",cellBackground:null,textColor:null}]);let t=void 0!==this.__tableBorderWidth?this.__tableBorderWidth:1,i=Math.max(t,this.__resizeElementMinWidth),r=this.__element[0].clientWidth-this.__columnWidths[0].pixelWidth;this.__columnWidths.splice(1),this.__comboboxDropdowns={};for(let t=0,s=this.__internalSrcColumn.length;t<s;t++){let s=this.__internalSrcColumn[t],l=s.minWidthUnit;l=l||"px";let n="px"===l?i:(o=i,r>0?o/r*100:0),a=s.minWidth;if(a=null!=a?a:0,a=a>=n?a:n,this.__columnWidths.push({width:0,widthUnit:s.widthUnit,pixelWidth:0,minWidth:a,minWidthUnit:l,resizable:null!==(e=s.resize)&&void 0!==e&&e}),this.__resizeColumn(t+1,s.width,!0),"ComboBox"===s.control){let e=document.createElement("div");if(e.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown tchmi-datagrid-combobox-template-dropdown tchmi-box"),e.setAttribute("tabindex","-1"),s.dataDefinitions)for(let t=0,i=s.dataDefinitions.length;t<i;t++){let i=s.dataDefinitions[t],text=tchmi_decode_control_characters(i.text),r=document.createElement("div");r.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown-element tchmi-datagrid-combobox-template-dropdown-element"),r.setAttribute("data-index",t.toString()),r.setAttribute("data-value",i.value.toString()),r.textContent=text,e.appendChild(r)}this.__comboboxDropdowns[JSON.stringify(s.dataDefinitions)]=e}}var o;null!==this.__selectedCombobox&&this.__closeCombobox(),this.__buildHeader(),this.__updateTable(1)}__executeFormatFunction(t,i){if(null!=t&&!1!==t.active){const r=[i];let o=null,s=new e.Function(t),l=this;return s.executeEx(r,(function(i){i.error===e.Errors.NONE?o=i.result:TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+l.getId()+"] Execution of function="+t.fn+" failed with error: "+e.Log.buildMessage(i.details))})),s.destroy(),o}return null!=i?i.toString():""}setSrcData(valueNew){this.__dataSymbol?this.__overriddenSrcData=valueNew:this.__setSrcData(valueNew)}__setSrcData(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("SrcData"));let i=this.__objectResolvers.get("srcData");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("srcData",{resolver:r,watchCallback:this.__onResolverForSrcDataWatchCallback,watchDestroyer:r.watch(this.__onResolverForSrcDataWatchCallback)})}getSrcData(){return this.__dataSymbol?void 0:this.__srcData}__processSrcData(){var t;if(!this.__srcData||this.__oldSrcData&&this.__oldSrcData.length===this.__srcData.length||(this.__lockState&&this.__originalIndexToSrcDataIndex(this.__lockState.row)>=this.__srcData.length&&this.__unlock(),null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex&&this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex)>=this.__srcData.length&&(this.__selectedCell=null,e.EventProvider.raise(this.__id+".onSelectedItemChanged"),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedRowIndex"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}))),this.__srcData&&this.__srcData.length>0&&"object"!=typeof this.__srcData[0]&&0===this.__internalSrcColumn.length){this.__internalSrcColumn=[{label:"",control:"TextBlock",width:70,widthUnit:"px",resize:!0,minWidth:70,minWidthUnit:"px",editable:!0,horizontalAlignment:"Center",verticalAlignment:"Center",cellBackground:null,textColor:null}];let e=void 0!==this.__tableBorderWidth?this.__tableBorderWidth:1,i=Math.max(e,this.__resizeElementMinWidth);this.__columnWidths.splice(1);for(let e=0,r=this.__internalSrcColumn.length;e<r;e++){let r=this.__internalSrcColumn[e].minWidth;r=null!=r?r:0,r=r>=i?r:i;let o=this.__internalSrcColumn[e].minWidthUnit;o=o||"px",this.__columnWidths.push({width:0,widthUnit:this.__internalSrcColumn[e].widthUnit,pixelWidth:0,minWidth:r,minWidthUnit:o,resizable:null!==(t=this.__internalSrcColumn[e].resize)&&void 0!==t&&t}),this.__resizeColumn(e+1,this.__internalSrcColumn[e].width,!0)}this.__buildHeader()}if(this.__filterAndSort(),this.__updateTable(0),this.__oldSrcData&&this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let t=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1!==t&&!tchmi_equal(this.__oldSrcData[t],this.__srcData[t])&&(e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),this.__selectedCell.columnIndex>=0)){let r=this.__internalSrcColumn[this.__selectedCell.columnIndex];if(!i.isSimpleColumn(r)&&this.__selectedCell){let i=this.__readObjectProperty(this.__oldSrcData[t],r.name),o=this.__readObjectProperty(this.__srcData[t],r.name);tchmi_equal(i,o)||(e.EventProvider.raise(this.__id+".onSelectedItemChanged"),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}))}else e.EventProvider.raise(this.__id+".onSelectedItemChanged"),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"})}}this.__oldSrcData=this.__srcData}setDataSymbol(valueNew){let t=valueNew;if(null===t){let i=this.getAttributeDefaultValueInternal("DataSymbol");i&&(t=new e.Symbol(i))}this.__dataSymbol!==t&&(t instanceof e.Symbol?this.__dataSymbol=t:(this.__dataSymbol,this.__dataSymbol=null),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"DataSymbol"}),this.__processDataSymbol())}getDataSymbol(){return this.__dataSymbol}__processDataSymbol(t=!1){var i;TCHMI_DESIGNER||(this.__pagingInfo.usePaging?(null!==this.__pagingInfo.subscriptionId&&(e.Server.unsubscribeEx(this.__pagingInfo.subscriptionId,null,t=>{var i;t.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(i=this.__dataSymbol)||void 0===i?void 0:i.getExpression().toString()}] `+e.Log.buildMessage(t.details))}),this.__pagingInfo.subscriptionId=null),this.__pagingInfo.usePaging=!1):this.__destroyDataSymbolWatch&&(this.__destroyDataSymbolWatch(),this.__destroyDataSymbolWatch=null),this.__isAttached&&!t&&(this.__dataSymbol?(this.__overriddenSrcData=null!==(i=this.__srcData)&&void 0!==i?i:null,this.__setSrcData(null),this.__dataSymbol.getExpression().getType()===e.SymbolType.Server?(this.__pagingInfo.usePaging=!0,this.__updatePaging(!0)):this.__destroyDataSymbolWatch=this.__dataSymbol.watch(this.__onDataSymbolWatch)):void 0!==this.__overriddenSrcData&&(this.__setSrcData(this.__overriddenSrcData),this.__overriddenSrcData=void 0)))}__updatePaging(t=!1){var i,r,o;if(!this.__dataSymbol||!this.__pagingInfo.usePaging||0===this.__scrollInfo.rowCount)return;let s=this.__scrollInfo.firstIndex-this.__pagingInfo.buffer;if(!t&&null!==this.__pagingInfo.subscriptionId&&Math.abs(this.__pagingInfo.theoraticalOffset-s)<this.__pagingInfo.buffer/2)return;let l=e=>e.length>0?e.reduce((e,t)=>e+t)/e.length:0,n=Date.now();if(this.__pagingInfo.timing.lastUpdateTime>0){let e=n-this.__pagingInfo.timing.lastUpdateTime,t=l(this.__pagingInfo.timing.responseLatencies);(0===t||e<3*t)&&(this.__pagingInfo.timing.updateTimings.push(e),this.__pagingInfo.timing.updateTimings.length>5&&this.__pagingInfo.timing.updateTimings.shift())}if(this.__pagingInfo.timing.lastUpdateTime=n,null!==this.__pagingInfo.subscriptionId&&(e.Server.unsubscribeEx(this.__pagingInfo.subscriptionId,null,t=>{var i;t.error!==e.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(i=this.__dataSymbol)||void 0===i?void 0:i.getExpression().toString()}] `+e.Log.buildMessage(t.details))}),this.__pagingInfo.subscriptionId=null),this.__pagingInfo.timing.isScrolling&&l(this.__pagingInfo.timing.responseLatencies)>l(this.__pagingInfo.timing.updateTimings))return;this.__pagingInfo.theoraticalOffset=s;let a=this.__dataSymbol.getExpression();this.__pagingInfo.subscriptionId=e.Server.subscribeEx([{commandOptions:["SendErrorMessage"],symbol:a.getName(),offset:Math.max(s,0),limit:this.__scrollInfo.rowCount+2*this.__pagingInfo.buffer,orderBy:this.__internalSorting.map(e=>{var t;return(null!==(t=e.name)&&void 0!==t?t:"{value}")+" "+("Descending"===e.order?"DESC":"ASC")}).join(", "),filter:null!==(i=this.__filter)&&void 0!==i?i:void 0,filterMap:[]}],null!==(o=null!==(r=a.getOptions().Interval)&&void 0!==r?r:e.System.config.tcHmiServer.websocketIntervalTime)&&void 0!==o?o:500,null,this.__onDataSymbolPage),this.__pagingInfo.timing.lastRequestTime=n,this.__pagingInfo.timing.firstResponsePending=!0}__setDataSymbolTransform(valueNew){valueNew!==this.__dataSymbolTransform&&(this.__dataSymbolTransform=valueNew)}setSorting(valueNew){let t=e.ValueConverter.toObject(valueNew,this.getAttributeDefaultValueInternal("Sorting")),i=this.__objectResolvers.get("sorting");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("sorting",{resolver:r,watchCallback:this.__onResolverForSortingWatchCallback,watchDestroyer:r.watch(this.__onResolverForSortingWatchCallback)})}getSorting(){return this.__sorting}__processSorting(){this.__filterAndSort(),this.__pagingInfo.usePaging?this.__updatePaging(!0):this.__updateTable(0);let e=this.__elementHeaderTable[0].getElementsByTagName("th");for(let t=0,r=e.length;t<r;t++){if(e[t].classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||e[t].classList.contains("tchmi-datagrid-template-row-numbers"))continue;let r=e[t].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element-child")[0];r||(r=e[t].getElementsByClassName("tchmi-datagrid-sort-element-child")[0]),r.classList.remove("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc"),r.classList.remove("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc"),r.classList.remove("tchmi-datagrid-template-header-sort-asc"),r.classList.remove("tchmi-datagrid-template-header-sort-desc");let propertyName=void 0;i.isSimpleColumn(this.__internalSrcColumn[0])||(propertyName=e[t].dataset.name);for(let e=0,t=this.__internalSorting.length;e<t;e++)if(this.__internalSorting[e].name===propertyName){switch(this.__internalSorting[e].order){case"Ascending":r.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc","tchmi-datagrid-template-header-sort-asc");break;case"Descending":r.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc","tchmi-datagrid-template-header-sort-desc")}break}}}setFilter(valueNew){let t=e.ValueConverter.toObject(valueNew,this.getAttributeDefaultValueInternal("Filter")),i=this.__objectResolvers.get("filter");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("filter",{resolver:r,watchCallback:this.__onResolverForFilterWatchCallback,watchDestroyer:r.watch(this.__onResolverForFilterWatchCallback)})}getFilter(){return this.__filter}__processFilter(){this.__filter?this.__filterInstance=e.System.Filter.parse(this.__filter):this.__filterInstance=null,this.__filterAndSort(),this.__pagingInfo.usePaging?this.__updatePaging(!0):this.__updateTable(0)}setRowClassesProvider(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowClassesProvider")),tchmi_equal(t,this.__rowClassesProvider)||(this.__rowClassesProvider=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowClassesProvider"}),this.__processRowClassesProvider())}getRowClassesProvider(){return this.__rowClassesProvider}__processRowClassesProvider(){let e=this.__elementDataTableBody[0].children;for(let t=0,i=e.length;t<i;t++){let i=e[t],r=parseInt(i.dataset.row||"",10);isNaN(r)||this.__setRowClasses(i,r)}}__executeRowClassesProviderFunction(t){if(void 0!==this.__srcData&&void 0!==this.__rowClassesProvider&&null!==this.__rowClassesProvider&&!1!==this.__rowClassesProvider.active){let i=this.__srcData[t];if(void 0===i)return[];let r=!this.__pagingInfo.usePaging&&this.__filterSortMap?this.__filterSortMap.indexOf(t):t;if(-1===r)return[];let o=[i,t,r],s=null,l=new e.Function(this.__rowClassesProvider);return l.executeEx(o,t=>{t.error===e.Errors.NONE?s=t.result:TCHMI_CONSOLE_LOG_LEVEL>=1&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+"] Execution of function="+this.__rowClassesProvider.fn+" failed with error. Details: "+(void 0!==t.details?e.Log.buildMessage(t.details):e.Errors[t.error]))}),l.destroy(),s||[]}return[]}__setRowClasses(e,t){let i=this.__lockState&&this.__lockState.rowElement===e&&e.classList.contains("hidden");if(e.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row tchmi-datagrid-template-row"),this.__selectedCell&&null!==this.__selectedCell.rowIndex){let i=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);-1!==i&&i===t&&e.classList.add("focused")}i&&e.classList.add("hidden");let r=this.__executeRowClassesProviderFunction(t);for(let t=0,i=r.length;t<i;t++)e.classList.add(r[t])}setHeaderHeight(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderHeight")),t!==this.__headerHeight&&(this.__headerHeight=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderHeight"}),this.__processHeaderHeight())}getHeaderHeight(){return this.__headerHeight}__processHeaderHeight(){null!==this.__headerHeight&&void 0!==this.__headerHeight&&this.__headerHeightUnit&&(this.__recalcRowCount(),e.StyleProvider.setSimpleElementStyle(this.__elementHeaderScroll,"height",this.__headerHeight+this.__headerHeightUnit),e.StyleProvider.setSimpleElementStyle(this.__elementDataScroll,"height","calc(100% - "+this.__headerHeight+(this.__headerHeightUnit||"px")+")"),"Content"===this.getHeightMode()&&this.__processHeight())}setHeaderHeightUnit(valueNew){let t=e.ValueConverter.toDimensionUnit(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderHeightUnit")),t!==this.__headerHeightUnit&&(this.__headerHeightUnit=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderHeightUnit"}),this.__processHeaderHeightUnit())}getHeaderHeightUnit(){return this.__headerHeightUnit}__processHeaderHeightUnit(){this.__processHeaderHeight()}setHeaderCellPadding(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderCellPadding"));let i=this.__objectResolvers.get("headerCellPadding");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("headerCellPadding",{resolver:r,watchCallback:this.__onResolverForHeaderCellPaddingWatchCallback,watchDestroyer:r.watch(this.__onResolverForHeaderCellPaddingWatchCallback)})}getHeaderCellPadding(){return this.__headerCellPadding}__processHeaderCellPadding(){e.StyleProvider.processContentPadding(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerCellPadding)}setRowHeight(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowHeight")),t!==this.__rowHeight&&(this.__rowHeight=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowHeight"}),this.__processRowHeight())}getRowHeight(){return this.__rowHeight}__processRowHeight(){if(void 0===this.__tableBorderWidth||void 0===this.__rowHeight)return;this.__recalcRowCount(),e.StyleProvider.setSimpleElementStyle(this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row"),"height",this.__rowHeight+"px"),e.StyleProvider.setSimpleElementStyle(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),"height",this.__rowHeight+"px");let t=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=checkbox] + label");for(let e=0,i=t.length;e<i;e++){let i=t[e].parentElement.cellIndex;if(i>=this.__columnWidths.length)continue;let r=Math.min(this.__rowHeight,this.__columnWidths[i].pixelWidth)-this.__tableBorderWidth;t[e].style.width=r+"px",t[e].style.height=r+"px"}"Content"===this.getHeightMode()&&this.__processHeight()}getRowHeightUnit(){return"px"}setTableBorderColor(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("TableBorderColor"));let i=this.__objectResolvers.get("tableBorderColor");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("tableBorderColor",{resolver:r,watchCallback:this.__onResolverForTableBorderColorWatchCallback,watchDestroyer:r.watch(this.__onResolverForTableBorderColorWatchCallback)})}getTableBorderColor(){return this.__tableBorderColor}__processTableBorderColor(){e.StyleProvider.processBorderColor(this.__elementHeaderTable[0].getElementsByTagName("th"),this.__tableBorderColor),e.StyleProvider.processBorderColor(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),this.__tableBorderColor),e.StyleProvider.processBorderColor(this.__elementHeaderScroll,this.__tableBorderColor)}setTableBorderWidth(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("TableBorderWidth")),t!==this.__tableBorderWidth&&(this.__tableBorderWidth=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderWidth"}),this.__processTableBorderWidth(),this.__processRowHeight())}getTableBorderWidth(){return this.__tableBorderWidth}__processTableBorderWidth(){const t={right:this.__tableBorderWidth,rightUnit:"px",bottom:0,left:0,top:0},i={right:this.__tableBorderWidth,rightUnit:"px",bottom:this.__tableBorderWidth,bottomUnit:"px",top:0,left:0},r={bottom:this.__tableBorderWidth,bottomUnit:"px",left:0,top:0,right:0};e.StyleProvider.processBorderWidth(this.__elementHeaderTable[0].getElementsByTagName("th"),t),e.StyleProvider.processBorderWidth(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),i),e.StyleProvider.processBorderWidth(this.__elementHeaderScroll,r);let o=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=checkbox] + label");for(let e=0,t=o.length;e<t;e++){let t=o[e].parentElement.cellIndex;if(t>=this.__columnWidths.length)continue;let i=Math.min(this.__rowHeight||0,this.__columnWidths[t].pixelWidth)-(this.__tableBorderWidth||0);o[e].style.width=i+"px",o[e].style.height=i+"px"}e.StyleProvider.setSimpleElementStyle(this.__elementHeaderTable[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element"),{width:this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth?this.__tableBorderWidth+"px":null,right:this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth?-this.__tableBorderWidth+"px":null});let s=Math.max(this.__tableBorderWidth||0,this.__resizeElementMinWidth),l=!1,n=this.__element[0].clientWidth-this.__columnWidths[0].pixelWidth;for(let e=0,t=this.__columnWidths.length;e<t;e++){let t="px"===this.__columnWidths[e].minWidthUnit?s:(a=s,n>0?a/n*100:0),i=0===e?6:this.__internalSrcColumn[e-1].minWidth;i=null!=i?i:0,i=i>=t?i:t,this.__columnWidths[e].minWidth<i&&(l=!0),this.__columnWidths[e].minWidth=i}var a;l&&this.__recalcAllColumnWidths()}setTableBorderWidthUnit(){}getTableBorderWidthUnit(){return"px"}setTableBorderStyle(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("TableBorderStyle"));let i=this.__objectResolvers.get("tableBorderStyle");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("tableBorderStyle",{resolver:r,watchCallback:this.__onResolverForTableBorderStyleWatchCallback,watchDestroyer:r.watch(this.__onResolverForTableBorderStyleWatchCallback)})}getTableBorderStyle(){return this.__tableBorderStyle}__processTableBorderStyle(){e.StyleProvider.processBorderStyle(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border th, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),this.__tableBorderStyle)}setShowRowNumbers(valueNew){let t=e.ValueConverter.toBoolean(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("ShowRowNumbers")),t!==this.__showRowNumbers&&(this.__showRowNumbers=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowRowNumbers"}),this.__processShowRowNumbers())}getShowRowNumbers(){return this.__showRowNumbers}__processShowRowNumbers(){e.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"display",this.__showRowNumbers?null:"none"),this.__recalcAllColumnWidths()}setRowNumbersResizable(valueNew){let t=e.ValueConverter.toBoolean(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersResizable")),t!==this.__rowNumbersResizable&&(this.__rowNumbersResizable=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersResizable"}),this.__processRowNumbersResizable())}getRowNumbersResizable(){return this.__rowNumbersResizable}__processRowNumbersResizable(){var e;this.__columnWidths[0].resizable=null!==(e=this.__rowNumbersResizable)&&void 0!==e&&e,this.__elementHeaderTable.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers").toggleClass("resizable",this.__rowNumbersResizable)}setRowNumbersWidth(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersWidth")),t!==this.__rowNumbersWidth&&(this.__rowNumbersWidth=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersWidth"}),this.__processRowNumbersWidth())}getRowNumbersWidth(){return this.__rowNumbersWidth}__processRowNumbersWidth(){void 0!==this.__rowNumbersWidth&&this.__resizeColumn(0,this.__rowNumbersWidth,!0)}setRowNumbersWidthUnit(valueNew){let t=e.ValueConverter.toDimensionUnit(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersWidthUnit")),t!==this.__rowNumbersWidthUnit&&(this.__rowNumbersWidthUnit=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersWidthUnit"}),this.__processRowNumbersWidthUnit())}getRowNumbersWidthUnit(){return this.__rowNumbersWidthUnit}__processRowNumbersWidthUnit(){void 0!==this.__rowNumbersWidthUnit&&(this.__columnWidths[0].widthUnit=this.__rowNumbersWidthUnit,this.__processRowNumbersWidth())}setRowNumbersHorizontalAlignment(valueNew){let t=e.ValueConverter.toHorizontalAlignment(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersHorizontalAlignment")),t!==this.__rowNumbersHorizontalAlignment&&(this.__rowNumbersHorizontalAlignment=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersHorizontalAlignment"}),this.__processRowNumbersHorizontalAlignment())}getRowNumbersHorizontalAlignment(){return this.__rowNumbersHorizontalAlignment}__processRowNumbersHorizontalAlignment(){switch(this.__rowNumbersHorizontalAlignment){case"Left":case"Center":case"Right":e.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"text-align",this.__rowNumbersHorizontalAlignment.toLowerCase())}}setRowNumbersVerticalAlignment(valueNew){let t=e.ValueConverter.toVerticalAlignment(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersVerticalAlignment")),t!==this.__rowNumbersVerticalAlignment&&(this.__rowNumbersVerticalAlignment=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersVerticalAlignment"}),this.__processRowNumbersVerticalAlignment())}getRowNumbersVerticalAlignment(){return this.__rowNumbersVerticalAlignment}__processRowNumbersVerticalAlignment(){switch(this.__rowNumbersVerticalAlignment){case"Center":e.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"vertical-align","middle");break;case"Bottom":case"Top":e.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"vertical-align",this.__rowNumbersVerticalAlignment.toLowerCase())}}setRowNumbersCellPadding(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersCellPadding"));let i=this.__objectResolvers.get("rowNumbersCellPadding");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("rowNumbersCellPadding",{resolver:r,watchCallback:this.__onResolverForRowNumbersCellPaddingWatchCallback,watchDestroyer:r.watch(this.__onResolverForRowNumbersCellPaddingWatchCallback)})}getRowNumbersCellPadding(){return this.__rowNumbersCellPadding}__processRowNumbersCellPadding(){e.StyleProvider.processContentPadding(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersCellPadding)}setCellContentPadding(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("CellContentPadding"));let i=this.__objectResolvers.get("cellContentPadding");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("cellContentPadding",{resolver:r,watchCallback:this.__onResolverForCellContentPaddingWatchCallback,watchDestroyer:r.watch(this.__onResolverForCellContentPaddingWatchCallback)})}getCellContentPadding(){return this.__cellContentPadding}__processCellContentPadding(){let t=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell:not(.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control)");e.StyleProvider.processContentPadding(t,this.__cellContentPadding);let i=this.__elementDataTableBody[0].querySelectorAll('input[type="text"]');e.StyleProvider.processContentPadding(i,this.__cellContentPadding);let r=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select");e.StyleProvider.processContentPadding(r,this.__cellContentPadding)}setHeaderBackgroundColor(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderBackgroundColor"));let i=this.__objectResolvers.get("headerBackgroundColor");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("headerBackgroundColor",{resolver:r,watchCallback:this.__onResolverForHeaderBackgroundColorWatchCallback,watchDestroyer:r.watch(this.__onResolverForHeaderBackgroundColorWatchCallback)})}getHeaderBackgroundColor(){return this.__headerBackgroundColor}__processHeaderBackgroundColor(){e.StyleProvider.processBackgroundColor(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border th, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-placeholder"),this.__headerBackgroundColor)}setHeaderTextColor(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderTextColor"));let i=this.__objectResolvers.get("headerTextColor");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("headerTextColor",{resolver:r,watchCallback:this.__onResolverForHeaderTextColorWatchCallback,watchDestroyer:r.watch(this.__onResolverForHeaderTextColorWatchCallback)})}getHeaderTextColor(){return this.__headerTextColor}__processHeaderTextColor(){e.StyleProvider.processTextColor(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header:not(.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers)"),this.__headerTextColor)}setRowNumbersTextColor(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersTextColor"));let i=this.__objectResolvers.get("rowNumbersTextColor");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("rowNumbersTextColor",{resolver:r,watchCallback:this.__onResolverForRowNumbersTextColorWatchCallback,watchDestroyer:r.watch(this.__onResolverForRowNumbersTextColorWatchCallback)})}getRowNumbersTextColor(){return this.__rowNumbersTextColor}__processRowNumbersTextColor(){e.StyleProvider.processTextColor(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersTextColor)}setRowNumbersBackgroundColor(valueNew){let t=e.ValueConverter.toObject(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersBackgroundColor"));let i=this.__objectResolvers.get("rowNumbersBackgroundColor");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let r=new e.Symbol.ObjectResolver(t);this.__objectResolvers.set("rowNumbersBackgroundColor",{resolver:r,watchCallback:this.__onResolverForRowNumbersBackgroundColorWatchCallback,watchDestroyer:r.watch(this.__onResolverForRowNumbersBackgroundColorWatchCallback)})}getRowNumbersBackgroundColor(){return this.__rowNumbersBackgroundColor}__processRowNumbersBackgroundColor(){e.StyleProvider.processBackgroundColor(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersBackgroundColor)}setHeaderFontFamily(valueNew){let t=e.ValueConverter.toFontFamily(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderFontFamily")),t!==this.__headerFontFamily&&(this.__headerFontFamily=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontFamily"}),this.__processHeaderFontFamily())}getHeaderFontFamily(){return this.__headerFontFamily}__processHeaderFontFamily(){e.StyleProvider.processFontFamily(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontFamily)}setHeaderFontSize(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderFontSize")),t!==this.__headerFontSize&&(this.__headerFontSize=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontSize"}),this.__processHeaderFontSize())}getHeaderFontSize(){return this.__headerFontSize}__processHeaderFontSize(){e.StyleProvider.processFontSize(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontSize,this.__headerFontSizeUnit)}setHeaderFontSizeUnit(valueNew){let t=e.ValueConverter.toFontSizeUnit(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderFontSizeUnit")),t!==this.__headerFontSizeUnit&&(this.__headerFontSizeUnit=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontSizeUnit"}),this.__processHeaderFontSizeUnit())}getHeaderFontSizeUnit(){return this.__headerFontSizeUnit}__processHeaderFontSizeUnit(){this.__processHeaderFontSize()}setHeaderFontStyle(valueNew){let t=e.ValueConverter.toFontStyle(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderFontStyle")),t!==this.__headerFontStyle&&(this.__headerFontStyle=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontStyle"}),this.__processHeaderFontStyle())}getHeaderFontStyle(){return this.__headerFontStyle}__processHeaderFontStyle(){e.StyleProvider.processFontStyle(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontStyle)}setHeaderFontWeight(valueNew){let t=e.ValueConverter.toFontWeight(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeaderFontWeight")),t!==this.__headerFontWeight&&(this.__headerFontWeight=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontWeight"}),this.__processHeaderFontWeight())}getHeaderFontWeight(){return this.__headerFontWeight}__processHeaderFontWeight(){e.StyleProvider.processFontWeight(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontWeight)}setGridFontFamily(valueNew){let t=e.ValueConverter.toFontFamily(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("GridFontFamily")),t!==this.__gridFontFamily&&(this.__gridFontFamily=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontFamily"}),this.__processGridFontFamily())}getGridFontFamily(){return this.__gridFontFamily}__processGridFontFamily(){e.StyleProvider.processFontFamily(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontFamily)}setGridFontSize(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("GridFontSize")),t!==this.__gridFontSize&&(this.__gridFontSize=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontSize"}),this.__processGridFontSize())}getGridFontSize(){return this.__gridFontSize}__processGridFontSize(){void 0!==this.__gridFontSize&&void 0!==this.__gridFontSizeUnit&&e.StyleProvider.processFontSize(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontSize,this.__gridFontSizeUnit)}setGridFontSizeUnit(valueNew){let t=e.ValueConverter.toFontSizeUnit(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("GridFontSizeUnit")),t!==this.__gridFontSizeUnit&&(this.__gridFontSizeUnit=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontSizeUnit"}),this.__processGridFontSizeUnit())}getGridFontSizeUnit(){return this.__gridFontSizeUnit}__processGridFontSizeUnit(){this.__processGridFontSize()}setGridFontStyle(valueNew){let t=e.ValueConverter.toFontStyle(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("GridFontStyle")),t!==this.__gridFontStyle&&(this.__gridFontStyle=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontStyle"}),this.__processGridFontStyle())}getGridFontStyle(){return this.__gridFontStyle}__processGridFontStyle(){e.StyleProvider.processFontStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontStyle)}setGridFontWeight(valueNew){let t=e.ValueConverter.toFontWeight(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("GridFontWeight")),t!==this.__gridFontWeight&&(this.__gridFontWeight=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontWeight"}),this.__processGridFontWeight())}getGridFontWeight(){return this.__gridFontWeight}__processGridFontWeight(){e.StyleProvider.processFontWeight(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontWeight)}setRowNumbersFontFamily(valueNew){let t=e.ValueConverter.toFontFamily(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersFontFamily")),t!==this.__rowNumbersFontFamily&&(this.__rowNumbersFontFamily=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontFamily"}),this.__processRowNumbersFontFamily())}getRowNumbersFontFamily(){return this.__rowNumbersFontFamily}__processRowNumbersFontFamily(){e.StyleProvider.processFontFamily(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontFamily)}setRowNumbersFontSize(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersFontSize")),t!==this.__rowNumbersFontSize&&(this.__rowNumbersFontSize=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontSize"}),this.__processRowNumbersFontSize())}getRowNumbersFontSize(){return this.__rowNumbersFontSize}__processRowNumbersFontSize(){void 0!==this.__rowNumbersFontSize&&void 0!==this.__rowNumbersFontSizeUnit&&e.StyleProvider.processFontSize(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontSize,this.__rowNumbersFontSizeUnit)}setRowNumbersFontSizeUnit(valueNew){let t=e.ValueConverter.toFontSizeUnit(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersFontSizeUnit")),t!==this.__rowNumbersFontSizeUnit&&(this.__rowNumbersFontSizeUnit=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontSizeUnit"}),this.__processRowNumbersFontSizeUnit())}getRowNumbersFontSizeUnit(){return this.__rowNumbersFontSizeUnit}__processRowNumbersFontSizeUnit(){this.__processRowNumbersFontSize()}setRowNumbersFontStyle(valueNew){let t=e.ValueConverter.toFontStyle(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersFontStyle")),t!==this.__rowNumbersFontStyle&&(this.__rowNumbersFontStyle=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontStyle"}),this.__processRowNumbersFontStyle())}getRowNumbersFontStyle(){return this.__rowNumbersFontStyle}__processRowNumbersFontStyle(){e.StyleProvider.processFontStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontStyle)}setRowNumbersFontWeight(valueNew){let t=e.ValueConverter.toFontWeight(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("RowNumbersFontWeight")),t!==this.__rowNumbersFontWeight&&(this.__rowNumbersFontWeight=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontWeight"}),this.__processRowNumbersFontWeight())}getRowNumbersFontWeight(){return this.__rowNumbersFontWeight}__processRowNumbersFontWeight(){e.StyleProvider.processFontWeight(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontWeight)}setSelectedRowIndex(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("SelectedRowIndex")),null!==this.__selectedCell&&t===this.__selectedCell.rowIndex||(null!==t?null===this.__selectedCell?this.__selectedCell={rowIndex:t,columnIndex:-1}:this.__selectedCell.rowIndex=t:null!==this.__selectedCell&&(this.__selectedCell.rowIndex=null),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedRowIndex"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__processSelectedRowIndex())}getSelectedRowIndex(){return null!==this.__selectedCell?this.__selectedCell.rowIndex:null}__processSelectedRowIndex(){if(this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let e=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===e)return;let t=this.__elementDataTableBody.find(`tr[data-row=${e}]`).addClass("focused");t.length>0&&(-1===this.__selectedCell.columnIndex?t.find("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers").addClass("focused"):t.find(`td[data-column=${this.__selectedCell.columnIndex}]`).addClass("focused"))}}setSelectedColumnIndex(valueNew){let t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("SelectedColumnIndex")),null!==this.__selectedCell&&t===this.__selectedCell.columnIndex||(null!==t?null===this.__selectedCell?this.__selectedCell={rowIndex:null,columnIndex:t}:this.__selectedCell.columnIndex=t:null!==this.__selectedCell&&(this.__selectedCell.columnIndex=-1),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__processSelectedColumnIndex())}getSelectedColumnIndex(){return null!==this.__selectedCell?this.__selectedCell.columnIndex:null}__processSelectedColumnIndex(){this.__processSelectedRowIndex()}getSrcDataHasChanged(){return this.__srcDataHasChanged}getSelectedCellValue(){if(this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex&&this.__srcData.length>this.__selectedCell.rowIndex){if(this.__selectedCell.columnIndex>=0){let e=this.__internalSrcColumn[this.__selectedCell.columnIndex],t=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);return-1===t?null:i.isSimpleColumn(e)?this.__srcData[t]:this.__readObjectProperty(this.__srcData[t],e.name)}if(!this.__pagingInfo.usePaging&&this.__filterSortMap){let e=this.__filterSortMap.indexOf(this.__selectedCell.rowIndex);return-1!==e?e+1:null}{let e=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);return-1===e?null:e+1}}return null}getSelectedRowValue(){if(this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let e=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===e)return null;if(this.__srcData.length>e)return this.__srcData[e]}return null}setWidthMode(valueNew){let t=e.ValueConverter.toSizeModeWithContent(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("WidthMode")),t!==this.__widthMode&&(this.__widthMode=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"WidthMode"}),this.__processWidthMode())}__getContentWidth(){if("Collapsed"===this.__visibility)return null;if("Content"!==this.__widthMode)return super.__getContentWidth();let e=this.__columnWidths.reduce((e,t,i)=>0!==i||this.__showRowNumbers?e+Math.max("px"===t.widthUnit?t.width:0,"px"===t.minWidthUnit?t.minWidth:0):e,0);if(this.__isAttached){let t=this.__elementDataScroll[0];e+=t.offsetWidth-t.clientWidth}return 0!==e?e:null}__processWidth(){if("Content"===this.getWidthMode()){let t=this.__getContentWidth();if(t===this.__contentWidth)return;this.__contentWidth=t;let i="";null!==t&&(i=t+"px"),e.StyleProvider.setSimpleElementStyle(this.__element,"width",i)}else this.__contentWidth=null;super.__processWidth()}setHeightMode(valueNew){let t=e.ValueConverter.toSizeModeWithContent(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("HeightMode")),t!==this.__heightMode&&(this.__heightMode=t,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeightMode"}),this.__processHeightMode())}__getContentHeight(){if("Collapsed"===this.__visibility)return null;if("Content"!==this.__heightMode)return super.__getContentHeight();let e=("px"===this.__headerHeightUnit&&this.__headerHeight||0)+this.__dataLength*(this.__rowHeight||0);if(this.__isAttached){let t=this.__elementDataScroll[0];e+=t.offsetHeight-t.clientHeight}return 0!==e?e:null}__processHeight(){if("Content"===this.getHeightMode()){let e=this.__getContentHeight();if(e===this.__contentHeight)return;this.__contentHeight=e,this.__intHeight=null!==e?e+"px":null}else this.__contentHeight=null;super.__processHeight()}__lock(e,t,r){this.__lockState={row:e,column:t,propertyName:null,rowElement:r,editStarted:!1};let o=this.__internalSrcColumn[t];i.isSimpleColumn(o)||(this.__lockState.propertyName=o.name)}__unlock(){if(!this.__srcData||!this.__lockState)return;let e=this.__scrollInfo.firstIndex-this.__scrollInfo.buffer;e=e>0?e:0;let t=this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer;t=t<=this.__dataLength?t:this.__dataLength;let i=!this.__pagingInfo.usePaging&&this.__filterSortMap?this.__filterSortMap.indexOf(this.__originalIndexToSrcDataIndex(this.__lockState.row)):this.__originalIndexToSrcDataIndex(this.__lockState.row),r=this.__lockState.rowElement;this.__lockState=null;let o=this.__elementDataTableBody[0];-1===i||r.classList.contains("hidden")?o.removeChild(r):i<e&&o.firstElementChild?o.removeChild(o.firstElementChild):i>=t&&o.lastElementChild&&o.removeChild(o.lastElementChild)}__srcDataIndexToOriginalIndex(e){return this.__pagingInfo.usePaging&&void 0===(e=this.__pagingInfo.filterMap[e-this.__pagingInfo.actualOffset])?-1:e}__originalIndexToSrcDataIndex(e){return this.__pagingInfo.usePaging&&-1!==(e=this.__pagingInfo.filterMap.indexOf(e))&&(e+=this.__pagingInfo.actualOffset),e}__processIsEnabled(){super.__processIsEnabled(),!this.getIsEnabled()&&this.__selectedCombobox&&this.__closeCombobox()}}t.TcHmiDatagrid=i,function(e){e.isSimpleColumn=function(e){return e&&void 0===e.name}}(i=t.TcHmiDatagrid||(t.TcHmiDatagrid={}))}(i=t.Beckhoff||(t.Beckhoff={})),t.registerEx("TcHmiDatagrid","TcHmi.Controls.Beckhoff",e.Controls.Beckhoff.TcHmiDatagrid)}(t=e.Controls||(e.Controls={}))}(TcHmi||(TcHmi={}));